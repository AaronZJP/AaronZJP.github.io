{"meta":{"title":"Aaronçš„åšå®¢","subtitle":"Stay foolish,Stay hungry!","description":"å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ï¼Œéšä¾¿å†™å†™ï¼Œæƒ³åˆ°å•¥å°±å†™å•¥ã€‚","author":"Aaron_36","url":"Aaronzjp.cn"},"pages":[{"title":"æ ‡ç­¾","date":"2014-12-22T04:39:04.000Z","updated":"2017-06-08T02:00:29.000Z","comments":true,"path":"tags/index.html","permalink":"Aaronzjp.cn/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"What's new in iOS11","slug":"What-s-new-in-iOS11","date":"2017-10-12T03:06:03.000Z","updated":"2017-10-12T03:18:31.000Z","comments":true,"path":"2017/10/12/What-s-new-in-iOS11/","link":"","permalink":"Aaronzjp.cn/2017/10/12/What-s-new-in-iOS11/","excerpt":"è·ç¦»iOS11å¼€å‘å¤§ä¼šç»“æŸå¾ˆä¹…äº†ï¼Œç„¶è€Œä¸€å¤©æ‡’å¾—è·ŸçŒªğŸ·ä¸€æ ·çš„ï¼ŒiOS11æ­£å¼å‘å¸ƒåä¹Ÿä¸€ç›´æ²¡æœ‰å»æ•´ç†è¿™äº›ä¸œè¥¿ï¼Œç°åœ¨æ‰æ•´ç†ä¸€ç‚¹ç‚¹å‡ºæ¥ã€‚ä¸‹é¢å°±æ˜¯åœ¨iOS11ä¸­æ–°åŠ å…¥çš„ä¸€äº›ä¸œè¥¿ï¼Œå¯èƒ½ä¸æ˜¯å¾ˆå…¨é¢ï¼Œä½†æ˜¯åç»­ä¼šæœ‰è¡¥å……å§ã€‚","text":"è·ç¦»iOS11å¼€å‘å¤§ä¼šç»“æŸå¾ˆä¹…äº†ï¼Œç„¶è€Œä¸€å¤©æ‡’å¾—è·ŸçŒªğŸ·ä¸€æ ·çš„ï¼ŒiOS11æ­£å¼å‘å¸ƒåä¹Ÿä¸€ç›´æ²¡æœ‰å»æ•´ç†è¿™äº›ä¸œè¥¿ï¼Œç°åœ¨æ‰æ•´ç†ä¸€ç‚¹ç‚¹å‡ºæ¥ã€‚ä¸‹é¢å°±æ˜¯åœ¨iOS11ä¸­æ–°åŠ å…¥çš„ä¸€äº›ä¸œè¥¿ï¼Œå¯èƒ½ä¸æ˜¯å¾ˆå…¨é¢ï¼Œä½†æ˜¯åç»­ä¼šæœ‰è¡¥å……å§ã€‚ whatâ€™s new in iOS 11Drag and Dropç›®å‰åœ¨ iPad è®¾å¤‡ä¸­çš„åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡æ‹–åŠ¨UIä¸Šçš„ä¸œè¥¿åˆ°å…¶ä»–App ç›®å‰æ”¯æŒçš„æ§ä»¶æœ‰ TableView CollectionView TextView TextField WebView åŒæ—¶è¿˜æ•´åˆäº† UIPasteConfiguration File Manageræ–‡ä»¶ç®¡ç†ç³»ç»Ÿï¼Œå¯ä»¥æµè§ˆæ–‡ä»¶ç®¡ç†ç³»ç»Ÿä¸­äº‘ä¸Šçš„æ–‡ä»¶ä»¥åŠæœ¬åœ°æ–‡ä»¶ã€‚å…¶ä¸­å¯ä»¥é€šè¿‡ç›¸å…³çš„APIå»è¿‡æ»¤æ–‡ä»¶ï¼Œä»¥ä¾¿è¿‡æ»¤åˆ°Appä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹ UIDocumentBrowserViewController éƒ¨åˆ†çš„UIå¢å¼ºæ”¹å–„1. æ·»åŠ äº†å¤§çš„æ ‡é¢˜æ ï¼ŒLarge Titles é€šè¿‡æ§åˆ¶å™¨çš„ä¸€ä¸ªå±æ€§ï¼ŒprefersLargeTitle æ¥å†³å®šå¤§æ ‡é¢˜æ˜¯å¦æ˜¾ç¤º æ˜¾ç¤ºæ¨¡å¼largeTitleDisplayMode å†³å®šæ˜¾ç¤ºçš„æ¨¡å¼ï¼Œä¸€èˆ¬åªåœ¨æ ‘æ¡©å¯¼èˆªç»“æ„ä¸­çš„æ ¹è¯•å›¾ä¸­æ˜¾ç¤º 2. SearchBarè¢«æ•´åˆè¿›äº†UINavigationBarä¸­ï¼Œä»¥å‰åªèƒ½æ˜¯ä½œä¸ºTableViewçš„ headerView æ¥å¤„ç†çš„ï¼Œç°åœ¨å¯ä»¥ç›´æ¥å°†å…¶èµ‹å€¼ç»™ NavigationItem åˆ‡ä½œä¸º NavigationBar ä¸­çš„ä¸€ä¸ªæ•´ä½“ 3. safeAreaInsetsåœ¨ iOS 11 ä¸­æ·»åŠ äº†å®‰å…¨åŒºåŸŸçš„æ¦‚å¿µï¼Œå…¶ä½œç”¨å¤§æ¦‚æ˜¯ä¸ºäº†æ›´å¥½çš„ç¡®ä¿æˆ‘ä»¬è¦æ˜¾ç¤ºçš„ View èƒ½æ­£ç¡®çš„å‡ºç°åœ¨å±å¹•ä¸­ï¼Œå› ä¸º iPhone X çš„å±å¹•çš„ç‰¹æ®Šæ€§ï¼ŒsafeArea è¿™ä¸ªä¸œè¥¿åº”è¯¥æ›´å¤šæ˜¯ä¸ºäº†æ›´å¥½çš„é€‚é… iPhone X çš„å±å¹•çš„æ˜¾ç¤ºã€‚ safeAreaLayoutGuide å®‰å…¨åŒºåŸŸä¸­ AutoLayout ä¸­çš„å±æ€§ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ çº¦æŸçš„æ–¹å¼æ¥ç¡®ä¿ UI æ˜¾ç¤ºåœ¨å®‰å…¨åŒºåŸŸçš„èŒƒå›´å†… func safeAreaInsetsDidChange() å®‰å…¨åŒºåŸŸå‘ç”Ÿæ”¹å˜æ—¶çš„å›è°ƒæ–¹æ³•ï¼Œåœ¨æˆ‘çš„å®éªŒä¸­å®‰å…¨åŒºåŸŸåœ¨ viewDidLoad ä¸­æ˜¯ä¸º0çš„ æ»‘åŠ¨æ“ä½œiOS11 ä¸­åœ¨ TableView ä¸­å¯¹æ»‘åŠ¨æ“ä½œè¿›è¡Œäº†å¢å¼ºã€‚ä»¥å‰ TableView ä¸­æ»‘åŠ¨æ“ä½œåªæ˜¯é»˜è®¤çš„æ”¯æŒåˆ é™¤ã€‚ç°åœ¨æ»‘åŠ¨æ“ä½œå¯ä»¥æ›´åŠ çµæ´»çš„è‡ªå®šä¹‰å…¶ä»–çš„åŠŸèƒ½ 123456789class UISwipeActionsConfiguration &#123; init(actions: [UIContextualAction])var performsFirstActionWithFullSwipe: Bool &#125; class UIContextualAction &#123;init(style: Style, title: String?, handler: UIContextualActionHandler) &#125; TableViewåˆ†å‰²çº¿ å¯ä»¥è‡ªå®šä¹‰åˆ†å‰²çº¿çš„è·ç¦» Swift 4 å’Œ å¼€å‘æ¡†æ¶çš„Swift 4 ä¸­åŠ å…¥äº†å¯¹åŸç”Ÿç±»å‹çš„å½’æ¡£æ”¯æŒï¼Œåªéœ€è¦éµå®ˆ Codable åè®®å³å¯ï¼ŒåŒæ—¶è¿˜æ”¯æŒ JSON ä»¥åŠ Property List Key Paths é”®å€¼è·¯å¾„ï¼Œä»¥å‰çš„é”®å€¼è·¯å¾„éƒ½æ˜¯ç»å¯¹çš„ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´å¦‚æœå†™é”™äº†è·¯å¾„å°±ä¼šæŠ¥é”™ï¼Œä½†æ˜¯åœ¨ Swift4 ä¸­æ–°å¢äº†ç›¸å¯¹çš„é”®å€¼è·¯å¾„ 12345let copresenterNameKeyPath = \\Presenter.copresenter.nameeliza[keyPath: copresenterNameKeyPath] // â€œJoshâ€eliza[keyPath: .copresenter.name] åŒæ—¶è¿˜æ–°å¢äº†åŸºäº block çš„ KVOã€‚é€šè¿‡ block æ¥å®Œæˆ KVO ä»£ç æ›´åŠ ç®€æ´ AutoLayoutAutoLayoutæ–°å¢äº†å¯¹ ScrollView æ›´å¥½çš„æ”¯æŒï¼ŒScrollView å› ä¸ºæ˜¯å¤„äºä¸¤ç§åæ ‡çš„æ¨¡å¼ Frame å’Œå†…å®¹åæ ‡æ¨¡å¼ Contentï¼Œè¿™æ ·åœ¨ AutoLayoutä¸­å¹¶ä¸æ˜¯å¾ˆå¥½å¤„ç†ã€‚ç°åœ¨æ–°å¢äº† contentLayoutGuide frameLayoutGuide ä¸¤ä¸ªå±æ€§ï¼Œå·²æ–¹ä¾¿åœ¨ ScrollView ä¸­çš„å¸ƒå±€ Dynamic TypeUIFontMetrics åŠ¨æ€ç±»å‹ã€‚ Sizing your text å­—ä½“è‡ªé€‚åº”ï¼Œåœ¨ iOS 7 ä¸­å¼•å…¥çš„åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡ç³»ç»Ÿé€šç”¨ä¸­è®¾ç½®çš„å­—ä½“å¤§å°é‚£æ”¹å˜ App ä¸­çš„å­—ä½“ï¼ŒiOS 11ä¹‹å‰åªèƒ½æ”¯æŒé»˜è®¤çš„å­—ä½“ï¼Œä½†æ˜¯åœ¨ iOS 11ä¸­å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„å­—ä½“ 12345let bodyMetrics = UIFontMetrics(forTextStyle: .body)let standardFont = ... // any font you want, for standard type sizelet font = bodyMetrics.scaledFont(for: standardFont) AutoLayoutåœ¨è‡ªåŠ¨å¸ƒå±€ä¸Šæ§ä»¶é—´çš„è·ç¦»ä¹Ÿä¼šéšç€å­—ä½“å¤§å°çš„å˜åŒ–è€Œè‡ªåŠ¨è°ƒæ•´ Password AutoFillå¯†ç è‡ªåŠ¨å¡«å…… Asset CatalogsAsset æ”¯æŒæ·»åŠ é¢œè‰²ï¼Œå¹¶ä¸ºé¢œè‰²å‘½åï¼ŒåŒæ—¶æ”¯æŒå¹¿åŸŸè‰²å½© å›¾ç‰‡èµ„æºæ”¯æŒ PDF ä»¥åŠ çŸ¢é‡å›¾ã€‚tabBar åœ¨ iOS 11 ä¸­å¯ä»¥å¤§å›¾æ ‡ï¼Œå¦‚æœåœ¨ Asset ä¸­ä½¿ç”¨ PDF å›¾ç‰‡èµ„æºï¼Œå¹¶å‹¾é€‰æ”¯æŒçŸ¢é‡å›¾é‚£ä¹ˆ tabBar åˆ™é»˜è®¤æ”¯æŒæ˜¾ç¤ºå¤§å›¾æ ‡ã€‚å¦‚æœæ²¡æœ‰åˆ™éœ€è¦è‡ªè¡Œå»è®¾ç½® Variable Refresh Rateå±å¹•åˆ·æ–°ç‡å¤§è·å–ï¼Œå¯ä»¥é’ˆå¯¹è‡ªå·±çš„ App ç±»å‹è°ƒæ•´åˆé€‚çš„","categories":[],"tags":[{"name":"WWDC2017","slug":"WWDC2017","permalink":"Aaronzjp.cn/tags/WWDC2017/"}]},{"title":"ReactiveCocoa å’Œ MVVM çš„ç®€å•ä½¿ç”¨","slug":"ReactiveCocoa-and-MVVM","date":"2017-08-28T05:14:55.000Z","updated":"2017-11-16T07:08:39.000Z","comments":true,"path":"2017/08/28/ReactiveCocoa-and-MVVM/","link":"","permalink":"Aaronzjp.cn/2017/08/28/ReactiveCocoa-and-MVVM/","excerpt":"MVVMåœ¨ iOS ä¸­æœ€å¼€å§‹çš„æ—¶å€™ä»¥åŠæˆ‘ä»¬ä¸€å¼€å§‹å­¦ä¹ çš„æ—¶å€™å°±æ˜¯ä½¿ç”¨çš„ MVC çš„æ¨¡å¼æ¥è¿›è¡ŒiOS App å¼€å‘çš„ã€‚MVC çš„æ¨¡å¼æ€»çš„æ¥è¯´å°±æ˜¯åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ† Model(æ•°æ®æ¨¡å‹)ã€View(ç•Œé¢ï¼Œè§†å›¾)ã€Controller(æ§åˆ¶å™¨)ã€‚ åœ¨ MVC ä¸­ä»–ä»¬çš„é€šä¿¡æ–¹å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¯¥å›¾æ¥è‡ªæ–¯å¦ç¦å…¬å¼€è¯¾ä¸­çš„ PDF æ–‡ä»¶ã€‚","text":"MVVMåœ¨ iOS ä¸­æœ€å¼€å§‹çš„æ—¶å€™ä»¥åŠæˆ‘ä»¬ä¸€å¼€å§‹å­¦ä¹ çš„æ—¶å€™å°±æ˜¯ä½¿ç”¨çš„ MVC çš„æ¨¡å¼æ¥è¿›è¡ŒiOS App å¼€å‘çš„ã€‚MVC çš„æ¨¡å¼æ€»çš„æ¥è¯´å°±æ˜¯åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ† Model(æ•°æ®æ¨¡å‹)ã€View(ç•Œé¢ï¼Œè§†å›¾)ã€Controller(æ§åˆ¶å™¨)ã€‚ åœ¨ MVC ä¸­ä»–ä»¬çš„é€šä¿¡æ–¹å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¯¥å›¾æ¥è‡ªæ–¯å¦ç¦å…¬å¼€è¯¾ä¸­çš„ PDF æ–‡ä»¶ã€‚ å¦‚å›¾æ‰€ç¤ºï¼Œåœ¨ iOS å¼€å‘ä¸­ MVC çš„æ¨¡å¼ä¹‹é—´çš„é€šä¿¡æ–¹å¼å¦‚å›¾æ‰€ç¤ºï¼Œåœ¨è¯¥æ¨¡å¼ä¸­ Model å’Œ View ä¹‹é—´æ˜¯æ— æ³•ç›¸äº’é€šä¿¡çš„ï¼Œéƒ½æ˜¯é€šè¿‡ Controller æ¥å®Œæˆ Model å’Œ VIew ä¹‹å‰çš„é€šä¿¡ã€‚å¦‚æ­¤ä¸€æ¥ Controller ä¸­çš„ä¸œè¥¿å°±ä¼šååˆ†å¤šï¼ŒController ç±»å°±ä¼šååˆ†çš„å¤æ‚å’Œå¤§é‡çš„ä»£ç ã€‚æ‰€ä»¥åæ¥å°±å‡ºç°äº† MVVM çš„æ¨¡å¼ã€‚ MVVM å®ƒåˆ†åˆ«æ˜¯ç”± Model View View-Model ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆçš„ã€‚ Modelï¼šModel åœ¨ MVVM æ¨¡å¼ä¸­æ²¡æœ‰å¤ªå¤§çš„å˜åŒ–ï¼Œä¸»è¦è¿˜æ˜¯æ•°æ®çš„æ¨¡å‹ã€‚å¯èƒ½ä¹Ÿä¼šåœ¨å…¶ä¸­å°è£…ä¸€éƒ¨åˆ†çš„å…³äºæ•°æ®å¤„ç†å’Œä¸šåŠ¡é€»è¾‘çš„ä¸€äº›ä»£ç ã€‚ Viewï¼šå¾ˆæ˜æ˜¾å°±æ˜¯è¯´è§†å›¾ï¼Œåœ¨ iOS ä¸­è§†å›¾ä¸å•å•æ˜¯è§†å›¾ç±»çš„ä»£ç ï¼Œå…¶ä¸­ä¹ŸåŒ…æ‹¬äº† storyboardã€xibç­‰è§†å›¾ï¼ŒåŒæ—¶ä¹ŸåŒ…æ‹¬ Controller åœ¨å†…ã€‚ View-Modelï¼šView-Model åœ¨è¿™é‡Œçœ‹èµ·æ¥åº”è¯¥æ˜¯å‰é¢ä¸¤ç§çš„ç»„åˆï¼Œå…¶å®å¹¶ä¸æ˜¯ã€‚è¿™é‡Œçš„ View-Model å…¶å®æ˜¯è´Ÿè´£è§†å›¾æ˜¾ç¤ºéœ€è¦æ•°æ®çš„å¤„ç†çš„ä¸€ä¸ªç±»ï¼Œå¯ä»¥åŒ…æ‹¬æ•°æ®çš„è¯·æ±‚ï¼Œæ•°æ®çš„å¤„ç†ç­‰ã€‚View-Model ä¸­çš„æ•°æ®ä¸»è¦æä¾›ç»™ View ç”¨æ¥å±•ç¤ºå’Œæ˜¾ç¤ºã€‚ MVVM å…¶ç»“æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š å›¾ç‰‡æ¥è‡ªç»´åŸºç™¾ç§‘ï¼Œåœ¨ iOS ä¸­å›¾ä¸Šçš„ View ä¹Ÿåº”è¯¥åŒ…æ‹¬ Controllerã€‚å…¶ä¸­ View-Model æ˜¯ä»‹äº View(Controller) å’Œ Model ä¹‹é—´çš„ã€‚åœ¨ MVVM æ¨¡å¼ä¸­æ•°æ®çš„è·å–å’Œæ•°æ®çš„è·å–ä»¥åŠæ•°æ®çš„å¤„ç†éƒ½æ˜¯åœ¨ View-Model ä¸­æ¥å®Œæˆçš„ï¼Œå…¶ä¸­ View-Model å†é€šè¿‡ Model å°†æ•°æ®è½¬åŒ–æˆä¸€ä¸ªä¸€ä¸ªçš„ Model ç”¨æ¥ä¾›è§†å›¾å±•ç¤ºå’Œæ˜¾ç¤ºå‡ºæ¥ã€‚å…¶å® MVVM æ¨¡å‹å°±æ˜¯ä¸€ä¸ª MVC ç»è¿‡ä¼˜åŒ–åçš„æ¨¡å¼ã€‚å®ƒå°†åŸæ¥éœ€è¦åœ¨ View(Controller) ä¸­éœ€è¦å¤„ç†çš„æ•°æ®å•ç‹¬æå–åˆ° View-Model ä¸­æ¥å¤„ç†ï¼Œè¿™æ · View(Controller) åªè¦è´Ÿè´£æ˜¾ç¤ºå³å¯ï¼Œè®© View(Controller) æ›´åŠ çš„è½»é‡åŒ–ã€‚ MVVMä¸ReactiveCocoaView-ModelView-Model æ˜¯å’Œ Controller åœ¨ä¸€èµ·çš„ï¼Œä½†æ˜¯ View-Model å’Œ Controller æ˜¯ç›¸äº’ç‹¬ç«‹çš„ä¸¤ä¸ªä¸œè¥¿ï¼ŒView-Model åŸºæœ¬ä¸Šæ˜¯è´Ÿè´£å¤„ç†æ•°æ®çš„è·å–å’Œè¿‡æ»¤çš„ã€‚Controller é€šè¿‡ View-Model è·å–æ•°æ®æ¥ä½¿ç”¨ã€‚ åœ¨ä¾‹å­ä¸­ï¼Œæœ‰è¿™æ ·ä¸€ä¸ª UITableView ç”¨æ¥å±•ç¤ºä¸€äº›è½¦è¾†å®¡éªŒçš„ä¿¡æ¯ï¼Œè¿™é‡Œç»“åˆäº† ReactiveCocoa æ¥åšæ§åˆ¶æ•°æ®è¯·æ±‚åçš„æ•°æ®æµåŠ¨ã€‚è¯·æ±‚è·å–æ•°æ®åï¼Œé€šè¿‡åœ¨ Controller å¯¹ä¿¡å·è®¢é˜…ä»ä¿¡å·ç®¡é“ä¸­è·å–åˆ°æ•°æ®ã€‚æˆ‘çœ‹åˆ°æœ‰çš„äººæ˜¯åœ¨è¯·æ±‚åˆ°çš„æ•°æ®é€šè¿‡åªè¯»å±æ€§æš´éœ²åœ¨å¤–çš„ï¼Œä½†æ˜¯æˆ‘è§‰å¾—æ—¢ç„¶è¿™é‡Œä½¿ç”¨äº† ReactiveCocoa æ¥åšå¤„ç†ï¼Œæ‰€ä»¥æˆ‘è¿˜æ˜¯æŠŠæ•°æ®é€šè¿‡ä¿¡å·ç®¡é“çš„æ–¹å¼æ¥ä½¿ç”¨è¯·æ±‚åˆ°çš„æ•°æ®å¥½ä¸€ç‚¹ã€‚å¦å¤– View-Model è¿™ä¸ªç±»åœ¨è®¾è®¡çš„æ—¶å€™å› ä¸ºå¯¹æ•°æ®ç§ç±»è¿™ç‚¹æ²¡è€ƒè™‘åˆ°æ‰€ä»¥è¿™ä¸ªç±»è®¾è®¡å¾—ä¸æ˜¯å¾ˆå¥½ï¼Œè¿™é‡Œä¹Ÿå°±å…ˆä¸ç»†åŒ–çš„è¯´äº†ã€‚ä¸»è¦è®°å½•ä¸€ä¸‹ MVVM + ReactiveCocoa çš„ç®€å•çš„ä½¿ç”¨çš„ä¸€ä¸ªèŒƒä¾‹ã€‚ CarCheckViewModel.h 1234567891011121314151617181920#import &lt;Foundation/Foundation.h&gt;#import &lt;ReactiveObjC.h&gt;#import &quot;CarCheckModel.h&quot;//æ•°æ®ç§ç±»typedef NS_ENUM(NSUInteger, CarCheckDataType) &#123; Plan = 0, History&#125;;@interface CarCheckViewModel : NSObject@property (nonatomic,strong,readonly) RACCommand *getCarCheckListCommand;//åŠ è½½æ•°æ®- (void)loadDataWithType:(CarCheckDataType)type;//åŠ è½½æ›´å¤šæ•°æ®- (void)loadMoreDataWithType:(CarCheckDataType)type;//åˆ·æ–°æ•°æ®- (void)refreshDataWithType:(CarCheckDataType)type;@end CarCheckViewModel.m 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#import &quot;CarCheckViewModel.h&quot;#import &quot;CarCheckAPIManager.h&quot;#import &quot;AccountManager.h&quot;#import &quot;CarCheckModel.h&quot;@interface CarCheckViewModel()@property (nonatomic,strong,readwrite) RACCommand *getCarCheckListCommand;//Modelæ•°ç»„@property (nonatomic,strong,readwrite) NSArray&lt;CarCheckModel *&gt; *carCheckList;@end@implementation CarCheckViewModel- (instancetype)init &#123; if (self = [super init]) &#123; if (!_getCarCheckListCommand) &#123; _getCarCheckListCommand = [[RACCommand alloc]initWithSignalBlock:^RACSignal * _Nonnull(id _Nullable input) &#123; return [self getCarCheckListSignalWithParameter:input]; &#125;]; &#125; &#125; return self;&#125;- (void)loadDataWithType:(CarCheckDataType)type &#123; NSDictionary *parameter = @&#123;@&quot;number&quot;:[[AccountManager sharedInstance]getStoredNumber],@&quot;first&quot;:@(0),@&quot;type&quot;:@(type)&#125;; [self.getCarCheckListCommand execute:parameter];&#125;- (void)loadMoreDataWithType:(CarCheckDataType)type &#123; NSDictionary *parameter = @&#123;@&quot;number&quot;:[[AccountManager sharedInstance]getStoredNumber],@&quot;first&quot;:@(_carCheckList.count),@&quot;type&quot;:@(type)&#125;; [self.getCarCheckListCommand execute:parameter];&#125;- (void)refreshDataWithType:(CarCheckDataType)type &#123; [self loadDataWithType:type];&#125;- (RACSignal *)getCarCheckListSignalWithParameter:(NSDictionary *) parameter &#123; RACSignal *signal = [RACSignal createSignal:^RACDisposable * _Nullable(id&lt;RACSubscriber&gt; _Nonnull subscriber) &#123; [[[CarCheckAPIManager alloc]init]loadDataWithParams:parameter success:^(id data) &#123; [subscriber sendNext:data]; [subscriber sendCompleted]; &#125; failure:^(id data) &#123; [subscriber sendError:data]; [subscriber sendCompleted]; &#125;]; return nil; &#125;]; return [signal map:^id _Nullable(id _Nullable value) &#123; NSMutableArray *dicArray = value[@&quot;resultInfos&quot;]; _carCheckList = [[dicArray.rac_sequence map:^id _Nullable(id _Nullable value) &#123; return [[CarCheckModel alloc]initWithDictionary:value]; &#125;] array]; return _carCheckList; &#125;];&#125;@end Modelä»–çš„ Model ç±»å¦‚ä¸‹ï¼Œè¯¥æ¨¡å‹ç±»æ˜¯ä½¿ç”¨ JSONExport è‡ªåŠ¨ç”Ÿæˆçš„ï¼š CarCheckModel.h 1234567891011121314#import &lt;UIKit/UIKit.h&gt;@interface CarCheckModel : NSObject@property (nonatomic, strong) NSString * inspectionTime;@property (nonatomic, strong) NSString * plateNumber;@property (nonatomic, strong) NSString * remark;@property (nonatomic, assign) NSInteger type;@property (nonatomic, strong) NSString * waiteTime;-(instancetype)initWithDictionary:(NSDictionary *)dictionary;-(NSDictionary *)toDictionary;@end CarCheckModel.m 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119#import &quot;CarCheckModel.h&quot;NSString *const kCarCheckModelInspectionTime = @&quot;inspectionTime&quot;;NSString *const kCarCheckModelPlateNumber = @&quot;plateNumber&quot;;NSString *const kCarCheckModelRemark = @&quot;remark&quot;;NSString *const kCarCheckModelType = @&quot;type&quot;;NSString *const kCarCheckModelWaiteTime = @&quot;waiteTime&quot;;@interface CarCheckModel ()@end@implementation CarCheckModel/** * Instantiate the instance using the passed dictionary values to set the properties values */-(instancetype)initWithDictionary:(NSDictionary *)dictionary&#123; self = [super init]; if(![dictionary[kCarCheckModelInspectionTime] isKindOfClass:[NSNull class]])&#123; self.inspectionTime = dictionary[kCarCheckModelInspectionTime]; &#125; if(![dictionary[kCarCheckModelPlateNumber] isKindOfClass:[NSNull class]])&#123; self.plateNumber = dictionary[kCarCheckModelPlateNumber]; &#125; if(![dictionary[kCarCheckModelRemark] isKindOfClass:[NSNull class]])&#123; self.remark = dictionary[kCarCheckModelRemark]; &#125; if(![dictionary[kCarCheckModelType] isKindOfClass:[NSNull class]])&#123; self.type = [dictionary[kCarCheckModelType] integerValue]; &#125; if(![dictionary[kCarCheckModelWaiteTime] isKindOfClass:[NSNull class]])&#123; self.waiteTime = dictionary[kCarCheckModelWaiteTime]; &#125; return self;&#125;/** * Returns all the available property values in the form of NSDictionary object where the key is the approperiate json key and the value is the value of the corresponding property */-(NSDictionary *)toDictionary&#123; NSMutableDictionary * dictionary = [NSMutableDictionary dictionary]; if(self.inspectionTime != nil)&#123; dictionary[kCarCheckModelInspectionTime] = self.inspectionTime; &#125; if(self.plateNumber != nil)&#123; dictionary[kCarCheckModelPlateNumber] = self.plateNumber; &#125; if(self.remark != nil)&#123; dictionary[kCarCheckModelRemark] = self.remark; &#125; dictionary[kCarCheckModelType] = @(self.type); if(self.waiteTime != nil)&#123; dictionary[kCarCheckModelWaiteTime] = self.waiteTime; &#125; return dictionary;&#125;/** * Implementation of NSCoding encoding method *//** * Returns all the available property values in the form of NSDictionary object where the key is the approperiate json key and the value is the value of the corresponding property */- (void)encodeWithCoder:(NSCoder *)aCoder&#123; if(self.inspectionTime != nil)&#123; [aCoder encodeObject:self.inspectionTime forKey:kCarCheckModelInspectionTime]; &#125; if(self.plateNumber != nil)&#123; [aCoder encodeObject:self.plateNumber forKey:kCarCheckModelPlateNumber]; &#125; if(self.remark != nil)&#123; [aCoder encodeObject:self.remark forKey:kCarCheckModelRemark]; &#125; [aCoder encodeObject:@(self.type) forKey:kCarCheckModelType]; if(self.waiteTime != nil)&#123; [aCoder encodeObject:self.waiteTime forKey:kCarCheckModelWaiteTime]; &#125;&#125;/** * Implementation of NSCoding initWithCoder: method */- (instancetype)initWithCoder:(NSCoder *)aDecoder&#123; self = [super init]; self.inspectionTime = [aDecoder decodeObjectForKey:kCarCheckModelInspectionTime]; self.plateNumber = [aDecoder decodeObjectForKey:kCarCheckModelPlateNumber]; self.remark = [aDecoder decodeObjectForKey:kCarCheckModelRemark]; self.type = [[aDecoder decodeObjectForKey:kCarCheckModelType] integerValue]; self.waiteTime = [aDecoder decodeObjectForKey:kCarCheckModelWaiteTime]; return self;&#125;/** * Implementation of NSCopying copyWithZone: method */- (instancetype)copyWithZone:(NSZone *)zone&#123; CarCheckModel *copy = [CarCheckModel new]; copy.inspectionTime = [self.inspectionTime copy]; copy.plateNumber = [self.plateNumber copy]; copy.remark = [self.remark copy]; copy.type = self.type; copy.waiteTime = [self.waiteTime copy]; return copy;&#125;@end è¯¥ç±»ä¸»è¦æ˜¯æ•°æ®æ¨¡å‹çš„ä½œç”¨ï¼Œç”¨æ¥å­˜å‚¨å’Œä½¿ç”¨æ•°æ®ï¼Œä»¥åŠå¯¹æ•°æ®è¿›è¡Œä¸€äº›ä¸šåŠ¡é€»è¾‘çš„å¤„ç†çš„ä½œç”¨ã€‚ View(Controller)é€šè¿‡è¿™æ ·çš„æ–¹å¼ååœ¨ View ä¸­ä¸»è¦åšçš„äº‹å°±å¾ˆç®€å•äº†ï¼Œåªéœ€è¦æŠŠæ•°æ®å’Œ View ç»‘å®šèµ·æ¥å¹¶å±•ç¤ºå‡ºæ¥å°±å¯ä»¥ã€‚åœ¨è¿™ä¸ªç±»ä¸­æ¶‰åŠäº†é¡¹ç›®ä¸­å¾ˆå¤šå…¶ä»–çš„ç±»ï¼Œæ‰€ä»¥ä¸è¦åœ¨æ„å…¶ä»–çš„ï¼Œé‡è¦çš„æ˜¯çœ‹æ¸…æ€è·¯ï¼ŒMVVM å¤§æ¦‚å°±æ˜¯è¿™ä¹ˆä¸ªç»“æ„æ¥åšå¤„ç†çš„ã€‚å½“ç„¶åœ¨è¿™ä¸ªé¡µé¢ä¸­åªæ˜¯ç”¨æ¥å±•ç¤ºä¸œè¥¿ï¼Œæ²¡æœ‰äº†å…¶ä»–æ›´å¤šçš„æ“ä½œã€‚å…·ä½“åº”ç”¨åˆ°é¡¹ç›®ä¸­çš„æ—¶å€™ï¼Œå¯èƒ½è¿˜è¦ç»“åˆ ReactiveCocoa æ¥åšä¸€äº›å…¶ä»–çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ç™»é™†ç•Œé¢ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ MVVM + ReactiveCocoa æ¥åšï¼Œä½¿ç”¨ ReactiveCocoa æ¥ç›‘æ§ç”¨æˆ·çš„äº¤äº’åˆ¤æ–­ç”¨æˆ·åå’Œå¯†ç æ¥å†³å®šæ˜¯å¦å¯ä»¥ç™»é™†å’Œæ˜¯å¦ç™»é™†æˆåŠŸç­‰ã€‚ CarCheckViewController.m 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174#import &quot;CarCheckViewController.h&quot;#import &quot;CarCheckTableViewCell.h&quot;#import &quot;CarCheckViewModel.h&quot;#import &quot;AccountManager.h&quot;#import &quot;HLYHUD.h&quot;#import &quot;TaskVCHeaderView.h&quot;#import &quot;MJRefresh.h&quot;@interface CarCheckViewController () &lt;UITableViewDataSource,UITableViewDelegate&gt;@property (nonatomic,strong) UITableView *planTableView;@property (nonatomic,strong) UITableView *historyTableView;@property (nonatomic,strong) CarCheckViewModel *planViewModel;@property (nonatomic,strong) CarCheckViewModel *historyViewModel;@property (nonatomic,strong) NSArray&lt;CarCheckModel *&gt; *planDataSource;@property (nonatomic,strong) NSArray&lt;CarCheckModel *&gt; *historyDataSource;@property (nonatomic,strong) TaskVCHeaderView *segmentView;@property (nonatomic,strong) UIScrollView *scrollView;@property (nonatomic,assign) NSInteger currentPageIndex;@end@implementation CarCheckViewController- (CarCheckViewModel *)planViewModel &#123; if (!_planViewModel) &#123; _planViewModel = [[CarCheckViewModel alloc]init]; [_planViewModel.getCarCheckListCommand.executionSignals.switchToLatest subscribeNext:^(id _Nullable x) &#123; _planDataSource = x; [_planTableView.mj_header endRefreshing]; [_planTableView.mj_footer endRefreshing]; [_planTableView reloadData]; &#125;]; [_planViewModel.getCarCheckListCommand.errors subscribeNext:^(id _Nullable x) &#123; [HLYHUD hideHUDForView:_planTableView]; [_planTableView.mj_header endRefreshing]; [_planTableView.mj_footer endRefreshing]; [HLYHUD showHUDWithMessage:x[@&quot;message&quot;] addToView:_planTableView]; &#125;]; [_planViewModel.getCarCheckListCommand.executing subscribeNext:^(NSNumber * _Nullable x) &#123; if ([x boolValue]) &#123; [HLYHUD showLoadingHudAddToView:self.view]; &#125; else &#123; [HLYHUD hideHUDForView:self.view]; &#125; &#125;]; &#125; return _planViewModel;&#125;- (CarCheckViewModel *)historyViewModel &#123; if (!_historyViewModel) &#123; _historyViewModel = [[CarCheckViewModel alloc]init]; [_historyViewModel.getCarCheckListCommand.executionSignals.switchToLatest subscribeNext:^(id _Nullable x) &#123; _historyDataSource = x; [_historyTableView.mj_header endRefreshing]; [_historyTableView.mj_footer endRefreshing]; [_historyTableView reloadData]; &#125;]; [_historyViewModel.getCarCheckListCommand.errors subscribeNext:^(id _Nullable x) &#123; [HLYHUD hideHUDForView:_historyTableView]; [_historyTableView.mj_header endRefreshing]; [_historyTableView.mj_footer endRefreshing]; [HLYHUD showHUDWithMessage:x[@&quot;message&quot;] addToView:_historyTableView]; &#125;]; [_historyViewModel.getCarCheckListCommand.executing subscribeNext:^(NSNumber * _Nullable x) &#123; if ([x boolValue]) &#123; [HLYHUD showLoadingHudAddToView:self.view]; &#125; else &#123; [HLYHUD hideHUDForView:self.view]; &#125; &#125;]; &#125; return _historyViewModel;&#125;- (void)viewDidLoad &#123; [super viewDidLoad]; self.view.backgroundColor = [UIColor whiteColor]; self.title = @&quot;è½¦è¾†å®¡éªŒ&quot;; _currentPageIndex = 100; _segmentView = [[TaskVCHeaderView alloc]initWithFrame:CGRectMake(0, 0, kScreenWidth, 44)]; _segmentView.titleArray = @[@&quot;è®¡åˆ’æ‰§è¡Œ&quot;,@&quot;å†å²è®°å½•&quot;]; __weak CarCheckViewController *weakSelf =self; _segmentView.changeVCBlock = ^(NSInteger index) &#123; if (index == _currentPageIndex) &#123; return; &#125; else &#123; _currentPageIndex = index; if (index == 100) &#123; [weakSelf.scrollView setContentOffset:CGPointMake(0, 0) animated:YES]; [weakSelf.planViewModel loadDataWithType:Plan]; &#125; else &#123; [weakSelf.scrollView setContentOffset:CGPointMake(CGRectGetWidth(weakSelf.view.bounds), 0) animated:YES]; [weakSelf.historyViewModel loadDataWithType:History]; &#125; &#125; &#125;; [self.view addSubview:_segmentView]; _scrollView = [[UIScrollView alloc]initWithFrame:CGRectMake(0, 44, CGRectGetWidth(self.view.bounds) * 2, CGRectGetHeight(self.view.bounds) - 44)]; [self.view addSubview:_scrollView]; _planTableView = [[UITableView alloc]initWithFrame:CGRectMake(0, 0, self.view.bounds.size.width, self.view.bounds.size.height - 44) style:UITableViewStylePlain]; _planTableView.dataSource = self; _planTableView.delegate = self; _planTableView.rowHeight = UITableViewAutomaticDimension; _planTableView.estimatedRowHeight = 100; _planTableView.tableFooterView = [UIView new]; _planTableView.mj_header = [MJRefreshNormalHeader headerWithRefreshingBlock:^&#123; [_planViewModel refreshDataWithType:Plan]; &#125;]; _planTableView.mj_footer = [MJRefreshBackNormalFooter footerWithRefreshingBlock:^&#123; [_planViewModel loadMoreDataWithType:Plan]; &#125;]; [_scrollView addSubview:_planTableView]; _historyTableView = [[UITableView alloc]initWithFrame:CGRectMake(CGRectGetWidth(self.view.bounds), 0, self.view.bounds.size.width, self.view.bounds.size.height - 44) style:UITableViewStylePlain]; _historyTableView.dataSource = self; _historyTableView.delegate = self; _historyTableView.rowHeight = UITableViewAutomaticDimension; _historyTableView.estimatedRowHeight = 100; _historyTableView.tableFooterView = [UIView new]; _historyTableView.mj_header = [MJRefreshNormalHeader headerWithRefreshingBlock:^&#123; [_historyViewModel refreshDataWithType:History]; &#125;]; _historyTableView.mj_footer = [MJRefreshBackNormalFooter footerWithRefreshingBlock:^&#123; [_historyViewModel loadMoreDataWithType:History]; &#125;]; [_scrollView addSubview:_historyTableView]; [self.planViewModel loadDataWithType:Plan];&#125;- (void)didReceiveMemoryWarning &#123; [super didReceiveMemoryWarning]; &#125;- (NSInteger) tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section &#123; if (tableView == _historyTableView) &#123; return _historyDataSource.count; &#125; else &#123; return _planDataSource.count; &#125;&#125;- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath &#123; static NSString *identifier = @&quot;CheckCarCell&quot;; CarCheckTableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:identifier]; if (!cell) &#123; cell = [[CarCheckTableViewCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:identifier]; &#125; CarCheckModel *carCheck; if (tableView == _historyTableView) &#123; carCheck = _historyDataSource[indexPath.row]; &#125; else &#123; carCheck = _planDataSource[indexPath.row]; &#125; [cell fillDataWithModel:carCheck]; return cell;&#125;@end","categories":[],"tags":[{"name":"Reactive Cocoa","slug":"Reactive-Cocoa","permalink":"Aaronzjp.cn/tags/Reactive-Cocoa/"},{"name":"MVVM","slug":"MVVM","permalink":"Aaronzjp.cn/tags/MVVM/"}]},{"title":"ReactiveCocoaçš„åŸºæœ¬ä½¿ç”¨","slug":"Use-ReactiveCocoa","date":"2017-08-03T01:59:47.000Z","updated":"2017-08-28T05:13:25.000Z","comments":true,"path":"2017/08/03/Use-ReactiveCocoa/","link":"","permalink":"Aaronzjp.cn/2017/08/03/Use-ReactiveCocoa/","excerpt":"ä»€ä¹ˆæ˜¯ReactiveCocoaï¼Ÿæœ€è¿‘å› ä¸ºå…¬å¸çš„ä¸€ä¸ªé¡¹ç›®å› ä¸ºæ˜¯ç”¨ ReactiveCocoa ç»“åˆ MVVM æ¥å†™çš„ï¼Œæ‰€ä»¥åœ¨æˆ‘æ¥æ‰‹çš„æ—¶å€™æˆ‘ä¹Ÿæ‰“ç®—ç»§ç»­ä½¿ç”¨è¿™ç§æ¨¡å¼ï¼Œå› ä¸ºæˆ‘è§‰å¾—è¿™ç§æ¨¡å¼è¿˜æ˜¯æœ‰ä¸€å®šçš„å¥½å¤„çš„ï¼Œé€šè¿‡ ReactiveCocoa çš„ä½¿ç”¨å¼ºåŒ–äº†é¡¹ç›®ä¸­å›´ç»•æ•°æ®å˜åŒ–æ‰€åšçš„æ”¹å˜ã€‚æ‰€ä»¥æœ€è¿‘è¿˜æ˜¯å­¦ä¹ ä¸€ä¸‹ ReactiveCocoa çš„ä¸€äº›åŸºæœ¬çš„ä½¿ç”¨ã€‚ ReactiveCocoaï¼ˆå…¶ç®€ç§°ä¸ºRACï¼‰æ˜¯ç”±Githubå·¥ç¨‹å¸ˆä»¬å¼€å‘çš„ä¸€ä¸ªåº”ç”¨äºiOSå’ŒOS Xå¼€å‘çš„å‡½æ•°å“åº”å¼ç¼–ç¨‹æ–°æ¡†æ¶ã€‚ReactiveCocoa çš„çµæ„Ÿæ¥æºäº å‡½æ•°å¼å“åº”å¼ç¼–ç¨‹ã€‚ReactiveCocoa çš„ä¼˜ç‚¹æ˜¯å¯ä»¥å¾ˆè½»æ¾çš„å¤„ç†çŠ¶æ€ä»¥åŠçŠ¶æ€ä¹‹é—´ä¾èµ–è¿‡å¤šçš„é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ç§å¾ˆå¥½çš„æ¶ˆæ¯ä¼ é€’çš„æœºåˆ¶ã€‚é€šè¿‡å¯¹ RACSignal (ä¿¡å·) çš„ä½¿ç”¨ï¼Œå¯ä»¥å¾ˆå¥½çš„å¤„ç†äº‹ä»¶æµï¼Œä»¥åŠäº‹ä»¶çš„ç›‘æ§ï¼ŒçŠ¶æ€æ”¹å˜çš„å¤„ç†ã€‚","text":"ä»€ä¹ˆæ˜¯ReactiveCocoaï¼Ÿæœ€è¿‘å› ä¸ºå…¬å¸çš„ä¸€ä¸ªé¡¹ç›®å› ä¸ºæ˜¯ç”¨ ReactiveCocoa ç»“åˆ MVVM æ¥å†™çš„ï¼Œæ‰€ä»¥åœ¨æˆ‘æ¥æ‰‹çš„æ—¶å€™æˆ‘ä¹Ÿæ‰“ç®—ç»§ç»­ä½¿ç”¨è¿™ç§æ¨¡å¼ï¼Œå› ä¸ºæˆ‘è§‰å¾—è¿™ç§æ¨¡å¼è¿˜æ˜¯æœ‰ä¸€å®šçš„å¥½å¤„çš„ï¼Œé€šè¿‡ ReactiveCocoa çš„ä½¿ç”¨å¼ºåŒ–äº†é¡¹ç›®ä¸­å›´ç»•æ•°æ®å˜åŒ–æ‰€åšçš„æ”¹å˜ã€‚æ‰€ä»¥æœ€è¿‘è¿˜æ˜¯å­¦ä¹ ä¸€ä¸‹ ReactiveCocoa çš„ä¸€äº›åŸºæœ¬çš„ä½¿ç”¨ã€‚ ReactiveCocoaï¼ˆå…¶ç®€ç§°ä¸ºRACï¼‰æ˜¯ç”±Githubå·¥ç¨‹å¸ˆä»¬å¼€å‘çš„ä¸€ä¸ªåº”ç”¨äºiOSå’ŒOS Xå¼€å‘çš„å‡½æ•°å“åº”å¼ç¼–ç¨‹æ–°æ¡†æ¶ã€‚ReactiveCocoa çš„çµæ„Ÿæ¥æºäº å‡½æ•°å¼å“åº”å¼ç¼–ç¨‹ã€‚ReactiveCocoa çš„ä¼˜ç‚¹æ˜¯å¯ä»¥å¾ˆè½»æ¾çš„å¤„ç†çŠ¶æ€ä»¥åŠçŠ¶æ€ä¹‹é—´ä¾èµ–è¿‡å¤šçš„é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ç§å¾ˆå¥½çš„æ¶ˆæ¯ä¼ é€’çš„æœºåˆ¶ã€‚é€šè¿‡å¯¹ RACSignal (ä¿¡å·) çš„ä½¿ç”¨ï¼Œå¯ä»¥å¾ˆå¥½çš„å¤„ç†äº‹ä»¶æµï¼Œä»¥åŠäº‹ä»¶çš„ç›‘æ§ï¼ŒçŠ¶æ€æ”¹å˜çš„å¤„ç†ã€‚ ReactiveCocoaä¸ä¼ ç»ŸiOSå¼€å‘çš„æ¯”è¾ƒåœ¨ä¼ ç»Ÿçš„ä»£ç ä¸­å¦‚æœæˆ‘ä»¬è¦å»æ£€æµ‹ TextFiled ä¸­è¾“å…¥çš„å˜æ¢å¯èƒ½éœ€è¦åƒä¸‹é¢è¿™æ ·ä½¿ç”¨ï¼š 12345[self.usernameTextField addTarget:self action:@selector(usernameTextFieldChanged) forControlEvents:UIControlEventEditingChanged:];- (void)passwordTextFieldChanged:(UITextField *)sender &#123; NSLog(@â€œ%@â€,sender.text);&#125; ä½†æ˜¯åœ¨ ReactiveCocoa ä¸­æˆ‘ä»¬å°±å¯ä»¥å¾ˆå·§å¦™çš„ç”¨æå°‘çš„ä»£ç åœ¨ Block ä¸­å»å¤„ç† TextFiled çš„è¾“å…¥çŠ¶æ€çš„å˜åŒ–ï¼Œä»£ç å¦‚ä¸‹ï¼š 123[self.usernameTextField.rac_textSignal subscribeNext:^(NSString * _Nullable x) &#123; NSLog(@&quot;%@&quot;,x);&#125;]; æ˜¯ä¸æ˜¯å¾ˆç®€ä¾¿ï¼Œä½†æ˜¯è¿™åªæ˜¯ç®€å•çš„å¤„ç†ï¼Œæ‰€ä»¥çœ‹ä¸å‡ºæ¥ç‰¹åˆ«å¤§çš„ä¼˜åŠ¿ï¼Œå¦‚æœæ˜¯ç¨å¾®å¤æ‚ä¸€ç‚¹çš„ï¼ŒReactiveCocoa çš„ä¼˜åŠ¿å°±å¯ä»¥å¾ˆæ˜æ˜¾çš„å±•ç¤ºå‡ºæ¥äº†ã€‚ ReactiveCocoaçš„ç®€å•ä½¿ç”¨ä¿¡å·åˆ›å»ºå¤§éƒ¨åˆ†æƒ…å†µä¸‹ ReactiveCocoa æ¡†æ¶ä¸­ UIKit æ§ä»¶éƒ½å·²ç»æ·»åŠ äº†ä¿¡å·ï¼Œä¾›æˆ‘ä»¬è®¢é˜…ä¿¡å·è¿›è¡Œå¤„ç†ã€‚ä½†æ˜¯åœ¨æœ‰äº›æ—¶å€™æˆ‘ä»¬ä¹Ÿéœ€è¦è‡ªå·±å»åˆ›å»ºä¿¡å·ã€‚åˆ›å»ºä¿¡å·æ–¹å¼å¦‚ä¸‹ï¼š 123456789101112// 1.åˆ›å»ºä¿¡å·RACSignal *signal = [RACSignal createSignal:^RACDisposable *(id&lt;RACSubscriber&gt; subscriber) &#123;// 3.å‘é€ä¿¡å·[subscriber sendNext:@&quot;ws&quot;];// 4.å–æ¶ˆä¿¡å·ï¼Œå¦‚æœä¿¡å·æƒ³è¦è¢«å–æ¶ˆï¼Œå°±å¿…é¡»è¿”å›ä¸€ä¸ªRACDisposable// ä¿¡å·ä»€ä¹ˆæ—¶å€™è¢«å–æ¶ˆï¼š1.è‡ªåŠ¨å–æ¶ˆï¼Œå½“ä¸€ä¸ªä¿¡å·çš„è®¢é˜…è€…è¢«é”€æ¯çš„æ—¶å€™æœºä¼šè‡ªåŠ¨å–æ¶ˆè®¢é˜…ï¼Œ2.æ‰‹åŠ¨å–æ¶ˆï¼Œ//blockä»€ä¹ˆæ—¶å€™è°ƒç”¨ï¼šä¸€æ—¦ä¸€ä¸ªä¿¡å·è¢«å–æ¶ˆè®¢é˜…å°±ä¼šè°ƒç”¨//blockä½œç”¨ï¼šå½“ä¿¡å·è¢«å–æ¶ˆæ—¶ç”¨äºæ¸…ç©ºä¸€äº›èµ„æºreturn [RACDisposable disposableWithBlock:^&#123;NSLog(@&quot;å–æ¶ˆè®¢é˜…&quot;);&#125;];&#125;]; ä¿¡å·è®¢é˜…ä¿¡å·è®¢é˜…ï¼Œé€šè¿‡ä¿¡å·è®¢é˜…æˆ‘ä»¬å¯ä»¥åšåˆ°å®æ—¶è§‚å¯Ÿéœ€è¦çš„æ•°æ®ä»¥åŠçŠ¶æ€ã€‚æ¯”å¦‚è¦è§‚å¯Ÿå¤„ç† UITextField çš„è¾“å…¥ï¼š 123[self.usernameTextField.rac_textSignal subscribeNext:^(NSString * _Nullable x) &#123; NSLog(@&quot;%@&quot;,x);&#125;]; ä¸Šé¢çš„ä»£ç å½“ usernameTextField åœ¨è¾“å…¥æ—¶ï¼Œè¾“å…¥çš„æ–‡å­—æ”¹å˜å°±ä¼šè§¦å‘ block ä¸­ä»£ç çš„æ‰§è¡Œã€‚ ReactiveCocoa çš„ä¿¡å·ä¼šå‘ä¿¡å·çš„è®¢é˜…è€…å‘é€å·²è®¢é˜…çš„äº‹ä»¶æµã€‚å…¶ä¸­å‘é€çš„äº‹ä»¶åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼šnextã€error å’Œ completedã€‚RACSignal æä¾›äº†å¤šç§æ–¹æ³•ç”¨æ¥è®¢é˜…ä¸åŒçš„äº‹ä»¶ç±»å‹ã€‚å¯ä»¥æ¥å—ä¸€ä¸ªæˆ–å¤šä¸ª block ä½œä¸ºå‚æ•°ï¼Œå½“äº‹ä»¶æµä¼ é€’åˆ°å½“å‰äº‹ä»¶çš„æ—¶å€™ï¼Œå°±ä¼šæ‰§è¡Œ block ä¸­çš„ä»£ç ã€‚ReactiveCocoa æ¡†æ¶ä½¿ç”¨ Category ä¸ºå¤§éƒ¨åˆ†çš„æ ‡å‡†çš„ UIKit æ§ä»¶éƒ½æ·»åŠ äº†ä¿¡å·ï¼Œé€šè¿‡è¿™äº›å·²ç»æ·»åŠ çš„ä¿¡å·æˆ‘ä»¬è¿›è¡Œè®¢é˜…ï¼Œå¯ä»¥å®Œæˆå¤§éƒ¨åˆ†å¸¸è§çš„æ“ä½œã€‚åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é’ˆå¯¹è‡ªå·±çš„æ§ä»¶è‡ªå·±å®šä¹‰ä¿¡å·ã€‚ ä¿¡å·å¯ä»¥è¢«è®¢é˜…ï¼Œä¹Ÿå¯ä»¥è¢«ä¸»åŠ¨çš„å–æ¶ˆè®¢é˜…ï¼Œå–æ¶ˆè®¢é˜…çš„æ–¹å¼å¦‚ä¸‹ï¼š 1234567// åªè¦è®¢é˜…ä¿¡å·å°±ä¼šè¿”å›ä¸€ä¸ªå–æ¶ˆè®¢é˜…ä¿¡å·çš„ç±»RACDisposable *disposable = [signal subscribeNext:^(id x) &#123;// blockçš„è°ƒç”¨æ—¶åˆ»ï¼šåªè¦ä¿¡å·å†…éƒ¨å‘å‡ºæ•°æ®å°±ä¼šè°ƒç”¨è¿™ä¸ªblockNSLog(@&quot;======%@&quot;, x);&#125;];// å–æ¶ˆè®¢é˜…[disposable dispose]; ä¿¡å·è¿‡æ»¤ReactiveCocoaè¿˜å…·æœ‰å¯¹äº‹ä»¶æµè¿›è¡Œè¿‡æ»¤çš„æ“ä½œã€‚æ¯”å¦‚ä¸‹é¢è¿™æ ·ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ§åˆ¶å°æ‰“å°å­—ç¬¦ä¸²é•¿åº¦è¶…è¿‡3çš„æƒ…å†µã€‚ 123456[[self.usernameTextField.rac_textSignal filter:^BOOL(NSString * _Nullable value) &#123; NSString *text = value; return text.length &gt; 3;&#125;] subscribeNext:^(NSString * _Nullable x) &#123; NSLog(@&quot;%@&quot;,x);&#125;]; ç°åœ¨å† TextField ä¸­è¾“å…¥ï¼Œåªæœ‰å½“å­—ç¬¦ä¸²é•¿åº¦è¶…è¿‡3ç‚¹æ—¶å€™æ‰ä¼šåœ¨æ§åˆ¶å°æ‰“å°å‡ºæ¥ã€‚ ä¿¡å·çš„å¤„ç†åœ¨ ReactiveCocoa ä¸­è¿˜å¯ä»¥å¯¹å½“å‰åŸå§‹ä¿¡å·è¿›è¡Œå¤„ç†ååœ¨è¿›å…¥åˆ°äº‹ä»¶æµä¸­ã€‚å¦‚ä¸‹ï¼š 1234567[[[self.usernameTextField.rac_textSignal map:^id _Nullable(NSString * _Nullable value) &#123; return @(value.length);&#125;] filter:^BOOL(id _Nullable value) &#123; return [value integerValue] &gt; 3;&#125;] subscribeNext:^(id _Nullable x) &#123; NSLog(@&quot;%@&quot;,x);&#125;]; ä¸Šé¢çš„ä»£ç ä¸­æˆ‘ä»¬å°±å°† NSString ç±»å‹çš„ Vlue è¿›è¡Œäº†å¤„ç†ï¼Œå½“å®ƒä¼ åˆ°ä¸‹ä¸€æ­¥æ—¶å°±æˆäº†NSNumber ç±»å‹äº†ã€‚å½“ç„¶ä¹Ÿå¯ä»¥å¯¹è¿™é‡Œçš„ Value åšå…¶ä»–æ“ä½œï¼Œä¼ åˆ°ä¸‹ä¸€æ­¥çš„æ—¶å€™å°±æ˜¯å…¶ä»–ç±»å‹çš„æ•°æ®äº†ã€‚ ä¿¡å·åˆæˆåœ¨æŸäº›æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å¤šç§ä¿¡å·éƒ½æ»¡è¶³æŸä¸ªæ¡ä»¶åå†è¿›è¡Œä¸‹ä¸€æ­¥çš„æ“ä½œå’Œæ‰§è¡Œã€‚æ¯”å¦‚åšä¸€ä¸ªç™»é™†çš„æ—¶å€™ï¼Œå½“è´¦å·å’Œå¯†ç éƒ½æ»¡è¶³çš„æ—¶å€™æ‰å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥çš„å¤„ç†ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¿¡å·åˆå¹¶ï¼Œå°†è´¦å·éªŒè¯çš„ä¿¡å·å’Œå¯†ç éªŒè¯çš„ä¿¡å·åˆå¹¶åæ¥å‡ºæ¥ã€‚ 12345678910111213141516171819202122232425262728//è´¦æˆ·éªŒè¯çš„ä¿¡å·RACSignal *validUserNameSignal = [self.usernameTextField.rac_textSignal map:^id _Nullable(NSString * _Nullable value) &#123; return @([self isValidUsername:value]);&#125;];//å¯†ç éªŒè¯çš„ä¿¡å·RACSignal *validPassWordSignal = [self.passwordTextField.rac_textSignal map:^id _Nullable(NSString * _Nullable value) &#123; return @([self isValidPassword:value]); &#125;]; //ä¿¡å·åˆå¹¶ï¼Œå®Œæˆç™»é™†æŒ‰é’®çš„å¯ç‚¹å‡»RACSignal *mergeSignal = [RACSignal combineLatest:@[validUserNameSignal,validPassWordSignal] reduce:^id (NSNumber *userNameValid, NSNumber *passWordValid)&#123; return @([userNameValid boolValue] &amp;&amp; [passWordValid boolValue]);&#125;];//å†æ¬¡è®¢é˜…åˆå¹¶çš„ä¿¡å·å¤„ç†ç™»é™†æŒ‰é’®çš„å“åº”[mergeSignal subscribeNext:^(id _Nullable x) &#123; self.signInButton.enabled = [x boolValue];&#125;];//è´¦æˆ·å’Œå¯†ç çš„éªŒè¯æ–¹å¼- (BOOL)isValidUsername:(NSString *)username &#123; return username.length &gt; 3;&#125;- (BOOL)isValidPassword:(NSString *)password &#123; return password.length &gt; 3;&#125; ä¸Šé¢è¿™æ®µä»£ç å°±ä½¿ç”¨ä¿¡å·åˆå¹¶ï¼Œåˆå¹¶åçš„ä¿¡å·æºå¸¦äº†ä¸€ä¸ª Bool å€¼ï¼Œå½“æ¯æ¬¡å…¶ä¸­ä¸€ä¸ªå‘é€æ–°çš„ä¿¡å·æ—¶ reduce ä¸­çš„block å°±ä¼šæ‰§è¡Œè¿”å›çš„è¿™ä¸ª Bool å€¼å°±ä¼šä½œä¸ºä¸€ä¸ªæ–°çš„åˆæˆçš„è¿™ä¸ªä¿¡å·å‘é€å‡ºå»ï¼Œæœ€ç»ˆé€šè¿‡è®¢é˜…è¿™ä¸ªåˆå¹¶åçš„ä¿¡å·æºå¸¦çš„ Bool å€¼æ¥åˆ¤æ–­ç™»é™†æŒ‰é’®æ˜¯å¦å¯ä»¥è¢«ç‚¹å‡»ã€‚ æ³¨æ„ï¼šRACSignalåˆæˆæ–¹æ³•å¯ä»¥åˆæˆä»»æ„æ•°é‡çš„ä¿¡å·ï¼Œè€Œreduce blockçš„å…¥å‚å’Œæºä¿¡å·ä¸€ä¸€å¯¹åº”ã€‚ReactiveCocoaæœ‰ä¸€ä¸ªå·§å¦™çš„å·¥å…·ç±»RACBlockTrampolineï¼Œç”¨ä»¥å†…éƒ¨å¤„ç†reduce blockçš„å¯å˜å…¥å‚åˆ—è¡¨ã€‚ ä¿¡å·ä¸­çš„ä¿¡å·æœ‰æ—¶å€™åœ¨ä¿¡å·ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½è¿˜éœ€è¦å»åˆ›å»ºä¸€ä¸ªæ–°çš„ä¿¡å·ï¼Œç”¨æ¥å¤„ç†äº‹ä»¶ï¼Œä½†æ˜¯è¿™ç§ä¿¡å·ä¸­çš„ä¿¡å·ï¼Œå°±æ˜¯ä¸€ä¸ªä¿¡å·ä¸­åˆåŒ…å«äº†å¦å¤–ä¸€ä¸ªä¿¡å·ã€‚è¦æ€ä¹ˆå»å¤„ç†å‘¢ï¼Ÿ â€‹ å¯ä»¥é€šè¿‡åœ¨ä¿¡å·ä¸­å»è®¢é˜…è¿™ä¸ªå†…éƒ¨çš„ä¿¡å·æ¥è·å–é‡Œé¢ä¿¡å·çš„ç»“æœï¼Œä½†æ˜¯è¿™æ ·åšæ¥è¯´è®¢é˜…åµŒå¥—ä¼šè®©ä»£ç å¾ˆæ··ä¹±ï¼Œæ‰€ä»¥ ReactiveCocoa ä¸ºè¿™æ ·çš„æƒ…å†µæä¾›äº†ä¸€ä¸ªè§£å†³çš„æ–¹å¼ã€‚ ä½¿ç”¨ flattenMap å°±å¯ä»¥è¿‡æ»¤è·å–åˆ°å†…éƒ¨çš„ä¿¡å·ï¼Œåœ¨ä¼ åˆ°ä¸‹ä¸€ä¸ªäº‹ä»¶çš„æ—¶å€™å°±ä¼ é€’çš„æ˜¯å†…éƒ¨çš„ä¿¡å·äº†ã€‚ 12345678910111213141516171819[[[self.signInButton rac_signalForControlEvents:UIControlEventTouchUpInside] flattenMap:^__kindof RACSignal * _Nullable(__kindof UIControl * _Nullable value) &#123; return [self loginSignal];&#125;]subscribeNext:^(id _Nullable x) &#123; BOOL isLoginSucces = [x boolValue]; self.signInFailureText.hidden = isLoginSucces; [self performSegueWithIdentifier:@&quot;signInSuccess&quot; sender:self];&#125;];- (RACSignal *)loginSignal &#123; return [RACSignal createSignal:^RACDisposable * _Nullable(id&lt;RACSubscriber&gt; _Nonnull subscriber) &#123; [self.signInService signInWithUsername:self.usernameTextField.text password:self.passwordTextField.text complete:^(BOOL success) &#123; [subscriber sendNext:@(success)]; [subscriber sendCompleted]; &#125;]; return [RACDisposable disposableWithBlock:^&#123; NSLog(@&quot;ä¿¡å·è®¢é˜…è¢«å–æ¶ˆ&quot;); &#125;]; &#125;];&#125; ä¸Šé¢è¿™æ®µä»£ç åœ¨å¤„ç†æŒ‰é’®ç‚¹å‡»çš„ä¿¡å·ä¸­è°ƒç”¨ [self loginSignal] æ–¹æ³•è¿”å›äº†ä¸€ä¸ªæ–°çš„ä¿¡å·ï¼Œè¿™å°±é€ æˆäº†ä¿¡å·ä¸­çš„ä¿¡å·ï¼Œåœ¨ä¸‹é¢çš„ä¿¡å·ä¼ é€’ä¸­è·å–åˆ°çš„ x å°±è·å–åˆ°çš„æ˜¯ä¸€ä¸ªä¿¡å·ï¼Œè€Œä¸æ˜¯æƒ³è¦ç™»é™†çš„ä¿¡å·ã€‚æ‰€ä»¥è¿™é‡Œç”¨ flattenMap å»è·å–ä¿¡å·ä¸­çš„ä¿¡å·ï¼Œä»¥æ–¹ä¾¿åœ¨æ¥ä¸‹æ¥çš„ä¿¡å·ä¼ é€’ä¸­èƒ½æ–¹ä¾¿çš„è·å–åˆ°ä¿¡å·ä¸­ç™»é™†ä¿¡å·ä¸­ä¼ é€’çš„å€¼ã€‚ æ³¨å…¥æ•ˆæœæ³¨å…¥æ•ˆæœï¼Œä¸»è¦çš„ä½œç”¨çš„æ˜¯åœ¨ä¿¡å·å‘å‡ºçš„æ—¶å€™åšå‡ºä¸€äº›å¤„ç†ã€‚æ³¨å…¥æ•ˆæœæœ‰è¿™æ ·ä¸‰ç§ -doNext: ã€-doError: ã€ -doCompleted: ï¼Œæ³¨å…¥æ•ˆæœæ²¡æœ‰è¿”å›å€¼ï¼Œå®ƒåªæ˜¯åœ¨å…¶å¯¹åº”çš„æ“ä½œä¹‹å‰æ‰§è¡Œ block ä¸­çš„ä»£ç ã€‚å¦‚ä¸‹ï¼Œåœ¨ -subscribeNext: å‰ä½œä¸€äº›å…¶ä»–å¤„ç†å°±å¯ä»¥ä½¿ç”¨ -doNext: çš„æ³¨å…¥æ•ˆæœï¼š 123456789[[[[self.signInButton rac_signalForControlEvents:UIControlEventTouchUpInside] doNext:^(__kindof UIControl * _Nullable x) &#123; self.signInButton.enabled = NO;&#125;]flattenMap:^__kindof RACSignal * _Nullable(__kindof UIControl * _Nullable value) &#123; return [self loginSignal];&#125;]subscribeNext:^(id _Nullable x) &#123; BOOL isLoginSucces = [x boolValue]; self.signInFailureText.hidden = isLoginSucces; [self performSegueWithIdentifier:@&quot;signInSuccess&quot; sender:self];&#125;]; è¿™é‡Œå°±æ˜¯åœ¨æŒ‰é’®è¢«ç‚¹å‡»çš„æ—¶å€™åœ¨ -doNext: çš„æ³¨å…¥æ•ˆæœä¸­å°†ç™»é™†æŒ‰é’®è®¾ç½®ä¸ºä¸å¯ç”¨ã€‚ å…¶ä½™ä¸¤ä¸ªæ³¨å…¥æ•ˆæœä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œåˆ†åˆ«æ˜¯åœ¨ -subscribeError: å’Œ -subscribeCompleted: æ‰§è¡Œä¹‹å‰æ‰§è¡Œ block ä¸­çš„ä»£ç ï¼Œä½†æ˜¯å¦‚æœæ·»åŠ äº†æ³¨å…¥æ•ˆæœï¼Œä½†æ˜¯åé¢æ²¡æœ‰è¿›è¡Œ -subscribeNext: ã€ -subscribeError: å’Œ -subscribeCompleted: æ“ä½œçš„è¯æ³¨å…¥æ•ˆæœæ˜¯ä¸ä¼šæ‰§è¡Œçš„ã€‚","categories":[],"tags":[{"name":"ReactiveCocoa","slug":"ReactiveCocoa","permalink":"Aaronzjp.cn/tags/ReactiveCocoa/"}]},{"title":"Swift-æšä¸¾","slug":"Swift-Enum","date":"2017-04-20T07:01:27.000Z","updated":"2017-08-01T07:06:31.000Z","comments":true,"path":"2017/04/20/Swift-Enum/","link":"","permalink":"Aaronzjp.cn/2017/04/20/Swift-Enum/","excerpt":"åœ¨ Swift ä¸­æšä¸¾æ˜¯ä¸€ç­‰ç±»å‹ã€‚ Swift ä¸­æšä¸¾æ˜¯ä¸€ä¸ªå¾ˆå¼ºå¤§çš„ç±»å‹ï¼Œåœ¨ C è¯­è¨€ä¸­æšä¸¾ä¼šä¸ºä¸€ç»„æ•´å‹å€¼åˆ†é…ç›¸å…³è”çš„åç§°ã€‚ä½†æ˜¯åœ¨ Swift ä¸­ä¸æ˜¯å¿…é¡»çš„ï¼Œå¦‚æœç»™æšä¸¾æˆå‘˜èµ‹å€¼(åœ¨ Swift ä¸­åˆå«åŸå§‹å€¼)ï¼Œåˆ™è¯¥å€¼çš„ç±»å‹å¯ä»¥æ˜¯å­—ç¬¦ã€å­—ç¬¦ä¸²ã€æ•´å‹ã€æˆ–è€…æ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°ã€‚é™¤äº†è¿™äº›ä»¥ä¸º Swift ä¸­çš„æšä¸¾è¿˜å¯ä»¥æŒ‡å®šä»»æ„ç±»å‹çš„å…³è”å€¼åˆ°æšä¸¾æˆå‘˜ä¸­ï¼Œè¿˜å¯ä»¥æ·»åŠ è®¡ç®—å±æ€§ï¼Œå®ä¾‹æ–¹æ³•ï¼Œè¿˜å¯ä»¥å®šä¹‰æ„é€ å‡½æ•°ï¼Œè¿˜å¯ä»¥éµå®ˆåè®®ã€‚","text":"åœ¨ Swift ä¸­æšä¸¾æ˜¯ä¸€ç­‰ç±»å‹ã€‚ Swift ä¸­æšä¸¾æ˜¯ä¸€ä¸ªå¾ˆå¼ºå¤§çš„ç±»å‹ï¼Œåœ¨ C è¯­è¨€ä¸­æšä¸¾ä¼šä¸ºä¸€ç»„æ•´å‹å€¼åˆ†é…ç›¸å…³è”çš„åç§°ã€‚ä½†æ˜¯åœ¨ Swift ä¸­ä¸æ˜¯å¿…é¡»çš„ï¼Œå¦‚æœç»™æšä¸¾æˆå‘˜èµ‹å€¼(åœ¨ Swift ä¸­åˆå«åŸå§‹å€¼)ï¼Œåˆ™è¯¥å€¼çš„ç±»å‹å¯ä»¥æ˜¯å­—ç¬¦ã€å­—ç¬¦ä¸²ã€æ•´å‹ã€æˆ–è€…æ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°ã€‚é™¤äº†è¿™äº›ä»¥ä¸º Swift ä¸­çš„æšä¸¾è¿˜å¯ä»¥æŒ‡å®šä»»æ„ç±»å‹çš„å…³è”å€¼åˆ°æšä¸¾æˆå‘˜ä¸­ï¼Œè¿˜å¯ä»¥æ·»åŠ è®¡ç®—å±æ€§ï¼Œå®ä¾‹æ–¹æ³•ï¼Œè¿˜å¯ä»¥å®šä¹‰æ„é€ å‡½æ•°ï¼Œè¿˜å¯ä»¥éµå®ˆåè®®ã€‚ æšä¸¾çš„å®šä¹‰æšä¸¾çš„å®šä¹‰å¦‚ä¸‹ï¼š 123456789enum SomeFood &#123; case water case milk case bread&#125;//å¤šä¸ªæˆå‘˜ä¹Ÿå¯ä»¥ä½¿ç”¨é€—å·éš”å¼€çš„æ–¹å¼å®šä¹‰enum SomeFood &#123; case water, milk, bread&#125; æšä¸¾ä¸­å®šä¹‰çš„å€¼æ˜¯è¿™ä¸ªæšä¸¾çš„æˆå‘˜å€¼(æˆå‘˜)ï¼Œå¯ä»¥ç”¨ case æ¥æ·»åŠ æˆå‘˜ï¼Œå…¶ä¸­è¿™ä¸ C å’Œ Obj-c ä¸åŒçš„æ˜¯è¿™é‡Œçš„æšä¸¾å€¼ä¸å›è¢«éšè—çš„èµ‹å€¼ä¸ºæ•´å‹ï¼Œå› ä¸º Swift ä¸­æšä¸¾çš„æˆå‘˜å€¼æœ¬èº«å°±æ˜¯å®Œå¤‡çš„å€¼ï¼Œè¿™äº›æˆå‘˜å€¼çš„ç±»å‹æ˜¯å·²ç»è¢«å®šä¹‰å¥½çš„æšä¸¾çš„ç±»å‹ã€‚ æšä¸¾å…¶å®å°±åƒæ˜¯å®šä¹‰äº†ä¸€ä¸ªå…¨æ–°çš„ç±»å‹ï¼Œå°±åƒ Swift ä¸­å…¶ä»–çš„ç±»å‹ä¸€æ ·ã€‚å¦‚æœæšä¸¾ç±»å‹å¯ä»¥æ ¹æ®ä¸Šä¸‹æ–‡æ¨å¯¼å‡ºæ¥ï¼Œé‚£ä¹ˆèµ‹å€¼ä¸€ä¸ªæšä¸¾å€¼çš„æ—¶å€™å¯ä»¥çœç•¥æšä¸¾ç±»å‹ã€‚ 123var food = SomeFood.bread//åœ¨åˆæ¬¡çš„food = .milk ä½¿ç”¨ switch åŒ¹é…æšä¸¾å€¼ 123456789var food = SomeFood.milkswitch food &#123;case .water: print(\"this is water\")case .milk: print(\"this is milk\")case .bread: print(\"this is bread\")&#125; å…³è”å€¼åœ¨ Swift ä¸­ï¼Œæšä¸¾æˆå‘˜è¿˜å¯ä»¥æ·»åŠ ä»»æ„ç±»å‹çš„æšä¸¾å…³è”å€¼ï¼Œä½†æ˜¯åœ¨åŒä¸€ä¸ªæšä¸¾ç±»å‹å˜é‡ä¸­ï¼Œåªèƒ½åŒæ—¶å­˜åœ¨ä¸€ä¸ªæšä¸¾æˆå‘˜çš„å…³è”å€¼ã€‚å¦‚ä¸‹ï¼š 123456enum HttpStatus &#123; case errorCode(Int) case errorMessage(String)&#125;var code = HttpStatus.errorCode(5) è¿™äº›æšä¸¾å€¼çš„å…³è”å€¼è¿˜å¯ä»¥é€šè¿‡å˜é‡/å¸¸é‡è¿›è¡Œå€¼ç»‘å®šçš„æ–¹å¼æå‡ºæ¥å•ç‹¬ä½¿ç”¨ï¼š 123456switch code &#123;case .errorCode(let code): print(\"\\(code)\")case .errorMessage(let message): print(message)&#125; åŸå§‹å€¼åœ¨ Swift ä¸­æšä¸¾é™¤äº†å…³è”å€¼ä»¥ä¸ºï¼Œæšä¸¾è¿˜å¯ä»¥æœ‰åŸå§‹å€¼(é»˜è®¤å€¼)ï¼ŒåŸå§‹å€¼çš„ç±»å‹å¿…é¡»ç›¸åŒï¼Œæšä¸¾çš„åŸå§‹å€¼éœ€è¦æ˜¾ç¤ºçš„å£°æ˜ç±»å‹ã€‚åŸå§‹å€¼å¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ï¼Œæˆ–è€…ä»»æ„æ•´å‹å€¼æˆ–æµ®ç‚¹å‹å€¼ã€‚æ¯ä¸ªåŸå§‹å€¼åœ¨æšä¸¾å£°æ˜ä¸­å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚å¦‚ä¸‹ä¸ºæšä¸¾è®¾ç½®åŸå§‹å€¼ï¼š 123456enum Season: String &#123; case spring = \"æ˜¥å¤©\" case summer = \"å¤å¤©\" case autumn = \"ç§‹å¤©\" case winter = \"å†¬å¤©\"&#125; å£°æ˜éšå¼åŸå§‹å€¼ï¼š 12345enum Number: Int &#123; case one,two,three,four,five,six,seven,eight,nine,ten&#125;let one = Number(rawValue: 0) åŸå§‹å€¼ä¸º Int ç±»å‹æ—¶é»˜è®¤æ˜¯ä»0å¼€å§‹çš„ï¼Œä½†æ˜¯ä¸€æ—¦è®¾ç½®äº†ä¸€ä¸ªæšä¸¾æˆå‘˜çš„åŸå§‹å€¼ï¼Œåé¢çš„åŸå§‹å€¼åˆ™ä¾æ¬¡é€’å¢1ã€‚åŸå§‹å€¼ä¸º String ç±»å‹æ—¶é»˜è®¤åŸå§‹å€¼æ˜¯è¯¥æšä¸¾æˆå‘˜çš„åç§°ã€‚åŸå§‹å€¼æ˜¯å…¶ä»–ç±»å‹çš„æ—¶å€™åˆ™éœ€è¦ä¸€ä¸ªä¸€ä¸ªçš„è®¾ç½®å…¶åŸå§‹å€¼ã€‚ 123456enum Constants: Double &#123; case Ï€ = 3.14159 case e = 2.71828 case Ï† = 1.61803398874 case Î» = 1.30357&#125; ä½¿ç”¨æšä¸¾æˆå‘˜çš„ rawValue å±æ€§å¯ä»¥è®¿é—®æšä¸¾æˆå‘˜çš„åŸå§‹å€¼ï¼š 123456enum Number: Int &#123; case one,two = 8,three,four,five,six,seven,eight,nine,ten&#125;let one = Number.eight.rawValue//è¾“å‡º 14 ä½¿ç”¨åŸå§‹å€¼åˆå§‹åŒ–æšä¸¾æˆå‘˜ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªå¯é€‰æšä¸¾æˆå‘˜ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨æ²¡æœ‰åŸå§‹å€¼å¯¹åº”çš„æšä¸¾æˆå‘˜ï¼š 12345enum Number: Int &#123; case one,two = 8,three,four,five,six,seven,eight,nine,ten&#125;let six = Number(rawValue: 6)//è¯¥å€¼ä¸å›è¿”å›6ï¼Œè€Œæ˜¯nil é€’å½’æšä¸¾æšä¸¾é€’å½’å¯ä»¥è®©æšä¸¾åŒ…å«æšä¸¾æœ¬èº«ï¼Œå¦‚ä¸‹å«å…¥æ–‡ä»¶å¤¹å’Œæ–‡ä»¶çš„å…³ç³»å°±å¯ä»¥è¿™æ ·è¡¨ç¤ºï¼Œå› ä¸ºæ–‡ä»¶å¤¹ä¸­å¯ä»¥åŒ…å«æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼š 12345678910enum FileNode &#123; case File(name: String) indirect case Folder(name: String, files: [FileNode])&#125;let fileName = FileNode.File(name: \"å˜å½¢é‡‘åˆš\")let fileName2 = FileNode.File(name: \"è¥¿æ¸¸è®°\")let fileName3 = FileNode.Folder(name: \"åŠ¨ä½œç”µå½±\", files: [FileNode.Folder(name: \"æ—¥æœ¬çš„\", files: [FileNode.File(name: \"MIAE-044 å¥³å­æ ¡ç”Ÿæ‹·å•ãƒ•ã‚§ãƒ©ãã‚‰ã¶ãƒãƒ‹ã‚¢ãƒƒã‚¯ã‚¹vol.1\")])])let fileFolder = FileNode.Folder(name: \"ç”µå½±\", files: [fileName,fileName2,fileName3]) æ›´å¤šé«˜é˜¶ç”¨æ³•å‚è€ƒSwiftä¸­æšä¸¾çš„é«˜çº§ç”¨æ³•ä¸å®è·µ","categories":[],"tags":[{"name":"Swift","slug":"Swift","permalink":"Aaronzjp.cn/tags/Swift/"}]},{"title":"è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»ï¼ˆViewController Transitionï¼‰","slug":"TransitionAnimation","date":"2017-04-19T09:28:41.000Z","updated":"2017-07-27T02:52:28.000Z","comments":true,"path":"2017/04/19/TransitionAnimation/","link":"","permalink":"Aaronzjp.cn/2017/04/19/TransitionAnimation/","excerpt":"ä»€ä¹ˆæ˜¯è½¬åœºåŠ¨ç”»ï¼Œè½¬åœºåŠ¨ç”»å°±æ˜¯ä»ä¸€ä¸ª Controller è·³è½¬åˆ°å¦ä¸€ä¸ª Controller æ—¶å‘ˆç°çš„åŠ¨ç”»ã€‚åœ¨ç°åœ¨çš„iOS App ä¸­å¾ˆå¤š App éƒ½å®ç°äº†è‡ªå·±çš„è½¬åœºåŠ¨ç”»ï¼Œè¦çŸ¥é“è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»åœ¨ iOS7 ä»¥å‰æ˜¯æ²¡æœ‰è¿™ä¹ˆè½»æ¾çš„ï¼Œåœ¨ iOS7 ä»¥å‰è¦æƒ³è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»é‚£å°±åªèƒ½è‡ªå·±å»ä¸€æ­¥ä¸€æ­¥çš„å®ç°ï¼Œå¾ˆä¹…ä»¥å‰æˆ‘éšçº¦è®°å¾—æˆ‘çœ‹è¿‡ä¸€ç¯‡æ–‡ç« æ˜¯å…³äºè‡ªå®šä¹‰æ§åˆ¶å™¨å®¹æ˜“å™¨è½¬åœºåŠ¨ç”»çš„ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯è‡ªå®š","text":"ä»€ä¹ˆæ˜¯è½¬åœºåŠ¨ç”»ï¼Œè½¬åœºåŠ¨ç”»å°±æ˜¯ä»ä¸€ä¸ª Controller è·³è½¬åˆ°å¦ä¸€ä¸ª Controller æ—¶å‘ˆç°çš„åŠ¨ç”»ã€‚åœ¨ç°åœ¨çš„iOS App ä¸­å¾ˆå¤š App éƒ½å®ç°äº†è‡ªå·±çš„è½¬åœºåŠ¨ç”»ï¼Œè¦çŸ¥é“è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»åœ¨ iOS7 ä»¥å‰æ˜¯æ²¡æœ‰è¿™ä¹ˆè½»æ¾çš„ï¼Œåœ¨ iOS7 ä»¥å‰è¦æƒ³è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»é‚£å°±åªèƒ½è‡ªå·±å»ä¸€æ­¥ä¸€æ­¥çš„å®ç°ï¼Œå¾ˆä¹…ä»¥å‰æˆ‘éšçº¦è®°å¾—æˆ‘çœ‹è¿‡ä¸€ç¯‡æ–‡ç« æ˜¯å…³äºè‡ªå®šä¹‰æ§åˆ¶å™¨å®¹æ˜“å™¨è½¬åœºåŠ¨ç”»çš„ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯è‡ªå®š ä¹‰ä¸€ä¸ª ContainerViewController å°†è¦è½¬åœºçš„ä¸¤ä¸ªæ§åˆ¶å™¨æ”¾å…¥åˆ° ContainerViewController ï¼Œç„¶åä½¿ç”¨ UIView çš„+ (void)transitionFromView:(UIView *)fromView toView:(UIView *)toView duration:(NSTimeInterval)duration options:(UIViewAnimationOptions)options completion:(void (^)(BOOL finished))completion; æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­å»å®Œæˆè½¬åœºåˆ°æ“ä½œï¼Œå…·ä½“æ€ä¹ˆåšæˆ‘ä¹Ÿæ‡’çš„å»ç ”ç©¶äº†ï¼Œè¿™é‡Œè¿˜æ˜¯ç»§ç»­çœ‹ä¸€ä¸‹ iOS7 æä¾›çš„è½¬åœºåŠ¨ç”»çš„ API çš„ä½¿ç”¨ã€‚åœ¨ iOS7 ä¹‹åè‹¹æœå…¬å¼€äº†ä¸€äº›æ¥å£å¯ä»¥è®©æˆ‘ä»¬å¾ˆè½»æ¾çš„æ¥è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»ã€‚ è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»æ€»å…±çš„å¤§æ¦‚åˆ†ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š æä¾›ä¸€ä¸ªéµå®ˆ &lt;UIViewControllerAnimatedTransitioning&gt; åè®®çš„åŠ¨ç”»æ§åˆ¶å™¨ï¼ˆAnimation Controllerï¼‰ã€‚åœ¨åŠ¨ç”»æ§åˆ¶å™¨ä¸­æˆ‘ä»¬éœ€è¦å®Œæˆè½¬åœºæ—¶é—´ä»¥åŠè½¬åœºåŠ¨ç”»çš„æä¾›ã€‚ æä¾›ä¸€ä¸ªéµå®ˆ &lt;UIviewControllerInteractiveTransitioning&gt; åè®®çš„äº¤äº’æ§åˆ¶å™¨ï¼ˆInteraction Controllerï¼‰ï¼Œè¯¥æ§åˆ¶å™¨å…¶å®ä¸éœ€è¦è‡ªå·±å»å®ç°ï¼Œå› ä¸ºè‹¹æœå·²ç»æä¾›äº†ä¸€ä¸ªå°è£…å¥½äº†çš„äº¤äº’æ§åˆ¶å™¨ UIPercentDrivenInteractiveTransition ã€‚ è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»çš„æ§åˆ¶å™¨æä¾›è½¬åœºä»£ç†ï¼ˆTransition Delegateï¼‰ï¼Œéµå®ˆä»£ç†çš„è§„åˆ™ã€‚ è½¬åœºä»£ç†ç›®å‰æ¥è¯´æœ‰ä¸‰ç§ï¼Œåˆ†åˆ«å¯¹åº”äº†ä¸‰ç§ä¸åŒç±»å‹çš„è½¬åœºæƒ…å†µï¼Œåˆ†åˆ«å¦‚ä¸‹ï¼š 123&lt;UINavigationControllerDelegate&gt; //UINavigationController çš„ delegate å±æ€§éµå®ˆè¯¥åè®®ã€‚&lt;UIViewControllerTransitioningDelegate&gt; //UIViewController çš„ transitioningDelegate å±æ€§éµå®ˆè¯¥åè®®ã€‚&lt;UITabBarControllerDelegate&gt; //UITabBarController çš„ delegate å±æ€§éµå®ˆè¯¥åè®®ã€‚ åœ¨è½¬åœºåŠ¨ç”»å‘ç”Ÿçš„æ—¶å€™è¿™ä¸‰ä¸ªåè®®ä¸­éƒ½åˆ†åˆ«æœ‰ä¸åŒçš„æ–¹æ³•è¦æ±‚æˆ‘ä»¬æä¾›ä¸€ä¸ªåŠ¨ç”»æ§åˆ¶å™¨å’Œä¸€ä¸ªäº¤äº’æ§åˆ¶å™¨ï¼Œè¿™éƒ½æ˜¯å¯é€‰çš„ã€‚ é™¤äº†ä¸Šé¢è¯´çš„è¿™äº›ä»¥å¤–è¿˜æœ‰ä¸¤ä¸ªä¼šç”¨åˆ°çš„é‚£å°±æ˜¯è½¬åœºç¯å¢ƒï¼ˆTransition Contextï¼‰å’Œè½¬åœºåè°ƒå™¨ï¼ˆTransition Coordinatorï¼‰ï¼Œå…¶ä¸­è½¬åœºç¯å¢ƒæ˜¯å¿…é¡»çš„ï¼Œè½¬åœºç¯å¢ƒéµå®ˆ &lt;UIViewControllerContextTransitioning&gt; åè®®ï¼Œä¸è¿‡è¿™æ˜¯ç³»ç»Ÿæä¾›ç»™æˆ‘ä»¬çš„ï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨è½¬åœºæ—¶ï¼Œè·å–è½¬åœºä¸­éœ€è¦çš„æ•°æ®ã€‚è½¬åœºåè°ƒå™¨ç›®å‰æˆ‘è¿˜æ²¡æœ‰å…·ä½“çš„ä½¿ç”¨è¿‡ï¼Œè½¬åœºåè°ƒå™¨éµå®ˆ &lt;UIViewControllerTransitionCoordinator&gt; åè®®ï¼Œå¯ä»¥é€šè¿‡æ§åˆ¶å™¨çš„ transitionCoordinator å±æ€§è·å–è½¬åœºåè°ƒå™¨ï¼Œä¸è¿‡å®ƒåªåœ¨è½¬åœºçš„è¿‡ç¨‹ä¸­æ‰ä¼šå­˜åœ¨ï¼Œå¦‚æœå¤„äºéè½¬åœºçŠ¶æ€ä¸‹è¯¥å±æ€§ä¼šè¿”å› nilã€‚ å¼€å§‹DemoPushï¼Pop è½¬åœºåºŸè¯ä¹Ÿä¸å¤šè¯´äº†ï¼Œç›´æ¥å¼€å§‹ä¸Šä»£ç ã€‚é¦–å…ˆå†™ä¸€ä¸ª NavigationController çš„ Push å’Œ Pop çš„è½¬åœºåŠ¨ç”»ã€‚ é¦–å…ˆç”¨ StoryBoard å¿«é€Ÿçš„æ‹–å‡ºä¸¤ä¸ªæ§åˆ¶å™¨æ¥ã€‚åœ¨æˆ‘çš„ Demo ä¸­æ ¹è§†å›¾æ˜¯ä¸€ä¸ª UITableViewController ï¼Œè¢« Push çš„æ§åˆ¶å™¨æ˜¯ä¸€ä¸ªæ™®é€šçš„ Controllerã€‚å¦‚å›¾ï¼š ç›®å‰è¿™ä¸ª Demo å°±å¯ä»¥ Run èµ·æ¥äº†ï¼Œåªä¸è¿‡åŠ¨ç”»æ˜¯ç³»ç»Ÿé»˜è®¤çš„ï¼Œè‡´äº Demo ä¸­å…·ä½“æ”¾ä»€ä¹ˆä¸œè¥¿å°±ä¸è¯´äº†ï¼ŒDemo è€Œå·²ä½ æƒ³æ”¾å•¥å°±æ”¾å•¥ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»ä¸­éœ€è¦çš„åŠ¨ç”»ï¼Œå°±æ˜¯åŠ¨ç”»æ§åˆ¶å™¨ã€‚ æ–°å»ºä¸€ä¸ª PushAnimation çš„ç±»å¹¶éµå®ˆ &lt;UIViewControllerAnimatedTransitioning&gt; åè®®å¦‚ä¸‹ï¼š 1234567// PushAnimation.h#import &lt;Foundation/Foundation.h&gt;#import &lt;UIKit/UIKit.h&gt;@interface PushAnimation : NSObject &lt;UIViewControllerAnimatedTransitioning&gt;@end 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556// PushAnimation.m#import &quot;PushAnimation.h&quot;#import &quot;RootTableViewController.h&quot;#import &quot;RootDetailViewController.h&quot;#import &quot;RootTableViewCell.h&quot;@implementation PushAnimation- (NSTimeInterval)transitionDuration:(id&lt;UIViewControllerContextTransitioning&gt;)transitionContext &#123; return 0.5;&#125;- (void)animateTransition:(id&lt;UIViewControllerContextTransitioning&gt;)transitionContext &#123; //é€šè¿‡è½¬åœºç¯å¢ƒè·å– fromVC å’Œ toVCã€‚ RootTableViewController *fromVC = (RootTableViewController *)[transitionContext viewControllerForKey:UITransitionContextFromViewControllerKey]; RootDetailViewController *toVC = (RootDetailViewController *)[transitionContext viewControllerForKey:UITransitionContextToViewControllerKey]; //è·å– fromVC ä¸­è¢«é€‰ä¸­çš„ Cell RootTableViewCell *cell = [fromVC.tableView cellForRowAtIndexPath:fromVC.currentIndexPath]; //é€šè¿‡è½¬åœºç¯å¢ƒè·å– å®¹å™¨è§†å›¾ UIView *containerView = [transitionContext containerView]; //è·å– Cell ä¸­ headerView çš„æˆªå›¾ UIView *cellImageView = [cell.headerView snapshotViewAfterScreenUpdates:NO]; //å°†è·å–åˆ°çš„ cell çš„ headerView çš„æˆªå›¾çš„ frame è½¬æ¢æˆå½“å‰å®¹å™¨è§†å›¾çš„ä½ç½® cellImageView.frame = [cell.headerView convertRect:cell.headerView.bounds toView:containerView]; //è®¾ç½®è½¬åœºå‰åˆå§‹çš„çŠ¶æ€ toVC.view.alpha = 0; cell.headerView.hidden = YES; toVC.headerImageView.hidden = YES; //æŠŠéœ€è¦å‚ä¸åˆ°è½¬åœºåŠ¨ç”»ä¸­çš„è§†å›¾æ·»åŠ åˆ°å®¹å™¨è§†å›¾ä¸­ [containerView addSubview:toVC.view]; [containerView addSubview:cellImageView]; //è½¬åœºåŠ¨ç”»å¼€å§‹ [UIView animateWithDuration:[self transitionDuration:transitionContext] animations:^&#123; //éœ€è¦æ›´æ–°å¸ƒå±€ å¦åˆ™åœ¨æ¨ªå±çŠ¶æ€ä¸‹ cellImageView ä½ç½®ä¸æ­£ç¡® [containerView layoutIfNeeded]; cellImageView.frame = [toVC.headerImageView convertRect:toVC.headerImageView.bounds toView:containerView]; toVC.view.alpha = 1; &#125; completion:^(BOOL finished) &#123; [cellImageView removeFromSuperview]; toVC.headerImageView.hidden = NO; cell.headerView.hidden = NO; //åŠ¨ç”»ç»“æŸåå¿…é¡»è¦å‘ Context è°ƒç”¨è¯¥æ–¹æ³•é€šçŸ¥åŠ¨ç”»ç»“æŸï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥è¿”å›YESï¼Œå¦‚æœåŠ¨ç”»æœ‰æ‰‹åŠ¿å‚ä¸åˆ°è¯æœ€å¥½ä¸è¦ç›´æ¥è¿”å›YES [transitionContext completeTransition:YES]; &#125;]; &#125;@end &lt;UIViewControllerAnimatedTransitioning&gt; åè®®ä¸»è¦æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š - (NSTimeInterval)transitionDuration:(nullable id &lt;UIViewControllerContextTransitioning&gt;)transitionContext; è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ª NSTimeInterval ï¼Œå³è½¬åœºåŠ¨ç”»çš„æ—¶é—´é•¿åº¦ï¼Œç¡®å®šè½¬åœºåŠ¨ç”»æ‰€éœ€è¦çš„æ—¶é—´ã€‚åœ¨è¯¥æ–¹æ³•ä¸­ç³»ç»Ÿè¿˜æä¾›äº†ä¸€ä¸ªä¸Šæ–‡ä¸­æåˆ°çš„è½¬åœºç¯å¢ƒã€‚ - (void)animateTransition:(id &lt;UIViewControllerContextTransitioning&gt;)transitionContext; è¯¥æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼ŒåŒæ—¶ä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†è½¬åœºç¯å¢ƒï¼Œè½¬åœºçš„åŠ¨ç”»å°±éœ€è¦åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢æ¥å®Œæˆã€‚è¿™é‡Œå¾—è¯´ä¸‹ fromVc å’Œ toVC ï¼Œè¿™ä¸¤ä¸ªæ˜¯ä¸€ä¸ªç›¸å¯¹çš„æ¦‚å¿µï¼Œå°±æ˜¯è¯´å½“å‰æ­£åœ¨æ˜¾ç¤ºçš„ Controller å°±æ˜¯ fromVC ï¼Œå°†è¦è½¬åœºè¿‡å»çš„ Controller å°±æ˜¯ toVCã€‚ ä¸Šé¢è®²åˆ°çš„è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»çš„æ­¥éª¤åˆ°è¿™å·²ç»å®Œæˆäº†ç¬¬ä¸€æ­¥ï¼Œä½†æ˜¯ç°åœ¨å…ˆè·³è¿‡ç¬¬äºŒéƒ¨ï¼Œæš‚æ—¶ä¸æ·»åŠ äº¤äº’æ§åˆ¶å™¨åˆ°æˆ‘ä»¬çš„è½¬åœºåŠ¨ç”»ä¸­æ¥ï¼Œå…ˆå®Œæˆè½¬åœºåŠ¨ç”»åå†æ·»åŠ ã€‚ç°åœ¨è¿›å…¥åˆ°ç¬¬ä¸‰æ­¥ï¼Œéµå®ˆè½¬åœºåŠ¨ç”»åè®®ï¼Œä¸ºè½¬åœºåŠ¨ç”»æä¾›ä»£ç†ã€‚ 12345678// RootTableViewController.h#import &lt;UIKit/UIKit.h&gt;@interface RootTableViewController : UITableViewController//è¿™ä¸ªå±æ€§å°±æ˜¯ç”¨æ¥è®°å½•è¢«é€‰ä¸­çš„Cellçš„ï¼Œåœ¨ä¸Šé¢åŠ¨ç”»æ§åˆ¶å™¨ä¸­å°±é€šè¿‡è¿™ä¸ªå±æ€§æ¥è·å–çš„Cell@property (nonatomic,strong) NSIndexPath *currentIndexPath;@end 1234567891011121314151617181920212223242526272829303132333435363738394041// RootTableViewController.m#import &quot;RootTableViewController.h&quot;#import &quot;PushAnimation.h&quot;@interface RootTableViewController () &lt;UINavigationControllerDelegate&gt;...@property (nonatomic,strong) PushAnimation *pushAnimation;...@end@implementation RootTableViewController- (void)viewDidLoad &#123; [super viewDidLoad]; ... ... self.pushAnimation = [PushAnimation new]; self.navigationController.delegate = self;&#125;#pragma mark - Table view data source......#pragma mark - Table view data delegate......#pragma mark - UINavigationControllerDelegate// 1.è½¬åœºåè®®ï¼Œè¿”å›ä¸€ä¸ª éµå®ˆ UIViewControllerAnimatedTransitioning åè®®çš„ç±»ã€‚ï¼ˆå°±æ˜¯åŠ¨ç”»æ§åˆ¶å™¨ï¼‰- (id&lt;UIViewControllerAnimatedTransitioning&gt;)navigationController:(UINavigationController *)navigationController animationControllerForOperation:(UINavigationControllerOperation)operation fromViewController:(UIViewController *)fromVC toViewController:(UIViewController *)toVC &#123; if (operation == UINavigationControllerOperationPush) &#123; return _pushAnimation; &#125; else &#123; return nil; &#125;&#125; å®Œæˆäº†ä¸Šé¢çš„è¿™äº›ï¼Œç°åœ¨è¿™ä¸ª Demo åœ¨ Push çš„æ—¶å€™å°±å·²ç»æ˜¯æˆ‘ä»¬çš„è‡ªå®šä¹‰çš„è½¬åœºåŠ¨ç”»äº†ã€‚æµ‹è¯•ä¸€ä¸‹ï¼Œæ²¡é—®é¢˜ã€‚ Pop åŠ¨ç”»å‘¢è¿™é‡Œå°±ä¸è¯¦ç»†è¯´å¤ªå¤šäº†ï¼Œå’Œ Push æ˜¯ä¸€æ ·çš„ï¼Œå†™ä¸ªåŠ¨ç”»æ§åˆ¶å™¨ï¼Œåœ¨è½¬åœºåè®®çš„æ–¹æ³•ä¸­ï¼ˆä¸Šé¢ä»£ç ä¸­æ ‡ä¸º1çš„é‚£ä¸ªæ–¹æ³•ï¼‰åˆ¤æ–­ä¸€ä¸‹ï¼Œè¿”å›ä¸€ä¸ª Pop çš„åŠ¨ç”»æ§åˆ¶å™¨å°±å¯ä»¥äº†ã€‚ æ·»åŠ äº¤äº’æ§åˆ¶å™¨ä¸Šé¢å·²ç»è®²äº†ç³»ç»Ÿå·²ç»ä¸ºæˆ‘ä»¬å°è£…å¥½äº†ä¸€ä¸ªäº¤äº’æ§åˆ¶å™¨ï¼Œæˆ‘ä»¬ç»§æ‰¿è¿™ä¸ªç±»å°±å¯ä»¥äº†ã€‚ä»£ç å¦‚ä¸‹ï¼š 12345678910// SwipInteractiveTransition.h#import &lt;UIKit/UIKit.h&gt;@interface SwipInteractiveTransition : UIPercentDrivenInteractiveTransition//è¯¥å±æ€§ç”¨æ¥è®°å½•æ˜¯å¦å¤„äºäº¤äº’ä¸­ï¼Œåé¢ä¼šç”¨åˆ°è¿™ä¸ªå±æ€§@property (nonatomic,assign) BOOL interacting;//æ·»åŠ ä¸€ä¸ªæ·»åŠ æ‰‹åŠ¿çš„æ–¹æ³•- (void)addGestureInViewController:(UIViewController *)controller;@end 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657// SwipInteractiveTransition.m#import &quot;SwipInteractiveTransition.h&quot;@interface SwipInteractiveTransition ()//è¯¥å±æ€§ç”¨æ¥æŒæœ‰è¢«æ·»åŠ æ‰‹åŠ¿çš„æ§åˆ¶å™¨ï¼Œå› ä¸ºåé¢æ‰‹åŠ¿è§¦å‘çš„æ—¶å€™è¦ç”¨æ”¹æ§åˆ¶å™¨Popå›å»@property (nonatomic,strong) UIViewController *pushingViewController;@end@implementation SwipInteractiveTransition- (void)addGestureInViewController:(UIViewController *)controller &#123; self.pushingViewController = controller; [self prepareGesture];&#125;- (void)prepareGesture &#123; UIScreenEdgePanGestureRecognizer *gesture = [[UIScreenEdgePanGestureRecognizer alloc]initWithTarget:self action:@selector(handleGesture:)]; //è®¾ç½®æ‰‹åŠ¿æ–¹å‘ gesture.edges = UIRectEdgeLeft; //æ·»åŠ æ‰‹åŠ¿åˆ°æ§åˆ¶å™¨çš„View [self.pushingViewController.view addGestureRecognizer:gesture];&#125;- (void)handleGesture:(UIPanGestureRecognizer *)gesture &#123; //è·å–æ‰‹åŠ¿åœ¨Viewä¸­å½“å‰çš„ä½ç½® CGPoint traslation = [gesture translationInView:self.pushingViewController.view]; //è®¡ç®—è¿›åº¦ï¼Œè¿™é‡ŒæŒ‰ç…§å½“å‰æ§åˆ¶å™¨çš„å®½æ¥è®¡ç®—ã€‚ CGFloat progress = traslation.x / CGRectGetWidth(self.pushingViewController.view.bounds); //æ‰‹åŠ¿å¼€å§‹ if (gesture.state == UIGestureRecognizerStateBegan) &#123; //è®¾ç½®è¯¥å±æ€§ï¼Œæ ‡è®°è½¬åœºæ­£åœ¨è¿›è¡Œ self.interacting = YES; //Popå½“å‰æ§åˆ¶å™¨ [self.pushingViewController.navigationController popViewControllerAnimated:YES]; //æ‰‹åŠ¿çŠ¶æ€å˜åŒ– &#125; else if (gesture.state == UIGestureRecognizerStateChanged) &#123; //æ›´æ–°æ‰‹åŠ¿æ§åˆ¶å™¨è¿›åº¦ [self updateInteractiveTransition:progress]; //æ‰‹åŠ¿ç»“æŸæˆ–è€…å–æ¶ˆçš„æ—¶å€™ &#125; else if (gesture.state == UIGestureRecognizerStateEnded || gesture.state == UIGestureRecognizerStateCancelled) &#123; //æ ‡è®°è½¬åœºç»“æŸ self.interacting = NO; //å¦‚æœè¿›å»å¤§äº50%å°±å®Œæˆè½¬åœºï¼Œå¦åˆ™å–æ¶ˆè½¬åœº if (progress &gt; 0.5) &#123; [self finishInteractiveTransition]; &#125; else &#123; [self cancelInteractiveTransition]; &#125; &#125; else &#123; //å¯¹å…¶ä»–æƒ…å†µçš„å¤„ç† self.interacting = NO; [self cancelInteractiveTransition]; &#125;&#125;@end åšåˆ°è¿™ä¸€æ­¥çš„æ—¶å€™æ‰‹åŠ¿æ§åˆ¶å™¨ä¹Ÿå®Œæˆäº†ï¼Œé‚£ä¹ˆå¦‚ä½•æŠŠæ‰‹åŠ¿æ§åˆ¶å™¨æ·»åŠ åˆ° Controller å¹¶ç”Ÿæ•ˆä½¿ç”¨æ‰‹åŠ¿æ¥è¿›è¡Œè½¬åœºï¼Ÿç»§ç»­å¾€ä¸‹çœ‹ã€‚ğŸ˜„ è¿™é‡Œå›åˆ° RootDetailViewController è¿™ä¸ªç±»ï¼Œéµå®ˆ &lt;UINavigationControllerDelegate&gt; ä»£ç†ï¼Œå®ç°è¯¥ä»£ç†ä¸­çš„å¦ä¸€ä¸ªæ–¹æ³•å³å¯ã€‚å…¶å®è¿™é‡Œæ·»åŠ åœ¨é‚£ä¸ªæ§åˆ¶å™¨éƒ½å¯ä»¥çš„ï¼Œä½†æ˜¯è¿™é‡Œè¿˜æ˜¯æ·»åŠ åˆ° RootDetailViewController å§ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243// RootDetailViewController.m#import &quot;RootDetailViewController.h&quot;#import &quot;PopAnimation.h&quot;#import &quot;SwipInteractiveTransition.h&quot;#import &quot;PushAnimation.h&quot;@interface RootDetailViewController () &lt;UINavigationControllerDelegate&gt;@property (nonatomic,strong) UIPercentDrivenInteractiveTransition *interactiveControler;@property (nonatomic,strong) SwipInteractiveTransition *swipInteractiveController;@property (nonatomic,strong) PopAnimation *popAnimation;@property (nonatomic,strong) PushAnimation *pushAnimation;@end@implementation RootDetailViewController- (void)viewDidLoad &#123; [super viewDidLoad]; _headerImageView.image = _image; _textView.text = _text; self.popAnimation = [PopAnimation new]; self.pushAnimation = [PushAnimation new]; self.swipInteractiveController = [SwipInteractiveTransition new]; [self.swipInteractiveController addGestureInViewController:self]; self.navigationController.delegate = self;&#125;- (id&lt;UIViewControllerAnimatedTransitioning&gt;)navigationController:(UINavigationController *)navigationController animationControllerForOperation:(UINavigationControllerOperation)operation fromViewController:(UIViewController *)fromVC toViewController:(UIViewController *)toVC &#123; if (operation == UINavigationControllerOperationPop) &#123; return _popAnimation; &#125; else if (operation == UINavigationControllerOperationPush) &#123; return _pushAnimation; &#125; return nil;&#125;//åœ¨è¯¥æ–¹æ³•ä¸­è¿”å›æ‰‹åŠ¿æ§åˆ¶å™¨å³å¯- (id&lt;UIViewControllerInteractiveTransitioning&gt;)navigationController:(UINavigationController *)navigationController interactionControllerForAnimationController:(id&lt;UIViewControllerAnimatedTransitioning&gt;)animationController &#123; return self.swipInteractiveController.interacting ? self.swipInteractiveController : nil;&#125;@end å®Œæˆåçš„æ•ˆæœå¦‚ä¸‹ï¼š è¿™é‡Œå¯èƒ½æ‰‹åŠ¿å–æ¶ˆååˆ°åŠ¨ç”»æœ‰ç‚¹é—®é¢˜ï¼ˆå¦‚æœè°çŸ¥é“åŸå› å¯ä»¥å‘Šè¯‰æˆ‘ä¸€ä¸‹ï¼Œè°¢è°¢ğŸ˜ï¼‰ï¼Œæ¨¡æ‹Ÿå™¨ä¸ŠåŠ¨ç”»è¡¨ç°çš„ä¸æ˜¯å¾ˆå¥½ï¼Œåé¢æˆ‘ä¼šæŠŠä»£ç ä¸Šä¼ åˆ°Githubï¼Œå¯ä»¥ä¸‹è½½æºç åœ¨çœŸæœºä¸Šæµ‹è¯•ã€‚ Modalè½¬åœºæ™®é€šçš„ Modal è½¬åœºå°±ä¸è¯¦ç»†çš„è§£é‡ŠDemoï¼Œå› ä¸ºå…¶å®å’Œ Pushï¼Pop è½¬åœºæ˜¯å·®ä¸å¤šçš„ï¼Œåªæ˜¯è½¬åœºä»£ç†ä¸ä¸€æ ·ã€‚ Modal è½¬åœºéµå®ˆ &lt;UIViewControllerTransitioningDelegate&gt; åè®®ï¼Œåè®®ä¸­çš„æ–¹æ³•å¦‚ä¸‹ï¼š 1234567891011//æä¾› Present æ—¶çš„åŠ¨ç”»æ§åˆ¶å™¨- (nullable id &lt;UIViewControllerAnimatedTransitioning&gt;)animationControllerForPresentedController:(UIViewController *)presented presentingController:(UIViewController *)presenting sourceController:(UIViewController *)source;//æä¾› Dismiss æ—¶çš„åŠ¨ç”»æ§åˆ¶å™¨- (nullable id &lt;UIViewControllerAnimatedTransitioning&gt;)animationControllerForDismissedController:(UIViewController *)dismissed;//æä¾› Present æ—¶çš„äº¤äº’æ§åˆ¶å™¨- (nullable id &lt;UIViewControllerInteractiveTransitioning&gt;)interactionControllerForPresentation:(id &lt;UIViewControllerAnimatedTransitioning&gt;)animator;//æä¾› Dismiss æ—¶çš„äº¤äº’æ§åˆ¶å™¨- (nullable id &lt;UIViewControllerInteractiveTransitioning&gt;)interactionControllerForDismissal:(id &lt;UIViewControllerAnimatedTransitioning&gt;)animator;//è¯¥æ–¹æ³•æ˜¯åœ¨ iOS8 ä¹‹åæä¾›çš„ï¼Œå…¶ä½œç”¨å°±æ˜¯ç°åœ¨è¦è®²çš„ã€‚- (nullable UIPresentationController *)presentationControllerForPresentedViewController:(UIViewController *)presented presentingViewController:(nullable UIViewController *)presenting sourceViewController:(UIViewController *)source; åœ¨ Modal è½¬åœºä¸­é™¤äº†å¹³æ—¶é»˜è®¤çš„åŠ¨ç”»å¤–å…¶å®ç³»ç»Ÿä¹Ÿé»˜è®¤çš„æä¾›äº†å…¶ä»–å››ç§çš„è½¬åœºåŠ¨ç”»ï¼Œè®¾ç½®æ§åˆ¶å™¨çš„ modalTransitionStyle å±æ€§å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„ä½¿ç”¨è¿™å››ç§é»˜è®¤çš„è½¬åœºåŠ¨ç”»ï¼Œåˆ†åˆ«å¦‚ä¸‹ï¼š 1234UIModalTransitionStyleCoverVerticalUIModalTransitionStyleFlipHorizontal UIModalTransitionStyleCrossDissolveUIModalTransitionStylePartialCurl ä½†æ˜¯å¾ˆå¤šæ—¶å€™è¿˜æ˜¯å¹¶ä¸èƒ½æ»¡è¶³å¯¹è½¬åœºåŠ¨ç”»çš„éœ€æ±‚ï¼Œæ‰€ä»¥è¿™é‡Œå°±éœ€è¦è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»äº†ã€‚ è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»éœ€è¦åœ¨ ViewController çš„ modalPresentationStyle åˆ†åˆ«ä¸º UIModalPresentationCustom å’Œ UIModalPresentationFullScreen çš„æ—¶å€™æ‰å¯ä»¥è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»ï¼ŒåŒæ—¶ ViewController æŒ‡å®šçš„ modalTransitionStyle è½¬åœºåŠ¨ç”»å°†ä¼šè¢«å¿½ç•¥ã€‚ UIModalPresentationCustom å’Œ UIModalPresentationFullScreen ä¹‹é—´ä¹Ÿæ˜¯æœ‰å·®åˆ«çš„ï¼Œè¿™ç‚¹éœ€è¦ç‰¹åˆ«çš„æ³¨æ„ï¼Œä¸ç„¶å¾ˆæœ‰å¯èƒ½åœ¨åé¢çš„è‡ªå®šä¹‰è½¬åœºåŠ¨ç”»ä¸­è¸©å‘ã€‚ UIModalPresentationFullScreen æ¨¡å¼ï¼špresentation åï¼ŒpresentingView è¢«ä¸»åŠ¨ç§»å‡ºè§†å›¾ç»“æ„ï¼Œåœ¨ dismissal ä¸­ presentingView æ˜¯ toView çš„è§’è‰²ï¼Œå…¶å°†ä¼šé‡æ–°åŠ å…¥ containerView ä¸­ã€‚ UIModalPresentationCustom æ¨¡å¼ï¼šè½¬åœºæ—¶ containerView å¹¶ä¸æ‹…ä»» presentingView çš„çˆ¶è§†å›¾ï¼Œåè€…ç”± UIKit å¦è¡Œç®¡ç†ã€‚åœ¨ presentation åï¼ŒfromView(presentingView) æœªè¢«ç§»å‡ºè§†å›¾ç»“æ„ï¼Œåœ¨ dismissal ä¸­ï¼Œæ³¨æ„ä¸è¦åƒå…¶ä»–è½¬åœºä¸­é‚£æ ·å°† toView(presentingView) åŠ å…¥ containerView ä¸­ï¼Œå¦åˆ™æœ¬æ¥å¯è§çš„ presentingView å°†ä¼šè¢«ç§»é™¤å‡ºè‡ªèº«æ‰€å¤„çš„è§†å›¾ç»“æ„æ¶ˆå¤±ä¸è§ã€‚è¿™ç‚¹åœ¨ Custom æ¨¡å¼ä¸‹è¦ç‰¹åˆ«æ³¨æ„ã€‚ åœ¨ iOS8 ä¹‹å Modal è½¬åœºä»£ç†ä¸­æ–°å¢äº†ä¸Šé¢çš„ç¬¬4ä¸ªæ–¹æ³•ï¼Œå¯ä»¥æä¾›ä¸€ä¸ª UIPresentationController ï¼Œè¿™ä¸ªç±»ä¸ºæ¨¡æ€è§†å›¾çš„è½¬åœºæä¾›äº†æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥æ›´åŠ æ·±å…¥çš„è‡ªå®šä¹‰ PresentedViewController ï¼Œæ¯”å¦‚ PresentedView çš„å°ºå¯¸å¤§å°ï¼ŒèƒŒæ™¯ç­‰ï¼Œè¿™ä¸ªå…¶å®ä¹Ÿå¯ä»¥åœ¨ä¸éœ€è¦è½¬åœºåŠ¨ç”»çš„æƒ…å†µä¸‹å•ç‹¬ä½¿ç”¨ã€‚å…¶ä¸­è¿˜æœ‰æœ€é‡è¦çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œé‚£å°±æ˜¯å¯¹å±å¹•å¸ƒå±€çš„ç®¡ç†ï¼Œè¿™é‡Œå°±ä¸å±•å¼€å­¦ä¹ äº†ï¼Œåé¢å•ç‹¬å»å­¦ä¹ å…³äºè¿™ä¸ªçš„ä½¿ç”¨ã€‚ ç°åœ¨æˆ‘è¦è‡ªå®šä¹‰ä¸€ä¸ªåƒ iOS 10 ä¸­ Music Appä¸­ï¼Œæ’­æ”¾ç•Œé¢å¼¹å‡ºçš„æ•ˆæœï¼ˆå…¶å® Demo ä¸­çš„æ•ˆæœå¹¶ä¸æ˜¯å¾ˆåƒï¼Œåªèƒ½è¯´å·®ä¸å¤šå§ğŸ˜…ï¼‰ã€‚å¦‚å›¾ï¼š é¦–å…ˆè¿˜æ˜¯å…ˆæä¾›ä¸€ä¸ª Modal è½¬åœºçš„åŠ¨ç”»æ§åˆ¶å™¨å§ï¼Œå…³äºåŠ¨ç”»æ§åˆ¶å™¨ä¸Šé¢ä¹Ÿè¯¦ç»†è¯´è¿‡äº†ï¼Œå°±æ˜¯ä¸€ä¸ªéµå®ˆ &lt;UIViewControllerAnimatedTransitioning&gt; åè®®çš„å¯¹è±¡ï¼Œè¿™é‡Œå°±ç›´æ¥è´´ä¸Šä»£ç äº†ï¼š 12345678910111213141516// PresentAnimation.h#import &lt;Foundation/Foundation.h&gt;#import &lt;UIKit/UIKit.h&gt;typedef NS_ENUM(NSInteger,AnimationType) &#123; AnimationTypeOfPresent = 0, AnimationTypeOfPop&#125;;@interface PresentAnimation : NSObject &lt;UIViewControllerAnimatedTransitioning&gt;+ (instancetype)animationUseAnimationType:(AnimationType)type;- (instancetype)initWithAnimationType:(AnimationType)type;@end åœ¨è¿™ä¸ªæ§åˆ¶å™¨é‡Œï¼Œæˆ‘ç›´æ¥æŠŠä¸¤ä¸ªåŠ¨ç”»å†™åˆ°äº†ä¸€èµ·ï¼Œtype çš„ä¸åŒå»è·å– present æˆ–è€… dismiss å¯¹åº”çš„åŠ¨ç”»ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768// PresentAnimation.m#import &quot;PresentAnimation.h&quot;#import &quot;PresentedViewController.h&quot;@interface PresentAnimation ()@property (nonatomic,assign) AnimationType type;@end@implementation PresentAnimation+ (instancetype)animationUseAnimationType:(AnimationType)type &#123; return [[self alloc]initWithAnimationType:type];&#125;- (instancetype)initWithAnimationType:(AnimationType)type &#123; self = [super init]; if (self) &#123; _type = type; &#125; return self;&#125;- (NSTimeInterval)transitionDuration:(id&lt;UIViewControllerContextTransitioning&gt;)transitionContext &#123; return 0.5;&#125;- (void)animateTransition:(id&lt;UIViewControllerContextTransitioning&gt;)transitionContext &#123; switch (self.type) &#123; case AnimationTypeOfPresent: [self doPresentAnimation:transitionContext]; break; case AnimationTypeOfPop: [self doDisMissAnimation:transitionContext]; break; default: break; &#125;&#125;- (void)doPresentAnimation:(id&lt;UIViewControllerContextTransitioning&gt;)transitionContext &#123; UIViewController *toVC = [transitionContext viewControllerForKey:UITransitionContextToViewControllerKey]; toVC.view.transform = CGAffineTransformScale(CGAffineTransformIdentity, 0.01, 0.01); UIView *containerView = [transitionContext containerView]; [containerView addSubview:toVC.view]; [UIView animateWithDuration:[self transitionDuration:transitionContext] animations:^&#123; toVC.view.transform = CGAffineTransformIdentity; &#125; completion:^(BOOL finished) &#123; [transitionContext completeTransition:YES]; &#125;];&#125;- (void)doDisMissAnimation:(id&lt;UIViewControllerContextTransitioning&gt;)transitionContext &#123; UIViewController *fromVC = [transitionContext viewControllerForKey:UITransitionContextFromViewControllerKey]; UIView *toView = [transitionContext viewForKey:UITransitionContextToViewKey]; UIView *containerView = [transitionContext containerView]; [containerView insertSubview:toView belowSubview:fromVC.view]; [containerView addSubview:fromVC.view]; [UIView animateWithDuration:[self transitionDuration:transitionContext] animations:^&#123; fromVC.view.transform = CGAffineTransformScale(CGAffineTransformIdentity, 0.01, 0.01); &#125; completion:^(BOOL finished) &#123; [transitionContext completeTransition:![transitionContext transitionWasCancelled]]; &#125;];&#125;@end åŠ¨ç”»æ§åˆ¶å™¨å®Œæˆåè¿™é‡Œå›åˆ° presentingViewController ï¼Œåœ¨è¿™ä¸ª presentingViewController ä¸­éµå®ˆè½¬åœºåè®®ï¼Œæä¾›è½¬åœºéœ€è¦çš„åŠ¨ç”»æ§åˆ¶å™¨ã€‚åœ¨ Demo ä¸­è¿˜æ˜¯åœ¨ RootTableViewController è¿™ä¸ªæ§åˆ¶å™¨ä¸­è¿›è¡Œçš„æ¨¡æ€è½¬åœºçš„ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051// RootTableViewController.m#import &quot;RootTableViewController.h&quot;@interface RootTableViewController () &lt;UIViewControllerTransitioningDelegate&gt;......@end@implementation RootTableViewController- (void)viewDidLoad &#123; [super viewDidLoad]; ... ... self.pushAnimation = [PushAnimation new]; self.navigationController.delegate = self;&#125;#pragma mark - Table view data source......#pragma mark - Table view data delegate...//è¿™é‡Œæˆ‘æ—¶åœ¨ä¸€ä¸ª TableViewController ä¸­æ¼”ç¤ºå„ç§è½¬åœºåŠ¨ç”»çš„ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œè¿›è¡Œ present æ“ä½œ- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath &#123; [tableView deselectRowAtIndexPath:indexPath animated:YES]; //é€šè¿‡ MainStoryboard åˆå§‹åŒ–æ§åˆ¶å™¨ UIStoryboard *board = [UIStoryboard storyboardWithName:@&quot;Main&quot; bundle:nil]; HalfPresentedViewController *presentVC = [board instantiateViewControllerWithIdentifier:@&quot;customOfPresentattionVC&quot;]; //å°† presented çš„æ¨¡æ€è½¬åœºè®¾ç½®ä¸ºè‡ªå®šä¹‰ presentVC.modalPresentationStyle = UIModalPresentationCustom; //æ·»åŠ  UIViewControllerTransitioningDelegate åè®®çš„ä»£ç† presentVC.transitioningDelegate = self; [self presentViewController:presentVC animated:YES completion:nil];&#125;...#pragma mark - UIViewControllerTransitioningDelegate//è¿”å› Present æ—¶çš„åŠ¨ç”»æ§åˆ¶å™¨- (id&lt;UIViewControllerAnimatedTransitioning&gt;)animationControllerForPresentedController:(UIViewController *)presented presentingController:(UIViewController *)presenting sourceController:(UIViewController *)source &#123; return [PresentAnimation animationUseAnimationType:AnimationTypeOfPresent];&#125;//è¿”å› Dismiss æ—¶çš„åŠ¨ç”»æ§åˆ¶å™¨- (id&lt;UIViewControllerAnimatedTransitioning&gt;)animationControllerForDismissedController:(UIViewController *)dismissed &#123; return [PresentAnimation animationUseAnimationType:AnimationTypeOfPop];&#125; å®Œæˆè¿™æ­¥å run ä¸€ä¸‹ Demo ï¼Œå—¯æ²¡é—®é¢˜ã€‚è¿™å…¶å®å°±æ˜¯è‡ªå®šä¹‰äº† Modelçš„è½¬åœºåŠ¨ç”»äº†ã€‚ä½†æ˜¯è¿™æ—¶å€™ presented è¿˜æ˜¯ä¸€ä¸ªå…¨å±çš„æ–¹å¼å‘ˆç°å‡ºæ¥çš„ã€‚ä¸è¿‡ä¸‹é¢å°±å¼€å§‹è‡ªå®šä¹‰ preseted è¿™ä¸ªè§†å›¾äº†ï¼Œè‡ªå®šä¹‰ preseted å°±éœ€è¦éµå®ˆä¸Šé¢æåˆ°çš„ &lt;UIViewControllerTransitioningDelegate&gt; ä»£ç†ä¸­çš„æœ€åä¸€ä¸ªæ–¹æ³•ï¼Œä¸ºå…¶æä¾›ä¸€ä¸ª PresentationController ã€‚ æ¥ä¸‹æ¥å¼€å§‹è‡ªå®šä¹‰ PresentationController ã€‚ 1234567// CustomPresentationController.h#import &lt;UIKit/UIKit.h&gt;@interface CustomPresentationController : UIPresentationController@end 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081// CustomPresentationController.m// Test//// Created by Aaron Zhang on 12/04/2017.// Copyright Â© 2017 å¼ è¿‘åª. All rights reserved.//#import &quot;CustomPresentationController.h&quot;@interface CustomPresentationController ()//è¯¥è§†å›¾æ—¶ä½œä¸ºä¸Šé¢å›¾ä¸­é‚£ä¸ªé»‘è‰²åŠé€æ˜çš„èƒŒæ™¯çš„@property (nonatomic,strong) UIView *backView;@end@implementation CustomPresentationController- (void)presentationTransitionWillBegin &#123; self.backView = [[UIView alloc]init]; self.backView.frame = self.containerView.bounds; self.backView.backgroundColor = [UIColor blackColor]; self.backView.alpha = 0.0; //è·å–å½“å‰è½¬åœºçš„å®¹å™¨è§†å›¾å¹¶æ·»åŠ è¦è½¬åœºè§†å›¾åˆ°å®¹å™¨ [self.containerView insertSubview:self.backView atIndex:0]; [self.containerView addSubview:self.presentedView]; //åœ¨è½¬åœºä¸­åšåŠ¨ç”»è¿™é‡Œå°±ç”¨åˆ°äº†ä¸Šé¢æåˆ°çš„ è½¬åœºåè°ƒå™¨ï¼Œå¦‚æœä¸é€šè¿‡è½¬åœºåè°ƒå™¨æ¥åšåŠ¨ç”»ï¼Œå¯èƒ½è½¬åœºçš„æ—¶å€™åŠ¨ç”»ä¸åŒæ­¥ id &lt;UIViewControllerTransitionCoordinator&gt; transitionCoordinator = self.presentingViewController.transitionCoordinator; [transitionCoordinator animateAlongsideTransition:^(id&lt;UIViewControllerTransitionCoordinatorContext&gt; _Nonnull context) &#123; _backView.alpha = 0.5; self.presentingViewController.view.transform = CGAffineTransformScale(self.presentingViewController.view.transform, 0.98, 0.98); &#125; completion:^(id&lt;UIViewControllerTransitionCoordinatorContext&gt; _Nonnull context) &#123; &#125;]; &#125;//åœ¨ present å¤±è´¥çš„æ—¶å€™ç§»é™¤èƒŒæ™¯åŠé€æ˜è§†å›¾- (void)presentationTransitionDidEnd:(BOOL)completed &#123; if (!completed) &#123; [_backView removeFromSuperview]; &#125;&#125;- (void)dismissalTransitionWillBegin &#123; id &lt;UIViewControllerTransitionCoordinator&gt; transitionCoordinator = self.presentingViewController.transitionCoordinator; [transitionCoordinator animateAlongsideTransition:^(id&lt;UIViewControllerTransitionCoordinatorContext&gt; _Nonnull context) &#123; _backView.alpha = 0.0; self.presentingViewController.view.transform = CGAffineTransformIdentity; &#125; completion:^(id&lt;UIViewControllerTransitionCoordinatorContext&gt; _Nonnull context) &#123; &#125;];&#125;////åœ¨ present ç»“æŸçš„æ—¶å€™ç§»é™¤èƒŒæ™¯åŠé€æ˜è§†å›¾- (void)dismissalTransitionDidEnd:(BOOL)completed &#123; if (completed) &#123; [_backView removeFromSuperview]; &#125;&#125;//è¯¥æ–¹æ³•è¿”å› PresentedView åœ¨å®¹å™¨ä¸­çš„frame ï¼Œå°±æ˜¯åœ¨è¿™é‡Œä¿®æ”¹ presentedView è§†å›¾å¤§å°çš„ã€‚- (CGRect)frameOfPresentedViewInContainerView &#123; return CGRectMake(10, self.containerView.bounds.size.height / 2, self.containerView.bounds.size.width - 20, self.containerView.bounds.size.height / 2 - 10);&#125;//å®¹å™¨è§†å›¾é‡æ–°å¸ƒå±€å­è§†å›¾ï¼Œåœ¨æˆ‘çš„è¿™ä¸ªDemoä¸­å¿…é¡»åšè¿™ä¸€æ­¥çš„æ“ä½œï¼Œå¦åˆ™ä¸Šé¢æ–¹æ³•è¿”å›çš„ presentedView çš„ frame ä¸ä¼šç”Ÿæ•ˆï¼Œç›®å‰æˆ‘ä¹Ÿä¸æ˜¯ç‰¹åˆ«æ¸…æ¥šåŸå› ã€‚- (void)containerViewWillLayoutSubviews &#123; self.backView.frame = self.containerView.bounds; self.presentedView.frame = [self frameOfPresentedViewInContainerView];&#125;//è¿”å› presentedView è§†å›¾ã€‚- (UIView *)presentedView &#123; UIView *presentedView = self.presentedViewController.view; presentedView.layer.cornerRadius = 8; return presentedView;&#125;@end PresentationController å°±å®Œæˆäº†ï¼Œåœ¨è¿™ä¸­ä¸»è¦é‡å†™äº†åœ¨ PresentationController ä¸åŒçŠ¶æ€ä¸‹çš„æ–¹æ³•ï¼Œæ¥è‡ªå®šä¹‰ PresentationController çš„å‘ˆç°ã€‚æ¥ä¸‹æ¥åªéœ€è¦å›åˆ°åˆšåˆšçš„ presentedViewController ä¸­ï¼Œåœ¨è¿™ä¸ªç±» RootTableViewController ä¸­é€šè¿‡ &lt;UIViewControllerTransitioningDelegate&gt; è¿”å›è‡ªå®šä¹‰çš„ PresentationViewController å°±å¥½äº†ï¼Œå¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536// RootTableViewController.m#import &quot;RootTableViewController.h&quot;@interface RootTableViewController () &lt;UIViewControllerTransitioningDelegate&gt;......@end@implementation RootTableViewController- (void)viewDidLoad &#123; [super viewDidLoad]; ... ... self.pushAnimation = [PushAnimation new]; self.navigationController.delegate = self;&#125;#pragma mark - Table view data source......#pragma mark - Table view data delegate......#pragma mark - UIViewControllerTransitioningDelegate......//æä¾›è‡ªå®šä¹‰çš„ UIPresentationController- (UIPresentationController *)presentationControllerForPresentedViewController:(UIViewController *)presented presentingViewController:(UIViewController *)presenting sourceViewController:(UIViewController *)source &#123; CustomPresentationController *myPresentationController = [[CustomPresentationController alloc]initWithPresentedViewController:presented presentingViewController:presenting]; return myPresentationController;&#125; å®Œæˆåæœ€ç»ˆçš„æ•ˆæœå¦‚ä¸‹ï¼š Demo å‚è€ƒèµ„æ–™ï¼š View Controller Programming Guide for iOS Presentation Controllers, Adaptivity, and Custom Animator Objects","categories":[],"tags":[{"name":"è½¬åœºåŠ¨ç”»","slug":"è½¬åœºåŠ¨ç”»","permalink":"Aaronzjp.cn/tags/è½¬åœºåŠ¨ç”»/"}]},{"title":"Swift-æ„é€ è¿‡ç¨‹","slug":"Swift-Initializer","date":"2017-03-27T14:06:28.000Z","updated":"2017-07-31T19:35:42.000Z","comments":true,"path":"2017/03/27/Swift-Initializer/","link":"","permalink":"Aaronzjp.cn/2017/03/27/Swift-Initializer/","excerpt":"Swift æ„é€ è¿‡ç¨‹æ˜¯åœ¨ä½¿ç”¨ç±»ã€ç»“æ„ä½“æˆ–è€…æšä¸¾ç±»å‹çš„å®ä¾‹ä¹‹å‰æ‰€åšçš„å‡†å¤‡å·¥ä½œã€‚åœ¨ä½¿ç”¨ç±»å‹å®ä¾‹ä¹‹å‰ä¸ºäº†ç¡®ä¿ç±»å‹å®ä¾‹èƒ½å¤Ÿæ­£ç¡®çš„å®ä¾‹åŒ–ï¼Œéœ€è¦åœ¨å®ä¾‹åŒ–è¿‡ç¨‹ä¸­å¯¹å­˜å‚¨å±æ€§ç­‰è®¾ç½®åˆå§‹å€¼ï¼Œå’Œä¸€äº›å¿…é¡»æ‰§è¡Œå’Œåˆå§‹åŒ–çš„å·¥ä½œã€‚","text":"Swift æ„é€ è¿‡ç¨‹æ˜¯åœ¨ä½¿ç”¨ç±»ã€ç»“æ„ä½“æˆ–è€…æšä¸¾ç±»å‹çš„å®ä¾‹ä¹‹å‰æ‰€åšçš„å‡†å¤‡å·¥ä½œã€‚åœ¨ä½¿ç”¨ç±»å‹å®ä¾‹ä¹‹å‰ä¸ºäº†ç¡®ä¿ç±»å‹å®ä¾‹èƒ½å¤Ÿæ­£ç¡®çš„å®ä¾‹åŒ–ï¼Œéœ€è¦åœ¨å®ä¾‹åŒ–è¿‡ç¨‹ä¸­å¯¹å­˜å‚¨å±æ€§ç­‰è®¾ç½®åˆå§‹å€¼ï¼Œå’Œä¸€äº›å¿…é¡»æ‰§è¡Œå’Œåˆå§‹åŒ–çš„å·¥ä½œã€‚ æ„é€ å™¨æ„é€ å™¨æ˜¯åœ¨åˆ›å»ºä¸€ä¸ªç±»å‹çš„å®ä¾‹ç­‰æ—¶å€™è¢«è°ƒç”¨çš„æ–¹æ³•ï¼Œæ„é€ å™¨çš„å£°æ˜æ˜¯ä»¥ init å…³é”®å­—å£°æ˜çš„ã€‚å¦‚ä¸‹å°±æ˜¯åˆ›å»ºäº† Person ç±»çš„æ„é€ å™¨ã€‚ 123456class Person &#123; var name: String init(name: String) &#123; self.name = name &#125;&#125; åœ¨æ„é€ å™¨æ–¹æ³•ä¸­ï¼Œå°†å‚æ•° name çš„å€¼è®¾ç½®ä¸º name å±æ€§çš„å€¼ï¼Œä½œä¸ºåˆå§‹å€¼ã€‚ é»˜è®¤å±æ€§å€¼è¦çŸ¥é“åœ¨ Swift ä¸­ç±»å’Œç»“æ„ä½“åœ¨åˆ›å»ºå®ä¾‹çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„å­˜å‚¨å±æ€§éƒ½å¿…é¡»è¦æœ‰åˆé€‚çš„åˆå§‹å€¼ï¼Œå­˜å‚¨å±æ€§çš„å€¼ä¸èƒ½æ˜¯å‡ºäºä¸€ä¸ªæœªèµ‹å€¼çš„æœªçŸ¥çŠ¶æ€ï¼Œè¿™æ ·æ‰èƒ½æ­£ç¡®çš„ä½¿ç”¨ç±»å‹çš„å®ä¾‹ã€‚é™¤äº†åƒä¸Šé¢é‚£æ ·åœ¨æ„é€ å™¨ä¸­ä½å­˜å‚¨å±æ€§è®¾ç½®åˆå§‹å€¼å¤–ï¼Œå¯ä»¥åœ¨å±æ€§å£°æ˜æ—¶ä¸ºå…¶è®¾ç½®é»˜è®¤å€¼ã€‚å¦‚ä¸‹ï¼Œä¸º Person ç±»è®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼ã€‚ 123456class Person &#123; var name: String = \"Aaron\"&#125;let person = Person()print(person.name)//è¾“å‡º Aaron å½“ç„¶å±æ€§é»˜è®¤å€¼ä¹Ÿå¯ä»¥è®¾ç½®ä¸ºå¯é€‰ç±»å‹ã€‚ è‡ªå®šä¹‰æ„é€ è¿‡ç¨‹å½“ç„¶ä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ„é€ å™¨çš„æ„é€ è¿‡ç¨‹æ¥ç¡®ä¿ç±»å‹åœ¨åˆ›å»ºç±»å‹å®ä¾‹çš„æ—¶å€™å¯ä»¥è¢«æ­£ç¡®çš„åˆå§‹åŒ–ã€‚ æ„é€ å‚æ•°è‡ªå®šä¹‰æ„é€ å™¨æ„é€ è¿‡ç¨‹çš„æ—¶å€™å¯ä»¥åœ¨å®šä¹‰ä¸­æä¾›æ„é€ å‚æ•°ï¼ŒæŒ‡å®šå‚æ•°çš„åç§°ï¼Œç±»å‹ç­‰ã€‚è‡ªå®šä¹‰æ„é€ å™¨çš„è¯­æ³•å’Œå‡½æ•°å’Œæ–¹æ³•ç±»ä¼¼ã€‚å…¶å®åœ¨ä¸Šé¢çš„ Person ç±»ä¸­å°±ä½¿ç”¨äº†è‡ªå®šä¹‰çš„æ„é€ è¿‡ç¨‹ã€‚å¦‚ä¸‹: 123456class Person &#123; var name: String init(name: String) &#123; self.name = name &#125;&#125; è¯¥æ„é€ å™¨æœ‰ä¸€ä¸ª name å‚æ•°ï¼Œè¯¥å‚æ•°æ˜¯ String ç±»å‹ï¼Œåœ¨æ„é€ å™¨å†…éƒ¨ï¼Œå°†æ„é€ å™¨çš„å‚æ•° name èµ‹å€¼ç»™äº† Person ç±»çš„ name å±æ€§ã€‚ å¤–éƒ¨å‚æ•°åç§°å’Œå†…éƒ¨å‚æ•°åç§°æ„é€ å™¨å’Œæ–¹æ³•ã€å‡½æ•°ä¸€æ ·ï¼Œå‚æ•°ä¹Ÿæœ‰å¤–éƒ¨å‚æ•°åç§°å’Œå†…éƒ¨å‚æ•°åç§°ã€‚ä½†æ˜¯å’Œæ–¹æ³•å’Œå‡½æ•°ä¸ä¸€æ ·çš„æ˜¯ï¼Œå¦‚æœåœ¨å®šä¹‰æ„é€ å™¨çš„æ—¶å€™æ²¡æœ‰ä¸ºå…¶å®šä¹‰å‚æ•°å¤–éƒ¨åç§°ï¼Œé‚£ä¹ˆæ„é€ å™¨å°†ä¼šè‡ªåŠ¨çš„ä¸ºæ„é€ å™¨ç”Ÿæˆè·Ÿå†…éƒ¨å‚æ•°åç§°ä¸€æ ·çš„å¤–éƒ¨å‚æ•°åç§°ã€‚ 123456789class Person &#123; var name: String init(name: String) &#123; self.name = name &#125; init(nickName name: String) &#123; self.name = name &#125;&#125; è¿™é‡Œå±•ç¤ºäº†ä¸¤ç§æ„é€ å™¨ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ²¡æœ‰æ˜ç¡®æ·»åŠ å¤–éƒ¨å‚æ•°åçš„æ„é€ å™¨ï¼Œç¬¬äºŒä¸ªåˆ™æ˜¯æ·»åŠ äº† nickName ä½œä¸º name å‚æ•°çš„å¤–éƒ¨åç§°çš„æ„é€ å™¨ã€‚è¿™ä¸¤ç§æ„é€ å™¨æ–¹æ³•éƒ½å¯ä»¥åˆ›å»ºä¸€ä¸ª Person å®ä¾‹ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨å¤–éƒ¨åç§°ï¼Œä½¿ç”¨ä¸‹åˆ’çº¿(_)æ¥æ˜¾ç¤ºçš„è¯´æ˜å¿½ç•¥æ‰å¤–éƒ¨å‚æ•°åç§°ã€‚ 123456789101112class Person &#123; var name: String init(name: String) &#123; self.name = name &#125; init(_ name: String) &#123; self.name = name &#125;&#125;let person = Person(name: \"Aaron\")let person2 = Person(\"Aaron\") å¯é€‰å±æ€§å¦‚æœä¸€ä¸ªç±»å‹åœ¨åˆå§‹åŒ–å®ä¾‹çš„æ—¶å€™æŸä¸ªå±æ€§å¹¶ä¸éœ€è¦åˆå§‹å€¼æ€ä¹ˆåŠå‘¢ï¼Ÿä¸Šé¢ä¹Ÿè¯´äº†å±æ€§ä¸èƒ½å¤„äºæœªçŸ¥çŠ¶æ€ã€‚é‚£ä¹ˆå¯ä»¥å®šä¹‰ä¸€ä¸ªå¯é€‰ç±»å‹çš„å±æ€§ï¼Œå¯é€‰ç±»å‹çš„å±æ€§å¦‚æœåœ¨æ„é€ å™¨ä¸­æœªèµ‹å€¼çš„æ—¶å€™å°†ä¼šè‡ªåŠ¨åˆå§‹åŒ–ä¸º nil ã€‚è¿™æ ·å°±å¯ä»¥è¡¨ç¤ºè¿™ä¸ªå±æ€§åˆå§‹åŒ–åæ˜¯æ²¡æœ‰å€¼çš„ã€‚ 1234567class Person &#123; var name: String var age: Int? init(name: String) &#123; self.name = name &#125;&#125; ä¸Šé¢è¿™æ®µä»£ç åœ¨åˆ›å»ºä¸€ä¸ª Person å®ä¾‹åï¼ŒPerson çš„ age å±æ€§å°±æ˜¯ nil æ„é€ è¿‡ç¨‹ä¸­å¸¸é‡å±æ€§çš„ä¿®æ”¹åœ¨æ„é€ è¿‡ç¨‹ä¸­åŒæ ·ä¹Ÿå¯ä»¥å¯¹å¸¸é‡çš„å±æ€§è¿›è¡Œèµ‹å€¼ï¼Œä½†æ˜¯ä¸€æ—¦ç±»å‹çš„å®ä¾‹è¢«åˆ›å»ºåè¯¥å®ä¾‹çš„å¸¸é‡å±æ€§å°±æ— æ³•è¢«ä¿®æ”¹ã€‚åœ¨ç±»ä¸­å¸¸é‡å±æ€§åªèƒ½åœ¨å®šä¹‰è¯¥ç±»çš„æ„é€ å™¨ä¸­ä¿®æ”¹å¸¸é‡å±æ€§ï¼Œåœ¨å­ç±»çš„æ„é€ å™¨ä¸­æ˜¯æ— æ³•å¯¹å¸¸é‡å±æ€§è¿›è¡Œä¿®æ”¹çš„ã€‚ é»˜è®¤æ„é€ å™¨åœ¨ Swift ä¸­å¦‚æœç»“æ„ä½“å’Œç±»ä¸­æ‰€æœ‰çš„å±æ€§éƒ½æœ‰é»˜è®¤å€¼ï¼ŒåŒæ—¶æ²¡æœ‰è‡ªå®šä¹‰çš„æ„é€ å™¨çš„æ—¶å€™ Swift åˆ™ä¼šæä¾›ä¸€ä¸ªé»˜è®¤çš„æ„é€ å™¨ï¼Œé€šè¿‡è¯¥æ„é€ å™¨ä¼šåˆ›å»ºä¸€ä¸ªæ‰€æœ‰å±æ€§éƒ½æ˜¯é»˜è®¤å€¼çš„å®ä¾‹ã€‚ 123456class Person &#123; var name: String? var age: Int?&#125;let person = Person() é€šè¿‡è¯¥æ„é€ å™¨åˆ›å»ºå‡ºæ¥çš„ Person ç±»çš„å®ä¾‹å…¶æ‰€æœ‰çš„å±æ€§éƒ½å°†æ˜¯ nil ç»“æ„ä½“çš„é€ä¸€æˆå‘˜æ„é€ å™¨é™¤äº†é»˜è®¤çš„æ„é€ å™¨ä»¥å¤–ï¼Œåœ¨ç»“æ„ä½“ä¸­å¦‚æœæ²¡æœ‰æä¾›è‡ªå®šä¹‰çš„æ„é€ å™¨ï¼Œé‚£ä¹ˆå°†ä¼šæœ‰ä¸€ä¸ªè‡ªåŠ¨æ ¹æ®ç»“æ„ä½“ä¸­çš„å±æ€§ç”Ÿæˆçš„ä¸€ä¸ªæ„é€ å™¨ï¼Œè¯¥æ„é€ å™¨çš„å‚æ•°å°†æ˜¯ç»“æ„ä½“ä¸­æ‰€æœ‰å±æ€§ï¼Œå‚æ•°ååˆ™æ˜¯æ‰€æœ‰å±æ€§åã€‚å¦‚ä¸‹ï¼š 123456struct Point &#123; var x: Float var y: Float&#125;let point = Point(x: 100, y: 100) å€¼ç±»å‹çš„æ„é€ å™¨ä»£ç†æ„é€ å™¨å¯ä»¥é€šè¿‡è°ƒç”¨å…¶ä»–æ„é€ å™¨æ¥å®Œæˆå®ä¾‹çš„éƒ¨åˆ†æ„é€ è¿‡ç¨‹ï¼Œè¿™æ ·çš„è¿‡ç¨‹å°±æ˜¯æ„é€ å™¨ä»£ç†ï¼Œæ„é€ å™¨ä»£ç†å¯ä»¥å‡å°‘å¤šä¸ªæ„é€ å™¨ä¹‹é—´çš„é‡å¤ã€‚å€¼ç±»å‹å’Œç±»ç±»å‹çš„æ„é€ å™¨ä»£ç†è§„åˆ™æ˜¯æœ‰åŒºåˆ«çš„ï¼Œå€¼ç±»å‹æ˜¯ä¸æ”¯æŒç»§æ‰¿çš„ï¼Œæ‰€ä»¥å€¼ç±»å‹çš„æ„é€ å™¨ä»£ç†èŒèƒ½ä½¿ç”¨è‡ªå·±çš„å…¶ä»–æ„é€ å™¨ï¼Œè€Œç±»åˆ™æ˜¯å¯ä»¥ç»§æ‰¿è‡ªå…¶ä»–ç±»çš„ã€‚ åœ¨å€¼ç±»å‹ä¸­å¯ä»¥ä½¿ç”¨ self.init åœ¨è‡ªå®šä¹‰çš„æ„é€ å™¨ä¸­ä½¿ç”¨æœ¬ç±»å‹ä¸­å…¶ä»–çš„çš„æ„é€ å™¨ï¼Œä¸”åªèƒ½å¤Ÿåœ¨æ„é€ å™¨å†…éƒ¨è°ƒç”¨ self.init ã€‚å½“ä¸ºå€¼ç±»å‹è‡ªå®šä¹‰äº†æ„é€ å™¨æ—¶ï¼Œå°†æ— æ³•ä½¿ç”¨é»˜è®¤æ„é€ å™¨ã€é€ä¸€æˆå‘˜æ„é€ å™¨ã€‚å¦‚æœéœ€è¦è‡ªå®šä¹‰æ„é€ å™¨ï¼Œé»˜è®¤æ„é€ å™¨å’Œé€ä¸€æˆå‘˜æ„é€ å™¨éƒ½å¯ä»¥è®¿é—®ï¼Œåˆ™éœ€è¦å°†è‡ªå®šä¹‰æ„é€ å™¨å†™åˆ°æ‰©å±•ä¸­ã€‚ 123456789101112131415161718192021struct Size &#123; var width = 0.0, height = 0.0&#125;struct Point &#123; var x = 0.0, y = 0.0&#125;struct Rect &#123; var origin = Point() var size = Size() init() &#123;&#125; init(origin: Point, size: Size) &#123; self.origin = origin self.size = size &#125; init(center: Point, size: Size) &#123; let originX = center.x - (size.width / 2) let originY = center.y - (size.height / 2) self.init(origin: Point(x: originX, y: originY), size: size) &#125;&#125; åœ¨è¯¥ä¾‹å­ä¸­ Rect å®šä¹‰äº†ä¸‰ä¸ªæ„é€ å™¨ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªæ„é€ å™¨æ˜¯ä¸€ä¸ªç©ºå‡½æ•°ï¼Œè¿™å’Œæ²¡æœ‰è‡ªå®šä¹‰æ„é€ å™¨çš„æ—¶è‡ªåŠ¨è·å¾—çš„é»˜è®¤æ„é€ å™¨æ˜¯ä¸€æ ·çš„ã€‚ç¬¬äºŒä¸ªæ„é€ å™¨æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œæ„é€ å™¨å†…éƒ¨åœ¨æ„é€ è¿‡ç¨‹ä¸­å°†è¿™ä¸¤ä¸ªå‚æ•°åˆ†åˆ«èµ‹å€¼ç»™äº† origin å’Œ size å±æ€§ã€‚ç¬¬ä¸‰ä¸ªæ„é€ å™¨ä¹Ÿæ˜¯æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸åŒçš„æ˜¯åœ¨æ„é€ å™¨å†…éƒ¨çš„æ„é€ è¿‡ç¨‹ä¸­ï¼Œå°†è·å–åˆ°çš„å‚æ•°ç»è¿‡è®¡ç®—åï¼Œå†è°ƒç”¨ç¬¬äºŒä¸ªæ„é€ å™¨å°†è®¡ç®—å¾—åˆ°çš„ origin å’Œ size èµ‹å€¼åˆ°å¯¹åº”çš„å±æ€§ã€‚åƒç¬¬ä¸‰ä¸ªæ„é€ å™¨è¿™æ ·åœ¨æ„é€ å™¨å†…éƒ¨çš„æ„é€ è¿‡ç¨‹ä¸­è°ƒç”¨å…¶ä»–çš„æ„é€ å™¨å°±æ˜¯æ„é€ å™¨ä»£ç†ã€‚ ç±»çš„ç»§æ‰¿å’Œæ„é€ è¿‡ç¨‹ç±»æ˜¯å¯ä»¥ç»§æ‰¿çš„ï¼Œåœ¨ç±»ä¸­æ‰€æœ‰çš„å­˜å‚¨å±æ€§åŒ…æ‹¬ç»§æ‰¿è‡ªçˆ¶ç±»çš„å±æ€§éƒ½å¿…é¡»åœ¨æ„é€ è¿‡ç¨‹ä¸­è®¾ç½®åˆå§‹å€¼ã€‚åœ¨ç±»ç±»å‹ä¸­ Swift ä¸ºå…¶æä¾›äº†ä¸¤ç§æ„é€ å™¨ï¼Œåˆ†åˆ«æ˜¯æŒ‡å®šæ„é€ å™¨å’Œä¾¿åˆ©æ„é€ å™¨ã€‚ æŒ‡å®šæ„é€ å™¨å’Œä¾¿åˆ©æ„é€ å™¨æŒ‡å®šæ„é€ å™¨æ˜¯ç±»ä¸­æœ€ä¸»è¦çš„æ„é€ å™¨ï¼Œä¸€ä¸ªæŒ‡å®šçš„æ„é€ å™¨åˆå§‹åŒ–ç±»ä¸­æ‰€æœ‰çš„å±æ€§ï¼Œå¹¶æ ¹æ®çˆ¶ç±»é“¾å¾€ä¸Šè°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨æ¥å®ç°çˆ¶ç±»çš„åˆå§‹åŒ–ã€‚æ¯ä¸€ä¸ªç±»éƒ½å¿…é¡»æœ‰è‡³å°‘ä¸€ä¸ªçš„æŒ‡å®šæ„é€ å™¨ã€‚ä¾¿åˆ©æ„é€ å™¨åˆ™æ˜¯ç±»ä¸­çš„è¾…åŠ©å‹çš„æ„é€ å™¨ï¼Œå¯ä»¥é€šè¿‡ä¾¿åˆ©æ„é€ å™¨è°ƒç”¨ç±»ä¸­çš„æŒ‡å®šæ„é€ å™¨ï¼Œå¹¶ä¸ºå…¶å‚æ•°æä¾›é»˜è®¤å€¼ï¼Œä¹Ÿå¯ä»¥åœ¨ä¾¿åˆ©æ„é€ å™¨ä¸­åˆ›å»ºä¸€äº›ç‰¹æ®Šç”¨é€”çš„å®ä¾‹ã€‚ æŒ‡å®šæ„é€ å™¨å…¶å®å’Œæ„é€ å™¨è¯­æ³•æ˜¯ä¸€æ ·çš„ï¼Œä½¿ç”¨ init ä½œä¸ºå…³é”®å­—å¯ä»¥åŠ å…¥å‚æ•°ã€‚ä¾¿åˆ©æ„é€ å™¨éœ€è¦åœ¨æ„é€ å™¨ init å‰åŠ ä¸Š convenience å…³é”®å­—ã€‚ ç±»çš„æ„é€ å™¨ä»£ç†è§„åˆ™Swift ä¸­æœ‰ä¸‰æ¡è§„åˆ™æ¥é™åˆ¶æ„é€ å™¨ä¹‹é—´çš„ä»£ç†è°ƒç”¨ï¼š æŒ‡å®šæ„é€ å™¨å¿…é¡»è°ƒç”¨å…¶ç›´æ¥çˆ¶ç±»çš„çš„æŒ‡å®šæ„é€ å™¨ã€‚ ä¾¿åˆ©æ„é€ å™¨å¿…é¡»è°ƒç”¨åŒç±»ä¸­å®šä¹‰çš„å…¶å®ƒæ„é€ å™¨ã€‚ ä¾¿åˆ©æ„é€ å™¨å¿…é¡»æœ€ç»ˆå¯¼è‡´ä¸€ä¸ªæŒ‡å®šæ„é€ å™¨è¢«è°ƒç”¨ã€‚ æŒ‡å®šæ„é€ å™¨æ˜¯å‘ä¸Šä»£ç†ï¼Œä¾¿åˆ©æ„é€ å™¨æ˜¯æ¨ªå‘ä»£ç†ã€‚ æ„é€ å™¨çš„ç»§æ‰¿å’Œé‡å†™Swift ä¸­é»˜è®¤æƒ…å†µä¸‹å­ç±»æ˜¯ä¸ä¼šç»§æ‰¿çˆ¶ç±»çš„æ„é€ å™¨çš„ã€‚ä½†æ˜¯å¦‚æœæ»¡è¶³ä»¥ä¸‹ä»»æ„ä¸€ä¸ªæ¡ä»¶å­ç±»æ˜¯å¯ä»¥ç»§æ‰¿çˆ¶ç±»çš„æ„é€ å™¨çš„ã€‚ 1.å­ç±»æ²¡æœ‰å®šä¹‰ä»»ä½•çš„æŒ‡å®šæ„é€ å™¨ï¼Œè¿™æ—¶å€™å­ç±»ä¼šè‡ªåŠ¨çš„ç»§æ‰¿çˆ¶ç±»æ‰€æœ‰çš„æŒ‡å®šæ„é€ å™¨ 2.å¦‚æœå­ç±»æä¾›äº†æ‰€æœ‰çš„çˆ¶ç±»æŒ‡å®šçš„æ„é€ å™¨çš„å®ç°ï¼Œä¸ç®¡æ˜¯ç»§æ‰¿è¿˜æ˜¯è‡ªå·±æä¾›å®ç°ã€‚å­ç±»éƒ½ä¼šè‡ªåŠ¨ç»§æ‰¿çˆ¶ç±»æ‰€æœ‰çš„ä¾¿åˆ©æ„é€ å™¨ã€‚ å¯å¤±è´¥æ„é€ å™¨åœ¨å¾ˆå¤šæ—¶å€™åœ¨æ„é€ å™¨ä¼ å…¥çš„å‚æ•°å¯èƒ½å¹¶ä¸èƒ½å¦‚é¢„æœŸçš„å®Œæˆåˆå§‹åŒ–ï¼Œè¿™æ ·æ„é€ è¿‡ç¨‹å°±ä¼šå¤±è´¥ï¼Œåœ¨ swift ä¸­å¯ä»¥ä½¿ç”¨å¯å¤±è´¥æ„é€ å™¨æ¥å¤„ç†è¿™æ ·çš„æƒ…å†µã€‚å¯å¤±è´¥æ„é€ å™¨å¯ä»¥åœ¨ç±»ï¼Œç»“æ„ä½“ï¼Œæˆ–è€…æ˜¯æšä¸¾ä¸­æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå¯å¤±è´¥æ„é€ å™¨ã€‚å¯å¤±è´¥æ„é€ å™¨çš„è¯­æ³•ä¸ºåœ¨ init åæ·»åŠ ä¸€ä¸ªé—®å·ï¼šï¼ˆinit?ï¼‰ å¦‚ä¸‹ï¼š 123456789101112class Person &#123; var name: String? init?(name: String) &#123; if name.isEmpty &#123; return nil &#125; self.name = name &#125; var apartment: Apartment?&#125;let aaron = Person(name: \"Aaron\") åœ¨ä¸Šé¢è¿™æ®µä»£ç ä¸­æ„é€ ä¸€ä¸ª Person å®ä¾‹ï¼Œå½“ä¼ å…¥çš„å‚æ•°ä¸ºç©ºå­—ç¬¦ä¸²çš„æ—¶å€™åˆ™ä¼šè¿”å› nilã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ã€‚å¯å¤±è´¥æ„é€ å™¨çš„å‚æ•°åå’Œå‚æ•°ç±»å‹ï¼Œä¸èƒ½ä¸å…¶å®ƒéå¯å¤±è´¥æ„é€ å™¨çš„å‚æ•°åï¼ŒåŠå…¶å‚æ•°ç±»å‹ç›¸åŒã€‚ æšä¸¾ç±»å‹çš„å¯å¤±è´¥æ„é€ å™¨åŒæ ·çš„åœ¨æšä¸¾ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨å¯å¤±è´¥æ„é€ å™¨ï¼Œå½“å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå‚æ•°æ— æ³•åŒ¹é…ä»»ä½•çš„æšä¸¾å€¼çš„æ—¶å€™åˆ™æ„é€ å¤±è´¥ï¼Œè¿”å› nil 1234567891011121314151617enum Food &#123; case Beef,Noodles,Fish init?(name: String) &#123; switch name &#123; case \"Beef\": self = .Beef case \"Noodles\": self = .Noodles case \"Fish\": self = .Fish default: return nil &#125; &#125;&#125;let myFavriteFood = Food(name: \"Fish\") åŒæ ·çš„å¦‚åŒä¸Šé¢æƒ…å†µçš„æ„é€ å™¨ä¸€æ ·ï¼Œå¦‚æœåœ¨æšä¸¾æ„é€ å™¨ä¸­æ‰¾ä¸åˆ°ä¸ä¹‹åŒ¹é…çš„å‚æ•°åˆ™ä¼šè¿”å›nilã€‚åŒæ—¶ï¼Œæšä¸¾çš„å¯å¤±è´¥æ„é€ å™¨ä¹Ÿå¯ä»¥é€šè¿‡å¸¦æœ‰åŸå§‹å€¼çš„æ–¹å¼æ¥å®Œæˆï¼Œè¿™æ ·å†™æ›´åŠ çš„ç®€çŸ­ã€‚ 123enum Food &#123; case Beef = â€œBeefâ€,Noodles = â€œNoodlesâ€,Fish = \"Fish\"&#125; æ„é€ å¤±è´¥çš„ä¼ é€’å’Œæ™®é€šæ„é€ å™¨ä¸€æ ·å¯å¤±è´¥æ„é€ å™¨ä¹Ÿå¯ä»¥æ¨ªå‘ä»£ç†åˆ°åŒç±»å‹çš„å…¶ä»–æ„é€ å™¨ä¸­ï¼ŒåŒæ—¶å­ç±»çš„å¯å¤±è´¥æ„é€ å™¨ä¹Ÿå¯ä»¥å‘ä¸Šä»£ç†åˆ°çˆ¶ç±»çš„å¯å¤±è´¥æ„é€ å™¨ï¼ŒåŒæ—¶å¯å¤±è´¥æ„é€ å™¨ä¹Ÿå¯ä»¥ä»£ç†åˆ°å…¶ä»–éå¯å¤±è´¥æ„é€ å™¨ä¸­ã€‚æ— è®ºæ˜¯å‘ä¸Šä»£ç†è¿˜æ˜¯æ¨ªå‘ä»£ç†ï¼Œå¦‚æœä½ ä»£ç†åˆ°çš„å…¶ä»–å¯å¤±è´¥æ„é€ å™¨è§¦å‘æ„é€ å¤±è´¥ï¼Œæ•´ä¸ªæ„é€ è¿‡ç¨‹å°†ç«‹å³ç»ˆæ­¢ï¼Œæ¥ä¸‹æ¥çš„ä»»ä½•æ„é€ ä»£ç ä¸ä¼šå†è¢«æ‰§è¡Œã€‚ å¯å¤±è´¥æ„é€ å™¨çš„é‡å†™å’Œå…¶ä»–æ™®é€šæ„é€ å™¨ä¸€æ ·ï¼Œå¯å¤±è´¥æ„é€ å™¨æ˜¯å¯ä»¥åœ¨å­ç±»ä¸­é‡å†™çˆ¶ç±»çš„å¯å¤±è´¥æ„é€ å™¨çš„ï¼Œä¹Ÿå¯ä»¥ç”¨å­ç±»çš„éå¯å¤±è´¥æ„é€ å™¨é‡å†™çˆ¶ç±»çš„å¯å¤±è´¥æ„é€ å™¨ï¼Œä½†æ˜¯ä¸èƒ½åè¿‡æ¥ç”¨å¯å¤±è´¥æ„é€ å™¨é‡å†™éå¯å¤±è´¥æ„é€ å™¨ã€‚ å¯å¤±è´¥æ„é€ å™¨init!é€šå¸¸æ¥è¯´æˆ‘ä»¬é€šè¿‡åœ¨initå…³é”®å­—åæ·»åŠ é—®å·çš„æ–¹å¼ï¼ˆinit?ï¼‰æ¥å®šä¹‰ä¸€ä¸ªå¯å¤±è´¥æ„é€ å™¨ï¼Œä½†ä½ ä¹Ÿå¯ä»¥é€šè¿‡åœ¨initåé¢æ·»åŠ æƒŠå¹å·çš„æ–¹å¼æ¥å®šä¹‰ä¸€ä¸ªå¯å¤±è´¥æ„é€ å™¨ï¼ˆinit!ï¼‰ï¼Œè¯¥å¯å¤±è´¥æ„é€ å™¨å°†ä¼šæ„å»ºä¸€ä¸ªå¯¹åº”ç±»å‹çš„éšå¼è§£åŒ…å¯é€‰ç±»å‹çš„å¯¹è±¡ã€‚ ä½ å¯ä»¥åœ¨init?ä¸­ä»£ç†åˆ°init!ï¼Œåä¹‹äº¦ç„¶ã€‚ä½ ä¹Ÿå¯ä»¥ç”¨init?é‡å†™init!ï¼Œåä¹‹äº¦ç„¶ã€‚ä½ è¿˜å¯ä»¥ç”¨initä»£ç†åˆ°init!ï¼Œä¸è¿‡ï¼Œä¸€æ—¦init!æ„é€ å¤±è´¥ï¼Œåˆ™ä¼šè§¦å‘ä¸€ä¸ªæ–­è¨€ã€‚ å¿…è¦æ„é€ å™¨å¿…è¦æ„é€ å™¨æ˜¯é€šè¿‡åœ¨æ„é€ å™¨å‰æ·»åŠ  requred å…³é”®å­—è¡¨ç¤ºæ‰€æœ‰è¯¥ç±»çš„å­ç±»éƒ½åº”è¯¥å¿…é¡»å®ç°è¯¥æ„é€ å™¨ã€‚ 12345class SomeClass &#123; required init() &#123; // æ„é€ å™¨çš„å®ç°ä»£ç  &#125;&#125; åœ¨å­ç±»é‡å†™çˆ¶ç±»çš„å¿…è¦æ„é€ å™¨æ—¶ï¼Œå¿…é¡»åœ¨å­ç±»çš„æ„é€ å™¨å‰ä¹Ÿæ·»åŠ requiredä¿®é¥°ç¬¦ï¼Œè¡¨æ˜è¯¥æ„é€ å™¨è¦æ±‚ä¹Ÿåº”ç”¨äºç»§æ‰¿é“¾åé¢çš„å­ç±»ã€‚åœ¨é‡å†™çˆ¶ç±»ä¸­å¿…è¦çš„æŒ‡å®šæ„é€ å™¨æ—¶ï¼Œä¸éœ€è¦æ·»åŠ overrideä¿®é¥°ç¬¦ï¼š 12345class SomeSubclass: SomeClass &#123; required init() &#123; // æ„é€ å™¨çš„å®ç°ä»£ç  &#125;&#125; æ³¨æ„å¦‚æœå­ç±»ç»§æ‰¿çš„æ„é€ å™¨èƒ½æ»¡è¶³å¿…è¦æ„é€ å™¨çš„è¦æ±‚ï¼Œåˆ™æ— é¡»åœ¨å­ç±»ä¸­æ˜¾å¼æä¾›å¿…è¦æ„é€ å™¨çš„å®ç°ã€‚","categories":[],"tags":[{"name":"Swift","slug":"Swift","permalink":"Aaronzjp.cn/tags/Swift/"}]},{"title":"Swift-æ–¹æ³•","slug":"Swift-Method","date":"2017-03-22T04:57:57.000Z","updated":"2017-07-27T02:53:02.000Z","comments":true,"path":"2017/03/22/Swift-Method/","link":"","permalink":"Aaronzjp.cn/2017/03/22/Swift-Method/","excerpt":"åœ¨ Swift ä¸­æ–¹æ³•åˆ†ä¸ºä¸¤ç§ï¼Œå®ä¾‹æ–¹æ³•ã€ç±»å‹æ–¹æ³•ã€‚å…¶ä¸­ç±»å‹æ–¹æ³•å’Œ Obj-c ä¸­çš„ç±»æ–¹æ³•ç›¸ä¼¼çš„ï¼Œç±»å‹æ–¹æ³•æ˜¯ä½œç”¨äºç±»å‹æœ¬èº«çš„ï¼Œå®ä¾‹æ–¹æ³•åˆ™æ˜¯ä½œç”¨äºç±»å‹å¯¹åº”çš„å®ä¾‹ã€‚å’Œ Obj-c ä¸åŒçš„æ˜¯ï¼Œåœ¨ Swift ä¸­ä¸ä»…å¯ä»¥ç»™ç±»å®šä¹‰æ–¹æ³•ï¼ŒåŒæ—¶è¿˜å¯ä»¥ç»™ç»“æ„ä½“å’Œæšä¸¾å®šä¹‰æ–¹æ³•ã€‚","text":"åœ¨ Swift ä¸­æ–¹æ³•åˆ†ä¸ºä¸¤ç§ï¼Œå®ä¾‹æ–¹æ³•ã€ç±»å‹æ–¹æ³•ã€‚å…¶ä¸­ç±»å‹æ–¹æ³•å’Œ Obj-c ä¸­çš„ç±»æ–¹æ³•ç›¸ä¼¼çš„ï¼Œç±»å‹æ–¹æ³•æ˜¯ä½œç”¨äºç±»å‹æœ¬èº«çš„ï¼Œå®ä¾‹æ–¹æ³•åˆ™æ˜¯ä½œç”¨äºç±»å‹å¯¹åº”çš„å®ä¾‹ã€‚å’Œ Obj-c ä¸åŒçš„æ˜¯ï¼Œåœ¨ Swift ä¸­ä¸ä»…å¯ä»¥ç»™ç±»å®šä¹‰æ–¹æ³•ï¼ŒåŒæ—¶è¿˜å¯ä»¥ç»™ç»“æ„ä½“å’Œæšä¸¾å®šä¹‰æ–¹æ³•ã€‚ å®ä¾‹æ–¹æ³•å®ä¾‹æ–¹æ³•æ˜¯å±äºç±»ã€ç»“æ„ä½“æˆ–è€…æšä¸¾ç±»å‹å®ä¾‹çš„æ–¹æ³•ã€‚å®ä¾‹æ–¹æ³•çš„è¯­æ³•å’Œå‡½æ•°æ˜¯ä¸€è‡´çš„ï¼ˆå…¶å®å°±æ˜¯å‡½æ•°å§ï¼Œåªæ˜¯æ˜¯å’ŒæŸä¸ªç‰¹å®šç±»å‹ç›¸å…³è”çš„å‡½æ•°ï¼‰ï¼Œå®ä¾‹æ–¹æ³•æ˜¯æä¾›ä¿®æ”¹å’Œè®¿é—®å®ä¾‹å±æ€§çš„æ–¹æ³•ï¼Œå®ç°å’Œå®ä¾‹ç›®çš„ç›¸å…³çš„åŠŸèƒ½ã€‚ 123456789101112class Dog &#123; var name: String? func giveDog(name: String) &#123; self.name = name &#125; func changeDog(name: String) &#123; self.name = name &#125; func deleteDogName() &#123; self.name = nil &#125;&#125; Dog ç±»å®šä¹‰äº†ä¸‰ä¸ªå®ä¾‹æ–¹æ³•ï¼Œæ–¹æ³•çš„è°ƒç”¨å’Œå±æ€§æ˜¯ä¸€æ ·çš„ä½¿ç”¨ç‚¹è¯­æ³•: 1234567let dog = Dog()dog.giveDog(name: \"DouDou\")//dog çš„åå­—æ˜¯ DouDoudog.changeDog(name: \"SB\")//dog çš„åå­—æ˜¯ SBdog.deleteDogName()//dog çš„åå­—æ˜¯ä¸€ä¸ª nil çš„å¯é€‰å€¼ æ–¹æ³•å’Œå‡½æ•°ä¸€æ ·ä¹Ÿå¯ä»¥æŒ‡å®šå‚æ•°å¤–éƒ¨åç§°å’Œå†…éƒ¨åç§°ã€‚ å®ä¾‹æ–¹æ³•ä¸­ä¿®æ”¹å€¼ç±»å‹å±æ€§swift ä¸­æšä¸¾å’Œç»“æ„ä½“å±äºå€¼ç±»å‹ï¼Œé»˜è®¤æƒ…å†µä¸‹å€¼ç±»å‹çš„å±æ€§æ˜¯ä¸èƒ½åœ¨å®ä¾‹æ–¹æ³•ä¸­å°±è¡Œä¿®æ”¹çš„ï¼Œå¦‚æœéœ€è¦åœ¨å€¼ç±»å‹ä¸­ä¿®æ”¹å±æ€§å°±éœ€è¦ä½¿ç”¨å¯å˜æ–¹æ³•ã€‚å¯å˜æ–¹æ³•ä½¿ç”¨å…³é”®å­— mutating ä¿®é¥°ï¼Œæ”¾åœ¨æ–¹æ³•å£°æ˜çš„æœ€å‰é¢ï¼Œåœ¨å¯å˜æ–¹æ³•ä¸­è¿˜å¯ä»¥å¯¹ self è¿›è¡Œèµ‹å€¼ï¼Œæ–¹æ³•ç»“æŸåè¢«èµ‹å€¼çš„ self çš„å®ä¾‹ä¼šè¢«æ–°çš„å€¼æ‰€å–ä»£ã€‚åœ¨å¸¸é‡å€¼ç±»å‹å®ä¾‹ä¸­æ˜¯ä¸å¯ä»¥è°ƒç”¨å¯å˜æ–¹æ³•çš„ï¼Œå› ä¸ºå€¼ç±»å‹çš„å®ä¾‹ä¸€æ—¦å£°æ˜æˆä¸ºå¸¸é‡é‚£ä¹ˆä»–çš„å±æ€§ä¹Ÿå…¨éƒ¨å˜ä¸ºå¸¸é‡ã€‚ 123456struct Point &#123; var x = 0.0, y = 0.0 mutating func moveTo(x:Double, y:Double) &#123; self = Point(x: x, y: y) &#125;&#125; åŒæ ·çš„ä¹Ÿå¯ä»¥åº”ç”¨åœ¨æšä¸¾ä¸­ 12345678910111213enum TriStateSwitch &#123; case Off, Low, High mutating func next() &#123; switch self &#123; case Off: self = Low case Low: self = High case High: self = Off &#125; &#125;&#125; ç±»å‹æ–¹æ³•å®ä¾‹æ–¹æ³•æ˜¯è¢«ç±»å‹çš„ç‰¹å®šå®ä¾‹è°ƒç”¨ï¼Œé‚£ä¹ˆç±»å‹æ–¹æ³•å°±æ˜¯è¢«ç±»å‹è°ƒç”¨çš„ã€‚åœ¨ç±»ä¸­å£°æ˜ç±»å‹æ–¹æ³•ä½¿ç”¨ class å…³é”®å­—ï¼Œæ”¾åœ¨ func çš„å‰é¢ï¼Œåœ¨ç»“æ„ä½“å’Œæšä¸¾ä¸­å£°æ˜ç±»å‹æ–¹æ³•ä½¿ç”¨ static å…³é”®å­—ï¼Œä¹Ÿæ˜¯æ”¾åœ¨ func å‰é¢ã€‚ 1234567891011class Person &#123; var name: String? class func newPerson(name: String) -&gt; Person &#123; return Person(name: name) &#125; init(name: String) &#123; self.name = name &#125;&#125;let person = Person.newPerson(name: \"Aaron\") åœ¨ Person ä¸­å£°æ˜äº†ä¸€ä¸ªç±»æ–¹æ³•ï¼Œè°ƒç”¨è¯¥ç±»æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª person å®ä¾‹ã€‚åœ¨ç±»å‹æ–¹æ³•ä¸­å¯ä»¥ç›´æ¥è®¿é—®ç±»å‹å±æ€§æˆ–è€…è°ƒç”¨ç±»å‹æ–¹æ³•ï¼Œè€Œä¸éœ€è¦åŠ ä¸Šç±»å‹åç§°ã€‚","categories":[],"tags":[{"name":"Swift","slug":"Swift","permalink":"Aaronzjp.cn/tags/Swift/"}]},{"title":"iOSåŠ¨ç”»","slug":"Animation","date":"2017-03-07T06:44:31.000Z","updated":"2017-11-14T03:01:19.000Z","comments":true,"path":"2017/03/07/Animation/","link":"","permalink":"Aaronzjp.cn/2017/03/07/Animation/","excerpt":"â€‹ åœ¨iOSï¼MacOSä¸­ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„åŠ¨ç”»éƒ½æ˜¯ç”± Core Animation è¿™ä¸ªæ¡†æ¶æ¥å®Œæˆçš„ã€‚è¿™ä¸ªæ¡†æ¶çš„ä¸»è¦åŠŸèƒ½å°±æ˜¯æ¸²æŸ“å›¾å½¢ï¼Œä»¥åŠåŠ¨ç”»çš„å®ç°ï¼Œä½¿ç”¨ Core Animation æ¥å®ç°å›¾å½¢æ¸²æŸ“ä»¥åŠåŠ¨ç”»åªéœ€è¦é…ç½®ä¸€äº›ç®€å•çš„å‚æ•°ï¼Œå‘Šè¯‰å®ƒåŠ¨ç”»åº”è¯¥ä»€ä¹ˆæ—¶å€™å¼€å§‹ï¼Œä»€ä¹ˆæ—¶å€™ç»“æŸï¼Œä»¥åŠçŠ¶æ€ç­‰ã€‚ Core Animation é€šè¿‡ç¡¬ä»¶åŠ é€Ÿè‡ªåŠ¨çš„å®Œæˆå›¾å½¢çš„ç»˜åˆ¶ï¼Œæ¸²æŸ“ä»¥åŠåŠ¨ç”»ã€‚","text":"â€‹ åœ¨iOSï¼MacOSä¸­ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„åŠ¨ç”»éƒ½æ˜¯ç”± Core Animation è¿™ä¸ªæ¡†æ¶æ¥å®Œæˆçš„ã€‚è¿™ä¸ªæ¡†æ¶çš„ä¸»è¦åŠŸèƒ½å°±æ˜¯æ¸²æŸ“å›¾å½¢ï¼Œä»¥åŠåŠ¨ç”»çš„å®ç°ï¼Œä½¿ç”¨ Core Animation æ¥å®ç°å›¾å½¢æ¸²æŸ“ä»¥åŠåŠ¨ç”»åªéœ€è¦é…ç½®ä¸€äº›ç®€å•çš„å‚æ•°ï¼Œå‘Šè¯‰å®ƒåŠ¨ç”»åº”è¯¥ä»€ä¹ˆæ—¶å€™å¼€å§‹ï¼Œä»€ä¹ˆæ—¶å€™ç»“æŸï¼Œä»¥åŠçŠ¶æ€ç­‰ã€‚ Core Animation é€šè¿‡ç¡¬ä»¶åŠ é€Ÿè‡ªåŠ¨çš„å®Œæˆå›¾å½¢çš„ç»˜åˆ¶ï¼Œæ¸²æŸ“ä»¥åŠåŠ¨ç”»ã€‚ â€‹ é¦–å…ˆçœ‹ä¸€ä¸‹ Core Animation ä¸­ä¸»è¦çš„å‡ ä¸ªç±»çš„ç»§æ‰¿æœºæ„ï¼Œå¦‚ä¸‹å›¾ï¼š éšå¼åŠ¨ç”»ä¹‹æ‰€ä»¥å«éšå¼åŠ¨ç”»æˆ‘è§‰å¾—åº”è¯¥æ˜¯æˆ‘ä»¬åœ¨å¤„ç†éšå¼åŠ¨ç”»çš„æ—¶å€™ä¸éœ€è¦å»å¤„ç†åŠ¨ç”»ç›¸å…³çš„ä¸œè¥¿ï¼Œä¸éœ€è¦å»è®¾ç½®åŠ¨ç”»çš„æ—¶é—´ï¼ŒåŠ¨ç”»çš„è½¨è¿¹ï¼Œè€Œåªéœ€è¦æ”¹å˜ä¸€ä¸ªå±æ€§å°±å¯ä»¥åšå‡ºä¸€ä¸ªåŠ¨ç”»ï¼Œè¿™äº›åŠ¨ç”»å…¶å®éƒ½æ˜¯ç”± Core Animation æ¥å®Œæˆçš„ã€‚Core Animation åŒ…å«äº†ä¸€ç³»åˆ—çš„å±æ€§åŠ¨ç”»çš„é›†åˆæœºåˆ¶ã€‚éšå¼åŠ¨ç”»åªä½œç”¨äº RootLayer ä»¥å¤–çš„ Layer ã€‚ äº‹åŠ¡éšå¼åŠ¨ç”»å…¶å®æ˜¯é€šè¿‡äº‹åŠ¡æ¥ç®¡ç†çš„ï¼Œäº‹åŠ¡å®é™…ä¸Šæ˜¯ Core Animation ç”¨æ¥åŒ…å«ç®¡ç†å±æ€§åŠ¨ç”»çš„é›†åˆæœºåˆ¶ï¼Œä»»ä½•é€šè¿‡äº‹åŠ¡å»æ”¹å˜çš„åŠ¨ç”»å±æ€§éƒ½ä¸ä¼šç«‹åˆ»çš„å‘ç”Ÿå˜åŒ–ï¼Œè€Œæ˜¯å½“äº‹åŠ¡æäº¤çš„æ—¶å€™æ‰å¼€å§‹ä»åŸæ¥çš„å€¼è¿‡æ¸¡åˆ°ä¸€ä¸ªæ–°çš„å€¼ã€‚äº‹åŠ¡æ˜¯é€šè¿‡ CATransaction ç±»æ¥ç®¡ç†çš„ï¼Œè¯¥ç±»å’Œå…¶ä»–æ™®é€šçš„ç±»ä¸ä¸€æ ·ï¼Œæ²¡æœ‰å±æ€§å’Œå®ä¾‹æ–¹æ³•ï¼Œä¹Ÿæ²¡æœ‰ + alloc; ï¼Œ - init; ç­‰æ–¹æ³•ã€‚è€Œæ˜¯é€šè¿‡ + begin; ï¼Œ + commit; æ¥å…¥æ ˆå’Œå‡ºæ ˆã€‚æ‰€æœ‰å¯ä»¥åšåŠ¨ç”»çš„å±æ€§éƒ½å¯ä»¥æ·»åŠ åˆ°æ ˆé¡¶é¡¶äº‹åŠ¡ï¼Œç„¶åæäº¤äº‹åŠ¡ã€‚éšå¼åŠ¨ç”»ä¸­åŠ¨ç”»é»˜è®¤çš„æ—¶é—´ä¸º0.25ç§’ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ - setAnimationDuration; æ¥è®¾ç½®æ—¶é—´ï¼Œæˆ–è€…é€šè¿‡ + animationDuration; æ¥è·å–å½“å‰çš„æ—¶é—´ã€‚å›¾å±‚ä½œå‡ºçš„æ‰€æœ‰çš„æ”¹å˜éƒ½æ˜¯äº‹åŠ¡çš„ä¸€éƒ¨åˆ†ï¼Œéƒ½æ˜¯ç»ç”±äº‹åŠ¡æŠŠå›¾å±‚çš„æ”¹å˜æ›´æ–°åˆ°å›¾å±‚çš„ã€‚äº‹åŠ¡åˆå¯ä»¥åˆ†ä¸ºéšå¼äº‹åŠ¡å’Œæ˜¾å¼äº‹åŠ¡ã€‚ éšå¼äº‹åŠ¡å½“ä¿®æ”¹å›¾å±‚æ²¡æœ‰åœ¨æ˜¾ç¤ºçš„è·å–äº‹åŠ¡è¿›è¡Œæ›´æ”¹çš„æ—¶å€™éƒ½ä¼šè‡ªåŠ¨çš„åˆ›å»ºéšå¼äº‹åŠ¡ï¼Œå½“çº¿ç¨‹ä¸­çš„ run-loop æ‰§è¡Œä¸‹ä¸€æ¬¡è¿­ä»£çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨çš„æ”¶é›†äº‹åŠ¡å¹¶æäº¤äº‹åŠ¡ã€‚ 1layer.position = CGPointMake(0.0,1.0); ä¸Šé¢çš„è¿™æ®µä»£ç ä¼šè¢«äº‹åŠ¡æ”¶é›†å¹¶æäº¤ï¼Œç”ŸæˆåŠ¨ç”»æ•ˆæœã€‚ æ˜¾å¼äº‹åŠ¡æ˜¾ç¤ºäº‹åŠ¡å°±éœ€è¦åœ¨ä¿®æ”¹ layer å‰å¼€å§‹ä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œç„¶ååœ¨ä¿®æ”¹ layer åæäº¤äº‹åŠ¡ã€‚ 1234567891011121314151617//å¼€å§‹ä¸€ä¸ªæ–°äº‹åŠ¡ï¼Œå¦‚æœä¸å¼€å¯æ–°çš„äº‹åŠ¡ï¼Œç›´æ¥åœ¨å½“å‰äº‹åŠ¡ä¸­åšä¿®æ”¹å¯èƒ½ä¼šé€ æˆä¸€äº›å‰¯ä½œç”¨[CATransaction begin];// [CATransaction setDisableActions:YES];//è®¾ç½®äº‹åŠ¡æ—¶é—´[CATransaction setAnimationDuration:3.0];//è®¾ç½®å®Œæˆäº‹åŠ¡[CATransaction setCompletionBlock:^&#123; CGAffineTransform transform = self.layer.affineTransform; transform = CGAffineTransformRotate(transform, M_PI_4); self.layer.affineTransform = transform;&#125;];CGFloat red = arc4random() / (CGFloat)INT_MAX;CGFloat green = arc4random() / (CGFloat)INT_MAX;CGFloat blue = arc4random() / (CGFloat)INT_MAX;self.layer.backgroundColor = [UIColor colorWithRed:red green:green blue:blue alpha:1.0].CGColor;//æäº¤äº‹åŠ¡[CATransaction commit]; è¿™ç§è®¾ç½®åŠ¨ç”»çš„æ–¹å¼æ˜¯ä¸æ˜¯è§‰å¾—å¥½åƒåœ¨é‚£è§è¿‡ï¼Ÿå¯¹ï¼Œåœ¨ UIView ä¸­ä¹Ÿæœ‰è¿™æ ·ç±»ä¼¼çš„åŠ¨ç”»çš„å®ç°æ–¹å¼ã€‚åœ¨ UIViewä¸­è®¾ç½®ä¸€ä¸ªåŠ¨ç”»å¦‚ä¸‹ï¼š 12345678CGPoint piont = [[touches anyObject]locationInView:self.view];[UIView beginAnimations:nil context:nil];[UIView setAnimationDuration:2.0];self.layerView.backgroundColor = [UIColor orangeColor];self.layerView.center = piont;[UIView commitAnimations]; å®é™…ä¸Šé€šè¿‡ UIView è¿™ç§æ–¹å¼å®ç°çš„åŠ¨ç”»éƒ½æ˜¯é€šè¿‡è®¾ç½® CATransaction æ¥å®Œæˆçš„ï¼Œä½†æ˜¯ UIView ç›¸å¯¹äº CATransaction æ¥è¯´è¦æ›´åŠ ä¸°å¯Œä¸€äº›ï¼Œå¯ä»¥è®¾ç½® delayã€repeatCountç­‰ç­‰ã€‚ åœ¨ iOS 4.0 ç‚¹æ—¶è‹¹æœä¸º UIView æ·»åŠ äº†åŸºäº Block æ·»åŠ ç‚¹åŠ¨ç”»ç‚¹æ–¹å¼ï¼š + (void)animateWithDuration:(NSTimeInterval)duration animations:(void (^)(void))animations completion:(void (^ __nullable)(BOOL finished))completionï¼› åœ¨ Block åŠ¨ç”»æ–¹å¼ä¸­å¯ä»¥è®¾ç½® completion ä»¥åœ¨åŠ¨ç”»å®Œæˆçš„æ—¶å€™åšä¸€äº›å…¶ä»–æ“ä½œï¼Œè¿™ç§æ–¹å¼åœ¨ CATransaction ä¸­ä¹Ÿæœ‰å¯¹åº”çš„æ–¹æ³• ï¼š+ (void)setCompletionBlock:(nullable void (^)(void))block; åœ¨ CATransaction ä¸­ä½¿ç”¨åŠ¨ç”»å®Œæˆå—ï¼š 1234567891011121314151617//å¼€å§‹ä¸€ä¸ªæ–°äº‹åŠ¡[CATransaction begin];// [CATransaction setDisableActions:YES];//è®¾ç½®äº‹åŠ¡æ—¶é—´[CATransaction setAnimationDuration:3.0];//è®¾ç½®å®Œæˆäº‹åŠ¡[CATransaction setCompletionBlock:^&#123; CGAffineTransform transform = self.layer.affineTransform; transform = CGAffineTransformRotate(transform, M_PI_4); self.layer.affineTransform = transform;&#125;];CGFloat red = arc4random() / (CGFloat)INT_MAX;CGFloat green = arc4random() / (CGFloat)INT_MAX;CGFloat blue = arc4random() / (CGFloat)INT_MAX;self.layer.backgroundColor = [UIColor colorWithRed:red green:green blue:blue alpha:1.0].CGColor;//æäº¤äº‹åŠ¡[CATransaction commit]; ä»¥ä¸Šä»£ç ä¼šåœ¨åŠ¨ç”»å®Œæˆçš„æ—¶å€™æ—‹è½¬90åº¦ï¼Œåœ¨å›¾å±‚æ—‹è½¬çš„æ—¶å€™è¦æ¯”é¢œè‰²æ¸å˜å¿«å¾ˆå¤šï¼Œè¿™æ˜¯å› ä¸ºæ—‹è½¬æ˜¯åœ¨äº‹åŠ¡æäº¤åæ‰è¢«æ‰§è¡Œçš„ï¼Œæ˜¯ä½¿ç”¨é»˜è®¤çš„äº‹åŠ¡åšçš„æ—‹è½¬ï¼Œæ‰€ä»¥æ—¶é—´å°±å˜æˆäº†é»˜è®¤çš„0.25ç§’ã€‚ éšå¼åŠ¨ç”»çš„å®ç°åœ¨æœ€ä¸Šé¢å°±è®²åˆ°äº†éšå¼åŠ¨ç”»åªä½œç”¨äºé RootLayer çš„å›¾å±‚ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ UIView ä¸­è‹¹æœç¦ç”¨äº† RootLayer çš„è¿™ä¸ªç‰¹æ€§ã€‚ä¸ºäº†ææ¸…æ¥š UIView æ˜¯å¦‚ä½•ç¦ç”¨ CALayer çš„éšå¼åŠ¨ç”»çš„å°±éœ€è¦äº†è§£éšå¼åŠ¨ç”»çš„å®ç°ã€‚ éšå¼åŠ¨ç”»å®ç°æ–¹å¼å¯ä»¥åˆ†ä¸ºå¦‚ä¸‹çš„å‡ æ­¥ï¼š å½“ CALayer çš„å±æ€§æ”¹å˜çš„æ—¶å€™ï¼Œå°±ä¼šè°ƒç”¨ - actionForKey(NSSrting *):event; æ–¹æ³•ä¼ é€’å±æ€§çš„åç§°ã€‚ å¦‚æœå›¾å±‚å¦æœ‰å§”æ‰˜ï¼Œå¹¶ä¸”æ˜¯å¦å®ç° CALayerDelegate åè®®æŒ‡å®šçš„ - actionForLayer:forKey æ–¹æ³•ã€‚å¦‚æœæœ‰ï¼Œç›´æ¥è°ƒç”¨å¹¶è¿”å›ç»“æœã€‚ å¦‚æœæ²¡æœ‰å§”æ‰˜ï¼Œæˆ–è€…å§”æ‰˜æ²¡æœ‰å®ç° -actionForLayer:forKey æ–¹æ³•ï¼Œå›¾å±‚æ¥ç€æ£€æŸ¥åŒ…å«å±æ€§åç§°å¯¹åº”è¡Œä¸ºæ˜ å°„çš„ actions å­—å…¸ã€‚ å¦‚æœ actions å­—å…¸æ²¡æœ‰åŒ…å«å¯¹åº”çš„å±æ€§ï¼Œé‚£ä¹ˆå›¾å±‚æ¥ç€åœ¨å®ƒçš„ style å­—å…¸æ¥ç€æœç´¢å±æ€§åã€‚ æœ€åï¼Œå¦‚æœåœ¨ style é‡Œé¢ä¹Ÿæ‰¾ä¸åˆ°å¯¹åº”çš„è¡Œä¸ºï¼Œé‚£ä¹ˆå›¾å±‚å°†ä¼šç›´æ¥è°ƒç”¨å®šä¹‰äº†æ¯ä¸ªå±æ€§çš„æ ‡å‡†è¡Œä¸ºçš„ - defaultActionForKey: æ–¹æ³•ã€‚ æ‰€ä»¥å½“ä¸€è½®æœç´¢è¿‡åï¼Œè¦ä¹ˆ - actionForLayer:forkey; è¿”å› nil ï¼Œè¦ä¹ˆå°±æ˜¯ CAAction åè®®å¯¹åº”çš„å¯¹è±¡ï¼Œæœ€å CALayer å°±ä¼šè·å–è¿™ä¸ªç»“æœå¯¹ä¹‹å‰å’Œç°åœ¨çš„å€¼åšåŠ¨ç”»ã€‚ é‚£ä¹ˆ UIView æ˜¯å¦‚ä½•ç¦ç”¨éšå¼åŠ¨ç”»çš„å‘¢ï¼Ÿ æ¯ä¸ª UIView å¯¹å…¶å…³è”çš„ RootLayer éƒ½æ˜¯ä¸€ä¸ªå§”æ‰˜ï¼Œå¹¶ä¸”å®ç°äº† - actionForLayer:forKey; æ–¹æ³•ï¼Œå½“ä¸å†ä¸€ä¸ªåŠ¨ç”»å—çš„å®ç°çš„æ—¶å€™ï¼ŒUIView å¯¹æ‰€æœ‰çš„å›¾å±‚çš„åŠ¨ç”»è¡Œä¸ºéƒ½è¿”å› nil ï¼Œä½†æ˜¯åœ¨åŠ¨ç”»èŒƒå›´å†…çš„å°±è¿”å›ä¸€ä¸ªéç©ºçš„å€¼ã€‚å½“ç„¶è¿˜æœ‰ä¸€ç§æ–¹å¼å¯ä»¥ç›´æ¥ç¦ç”¨éšå¼åŠ¨ç”»ï¼Œå°±æ˜¯åœ¨å…¥æ ˆçš„æ—¶å€™è°ƒç”¨ - setDisableActions; æ–¹æ³•ã€‚ 123[CATransaction begin];[CATransaction setDisableActions:YES];[CATrasnaction commit]; å‘ˆç°ä¸æ¨¡å‹å‰é¢ä¹Ÿæåˆ°äº†ï¼Œå½“æ›´æ”¹ä¸€ä¸ªå›¾å±‚çš„å±æ€§çš„æ—¶å€™ï¼Œäº‹åŠ¡è¢«æäº¤ï¼Œå›¾å±‚åœ¨å±å¹•ä¸Šå°±ä¼šä»ä¹‹å‰çš„å€¼è¿‡æ¸¡åˆ°æ›´æ”¹çš„æ–°å€¼ï¼Œè€Œä¸æ˜¯ç«‹å³å°±ä¼šç”Ÿæ•ˆçš„ã€‚å½“å›¾å±‚çš„å±æ€§å€¼æ›´æ–°åï¼Œå¹¶ä¸ä¼šé©¬ä¸Šçš„åœ¨å±å¹•ä¸Šæ˜¾ç¤ºå‡ºæ¥ï¼Œè€Œæ˜¯ä»ä¹‹å‰çš„å€¼æ…¢æ…¢è¿‡æ¸¡è¿‡æ¥çš„ï¼Œæˆ‘ä»¬æ›´æ”¹çš„å›¾å±‚å±æ€§çš„å€¼å…¶å®æ˜¯åœ¨è¿‡æ¸¡å®Œæˆåå°†è¦æ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„å€¼ã€‚ åœ¨iOSä¸­ï¼Œå±å¹•æ¯ç§’é’Ÿé‡ç»˜60æ¬¡ã€‚å¦‚æœåŠ¨ç”»æ—¶é•¿æ¯”60åˆ†ä¹‹ä¸€ç§’è¦é•¿ï¼ŒCore Animationå°±éœ€è¦åœ¨è®¾ç½®ä¸€æ¬¡æ–°å€¼å’Œæ–°å€¼ç”Ÿæ•ˆä¹‹é—´ï¼Œå¯¹å±å¹•ä¸Šçš„å›¾å±‚è¿›è¡Œé‡æ–°ç»„ç»‡ã€‚è¿™æ„å‘³ç€ CALayer é™¤äº†â€œçœŸå®â€å€¼ï¼ˆå°±æ˜¯ä½ è®¾ç½®çš„å€¼ï¼‰ä¹‹å¤–ï¼Œå¿…é¡»è¦çŸ¥é“å½“å‰æ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„å±æ€§å€¼çš„è®°å½•ã€‚æ¯ä¸ªå›¾å±‚å±æ€§çš„æ˜¾ç¤ºå€¼éƒ½è¢«å­˜å‚¨åœ¨ä¸€ä¸ªå«å‘ˆç°å›¾å±‚çš„ç‹¬ç«‹å›¾å±‚ä¸­ï¼Œè¯¥å›¾å±‚å¯ä»¥é€šè¿‡ presentationLayer; æ–¹æ³•è·å–ï¼Œè¿™ä¸ªå‘ˆç°å›¾å±‚å…¶å®æ˜¯æ¨¡å‹å›¾å±‚çš„å¤åˆ¶ï¼Œå‘ˆç°å›¾å±‚çš„å€¼å°±æ˜¯å½“å‰å±å¹•æ­£åœ¨æ˜¾ç¤ºçš„å€¼ã€‚é™¤äº†å‘ˆç°å±‚ï¼Œæ¨¡å‹å±‚ä»¥å¤–å…¶å®è¿˜æœ‰ä¸€ä¸ªæ¸²æŸ“å±‚ï¼Œä½†æ˜¯æ¸²æŸ“å±‚æ˜¯ç§æœ‰çš„æ‰€ä»¥è¿™é‡Œä¸åšäº†è§£ã€‚ ä»€ä¹ˆæ—¶å€™ä¼šç”¨åˆ°å‘ˆç°å±‚ï¼Ÿ å½“æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªåŸºäºå®šæ—¶å™¨çš„åŠ¨ç”»çš„æ—¶å€™ï¼Œéœ€è¦çŸ¥é“åœ¨æŸä¸ªæ—¶é—´å›¾å±‚æ˜¾ç¤ºçš„ä½ç½®æ—¶ï¼Œæˆ–è€…åœ¨åŠ¨ç”»æ­£åœ¨è¿›è¡Œçš„æ—¶å€™ä¹Ÿå…è®¸åŠ¨ç”»ä¸ç”¨æˆ·äº¤äº’çš„æ—¶å€™ï¼Œè¿™ä¸ªæ—¶å€™å‘ˆç°å±‚å°±èµ·äº†å¾ˆå¤§çš„ä½œç”¨ï¼Œæˆ‘ä»¬é€šè¿‡å‘ˆç°å±‚å¯ä»¥çŸ¥é“ç›®å‰å›¾å±‚åœ¨å±å¹•ä¸Šå¤„äºä»€ä¹ˆä½ç½®ï¼Œä»¥åŠå½“å‰å±å¹•ä¸Šå›¾å±‚çš„çŠ¶æ€ã€‚ å¦‚ä¸‹Demoï¼š 1234567891011121314151617181920- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event &#123; CGPoint point = [[touches anyObject] locationInView:self.view]; if ([self.layer.presentationLayer hitTest:point]) &#123; CGFloat red = arc4random() / (CGFloat)INT_MAX; CGFloat green = arc4random() / (CGFloat)INT_MAX; CGFloat blue = arc4random() / (CGFloat)INT_MAX; [CATransaction begin]; [CATransaction setAnimationDuration:1]; self.layer.backgroundColor = [UIColor colorWithRed:red green:green blue:blue alpha:1].CGColor; [CATransaction commit]; &#125;else&#123; [CATransaction begin]; [CATransaction setAnimationDuration:4]; self.layer.position = point; [CATransaction commit]; &#125;&#125; æ˜¾å¼åŠ¨ç”»â€‹ æ˜¾ç¤ºåŠ¨ç”»å°±æ˜¯éœ€è¦æ˜¾ç¤ºå»è®¾ç½®åŠ¨ç”»æ—¶é—´åŠ¨ç”»è½¨è¿¹ï¼Œä»¥åŠä¸€äº›å…¶ä»–åŠ¨ç”»çš„ç‰¹æ€§ã€‚å®ƒèƒ½å¤Ÿå¯¹ä¸€äº›å±æ€§åšæŒ‡å®šçš„è‡ªå®šä¹‰åŠ¨ç”»ï¼Œæˆ–è€…åˆ›å»ºéçº¿æ€§åŠ¨ç”»ï¼Œæ¯”å¦‚æ²¿ç€ä»»æ„ä¸€æ¡æ›²çº¿ç§»åŠ¨ã€‚ CAAnimationâ€‹ CAAnimation ä½œä¸ºåŠ¨ç”»çš„æ ¹ç±»ï¼Œæ˜¯ä¸å¯ä»¥ç›´æ¥ä½¿ç”¨çš„ï¼Œåº”è¯¥ä½¿ç”¨ä»–çš„å­ç±»ã€‚ä½†æ˜¯ CAAnimationä¸­è¿˜æ˜¯æœ‰ä¸€äº›ç»å¸¸ä½¿ç”¨åˆ°çš„ä¸€äº›å±æ€§ï¼Œå’Œæ–¹æ³•ï¼Œè¿™é‡Œåˆ—ä¸¾ä¸€ä¸‹ã€‚ å±æ€§ï¼š delgate:ä¸º CAAnimation è®¾ç½®ä»£ç†ï¼Œé»˜è®¤çš„ä¸ºniï¼Œè¯¥ä»£ç†ä¸‹æœ‰ä¸¤ä¸ªä»£ç†å›è°ƒæ–¹æ³•ã€‚ removedOnCompletion:åŠ¨ç”»å®Œæˆåæ˜¯å¦ç§»é™¤åŠ¨ç”»æ•ˆæœï¼Œé»˜è®¤ä¸º YES ï¼Œå½“åŠ¨ç”»ç»“æŸçš„æ—¶å€™åˆ™ä¼šç«‹å³æ¢å¤åˆ°åŠ¨ç”»å‰çš„çŠ¶æ€ã€‚å¦‚æœæƒ³è®©åŠ¨ç”»åœ¨å®Œæˆåä¿æŒåŠ¨ç”»æ‰§è¡Œå®Œçš„çŠ¶æ€ï¼Œéœ€è¦è®¾ç½®è¯¥å±æ€§ä¸º NO ï¼ŒåŒæ—¶è¿˜è¦è®¾ç½® fillMode ä¸ºkCAFillModeForwardsã€‚ timingFuncation:é€Ÿåº¦æ§åˆ¶ï¼Œæ§åˆ¶åŠ¨ç”»çš„èŠ‚å¥ã€‚è¯¥å±æ€§æ˜¯ä¸€ä¸ª NSString ç±»å‹ï¼Œå¯ä»¥æ¥å—å¦‚ä¸‹å‡ ç§å¸¸é‡ï¼š 12345678910//åŒ€é€ŸkCAMediaTimingFunctionLinear//æ…¢è¿›å¿«å‡ºkCAMediaTimingFunctionEaseIn//å¿«è¿›æ…¢å‡ºkCAMediaTimingFunctionEaseOut//æ…¢è¿›æ…¢å‡ºä¸­é—´åŠ é€ŸkCAMediaTimingFunctionEaseInEaseOut//é»˜è®¤å½¢å¼kCAMediaTimingFunctionDefault æ–¹æ³•ï¼š + animation; è¿”å›ä¸€ä¸ª CAAnimation å®ä¾‹å¯¹è±¡ã€‚ + defualtValueForKey:(NSString *)key; æ ¹æ®å±æ€§ Key è¿”å›ç›¸å¯¹åº”çš„å€¼ï¼Œç”¨äºå½“ä½¿ç”¨çš„é”®æ²¡æœ‰è¢«è®¾ç½®å€¼çš„æ—¶å€™ï¼Œè¿”å›ä¸€ä¸ªé»˜è®¤å€¼ã€‚ - (BOOL)shouldArchiveValueForKey:(NSString *)key; è®¾ç½®å¯¹åº”çš„é”®çš„å±æ€§æ˜¯å¦å¯ä»¥è¢«å½’æ¡£ï¼Œé»˜è®¤ä¸º YES ã€‚ ä»£ç†æ–¹æ³•ï¼š - (void)animationDidStart:(CAAnimation *)theAnimation; åŠ¨ç”»å¼€å§‹çš„å›è°ƒã€‚ - (void)animationDidStop:(CAAnimation *)theAnimation finished:(BOOL)flag; åŠ¨ç”»åœæ­¢æ—¶å€™å›è°ƒï¼ŒflagåŠ¨ç”»æ˜¯å¦ç»“æŸã€‚ CAMediaTimingâ€‹ CAMediaTiming ä½œä¸ºä¸€ä¸ªåè®®ç±»ï¼ŒCAAnimation å’Œ CALayer éƒ½å®ç°äº†è¯¥åè®®ã€‚è¯¥åè®®ä¸»è¦æ§åˆ¶åŠ¨ç”»çš„æ—¶é—´ï¼Œä»¥åŠä¸€äº›é‡å¤å±æ€§ã€‚è¯¥åè®®åŒ…å«äº†ä¸€ç³»åˆ—çš„å±æ€§ï¼Œå¦‚ä¸‹ï¼š beginTimeï¼šæŒ‡åŠ¨ç”»å¼€å§‹å‰å»¶è¿Ÿçš„æ—¶é—´ï¼Œè¿™ä¸ªå¼€å§‹æ—¶é—´æ˜¯ç›¸å¯¹å½“å‰å›¾å±‚æ—¶é—´æ¥è¯´çš„ï¼Œè¿™ä¸ªæ—¶é—´æ˜¯ä»åŠ¨ç”»è¢«æ·»åŠ é‚£ä¸€åˆ»å¼€å§‹çš„ï¼Œé»˜è®¤ä¸º0ã€‚ timeOffset: æ—¶é—´åç§»é‡ï¼Œè¿™ä¸ªå±æ€§æœ‰ç‚¹ä¸å¤ªå¥½ç†è§£ï¼Œé¦–å…ˆæŠŠä¸€ä¸ªåŠ¨ç”»çœ‹æˆæ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œå¦‚æœè®¾ç½®åŠ¨ç”»çš„æ—¶é—´ä¸º5sï¼ŒtimeOffset é»˜è®¤ä¸º0çš„æƒ…å†µä¸‹æ²¡æœ‰ä»»ä½•çš„å˜åŒ–ã€‚å¦‚æœæŠŠ timeOffset è®¾ç½®ä¸º3ï¼Œé‚£ä¹ˆåŠ¨ç”»å°±ä¼šä»ç¬¬4ç§’çš„åœ°æ–¹å¼€å§‹ï¼Œæ‰§è¡Œåˆ°ç¬¬3ç§’ã€‚ duration: åŠ¨ç”»æ‰§è¡Œçš„æ—¶é—´ï¼Œè¯¥å±æ€§è¿˜å’Œ speed å±æ€§æœ‰å…³ç³»ï¼Œå¦‚æœä¸€ä¸ª speed ä¸º2ï¼Œ duration ä¸º3çš„åŠ¨ç”»ï¼Œé‚£ä¹ˆè¿™ä¸ªåŠ¨ç”»çš„å®é™…æ‰§è¡Œæ—¶é—´ä¸º duration / speed ï¼Œspeed æ˜¯å¯ä»¥å åŠ çš„ï¼Œå¦‚æœä¸€ä¸ª layer çš„ speed ä¸º2ï¼Œsublayer çš„ speed ä¹Ÿä¸º2ï¼Œ durationä¸º3ï¼Œé‚£ä¹ˆè¿™ä¸ª sublayer çš„åŠ¨ç”»æ—¶é—´åˆ™ä¸º 3 / (2 * 2) ç§’ã€‚ speed: åŠ¨ç”»æ‰§è¡Œé€Ÿåº¦ï¼Œå’Œ duration æœ‰ä¸€å®šçš„å…³ç³»ï¼Œå…·ä½“çš„å‚è§ä¸Šä¸€æ¡ durationã€‚ repeatCount: åŠ¨ç”»é‡å¤æ¬¡æ•° repeatDuration: é‡å¤æ—¶é—´ï¼Œè¿™ä¸ªé‡å¤æ—¶é—´æ˜¯æŒ‡è®©åŠ¨ç”»æŒç»­é‡å¤æ‰§è¡Œçš„æ—¶é•¿ autoreverses: åŠ¨ç”»ç¿»è½¬å›æ”¾ï¼Œé»˜è®¤ä¸º NO ï¼Œå¦‚æœè®¾ç½®ä¸º YES ï¼Œé‚£ä¹ˆåŠ¨ç”»ç»“æŸæ—¶ä¼šä»¥åŠ¨ç”»çš„æ–¹å¼å›åˆ°åˆå§‹çŠ¶æ€ã€‚ fillMode: å¡«å……æ¨¡å¼ï¼Œè¯¥å±æ€§æ—¶ä¸€ä¸ª NSString çš„ç±»å‹ï¼Œå¯ä»¥æ¥å—å¦‚ä¸‹å››ç§å¸¸é‡ï¼š 12345678//åŠ¨ç”»ç»“æŸåå›åˆ°å‡†å¤‡çŠ¶æ€kCAFillModeForwards//åŠ¨ç”»ç»“æŸåä¿æŒæœ€åçŠ¶æ€kCAFillModeBackwards//åŠ¨ç”»ç»“æŸåå›åˆ°å‡†å¤‡çŠ¶æ€,å¹¶ä¿æŒæœ€åçŠ¶æ€kCAFillModeBoth//æ‰§è¡Œå®Œæˆç§»é™¤åŠ¨ç”»kCAFillModeRemoved è¦æ³¨æ„çš„æ˜¯å¦‚æœ CA Animation çš„ removedOnCompletion å±æ€§è®¾ç½®ä¸º NO çš„æ—¶å€™ï¼ŒfillMode æ˜¯æ— æ•ˆçš„ã€‚ å±æ€§åŠ¨ç”»(CAPropertyAnimation)â€‹ å±æ€§åŠ¨ç”»ä½œç”¨äºå›¾å±‚çš„æŸä¸ªå•ä¸€å±æ€§ï¼Œå¹¶æŒ‡å®šäº†å®ƒçš„ä¸€ä¸ªç›®æ ‡å€¼ï¼Œæˆ–è€…ä¸€è¿ä¸²å°†è¦åšåŠ¨ç”»çš„å€¼ã€‚å±æ€§åŠ¨ç”»åˆ†ä¸ºä¸¤ç§ï¼šåŸºç¡€å’Œå…³é”®å¸§ã€‚ åŸºç¡€åŠ¨ç”»(CABasicAnimation)â€‹ åœ¨ä¸Šé¢çš„æ˜¾ç¤ºåŠ¨ç”»ä¸­ä¹Ÿæåˆ°äº†ï¼ŒåŠ¨ç”»å…¶å®å°±æ˜¯å›¾å±‚/è§†å›¾åœ¨ä¸€æ®µæ—¶é—´å†…å‘ç”Ÿçš„æ”¹å˜ï¼Œä»ä¸€ä¸ªå€¼åˆ°å¦ä¸€ä¸ªå€¼ä¹‹é—´çš„è¿‡æ¸¡ï¼Œè¿™ä¹Ÿæ˜¯ CABasicAnimation æœ€ä¸»è¦çš„åŠŸèƒ½ã€‚ CABasicAnimation æ˜¯ CAPropertyAnimation çš„å­ç±»ã€‚ CAPropertyAnimation é€šè¿‡æŒ‡å®šä¸€ä¸ªå›¾å±‚çš„ keyPath ä½œç”¨äºè¿™ä¸ªå±æ€§ï¼Œå®é™…ä¸Šè¿™ä¸ª keyPath å¹¶ä¸æ˜¯æŒ‡å•ä¸€çš„å›¾å±‚çš„å±æ€§ï¼Œè€Œæ˜¯åŒ…å«äº†å®ƒå­æˆå‘˜çš„å±æ€§ï¼Œæˆ–è€…æ˜¯ä¸€äº›è™šæ‹Ÿå±æ€§ã€‚ CABasicAnimation ç»§æ‰¿äº CAPropertyAnimationï¼Œå¹¶ä¸”æ·»åŠ äº†å¦‚ä¸‹ä¸‰ä¸ªå±æ€§ï¼š 123id fromValueid toValueid byValue åˆ†åˆ«è®¾ç½®è¿™ä¸‰ä¸ªå±æ€§è¯´è¡¨è¾¾çš„æ•ˆæœï¼š åŒæ—¶è®¾ç½® fromValue å’Œ toValueï¼Œä¼šåœ¨è¿™ä¸¤ä¸ªå€¼ä¹‹é—´åšåŠ¨ç”» åŒæ—¶è®¾ç½® formValue å’Œ byValueï¼Œåˆ™ä¼šåœ¨ fromValue å’Œ fromValue + byValue ä¹‹é—´åšåŠ¨ç”» åŒæ—¶è®¾ç½® byValue å’Œ toValueï¼Œä¼šåœ¨ toValue - byValue å’Œ toValue ä¹‹é—´åšåŠ¨ç”» åªè®¾ç½® fromValue åˆ™ä¼šåœ¨ fromValue å’Œå½“å‰å›¾å±‚çš„å‘ˆç°å±‚çš„ç›®æ ‡å€¼ä¹‹é—´åšåŠ¨ç”» åªè®¾ç½® toValue åˆ™ä¼šåœ¨å½“å‰å›¾å±‚å‘ˆç°å±‚çš„ç›®æ ‡å€¼å’Œ toValue ä¹‹é—´åšåŠ¨ç”» åªè®¾ç½® byValue åˆ™ä¼šåœ¨å½“å‰å›¾å±‚å‘ˆç°å±‚çš„ç›®æ ‡å€¼å’Œ å½“å‰å›¾å±‚å‘ˆç°å±‚çš„ç›®æ ‡å€¼ + byValue ä¹‹é—´åšåŠ¨ç”» è¿™ä¸‰ä¸ªå±æ€§éƒ½è¢«æŒ‡å®šæˆäº† id ç±»å‹ï¼Œä¹‹æ‰€ä»¥æ˜¯ id ç±»å‹çš„æ˜¯å› ä¸ºå±æ€§åŠ¨ç”»ä¸æ˜¯å•ä¸€çš„ä½œç”¨åœ¨ä¸€ä¸ªå›ºå®šç±»å‹çš„å±æ€§ï¼Œè€Œæ˜¯å¾ˆå¤šä¸åŒç±»å‹çš„å±æ€§ä¸Šï¼ŒåŒ…æ‹¬æ•°å­—ç±»å‹ï¼ŒçŸ¢é‡ï¼Œå˜æ¢çŸ©é˜µï¼Œç”šè‡³æ˜¯é¢œè‰²æˆ–è€…å›¾ç‰‡ã€‚è¿˜æœ‰ä¸€äº›é NSObject æ´¾ç”Ÿå¯¹è±¡çš„å±æ€§ï¼Œé‚£ä¹ˆå¦‚æœç”¨è¿™äº›å±æ€§æ¥åšåŠ¨ç”»å°±éœ€è¦å°†æ•°æ®è½¬æ¢åŒ…è£…ä¸€ä¸‹ã€‚ ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ä¸èƒ½åŒäº‹è®¾ç½®è¿™ä¸‰ä¸ªå±æ€§ï¼Œå› ä¸ºå¯èƒ½ä¼šå‘ç”Ÿå†²çªã€‚ å¦‚ä¸‹é€šè¿‡ CABasicAnimation æ˜¾ç¤ºåŠ¨ç”»æ¥ä¿®æ”¹ CALayer çš„èƒŒæ™¯è‰²ï¼š 123456789CGFloat red = arc4random() / (CGFloat)INT_MAX;CGFloat green = arc4random() / (CGFloat)INT_MAX;CGFloat blue = arc4random() / (CGFloat)INT_MAX;UIColor *color = [UIColor colorWithRed:red green:green blue:blue alpha:1.0];CABasicAnimation *animation = [CABasicAnimation animation];animation.duration = 3.0;animation.keyPath = @&quot;backgroundColor&quot;;animation.toValue = (__bridge id) color.CGColor;[_layer addAnimation:animation forKey:@&quot;backgroundColor&quot;]; å½“è¿è¡Œè¿™æ®µä»£ç çš„æ—¶å€™ä¼šå‘ç° layer çš„èƒŒæ™¯è‰²è¿‡æ¸¡åˆ°ä¸€ä¸ªæ–°çš„é¢œè‰²åå½“åŠ¨ç”»ç»“æŸçš„é‚£ä¸€ç¬é—´ï¼Œ layer çš„èƒŒæ™¯è‰²åˆç«‹åˆ»å˜å›äº†æœ€åˆå§‹çš„å€¼ã€‚è¿™æ‰€ä»¥è¿™æ ·æ˜¯å› ä¸º CABasicAnimation åŠ¨ç”»å¹¶ä¸ä¼šæ”¹å˜å›¾å±‚çš„æ¨¡å‹å±‚ï¼Œè€Œæ˜¯æ”¹å˜çš„å‘ˆç°å±‚ã€‚ä¸€æ—¦åŠ¨ç”»ç»“æŸå°±ä¼šä»å›¾å±‚ä¸Šç§»é™¤ï¼Œå›¾å±‚æ¢å¤åˆ°åˆå§‹çš„çŠ¶æ€ã€‚å› ä¸ºæˆ‘ä»¬ä¹Ÿä»æ¥æ²¡æœ‰æ”¹å˜ backgroudColor è¿™ä¸ªå±æ€§ã€‚åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œ CABasicAnimation å¾ˆåˆé€‚ç”¨æ¥åšè¿ç»­å¾ªç¯çš„åŠ¨ç”»ã€‚å¦‚ä¸‹å±•ç¤ºäº†ä¸€ä¸ªå¿ƒè·³çš„ç®€å•åŠ¨ç”»ã€‚ 123456789101112131415161718192021_layer = [CALayer layer];UIImage *image = [UIImage imageNamed:@&quot;heart.jpg&quot;];_layer.contents = (__bridge id )image.CGImage;self.layer.bounds = CGRectMake(0, 0, image.size.width / 10, image.size.height / 10);_layer.position = self.view.layer.position;[self.view.layer addSublayer:_layer];CABasicAnimation *animation = [CABasicAnimation animation];animation.keyPath = @&quot;bounds&quot;;animation.fromValue = [NSValue valueWithCGRect:_layer.bounds];animation.toValue = [NSValue valueWithCGRect:CGRectMake(0, 0, image.size.width / 2, image.size.height / 2)];//é‡å¤æ¬¡æ•°ï¼ŒHUGE ä¸€ä¸ªå®å®šä¹‰ç­‰åŒäºMAXFLOATanimation.repeatCount = HUGE;//åŠ¨ç”»æ—¶é•¿animation.duration = 1.0;//ä»¥åŠ¨ç”»çš„å½¢å¼å›åˆ°åˆå§‹çŠ¶æ€animation.autoreverses = YES;//è®¡æ—¶æ–¹å¼animation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];//æ·»åŠ åŠ¨ç”»åˆ° layer[_layer addAnimation:animation forKey:@&quot;heartJump&quot;]; å…³é”®å¸§åŠ¨ç”»(CAKeyframeAnimation)â€‹ CAKeyframeAnimation åŒæ ·çš„ä¹Ÿæ˜¯ CAPropertyAnimation çš„å­ç±»ï¼ŒåŒæ ·çš„ä¹Ÿæ˜¯ä½œç”¨äºä¸€ä¸ªå•ä¸€çš„å±æ€§ã€‚ä½†æ˜¯å’Œ CABasicAnimation ä¸åŒçš„æ˜¯å®ƒä¸é™åˆ¶äºåœ¨ fromValue ã€ byValue å’Œ toValue ä¹‹é—´çš„å€¼åšåŠ¨ç”»ï¼Œè€Œæ˜¯å¯ä»¥æ ¹æ®ä¸€è¿ä¸²éšæ„çš„å€¼æ¥åšåŠ¨ç”»ã€‚ â€‹ CAKeyframeAnimation æœ‰ä¸€äº›å…³é”®çš„å±æ€§å¦‚ä¸‹ï¼š values: å…³é”®å¸§å€¼æ•°ç»„ï¼ŒåŠ¨ç”»ä¼šæ ¹æ®è¯¥æ•°ç»„çš„å†…å®¹æ•°å€¼ä½œå‡ºåŠ¨ç”»å˜æ¢ã€‚ path: å…³é”®å¸§è·¯å¾„ï¼ŒåŠ¨ç”»æ ¹æ®è¯¥è·¯å¾„ä½œå‡ºå˜åŒ–ï¼Œä¼˜å…ˆæƒå¤§äº values ï¼Œå½“åŒæ—¶è®¾ç½® values å’Œ path æ—¶ï¼Œä¼˜å…ˆä½œç”¨äº path ã€‚ keyTimes: æ¯ä¸€å¸§æ‰€å¯¹åº”çš„æ—¶é—´ï¼Œæ—¶é—´å¯ä»¥æ§åˆ¶åŠ¨ç”»çš„é€Ÿåº¦ï¼Œå€¼ä» 0.0-1.0 ï¼Œé»˜è®¤ä¸ºæ¯ä¸€å¸§æ—¶é—´ç›¸ç­‰ã€‚ timingFunctions: æ—¶é—´æ§åˆ¶æ•°ç»„ï¼Œå³æ¯ä¸€å¸§çš„åŠ¨ç”»é€Ÿåº¦æ§åˆ¶ï¼Œå…·ä½“æ•ˆæœåœ¨ CAAnimation ä¸­æœ‰æè¿°ã€‚ calculationMode: åŠ¨ç”»è®¡ç®—æ¨¡å¼ï¼Œè¯¥å±æ€§æ—¶ä¸€ä¸ª NSString ç±»å‹çš„ï¼Œå¯æ¥å—å¦‚ä¸‹å‡ ç§å¸¸é‡ï¼š 1234567891011121314//å…³é”®å¸§ä¸ºåº§æ ‡ç‚¹çš„æ—¶å€™,å…³é”®å¸§ä¹‹é—´ç›´æ¥ç›´çº¿ç›¸è¿è¿›è¡Œæ’å€¼è®¡ç®—kCAAnimationLinear//ç¦»æ•£çš„,ä¹Ÿå°±æ˜¯æ²¡æœ‰è¡¥é—´åŠ¨ç”»kCAAnimationDiscrete//å¹³å‡ï¼ŒkeyTimesè·ŸtimeFunctionså¤±æ•ˆkCAAnimationPaced//å¯¹å…³é”®å¸§ä¸ºåº§æ ‡ç‚¹çš„å…³é”®å¸§è¿›è¡Œåœ†æ»‘æ›²çº¿ç›¸è¿åæ’å€¼è®¡ç®—,å¯¹äºæ›²çº¿çš„å½¢çŠ¶è¿˜å¯ä»¥é€šè¿‡tensionValues,continuityValues,biasValuesæ¥è¿›è¡Œè°ƒæ•´è‡ªå®šä¹‰,keyTimesè·ŸtimeFunctionså¤±æ•ˆkCAAnimationCubic//åœ¨kCAAnimationCubicçš„åŸºç¡€ä¸Šä½¿å¾—åŠ¨ç”»è¿è¡Œå˜å¾—å‡åŒ€,å°±æ˜¯ç³»ç»Ÿæ—¶é—´å†…è¿åŠ¨çš„è·ç¦»ç›¸åŒ,keyTimesè·ŸtimeFunctionså¤±æ•ˆkCAAnimationCubicPaced tensionValues: NSNumber æ•°ç»„ï¼Œå®šä¹‰æ›²çº¿å¯†åº¦ã€‚ continuityValues: NSNumber æ•°ç»„ï¼Œå®šä¹‰æ›²çº¿æ‹è§’çš„é”åº¦ biasValues: åŠ¨ç”»çš„åæ–œç‡ rotationMode: åŠ¨ç”»æ²¿ path ç§»åŠ¨æ—¶æ—‹è½¬çš„æ–¹å¼ï¼Œé»˜è®¤ä¸º nil å°±æ˜¯ä¸åšä»»ä½•æ—‹è½¬ã€‚NSString ç±»å‹çš„å±æ€§ï¼Œæ¥å—å¦‚ä¸‹ä¸¤ç§å¸¸é‡ï¼š 1234//æ ¹æ®pathçš„åˆ‡é¢è‡ªåŠ¨æ—‹è½¬æ–¹å‘kCAAnimationRotateAuto//æ ¹æ®pathçš„åˆ‡é¢è‡ªåŠ¨ç¿»è½¬kCAAnimationRotateAutoReverse å¦‚ä¸‹ä½¿ç”¨åšä¸€ä¸ªåŠ¨ç”»è®©å…¶æ ¹æ®è®¾å®šçš„ç‚¹ç§»åŠ¨ã€‚ 123456789101112131415161718192021222324252627//é¦–å…ˆæ·»åŠ ä¸€ä¸ª layer åˆ°è§†å›¾_maliaoLayer = [CALayer layer];_maliaoLayer.frame = CGRectMake(0, 0, 65, 75);_maliaoLayer.position = CGPointMake(33, CGRectGetHeight(self.view.bounds) - 38);_maliaoLayer.contents = (__bridge id) [UIImage imageNamed:@&quot;maliao.png&quot;].CGImage;[self.view.layer addSublayer:_maliaoLayer];//æ·»åŠ åŠ¨ç”»- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event &#123; //åˆ›å»ºå…³é”®å¸§åŠ¨ç”» CAKeyframeAnimation *animation = [CAKeyframeAnimation animation]; //é’ˆå¯¹positionå€¼åšåŠ¨ç”» animation.keyPath = @&quot;position&quot;; //åŠ¨ç”»æ—¶é—´ animation.duration = 3.0; animation.values = @[[NSValue valueWithCGPoint:CGPointMake(0, 667)], [NSValue valueWithCGPoint:CGPointMake(10, 550)], [NSValue valueWithCGPoint:CGPointMake(40, 400)], [NSValue valueWithCGPoint:CGPointMake(100, 300)], [NSValue valueWithCGPoint:CGPointMake(200, 600)], [NSValue valueWithCGPoint:CGPointMake(300, 250)], [NSValue valueWithCGPoint:CGPointMake(350, 0)]]; //åŠ¨ç”»æ–¹å¼ animation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut]; //æ·»åŠ åŠ¨ç”»åˆ°å›¾å±‚ [_maliaoLayer addAnimation:animation forKey:nil];&#125; æ•ˆæœå¦‚ä¸‹ï¼š å½“ç„¶ä¸Šé¢çš„ä¾‹å­æ—¶é€šè¿‡ values æ¥åšåŠ¨ç”»çš„ï¼Œä½†æ˜¯åŒæ ·çš„æ•ˆæœä¹Ÿå¯ä»¥é€šè¿‡ path æ¥å®ç°ï¼Œåªéœ€è¦æŠŠ values æ›´æ”¹æˆ pathï¼Œå¦‚ä¸‹: 1234567_path = [[UIBezierPath alloc]init];[_path moveToPoint:CGPointMake(33, CGRectGetHeight(self.view.bounds))];[_path addCurveToPoint:CGPointMake(100, 10) controlPoint1:CGPointMake(100, 20) controlPoint2:CGPointMake(100, 50)];[_path addCurveToPoint:CGPointMake(200,20) controlPoint1:CGPointMake(100, 50) controlPoint2:CGPointMake(200, 50)];animation.path = _path.CGPath;[_maliaoLayer addAnimation:animation forKey:nil]; å¼¹æ€§åŠ¨ç”»(CASpringAnimation)â€‹ å¼¹æ€§åŠ¨ç”»æ˜¯åœ¨ iOS9 ä¹‹åæ–°åŠ å…¥çš„ï¼Œä¸»è¦å¯ä»¥é€šè¿‡è¿™ä¸ªç±»æ¥åšä¸€äº›å¸¦æœ‰å¼¹æ€§çš„åŠ¨ç”»ï¼Œè¯¥ç±»ç»§æ‰¿è‡ª CABasicAnimation ï¼Œé™¤äº† CABasicAnimation çš„å±æ€§å¤–ï¼Œæ–°å¢äº†å¦‚ä¸‹å±æ€§ï¼š mass: è´¨é‡ï¼Œå½±å“å›¾å±‚è¿åŠ¨æ—¶çš„å¼¹ç°§æƒ¯æ€§ï¼Œè´¨é‡è¶Šå¤§ï¼Œå¼¹ç°§æ‹‰ä¼¸å’Œå‹ç¼©çš„å¹…åº¦è¶Šå¤§ã€‚ stiffness: åˆšåº¦ç³»æ•°ï¼Œåˆšåº¦ç³»æ•°è¶Šå¤§ï¼Œå½¢å˜äº§ç”Ÿçš„åŠ›å°±è¶Šå¤§ï¼Œè¿åŠ¨è¶Šå¿« damping: é˜»å°¼ç³»æ•°ï¼Œé˜»æ­¢å¼¹ç°§ä¼¸ç¼©çš„ç³»æ•°ï¼Œé˜»å°¼ç³»æ•°è¶Šå¤§ï¼ŒåŠ¨ç”»åœæ­¢è¶Šå¿« initialVelocity: åˆå§‹é€Ÿç‡ï¼ŒåŠ¨ç”»è§†å›¾çš„åˆå§‹é€Ÿåº¦å¤§å°é€Ÿç‡ä¸ºæ­£æ•°æ—¶ï¼Œé€Ÿåº¦æ–¹å‘ä¸è¿åŠ¨æ–¹å‘ä¸€è‡´ï¼Œé€Ÿç‡ä¸ºè´Ÿæ•°æ—¶ï¼Œé€Ÿåº¦æ–¹å‘ä¸è¿åŠ¨æ–¹å‘ç›¸å settlingDuration: ç»“æŸæ—¶é—´ï¼Œè¿™æ˜¯ä¸€ä¸ªåªè¯»å±æ€§ï¼Œè¿”å›åŠ¨ç”»ç»“æŸçš„æ—¶é—´ï¼Œè¯¥æ—¶é—´æ˜¯æ ¹æ®å½“å‰åŠ¨ç”»çš„å„ä¸ªå‚æ•°è®¡ç®—çš„ã€‚ ä¸‹é¢é€šè¿‡ä¸€ä¸ª Demo æ¥æ„Ÿå—ä¸‹è¿™ä¸ªå¼¹æ€§åŠ¨ç”»ğŸ˜„ 12345678910CASpringAnimation *animation = [CASpringAnimation animation];animation.keyPath = @&quot;position.x&quot;;animation.fromValue = (id)@(_imageView.layer.position.x);animation.toValue = (id)@(_imageView.layer.position.x + 100);animation.mass = 1;animation.stiffness = 100;animation.damping = 1;animation.initialVelocity = 0;animation.duration = animation.settlingDuration;[_imageView.layer addAnimation:animation forKey:nil]; åŠ¨ç”»ç»„(CAAnimationGroup)â€‹ åŠ¨ç”»ç»„ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯ä¸€ç»„åŠ¨ç”»åŒæ—¶è¿›è¡Œã€‚CAAnimationGroup ç»§æ‰¿äº CAAnimation ï¼Œæœ‰ä¸€ä¸ª Animations çš„å±æ€§ï¼Œå°±æ˜¯æŠŠå¤šä¸ª Animation æˆ–è€…å…¶å­ç±»è£…å…¥æ•°ç»„ä¸­æ·»åŠ åˆ°åŠ¨ç”»ç»„ä¸­ä¸€èµ·æ‰§è¡Œã€‚ç”¨æ³•å¦‚ä¸‹ï¼š 1234567891011121314151617181920CASpringAnimation *animation = [CASpringAnimation animation];animation.keyPath = @&quot;position.x&quot;;animation.fromValue = (id)@(_imageView.layer.position.x);animation.toValue = (id)@(_imageView.layer.position.x + 100);animation.mass = 1;animation.stiffness = 100;animation.damping = 1;animation.initialVelocity = 0;animation.duration = animation.settlingDuration;CABasicAnimation *scalAnimation = [CABasicAnimation animation];scalAnimation.keyPath = @&quot;bounds.size&quot;;scalAnimation.fromValue = [NSValue valueWithCGSize:_imageView.layer.bounds.size];scalAnimation.toValue = [NSValue valueWithCGSize:CGSizeMake(_imageView.layer.bounds.size.width * 3, _imageView.layer.bounds.size.height *3)];scalAnimation.duration = 3;CAAnimationGroup *animationGroup = [CAAnimationGroup animation];animationGroup.animations = @[animation,scalAnimation];animationGroup.duration = 6;[_imageView.layer addAnimation:animationGroup forKey:nil]; è½¬åœºè¿‡æ¸¡åŠ¨ç”»(CATrsantion)â€‹ CATrasition ç»§æ‰¿è‡ª CAAnimation ï¼ŒCATrasntion é€šè¿‡ type å±æ€§æä¾›äº† 4 ç§è¿‡æ¸¡åŠ¨ç”»ï¼Œæ˜¯ä¸€ä¸ª NSString ç±»å‹çš„å±æ€§ï¼Œå¯ä»¥æ¥å—ä¸‹é¢å››ç§å¸¸é‡ï¼š 12345678//æ·¡å…¥æ·¡å‡ºkCATransitionFade//ç§»è¿›kCATransitionMoveIn //æ¨åŠ¨è¿›å»kCATransitionPush //æ­å¼€kCATransitionReveal å…¶å®é™¤äº†ä¸Šé¢è¿™ 4 ç§è¿‡æ¸¡åŠ¨ç”»è¿˜æœ‰ä¸€äº›ç§æœ‰çš„ã€‚è¿™å››ç§å‡ºäº†ç¬¬ä¸€ç§æ˜¯å›ºå®šçš„ä»¥ä¸ºï¼Œåé¢ä¸‰ç§éƒ½æ˜¯æœ‰ä¸€ä¸ªæ–¹å‘çš„ï¼Œæ–¹å‘çš„æ›´æ”¹å¯ä»¥é€šè¿‡ subtype å±æ€§æ¥æ›´æ”¹æ–¹å‘ï¼Œè¯¥å±æ€§ä¹Ÿæ˜¯ä¸€ä¸ª NSString ç±»å‹çš„ï¼Œæœ‰å¦‚ä¸‹å››ç§å¸¸é‡ï¼š 1234kCATransitionFromRight kCATransitionFromLeft kCATransitionFromTop kCATransitionFromBottom å¹³å¸¸åŸºæœ¬ä¸Šéœ€è¦ç”¨åˆ°çš„åŠ¨ç”»éƒ½åœ¨è¿™é‡Œäº†ï¼ŒåŸºæœ¬ä¸Šéƒ½å¯ä»¥é€šè¿‡è¿™é‡Œè®²åˆ°çš„åŠ¨ç”»æ–¹å¼æ¥ç»„åˆå‡ºæ¥çš„ã€‚","categories":[],"tags":[{"name":"åŠ¨ç”»","slug":"åŠ¨ç”»","permalink":"Aaronzjp.cn/tags/åŠ¨ç”»/"},{"name":"Animation","slug":"Animation","permalink":"Aaronzjp.cn/tags/Animation/"}]},{"title":"Swift-é›†åˆç±»å‹","slug":"Swift-CollectionTypes","date":"2017-03-05T07:10:35.000Z","updated":"2017-08-01T07:55:09.000Z","comments":true,"path":"2017/03/05/Swift-CollectionTypes/","link":"","permalink":"Aaronzjp.cn/2017/03/05/Swift-CollectionTypes/","excerpt":"é›†åˆç±»å‹åœ¨ Swift ä¸­é›†åˆç±»å‹ä¸»è¦æœ‰ Arrayã€Setsã€Dictionariesã€‚å’Œ O-bjc ä¸­ä¸åŒçš„æ˜¯ Swift ä¸­é›†åˆçš„å¯å˜ç±»å‹å’Œä¸å¯å˜ç±»å‹å¹¶ä¸æ˜¯å­ç±»å’Œçˆ¶ç±»çš„å…³ç³»ï¼Œè€Œæ˜¯åŒä¸€ä¸ªç±»ã€‚å¯å˜å’Œä¸å¯å˜æ˜¯é€šè¿‡å˜é‡ç±»å‹æ¥åŒºåˆ†çš„ï¼Œå¦‚æœä½¿ç”¨ var æ¥å£°æ˜æˆå˜é‡é‚£ä¹ˆå°±æ˜¯å¯å˜çš„ï¼Œå¦‚æœä½¿ç”¨ let æ¥å£°æ˜æˆå¸¸é‡é‚£ä¹ˆå°±æ˜¯ä¸å¯å˜çš„ã€‚","text":"é›†åˆç±»å‹åœ¨ Swift ä¸­é›†åˆç±»å‹ä¸»è¦æœ‰ Arrayã€Setsã€Dictionariesã€‚å’Œ O-bjc ä¸­ä¸åŒçš„æ˜¯ Swift ä¸­é›†åˆçš„å¯å˜ç±»å‹å’Œä¸å¯å˜ç±»å‹å¹¶ä¸æ˜¯å­ç±»å’Œçˆ¶ç±»çš„å…³ç³»ï¼Œè€Œæ˜¯åŒä¸€ä¸ªç±»ã€‚å¯å˜å’Œä¸å¯å˜æ˜¯é€šè¿‡å˜é‡ç±»å‹æ¥åŒºåˆ†çš„ï¼Œå¦‚æœä½¿ç”¨ var æ¥å£°æ˜æˆå˜é‡é‚£ä¹ˆå°±æ˜¯å¯å˜çš„ï¼Œå¦‚æœä½¿ç”¨ let æ¥å£°æ˜æˆå¸¸é‡é‚£ä¹ˆå°±æ˜¯ä¸å¯å˜çš„ã€‚ æ•°ç»„çš„ç®€å•ä½¿ç”¨1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768//åˆ›å»ºä¸€ä¸ªç©ºçš„æ•°ç»„//å¯å˜var someInts = [Int]()//ä¸å¯å˜let someDoubels = [Double]()//å­—é¢é‡åˆ›å»ºæ•°ç»„let ints = [1,2,3,4,5]var shoppingList: [String] = [\"Eggs\",\"Milk\",\"Tomato\"]//åˆ›å»ºå¸¦æœ‰é»˜è®¤å€¼çš„æ•°ç»„var defualtArray = Array(repeating: 6, count: 3)//æ•°ç»„ä¹Ÿå¯ä»¥ä½¿ç”¨ + è¿ç®—ç¬¦æ¥æ‹¼æ¥let sumArray = ints + defualtArray//è·å–æ•°ç»„å…ƒç´ ä¸ªæ•°let arrayCount = sumArray.count//åˆ¤æ–­æ•°ç»„æ˜¯å¦ä¸ºç©º//é€šè¿‡ isEmpty å±æ€§åˆ¤æ–­if sumArray.isEmpty &#123; print(\"sumArray is empty array\");&#125; else &#123; print(\"sumArray is not empty array\");&#125;//é€šè¿‡æ£€æŸ¥æ•°ç»„å…ƒç´ ä¸ªæ•°æ˜¯å¦ä¸º0æ¥åˆ¤æ–­æ•°ç»„æ˜¯å¦ä¸ºç©ºif sumArray.count == 0 &#123; print(\"sumArray is empty array\");&#125; else &#123; print(\"sumArray is not empty array\");&#125;/* æ•°ç»„æ‹¼æ¥æ·»ï¼åŠ æ•°æ®*/shoppingList.append(\"Water\")shoppingList += [\"Cheese\",\"Butter\"]//æ•°ç»„å…ƒç´ çš„è·å–let water = shoppingList[3]//ä½¿ç”¨æ•°ç»„ä¸‹æ ‡ä¿®æ”¹æ•°ç»„ä¸­çš„å…ƒç´ shoppingList[3] = \"Bananas\"//ä½¿ç”¨ä¸‹æ ‡åŒºé—´ä¸€æ¬¡ä¿®æ”¹å¤šä¸ªå€¼shoppingList[0...3] = [\"iPhone\",\"iMac\",\"iPod\"]//åœ¨æ•°ç»„çš„åˆ¶å®šä¸‹æ ‡ç´¢å¼•ä½ç½®æ’å…¥å…ƒç´ shoppingList.insert(\"Apple\", at: 0)//åœ¨æ•°ç»„çš„æŒ‡å®šä¸‹æ ‡ç´¢å¼•ä½ç½®æ’å…¥ä¸€ä¸ªæ•°ç»„shoppingList.insert(contentsOf: [\"MicroSoft\",\"Google\"], at: 0)//åœ¨æ•°ç»„ä¸­ç§»é™¤æŸä¸ªæŒ‡å®šä¸‹æ ‡ä½ç½®çš„æ•°ç»„å…ƒç´ shoppingList.remove(at: 0)shoppingList.removeLast()shoppingList.removeSubrange(0...1)//æ›¿æ¢æ•°ç»„ä¸­æŒ‡å®šèŒƒå›´çš„å…ƒç´ shoppingList.replaceSubrange(0...1, with: [\"MacBook Pro\",\"MacBook Air\"])//æ•°ç»„çš„éå†for item in shoppingList &#123; print(item)&#125;/* ä½¿ç”¨ enumerated() æ–¹æ³•åŒæ—¶éå†æ•°ç»„ç´¢å¼•ï¼Œå’Œæ•°ç»„å…ƒç´ */for (index, value) in shoppingList.enumerated() &#123; print(\"ç¬¬\\(index + 1)ä¸ªå…ƒç´ æ˜¯\\(value)\")&#125; é›†åˆçš„ç®€å•ä½¿ç”¨123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990//åˆå§‹åŒ–ä¸€ä¸ªç©ºçš„é›†åˆï¼Œå¿…é¡»æ˜¾ç¤ºçš„å£°æ˜é›†åˆçš„ç±»å‹var letters = Set&lt;Int&gt;()//ç¡®å®šé›†åˆçš„ç±»å‹åå¯ä»¥ä½¿ç”¨æ•°ç»„å­—é¢é‡èµ‹å€¼letters = []//ä½¿ç”¨æ•°ç»„å­—é¢é‡åˆ›å»ºé›†åˆvar set:Set&lt;Int&gt; = [1,2,3,3,4]var set2:Set = [2,23,5,6,89,]//åˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©ºvar foods:Set = [\"Apple\",\"Milk\",\"Beef\"]if foods.isEmpty &#123; print(\"this sets is empty\")&#125; else &#123; print(\"this sets is not empty\")&#125;//ä¹Ÿå¯ä»¥åƒæ•°ç»„ä¸€æ ·ä½¿ç”¨å…ƒç´ ä¸ªæ•°æ¥æ£€æŸ¥æ˜¯å¦ä¸ºç©ºif foods.count == 0 &#123; print(\"this sets is empty\")&#125; else &#123; print(\"this sets is not empty\")&#125;//è·å–é›†åˆçš„å…ƒç´ ä¸ªæ•°foods.count//åƒé›†åˆæ·»åŠ æ–°çš„å…ƒç´ foods.insert(\"Peach\")foods.insert(\"Tomato\")foods.insert(\"Bread\")//ç§»é™¤é›†åˆå…ƒç´ foods.remove(at: foods.index(of: \"Apple\")!)foods.remove(\"Peach\")foods.removeFirst()//æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ çš„æ£€æŸ¥if foods.contains(\"Milk\") &#123; print(\"foods hava Milk\")&#125;//éå†é›†åˆfor food in foods &#123; print(food)&#125;//ä½¿ç”¨ sorted() æ–¹æ³•æœ‰åºçš„éå†é›†åˆfor food in foods.sorted() &#123; print(food)&#125;//æ—¢ç„¶æ˜¯é›†åˆå°±æœ‰äº¤é›†ï¼Œç›¸äº¤ç­‰let numbers: Set = [1,2,3,4,5,6,7,8,9]let newNumbers: Set = [2,3,4,5,10,11,12,13]//ç›¸äº¤ç­‰é›†åˆå…ƒç´ ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆlet interNumbers = numbers.intersection(newNumbers)//ä¸ç›¸äº¤çš„é›†åˆå…ƒç´ ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆlet symmerricNumbers = numbers.symmetricDifference(newNumbers)//å°†ä¸¤ä¸ªé›†åˆèåˆåœ¨ä¸€èµ·ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆlet unionNumbers = numbers.union(newNumbers)//ä¸åŒ…å«å¦ä¸€ä¸ªé›†åˆçš„å…ƒç´ ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆlet notSubNumbers = numbers.subtracting(newNumbers)//é›†åˆå…³ç³»çš„åˆ¤æ–­//åˆ¤æ–­é›†åˆæ˜¯å¦ç›¸ç­‰if numbers == newNumbers &#123; print(\"numbers == newNumbers\")&#125; else &#123; print(\"numbers != newNumbers\")&#125;//åˆ¤æ–­é›†åˆaæ˜¯æ˜¯é›†åˆbçš„å­é›†let a: Set = [2,3,4]let b: Set = [2,3,4,5,1]if a.isSubset(of: b) &#123; print(\"a is subSet of b\")&#125;//åˆ¤æ–­ä¸€ä¸ªé›†åˆbæ˜¯å¦åŒ…å«é›†åˆaçš„æ‰€æœ‰å…ƒç´ if b.isSuperset(of: a) &#123; print(\"b is superSet of a\")&#125;//åˆ¤æ–­ä¸¤ä¸ªé›†åˆæ˜¯å¦ä¸å«æœ‰ç›¸åŒçš„å€¼if b.isDisjoint(with: a) &#123; print(\"YES\")&#125; else &#123; print(\"NO\")&#125; å­—å…¸çš„ç®€å•ä½¿ç”¨123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960//åˆ›å»ºä¸€ä¸ªç©ºå­—å…¸var emptyDictionary = [Int: String]()emptyDictionary[16] = \"Aaron\"//ä½¿ç”¨å­—é¢é‡åˆ›å»ºå­—å…¸//å¸¸é‡ï¼Œä¸å¯å˜å­—å…¸let newDictionary = [1:\"Aaron\",2:\"Jay\",3:\"Edison\",4:\"Jack\"]//å˜é‡ï¼Œå¯å˜å­—å…¸var muatableDictionary: [String: String] = [\"è‰¾ä¼¦\":\"Aaron\",\"çˆ±è¿ªç”Ÿ\":\"Edison\",\"æ°\":\"Jay\",\"æ°å…‹\":\"Jack\"]//è®¿é—®å’Œä¿®æ”¹å­—å…¸//é€šè¿‡é”®å€¼è·å–let name = muatableDictionary[\"è‰¾ä¼¦\"]//é€šè¿‡é”®å€¼ä¿®æ”¹muatableDictionary[\"è‰¾ä¼¦\"] = \"Alan\"//ä¿®æ”¹å’Œæ·»åŠ å…ƒç´ muatableDictionary.updateValue(\"è‰¾ä¼¦\", forKey: \"è‰¾ä¼¦\")print(muatableDictionary)muatableDictionary.updateValue(\"Alan\", forKey: \"è‰¾ä¼¦\")print(muatableDictionary)//åˆ é™¤å…ƒç´ //é€šè¿‡keyåˆ é™¤å…ƒç´ muatableDictionary.removeValue(forKey: \"è‰¾ä¼¦\")//é€šè¿‡ç´¢å¼•åˆ é™¤muatableDictionary.remove(at: muatableDictionary.index(forKey: \"æ°å…‹\")!)//é€šè¿‡ç½®nilåˆ é™¤å…ƒç´ muatableDictionary[\"çˆ±è¿ªç”Ÿ\"] = nilprint(muatableDictionary)//å­—å…¸çš„éå†//é€šè¿‡å…ƒç»„éå†å­—å…¸for (numberOfName, englishName) in newDictionary &#123; print(\"ç¬¬\\(numberOfName)ä¸ªåå­—æ˜¯\\(englishName)\")&#125;//è¿™æ ·éå†å‡ºæ¥çš„åº”è¯¥ä¹Ÿæ˜¯å…ƒç»„for keysAndValues in newDictionary &#123; print(keysAndValues)&#125;//éå†å­—å…¸æ‰€æœ‰çš„keyfor numberOfName in newDictionary.keys &#123; print(numberOfName)&#125;//éå†å­—å…¸æ‰€æœ‰çš„å€¼for name in newDictionary.values &#123; print(name)&#125;","categories":[],"tags":[{"name":"Swift","slug":"Swift","permalink":"Aaronzjp.cn/tags/Swift/"}]},{"title":"swift-å‡½æ•°","slug":"Swift 3.0-Function","date":"2016-12-01T06:11:37.000Z","updated":"2017-08-01T07:52:36.000Z","comments":true,"path":"2016/12/01/Swift 3.0-Function/","link":"","permalink":"Aaronzjp.cn/2016/12/01/Swift 3.0-Function/","excerpt":"","text":"å‡½æ•°çš„å£°æ˜å’Œè°ƒç”¨åœ¨swiftä¸­å‡½æ•°æ˜¯ä¸€ä¸ªéå¸¸çµæ´»çš„ä¸œè¥¿ï¼Œå¯ä»¥å®šä¹‰ä»»ä½•çš„ç±»å‹æ¥ä½œä¸ºå‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ï¼Œä¸€ä¸ªæ¯”è¾ƒå®Œæ•´çš„å‡½æ•°å£°æ˜åŒ…æ‹¬å¾ˆå¤šéƒ¨åˆ†ï¼Œä¸‹é¢å°±æ˜¯ä¸€ä¸ªç®€å•çš„å‡½æ•°å£°æ˜ï¼š 1234567func sum(numbers: [Int]) -&gt; Int &#123; var sum = 0 for number in numbers &#123; sum += number &#125; return sum&#125; è¯¥å‡½æ•°çš„å‡½æ•°åä¸ºsum(numbers:)ï¼Œæœ‰ä¸€ä¸ªå«numbersçš„Intç±»å‹çš„æ•°ç»„å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªIntç±»å‹çš„å€¼ã€‚è¿™åº”è¯¥å°±æ˜¯ä¸€ä¸ªæ¯”è¾ƒå®Œæ•´çš„å‡½æ•°çš„å£°æ˜ã€‚åœ¨swiftä¸­å£°æ˜ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™å°½é‡åšåˆ°å‡½æ•°åç®€æ´æ¸…æ¥šï¼Œä»¥è¾¾åˆ°è¯¥å‡½æ•°ä½¿ç”¨è€…åœ¨çœ‹åˆ°è¿™ä¸ªå‡½æ•°çš„æ—¶å€™å°±èƒ½å¤§è‡´ç†è§£å‡½æ•°çš„ç”¨æ„ã€‚è°ƒç”¨ä¸‹ä¸Šé¢çš„å‡½æ•°çœ‹ä¸‹ç»“æœä¼šæ˜¯ä»€ä¹ˆæ ·ï¼š 123let numbers = [1,2,3,4,5,6,7,8,9]let sumNumber = sum(numbers: numbers)//è¾“å‡ºç»“æœï¼š45 ä¸Šé¢è¿™ä¸ªå‡½æ•°ä¼ å…¥çš„æ˜¯ä¸€ä¸ªIntç±»å‹çš„æ•°ç»„æ¥è®¡ç®—æ•°ç»„ä¸­å…ƒç´ çš„å’Œï¼Œé€šè¿‡è°ƒç”¨å‡½æ•°è¯æ˜è¯¥å‡½æ•°æ­£ç¡®çš„è¾“å‡ºäº†æ•°ç»„ä¸­å…ƒç´ çš„å’Œã€‚ å¯å˜å‡½æ•°å‚æ•°ä¹Ÿå¯ä»¥å°†ä¸Šé¢çš„å‡½æ•°æ”¹æˆå¦‚ä¸‹å‡½æ•°æ¥æ±‚å„ä¸ªæ•°çš„å’Œï¼Œè¯¥å‡½æ•°çœ‹èµ·æ¥å¯èƒ½å’Œä¸Šé¢çš„å‡½æ•°çœ‹èµ·æ¥åŸºæœ¬ä¸Šæ²¡æœ‰å·®åˆ«ï¼Œä½†æ˜¯ä»”ç»†çœ‹å¯ä»¥çœ‹åˆ°å‡½æ•°å‚æ•°å˜äº†ï¼Œè¯¥å‡½æ•°æ¥æ”¶Intç±»å‹çš„å‚æ•°ä¸”å‚æ•°ä¸ªæ•°æ˜¯å¯å˜çš„ï¼Œåœ¨å‡½æ•°ä½“å†…éƒ¨å¯å˜å‡½æ•°çš„å‚æ•°è¢«è½¬æ¢ä¸ºå‚æ•°åŒç±»å‹çš„æ•°ç»„ï¼Œå‡½æ•°ä½“å†…éƒ¨å…¶å®å’Œä¸Šé¢çš„é‚£ä¸ªå‡½æ•°æ²¡æœ‰å·®åˆ«ï¼Œéƒ½æ˜¯å¯¹æ•°ç»„è¿›è¡Œå¤„ç†æ±‚å’Œã€‚å¦‚æœæ„¿æ„è¿™é‡Œå¯ä»¥ä¼ å…¥å¤§é‡çš„å‚æ•°ã€‚ 12345678910func sum(numbers: Int...) -&gt; Int &#123; var sum = 0 for number in numbers &#123; sum += number &#125; return sum&#125;let sumNumber = sum(numbers: 1,2,3,4,5,6,7,8,9)//è¾“å‡ºç»“æœï¼š45 éœ€è¦æ³¨æ„çš„æ˜¯ä¸€ä¸ªå‡½æ•°æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªå¯å˜å‚ã€‚ å¤šå‚æ•°å‡½æ•°å‡½æ•°ä¹Ÿå¯ä»¥æ¥å—å¤šä¸ªå‚æ•°çš„è¾“å…¥ï¼Œå¤šä¸ªå‚æ•°ç”¨é€—å·éš”å¼€å³å¯ã€‚ä¸‹é¢è¿™ä¸ªå‡½æ•°è¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå‘Šè¯‰ä½ è°å’Œè°æ˜¯å¥½æœ‹å‹ï¼š 123456func whoIsFriend(person1: String, person2: String) -&gt; String &#123; return person1+\"å’Œ\"+person2+\"æ˜¯å¥½æœ‹å‹ï¼\"&#125;let friend = whoIsFriend(person1: \"Aaron\", person2: \"Edison\")//è¾“å‡ºç»“æœï¼šAaronå’ŒEdisonæ˜¯å¥½æœ‹å‹ï¼ æ— å‚æ•°å’Œæ— è¿”å›å€¼å‡½æ•°å‡½æ•°å¯ä»¥æ˜¯æ²¡æœ‰å‚æ•°çš„ï¼Œæ¯”å¦‚ä¸‹é¢çš„è¿™ä¸ªå‚æ•°åœ¨è°ƒç”¨çš„æ—¶å€™å®ƒä¼šè¿”å›ä¸€ä¸ªå›ºå®šçš„å€¼ï¼š 123456func printHello() -&gt; String &#123; return \"Hello!\"&#125;let hello = printHello()//è¾“å‡ºç»“æœï¼šHelloï¼ å‡½æ•°å¯ä»¥æ²¡æœ‰å‚æ•°ä¹Ÿå¯ä»¥æ²¡æœ‰è¿”å›å€¼ï¼Œä¸‹é¢çš„å‡½æ•°å°±æ˜¯ä¸€ä¸ªæ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°ï¼Œå½“å‡½æ•°è°ƒç”¨çš„æ—¶å€™ä¼šç›´æ¥æ‰§è¡Œå‡½æ•°ä½“ä¸­çš„ä»£ç ï¼Œä¸ä¼šè¿”å›ä»»ä½•å€¼ï¼š 123456func printHello() &#123; print(\"Hello!\")&#125;printHello()//è¾“å‡ºç»“æœï¼šHelloï¼ å¤šè¿”å›å€¼å‡½æ•°å½“å‡½æ•°éœ€è¦è¿”å›å¤šä¸ªå€¼çš„æ—¶å€™å¯ä»¥ä½¿ç”¨å…ƒç»„æ¥åŒ…è£¹éœ€è¦è¿”å›çš„å€¼ä»¥è¾¾åˆ°è¿”å›å¤šä¸ªå€¼çš„ç›®çš„ï¼Œä¸‹é¢çš„è¿™ä¸ªå‡½æ•°é€šè¿‡å…ƒç»„è¿”å›æ•°ç»„ä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼š 123456789101112131415161718func minMax(array: [Int]) -&gt; (min: Int, max: Int) &#123; var currentMin = array[0] var currentMax = array[0] for value in array[1..&lt;array.count] &#123; if value &lt; currentMin &#123; currentMin = value &#125; else if value &gt; currentMax &#123; currentMax = value &#125; &#125; return (currentMin, currentMax)&#125;let numbers = [2,5,3,6,7,10]let bounds = minMax(array: numbers)print(bounds.min,bounds.max)//è¾“å‡ºç»“æœï¼š2 10 è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªåŒ…å«äº†ä¸¤ä¸ªIntå…ƒç´ çš„å…ƒç»„ï¼Œå…ƒç´ è¢«æ ‡è®°ä¸ºminå’Œmaxï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…ƒç»„ä¸­çš„å…ƒç´ åç”¨ç‚¹è¯­æ³•æ¥å–å‡ºå…ƒç»„ä¸­çš„å€¼ã€‚ å¯é€‰å¤šè¿”å›å€¼å‡½æ•°å‡½æ•°å¯ä»¥é€šè¿‡å…ƒç»„è¿”å›å¤šä¸ªå€¼ï¼Œè¿™äº›å€¼ä¹Ÿå¯ä»¥æ˜¯å¯é€‰ç±»å‹çš„ã€‚ä½†æ˜¯è¦æ³¨æ„çš„æ˜¯å…ƒç»„å¯ä»¥åŒºåˆ†ä¸ºå…ƒç´ å¯é€‰å…ƒç»„(Int,String?)å’Œå…ƒç»„å¯é€‰å…ƒç»„(Int,String)?ã€‚ä¸Šé¢çš„è¿™ä¸ªå‡½æ•°ï¼Œå…¶å®å¹¶ä¸æ˜¯å¾ˆå®‰å…¨ï¼Œå¦‚æœç»™è¯¥å‡½æ•°ä¼ å…¥ä¸€ä¸ªç©ºæ•°ç»„å°±ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼Œä¸ºäº†å®‰å…¨èµ·è§æˆ‘ä»¬å¯ä»¥æ”¹æˆä¸‹é¢è¿™æ ·ï¼Œå½“ä¼ å…¥çš„æ•°ç»„ä¸ºç©ºæ—¶æˆ‘ä»¬è¿”å›nilï¼š 1234567891011121314151617181920func minMax(array: [Int]) -&gt; (min: Int, max: Int)? &#123; if array.isEmpty &#123;return nil&#125; var currentMin = array[0] var currentMax = array[0] for value in array[1..&lt;array.count] &#123; if value &lt; currentMin &#123; currentMin = value &#125; else if value &gt; currentMax &#123; currentMax = value &#125; &#125; return (currentMin, currentMax)&#125;let numbers = [Int]()//ç”¨å¯é€‰ç»‘å®šæ¥æ£€æŸ¥è¿”å›å€¼if let bounds = minMax(array: numbers) &#123; print(bounds.min,bounds.max)&#125;//æ­¤å¤„æ²¡æœ‰ä»»ä½•è¾“å‡ºç»“æœï¼Œå› ä¸ºè¿”å›å€¼ä¸ºnil å‡½æ•°å‚æ•°æ ‡ç­¾å’Œå‚æ•°åç§°åœ¨swiftçš„å‡½æ•°ä¸­æ¯ä¸ªå‡½æ•°çš„å‚æ•°éƒ½æœ‰ä¸€ä¸ªå‚æ•°æ ‡ç­¾å’Œå‚æ•°åç§°ã€‚å‚æ•°æ ‡ç­¾åœ¨è°ƒç”¨å‚æ•°çš„æ—¶å€™ä½¿ç”¨ï¼Œå‚æ•°åç§°åˆ™åœ¨å‡½æ•°çš„å®ç°ä¸­ä½¿ç”¨ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹å‚æ•°æ ‡ç­¾å°±æ˜¯å‚æ•°åç§°ã€‚ä½†æ˜¯åœ¨æŸäº›æ—¶å€™å¯èƒ½éœ€è¦æ›´å¥½çš„ä¸ºå‡½æ•°è°ƒç”¨è€…è¯´æ˜å‚æ•°çš„ç”¨æ„ï¼Œå¯èƒ½ä¼šå¦å¤–çš„ä¸ºå‚æ•°å–ä¸€ä¸ªæ˜“æ‡‚çš„å‚æ•°æ ‡ç­¾ï¼Œä»¥ä¾¿å‡½æ•°è°ƒç”¨çš„æ—¶å€™ä½¿ç”¨ã€‚å¦‚ä¸‹ä¸ºå‡½æ•°å‚æ•°æŒ‡å®šæ ‡ç­¾ï¼š 123456789let sumNumber = sum(numbers: 1,2,3,4,5,6,7,8,9)func whoIsFriend(person: String, with person1: String) -&gt; String &#123; return person+\"å’Œ\"+person1+\"æ˜¯å¥½æœ‹å‹ï¼\"&#125;let friend = whoIsFriend(person: \"Aaron\", with: \"Edison\")print(friend)//è¾“å‡ºç»“æœï¼šAaronå’ŒEdisonæ˜¯å¥½æœ‹å‹ï¼ ä¸Šé¢çš„è¿™ä¸ªå‡½æ•°ä¸ºå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°åŠ å…¥äº†ä¸€ä¸ªwithçš„å‚æ•°æ ‡ç­¾ï¼Œè¿™æ ·å‡½æ•°åœ¨è°ƒç”¨çš„æ—¶å€™å°±æ˜¾å¾—å¯è¯»æ€§æ›´é«˜ï¼Œæ¯”ä¹‹å‰æ²¡æœ‰å‡½æ•°æ ‡ç­¾æ—¶å¯è¯»æ€§æ›´é«˜ï¼Œæ›´è§„èŒƒã€‚å‡½æ•°ä¸­å‚æ•°åç§°å¿…é¡»æ˜¯ä¸ä¸€æ ·çš„ï¼Œä½†æ˜¯å‚æ•°æ ‡ç­¾æ˜¯å¯ä»¥ç›¸é€šçš„ã€‚ å¿½ç•¥å‚æ•°æ ‡ç­¾å½“ç„¶å‚æ•°æ ‡ç­¾ä¹Ÿæ˜¯å¯ä»¥å¿½ç•¥çš„ï¼Œå¿½ç•¥å‚æ•°æ ‡ç­¾ä½¿ç”¨_æ¥å ä½ä»£æ›¿å‚æ•°æ ‡ç­¾ï¼š 1234567func whoIsFriend(_ person: String, _ person1: String) -&gt; String &#123; return person+\"å’Œ\"+person1+\"æ˜¯å¥½æœ‹å‹ï¼\"&#125;let friend = whoIsFriend(\"Aaron\", \"Edison\")print(friend)//è¾“å‡ºç»“æœï¼šAaronå’ŒEdisonæ˜¯å¥½æœ‹å‹ï¼ å‡½æ•°é»˜è®¤å‚æ•°å€¼å‡½æ•°ä¸­è¿˜å¯ä»¥ä¸ºå‚æ•°èµ‹äºˆé»˜è®¤å€¼ï¼Œå½“é»˜è®¤å€¼è¢«è®¾ç½®ååœ¨è°ƒç”¨å‡½æ•°çš„æ—¶å€™å¯ä»¥å¿½ç•¥è¿™ä¸ªå‚æ•°ï¼š 123456789func sumNumber(number1: Int, number2: Int = 10) -&gt; Int &#123; return number1 + number2&#125;let sum = sumNumber(number1: 1)let sum2 = sumNumber(number1: 1, number2: 15)print(\"sum = \\(sum),sum2 = \\(sum2)\")//è¾“å‡ºç»“æœï¼šsum = 11,sum2 = 16 å¾ˆæ˜æ˜¾sumåœ¨è°ƒç”¨å‡½æ•°çš„æ—¶å€™å¿½ç•¥äº†ç¬¬äºŒä¸ªé»˜è®¤ä¸º 10 çš„å‚æ•°ï¼Œæ‰€ä»¥ä½¿ç”¨é»˜è®¤çš„å€¼æ¥è®¡ç®—è¿”å› 11ï¼Œsum2åœ¨è°ƒç”¨å‡½æ•°çš„æ—¶å€™ä¼ å…¥äº†ç¬¬äºŒä¸ªå‚æ•°ä¸º 15 æ¥æ›¿ä»£äº†é»˜è®¤å€¼ 10 æ‰€ä»¥è¿”å›ä¸º16ã€‚ è¾“å…¥è¾“å‡ºå‚æ•°è¾“å…¥è¾“å‡ºå‚æ•°æ˜¯æŒ‡ç»™å‡½æ•°ä¼ å…¥çš„å‚æ•°æ˜¯å¯ä»¥åœ¨å‡½æ•°å†…éƒ¨è¢«ä¿®æ”¹çš„ï¼Œè®¾ç½®è¾“å…¥è¾“å‡ºå‚æ•°è¦åœ¨å‡½æ•°å‚æ•°çš„ç±»å‹å‰åŠ ä¸Šinoutå…³é”®å­—ï¼Œè¿™æ ·è¢«æ ‡è®°çš„å‡½æ•°å‚æ•°æ‰æ˜¯å¯ä»¥è¢«ä¿®æ”¹çš„ã€‚è°ƒç”¨å‡½æ•°çš„æ—¶å€™ä¼ å…¥è¾“å…¥è¾“å‡ºå‚æ•°çš„å€¼å¿…é¡»æ˜¯å˜é‡ï¼Œä¸èƒ½æ˜¯å¸¸é‡æˆ–æ˜¯å­—é¢é‡ï¼Œå› ä¸ºåªæœ‰å˜é‡å¯ä»¥è¢«ä¿®æ”¹ï¼Œå¯å˜å‚æ•°ä¸èƒ½è®¾å®šä¸ºè¾“å…¥è¾“å‡ºå‚æ•°ã€‚ä¸”è¾“å…¥è¾“å‡ºå‚æ•°ä¸èƒ½è®¾ç½®é»˜è®¤å€¼ã€‚ 12345678910111213func swapNumber( a: inout Int, b: inout Int) &#123; let temp = a a = b b = temp&#125;var a = 10,b = 20print(\"äº¤æ¢å‰ a = \\(a),b = \\(b) \")swap(&amp;a, &amp;b)print(\"äº¤æ¢å a = \\(a),b = \\(b)\")//è¾“å‡ºç»“æœï¼šäº¤æ¢å‰ a = 10,b = 20 äº¤æ¢å a = 20,b = 10 è¯¥å‡½æ•°æ˜¯äº¤æ¢ä¸¤ä¸ªIntç±»å‹çš„å€¼ï¼Œè¦æ³¨æ„çš„æ˜¯åœ¨è°ƒç”¨æœ‰è¾“å…¥è¾“å‡ºå‚æ•°çš„å‡½æ•°æ—¶éœ€è¦åœ¨è¾“å…¥è¾“å‡ºå‚æ•°å‰åŠ ä¸Š&amp;ç¬¦å·ã€‚ å‡½æ•°ç±»å‹åœ¨swiftä¸­å‡½æ•°æ˜¯å…·æœ‰å‡½æ•°ç±»å‹çš„ï¼Œå‡½æ•°çš„ç±»å‹æ˜¯ç”±å‡½æ•°å‚æ•°å’Œå‡½æ•°è¿”å›å€¼ç»„æˆçš„ã€‚å¦‚ä¸‹å‡½æ•°ï¼š 123func sumNumber(number1: Int, number2: Int = 10) -&gt; Int &#123; return number1 + number2&#125; è¯¥å‡½æ•°çš„å‡½æ•°ç±»å‹æ˜¯(Int,Int) -&gt; Intï¼Œå¯ä»¥ç†è§£ä¸ºè¯¥å‡½æ•°æœ‰ä¸¤ä¸ªIntå‹çš„å‚æ•°å¹¶è¿”å›Intå‹çš„å€¼ã€‚é‚£å¦‚æœå‡½æ•°æ²¡æœ‰å‚æ•°å’Œè¿”å›å€¼ï¼Œå‡½æ•°ä¼šæ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿå¦‚ä¸‹ï¼š 123func printHelloWorld() &#123; print(\"hello, world\")&#125; è¯¥å‡½æ•°æ²¡æœ‰å‚æ•°ä¹Ÿæ²¡æœ‰è¿”å›å€¼ï¼Œè¯¥å‡½æ•°çš„ç±»å‹æ˜¯() -&gt; Voidï¼Œå¯ä»¥ç†è§£ä¸ºè¯¥å‡½æ•°æ²¡æœ‰å‚æ•°å¹¶è¿”å›Voidç±»å‹çš„å‡½æ•°ã€‚åœ¨OCä¸­å¦‚æœä¸€ä¸ªæ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆä¼šç”¨voidå…³é”®å­—æ¥æ ‡ç¤ºã€‚åœ¨swiftä¸­æ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°å‡½æ•°ç±»å‹ä¹Ÿç”¨Voidè¡¨ç¤ºï¼Œå…¶å®swiftä¸­æ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªç‰¹æ®Šçš„Voidå€¼ï¼Œå…¶æœ¬è´¨æ˜¯ä¸€ä¸ªç©ºçš„å…ƒç»„ï¼Œæ²¡æœ‰ä»»ä½•çš„å…ƒç´ ã€‚ å‡½æ•°ç±»å‹çš„ä½¿ç”¨å‡½æ•°ç±»å‹èµ‹å€¼ åœ¨swiftä¸­å‡½æ•°ç±»å‹å°±åƒæ˜¯æ™®é€šçš„ç±»å‹ä¸€æ ·ï¼Œå¯ä»¥å£°æ˜ä¸€ä¸ªå˜é‡æˆ–è€…æ˜¯å¸¸é‡çš„å‡½æ•°ç±»å‹ï¼Œå¹¶ä¸”å¯ä»¥ç»™åŒç±»å‹çš„å‡½æ•°ç›¸äº’èµ‹å€¼ï¼Œä¸”å‡½æ•°çš„ç±»å‹ä¹Ÿæ˜¯å¯ä»¥é€šè¿‡æ¨æ–­å¾—å‡ºæ¥çš„ã€‚å¦‚ä¸‹ï¼Œå£°æ˜ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶å°†å®ƒèµ‹å€¼ç»™å¦ä¸€ä¸ªå‡½æ•°å¹¶è°ƒç”¨è¯¥å‡½æ•°ï¼š 1234567891011121314func sum(number1: Int, number2: Int = 10) -&gt; Int &#123; return number1 + number2&#125;let sumNumber = sum(number1: 10, number2: 100);print(sumNumber)let numberSum = sumlet sumNumber2 = numberSum(10, 100)print(sumNumber2)//è¾“å‡ºç»“æœï¼š110110 ä¸Šé¢å£°æ˜äº†ä¸€ä¸ª(Int,Int) -&gt; Intç±»å‹çš„å‡½æ•°sumï¼Œå¹¶å°†è¯¥å‡½æ•°èµ‹å€¼ç»™å¸¸é‡ç±»å‹çš„å‡½æ•°numberSumï¼Œåˆ†åˆ«è°ƒç”¨sumå’ŒnumberSumå‡½æ•°ï¼Œå…¶ç»“æœæ˜¯ä¸€æ ·çš„ã€‚ å‡½æ•°ç±»å‹ä½œä¸ºå‚æ•°ç±»å‹ å½“ç„¶å‡½æ•°æ—¢ç„¶å¯ä»¥ç›¸äº’èµ‹å€¼é‚£ä¹ˆå‡½æ•°ä¹Ÿå¯ä»¥ä½œä¸ºå…¶ä»–å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ï¼Œå°†å‡½æ•°ç±»å‹ä½œä¸ºå‚æ•°ç±»å‹è¿™æ ·å°±å¯ä»¥ç»™å‡½æ•°è°ƒç”¨è€…æ›´å¤§çš„ç©ºé—´æ¥å®ç°è¿™ä¸€éƒ¨åˆ†çš„å‡½æ•°ã€‚ 1234567891011func sum(sumFunc: (Int, Int) -&gt; Int ,numberA: Int, numberB: Int = 10) -&gt; Int &#123; return sumFunc(numberA, numberB)&#125;func sumNumber(a: Int, b: Int) -&gt; Int &#123; return a + b&#125;let result = sum(sumFunc: sumNumber, numberA: 10, numberB: 20)//è¾“å‡ºç»“æœï¼šresult = 30 è¯¥å‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œå…¶ä¸­ä¸€ä¸ªsumFuncçš„å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹ï¼Œæ¥å—ä¸¤ä¸ªIntç±»å‹çš„å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªIntç±»å‹çš„å€¼ï¼ŒnumberAå’ŒnumberBåˆ™æ˜¯ä¸¤ä¸ªIntç±»å‹çš„å‚æ•°ã€‚è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªIntç±»å‹çš„å€¼ï¼Œè¯¥å€¼æ˜¯ç”±ç¬¬ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°æ¥å†³å®šçš„ã€‚å‡½æ•°ç±»å‹ä¹Ÿå¯ä»¥ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼æ¥ä½¿ç”¨ï¼Œæˆ‘æƒ³è¿™é‡Œçš„ç”¨å¤„åº”è¯¥æ˜¯è¿”å›ä¸€ä¸ªå†…éƒ¨å‡½æ•°ï¼ˆåµŒå¥—å‡½æ•°ï¼‰å§ã€‚ æ€»ç»“swiftçš„å‡½æ•°æ€»çš„æ¥è¯´æ¯”èµ·åœ¨OCè¯­è¨€ä¸­çš„å‡½æ•°è¦çµæ´»å¾—å¤šï¼Œå‡½æ•°çš„åˆ›å»ºæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯é€šè¿‡funcå…³é”®å­—æ¥åˆ›å»ºï¼Œå¦ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨{}æ¥åˆ›å»ºï¼Œå…¶ä¸­é€šè¿‡{}åˆ›å»ºçš„å‡½æ•°è¢«ç§°ä½œé—­åŒ…è¡¨è¾¾å¼ã€‚åœ¨swiftä¸­å‡½æ•°çš„ç±»å‹å…¶å®æ€»çš„æ¥è¯´å¯ä»¥åƒæˆ‘ä»¬å¹³å¸¸ä½¿ç”¨å˜é‡æˆ–è€…å¸¸é‡ä¸€æ ·ï¼Œå¯ä»¥åœ¨ç›¸é€šç±»å‹çš„å‡½æ•°ä¹‹é—´ç›¸äº’èµ‹å€¼ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‡½æ•°çš„å‚æ•°ï¼Œæˆ–è€…å°†å‡½æ•°ç±»å‹ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼æ¥ä½¿ç”¨ã€‚","categories":[],"tags":[{"name":"Swift","slug":"Swift","permalink":"Aaronzjp.cn/tags/Swift/"}]},{"title":"åˆè¯†CALayer","slug":"iOS-CALayer","date":"2016-12-01T06:11:37.000Z","updated":"2017-07-27T02:57:07.000Z","comments":true,"path":"2016/12/01/iOS-CALayer/","link":"","permalink":"Aaronzjp.cn/2016/12/01/iOS-CALayer/","excerpt":"CALayer å’Œ UIView ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸€äº›è¢«å±‚çº§å…³ç³»æ ‘ç®¡ç†çš„å—ã€‚ CALayer å’Œ UIView ä¸€æ ·çš„å¯ä»¥å¯ä»¥åœ¨å…¶ä¸­å±•ç¤ºå›¾ç‰‡ï¼Œæ–‡æœ¬ï¼Œé€šè¿‡æ–¹æ³•æˆ–å±æ€§åšåŠ¨ç”»å’Œå›¾å½¢å˜æ¢ç­‰ç­‰çš„ç•Œé¢ä¸Šçš„æ˜¾ç¤ºç›¸å…³çš„ä¸œè¥¿ï¼Œå¯ä»¥è¯´ UIView èƒ½åšåˆ°çš„ CALayer åŸºæœ¬ä¸Šä¹Ÿèƒ½åšåˆ°ï¼Œä½†æ˜¯ CALayer å’Œ UIView æœ€å¤§çš„ä¸åŒæ˜¯ CALayer ä¸å¤„ç†å’Œç”¨æˆ·çš„äº¤äº’ã€‚å› ä¸º CALayer ä¸èƒ½å¾ˆå¥½çš„å¤„ç†å…·ä½“çš„å“åº”é“¾ï¼Œæ— æ³•å“åº”äº‹ä»¶çš„å¤„ç†ï¼Œå³ä½¿åœ¨ CALayer çš„æ–¹æ³•ä¸­æä¾›äº†è§¦æ‘¸äº‹ä»¶çš„æ£€æµ‹æ–¹æ³•ã€‚","text":"CALayer å’Œ UIView ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸€äº›è¢«å±‚çº§å…³ç³»æ ‘ç®¡ç†çš„å—ã€‚ CALayer å’Œ UIView ä¸€æ ·çš„å¯ä»¥å¯ä»¥åœ¨å…¶ä¸­å±•ç¤ºå›¾ç‰‡ï¼Œæ–‡æœ¬ï¼Œé€šè¿‡æ–¹æ³•æˆ–å±æ€§åšåŠ¨ç”»å’Œå›¾å½¢å˜æ¢ç­‰ç­‰çš„ç•Œé¢ä¸Šçš„æ˜¾ç¤ºç›¸å…³çš„ä¸œè¥¿ï¼Œå¯ä»¥è¯´ UIView èƒ½åšåˆ°çš„ CALayer åŸºæœ¬ä¸Šä¹Ÿèƒ½åšåˆ°ï¼Œä½†æ˜¯ CALayer å’Œ UIView æœ€å¤§çš„ä¸åŒæ˜¯ CALayer ä¸å¤„ç†å’Œç”¨æˆ·çš„äº¤äº’ã€‚å› ä¸º CALayer ä¸èƒ½å¾ˆå¥½çš„å¤„ç†å…·ä½“çš„å“åº”é“¾ï¼Œæ— æ³•å“åº”äº‹ä»¶çš„å¤„ç†ï¼Œå³ä½¿åœ¨ CALayer çš„æ–¹æ³•ä¸­æä¾›äº†è§¦æ‘¸äº‹ä»¶çš„æ£€æµ‹æ–¹æ³•ã€‚ CALayerå’ŒUIViewçš„å…³ç³»å¾ˆæ—©ä»¥å‰æˆ‘ä¸€ç›´å¼„ä¸æ¸…æ¥š CALayer å’Œ UIView ä¹‹é—´åˆ°åº•æ˜¯ä¸ªæ€ä¹ˆæ ·çš„å…³ç³»ï¼Œæˆ‘åªæ˜¯çŸ¥é“æ¯ä¸€ä¸ª UIView ä¸­éƒ½è‡³å°‘åŒ…å«äº†ä¸€ä¸ª CALayer ã€‚å…¶å®åœ¨æ¯ä¸€ä¸ª UIView ä¸­éƒ½æœ‰ä¸€ä¸ª CALayer çš„å®ä¾‹å›¾å±‚å±æ€§ï¼Œå½“è§†å›¾è¢«åˆ›å»ºçš„æ—¶å€™å°±ä¼šæœ‰å¯¹åº”çš„ä¸€ä¸ªå›¾å±‚ï¼Œå›¾å±‚å’Œè§†å›¾ä¸€æ ·ä¹Ÿå¯ä»¥æ·»åŠ å­å›¾å±‚ã€‚ UIView å…¶å®æ˜¯å¯¹ CALayer çš„ä¸€å±‚å°è£…ï¼Œä¹‹å‰ä¹Ÿè¯´äº† CALayer ä¸èƒ½å“åº”äº‹ä»¶ä»¥åŠå’Œç”¨æˆ·äº¤äº’ï¼Œ UIView åœ¨è¿™é‡Œå°±å……å½“äº†ä¸€ä¸ªæ¥ä»£æ›¿ CALayer å“åº”äº‹ä»¶çš„å¤„ç†å’Œç®¡ç† CALayer çš„ä¸€ä¸ªè§’è‰²ï¼Œ UIView ä¹Ÿåªæ˜¯è´Ÿè´£è¿™äº›ä¸œè¥¿çš„å¤„ç†ï¼Œåœ¨å±å¹•ä¸Šæ˜¾ç¤ºå’ŒåŠ¨ç”»çš„å¤„ç†å…¶å®éƒ½æ˜¯åœ¨ CALayer ä¸Šè¿›è¡Œçš„ã€‚ å›¾å±‚ç»“æ„å’Œå¯¹åº”çš„è§†å›¾å±‚çº§çš„å…³ç³»å¦‚ä¸‹å›¾ï¼š CALayerå¸¸ç”¨å±æ€§ å±æ€§ å±æ€§ç›¸å…³æè¿° backgroundColor ä¸ºå›¾å±‚æ·»åŠ èƒŒæ™¯è‰²ï¼Œè¯¥å±æ€§ä¸ºCGColorRefç±»å‹ contents å›¾å±‚å†…å®¹ï¼Œå¯„å®¿å›¾ã€‚id ç±»å‹ï¼ŒiOSä¸­ä¸€èˆ¬ä½¿ç”¨CGImageèµ‹å€¼ï¼ŒMacOSä¸­åˆ™å¯ä»¥ä½¿ç”¨NSImage æˆ– CGImage contentsGravity å¯„å®¿å›¾å†…å®¹å±•ç¤ºæ–¹å¼ï¼Œå’ŒUIImageViewçš„contensModeå¯¹åº”ã€‚è¯¥å±æ€§æ˜¯NSStringç±»å‹ contentsScale å¯„å®¿å›¾æ˜¾ç¤ºæ¯”ä¾‹è®¾ç½®ï¼Œ maskToBounds æ˜¯å¦æ˜¾ç¤ºè¶…å‡ºè¾¹ç•Œçš„å†…å®¹ï¼Œè¯¥å±æ€§æ˜¯ä¸€ä¸ªBOOLå€¼ç±»å‹ï¼Œé»˜è®¤ä¸ºNOï¼Œå³æ˜¾ç¤ºè¶…å‡ºè¾¹ç•Œçš„å†…å®¹ contentsRect CGRectç±»å‹ï¼Œå…è®¸å›¾å±‚æ˜¾ç¤ºå¯„å®¿å›¾çš„æŸä¸ªå›ºå®šåŒºåŸŸã€‚ä½¿ç”¨å•ä½åæ ‡ï¼Œå³0åˆ°1ä¹‹é—´ contentsCenter å›¾å±‚å¯æ‹‰ä¼¸åŒºåŸŸçš„è®¾ç½®ï¼Œä¹Ÿæ˜¯ä½¿ç”¨å•ä½åæ ‡ frame ä»£è¡¨å›¾å±‚å¤–éƒ¨çš„åæ ‡ä»¥åŠå¤§å°ï¼Œå³ç›¸å¯¹äºçˆ¶å›¾å±‚çš„ä½ç½® bounds å›¾å±‚çš„å†…éƒ¨åæ ‡å¤§å°ï¼Œboundsçš„Xï¼ŒYè½´åœ¨ iOS ä¸­ä¸€èˆ¬ä½äºå›¾å±‚çš„å·¦ä¸Šè§’ position position æ˜¯ç›¸å¯¹äº anchorPiont çš„ä½ç½®åœ¨ superLayer çš„ä½ç½®ã€‚ anchorPiont å›¾å±‚çš„é”šç‚¹ï¼Œå›ºå®šå›¾å±‚çš„ç‚¹ã€‚ï¼ˆå½“å¯¹å›¾å±‚åšæ—‹è½¬å½¢å˜çš„æ—¶å€™ï¼Œå›¾å±‚å°†å›´ç»•è¯¥ç‚¹æ—‹è½¬ï¼‰ï¼Œä½¿ç”¨å•ä½åæ ‡å³{0,0,1,1}; geometryFlipped å›¾å±‚ç¿»è½¬ï¼Œè¯¥å±æ€§æ˜¯ä¸€ä¸ª BOOL å±æ€§ï¼Œåœ¨ iOS ä¸­å°†è¯¥å±æ€§è®¾ç½®ä¸º YES çš„æ—¶å€™ï¼Œå›¾å±‚å°†ä¼šç›¸å¯¹äºçˆ¶å›¾å±‚åšå‚ç›´ç¿»è½¬ï¼Œå³è¯¥å›¾å±‚çš„ä½ç½®å°†ä¼šç›¸å¯¹äºçˆ¶å›¾å±‚ä»å·¦ä¸‹è§’å¼€å§‹ã€‚ conrnerRadius è¯¥å±æ€§æ§åˆ¶ç€å›¾å±‚è§’çš„æ›²ç‡ã€‚å®ƒæ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°ï¼Œé»˜è®¤ä¸º0ï¼ˆä¸º0çš„æ—¶å€™å°±æ˜¯ç›´è§’ï¼‰ï¼Œä½†æ˜¯ä½ å¯ä»¥æŠŠå®ƒè®¾ç½®æˆä»»æ„å€¼ã€‚ masksToBounds è¯¥å±æ€§æ˜¯ä¸€ä¸ªBOOLç±»å‹çš„ï¼Œå½“è®¾ç½®ä¸ºYESçš„æ—¶å€™ä»–å°†ä¼šæˆªå–å›¾å±‚ä¸­è¶…å‡ºè¾¹ç•Œçš„éƒ¨åˆ† borderWidth å›¾å±‚è¾¹æ¡†å®½åº¦ï¼Œä»¥ç‚¹ä¸ºå•ä½ï¼Œé»˜è®¤ä¸º0 borderColor å›¾å±‚è¾¹æ¡†é¢œè‰²ï¼Œæ˜¯ä¸€ä¸ª CGColorRef ç±»å‹çš„å±æ€§ CALayerçš„ä½¿ç”¨ CALayer ä¹Ÿå¯ä»¥åƒ UIView ä¸€æ ·çš„æ·»åŠ èƒŒæ™¯è‰²ï¼Œå¯„å®¿å›¾ï¼ŒåŒæ—¶è¿˜å¯ä»¥é€šè¿‡ CALayer åšä¸€äº› UIView ä¸èƒ½åšåˆ°çš„è§†è§‰æ•ˆæœã€‚ ä¸ºCALayeræ·»åŠ èƒŒæ™¯è‰²123456789101112131415161718192021222324#import &quot;CALayerBGColorViewController.h&quot;@interface CALayerBGColorViewController ()@property (nonatomic,strong) UIView *whiteView;@end@implementation CALayerBGColorViewController- (void)viewDidLoad &#123; [super viewDidLoad]; self.whiteView = [[UIView alloc]init]; _whiteView.backgroundColor = [UIColor whiteColor]; _whiteView.bounds = CGRectMake(0, 0, 150, 150); _whiteView.center = self.view.center; [self.view addSubview:_whiteView]; CALayer *orangeLayer = [CALayer layer]; orangeLayer.frame = CGRectMake(25, 25, 100, 100); orangeLayer.backgroundColor = [UIColor orangeColor].CGColor; [_whiteView.layer addSublayer:orangeLayer];&#125;@end è¿™é‡Œä¸ºæ§åˆ¶å™¨æ·»åŠ äº†ä¸€ä¸ªç™½è‰²çš„è§†å›¾ å›¾ whiteView ï¼Œç„¶åå‘ whiteView ä¸­çš„ layer æ·»åŠ äº†ä¸€ä¸ªå­å›¾å±‚ï¼ˆ orangeLayer ï¼‰ï¼Œå¹¶ç»™ orangeLayer æ·»åŠ äº†æ©˜è‰²çš„èƒŒæ™¯è‰²ã€‚ CALayer å’Œ UIView ç›¸æ¯”ï¼Œç¼ºå°‘äº†ä¸€ä¸ª center å±æ€§ã€‚å½“å‘ CALayer æ·»åŠ èƒŒæ™¯è‰²çš„æ—¶å€™å¹¶ä¸æ˜¯èµ‹å€¼çš„ UIColor ç±»ï¼Œè€Œæ˜¯ä¸€ä¸ª CGColorRef è¿™æ˜¯å› ä¸ºè¯¥åº“æ˜¯ç”± C è¯­è¨€æ‰€ç¼–å†™çš„ã€‚ CALayer ä¸­è®¾ç½®å¯„å®¿å›¾åŒæ ·ä¹Ÿæ˜¯èµ‹å€¼ä¸€ä¸ª CGImage ã€‚ CALayerçš„contentsçš„ä½¿ç”¨1234567891011121314151617181920212223#import &quot;CALayerBackImageViewController.h&quot;@interface CALayerBackImageViewController ()@property (nonatomic,strong) UIView *layerView;@end@implementation CALayerBackImageViewController- (void)viewDidLoad &#123; [super viewDidLoad]; self.layerView = [[UIView alloc]init]; _layerView.bounds = CGRectMake(0, 0, 150, 100); _layerView.center = self.view.center; [self.view addSubview:_layerView]; UIImage *EdisonImage = [UIImage imageNamed:@&quot;Edison.jpg&quot;]; _layerView.layer.contents = (__bridge id)(EdisonImage.CGImage); _layerView.layer.backgroundColor = [UIColor orangeColor].CGColor; _layerView.layer.contentsGravity = kCAGravityResizeAspect; &#125;@end ä»£ç ä¸­æˆ‘ä»¬ä¸ºè§†å›¾çš„ layer æ·»åŠ äº†ä¸€ä¸ªå›¾ç‰‡ä½œä¸º layer çš„å¯„å®¿å›¾ï¼Œä½†æ˜¯è¿™é‡Œè¦æ³¨æ„âš ï¸çš„æ˜¯ï¼Œè¿™å’Œæˆ‘ä»¬ä½¿ç”¨ UIImageView æ·»åŠ å›¾ç‰‡æ˜¯æœ‰åŒºåˆ«çš„ã€‚æˆ‘ä»¬ç»™ layer èµ‹å€¼çš„å›¾ç‰‡æ˜¯ä¸€ä¸ª CGImage çš„ç±»å‹ï¼ŒåŸå› ä¸Šé¢ä¹Ÿæåˆ°äº†å› ä¸ºè¯¥åº“æ˜¯ç”± C è¯­è¨€ç¼–å†™çš„ï¼Œæ‰€ä»¥ CGImage å…¶å®æ˜¯ä¸€ä¸ª CGImageRef çš„ Core Foundation ç±»å‹ã€‚ Core Foundation ç±»å‹å’Œ Cocoa å¯¹è±¡å¹¶ä¸æ˜¯å…¼å®¹çš„å¯¹è±¡ï¼Œæ‰€ä»¥è¿™é‡Œåœ¨èµ‹å€¼çš„æ—¶å€™è¿˜éœ€è¦è¿›è¡Œç±»å‹è½¬æ¢ï¼Œåœ¨ ARC ç¯å¢ƒä¸‹éœ€è¦ä½¿ç”¨æ¡¥æ¥æ¥è½¬æ¢ç±»å‹ï¼Œä»¥ä¾¿ç¼–è¯‘å™¨åœ¨å†…å­˜ç®¡ç†çš„æ—¶å€™ä¸ä¼šå‡ºé”™ã€‚ 1_layerView.layer.contents = (__bridge id)(EdisonImage.CGImage); layer åœ¨è¢«èµ‹å€¼å¯„å®¿å›¾çš„æ—¶å€™è¢«èµ‹å€¼çš„å±æ€§å¹¶ä¸æ˜¯å¹³å¸¸ä½¿ç”¨ UIImageView æ—¶èµ‹å€¼çš„ Image å±æ€§ï¼Œè¯¥å±æ€§æ˜¯ä¸€ä¸ªå« Contents çš„ id ç±»å‹çš„å±æ€§ã€‚ id ç±»å‹å°±æ„å‘³ç€å¯ä»¥èµ‹å€¼ä»»ä½•çš„å¯¹è±¡ç»™è¿™ä¸ª Contents å±æ€§ï¼Œå¯ä»¥å°è¯•ä¸‹èµ‹å€¼å…¶ä»–çš„å¯¹è±¡ç»™ Contents å±æ€§ï¼Œå½“è¢«èµ‹å€¼å…¶ä»–å¯¹è±¡çš„æ—¶å€™ layer å‡ ä¹ä¸ä¼šå‘ç”Ÿä»»ä½•çš„æ”¹å˜ï¼Œå°±æ˜¯ä¸€ä¸ªç©ºç™½çš„å›¾å±‚ï¼Œ ç¼–è¯‘ä¹Ÿèƒ½é€šè¿‡ï¼Œç”šè‡³è¿˜å¯èƒ½äº§ç”Ÿé”™è¯¯ï¼Œè¿™æ ·çš„é”™è¯¯âŒå¦‚æœå‡ºç°åœ¨å®é™…çš„é¡¹ç›®ä¸­çš„è¯åº”è¯¥æ˜¯å¾ˆéš¾è¢«å‘ç°çš„ã€‚å…¶å®åœ¨ iOS ä¸­åªèƒ½ä¸º layer çš„ Contents å±æ€§èµ‹å€¼ CGImageRef ç±»å‹ï¼Œè¿™ä¸ªå±æ€§è¢«è‹¹æœè®¾ç½®æˆ id çš„åŸå› æ˜¯å› ä¸º iOS ç³»ç»Ÿæ˜¯ç”± MacOS çš„ç³»ç»Ÿæ¼”å˜å‡ºæ¥çš„ï¼Œåœ¨ MacOS ä¸­è¯¥å±æ€§å¯ä»¥æ¥å— CGImage å’Œ NSImage ç±»å‹ã€‚ CALayer å¯ä»¥æ·»åŠ å¯„å®¿å›¾ï¼Œæ‰€ä»¥ CALayer è¿˜æœ‰ä¸€ä¸ªå’Œ UIImageView çš„ contentMode å±æ€§ç›¸å¯¹åº”çš„å±æ€§ç”¨æ¥å¤„ç†å¯„å®¿å›¾çš„æ˜¾ç¤ºæ–¹å¼ã€‚è¿™ä¸ªä¸ä¹‹ç›¸å¯¹åº”çš„å±æ€§å« contentsGravity ï¼Œä½†æ˜¯è¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ª NSString çš„ç±»å‹ï¼Œè€Œ UIKit ä¸­çš„ contentMode å±æ€§æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ã€‚å…·ä½“çš„ä½¿ç”¨å’Œ contentMode æ‰€å¯¹åº”çš„æšä¸¾å€¼ä¸€ä¸€å¯¹åº”ï¼ŒåŒºåˆ«æ˜¯ä¸€ä¸ªæ˜¯ä½œç”¨äº UIImageView ä¸Šçš„ï¼Œä¸€ä¸ªæ˜¯ä½œç”¨äº CALayer ã€‚ å¯„å®¿å›¾æ˜¾ç¤ºæ¯”ä¾‹ï¼ˆcontentsScaleï¼‰è¿˜æœ‰ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ CALayer èµ‹å€¼å¯„å®¿å›¾çš„æ—¶å€™æ˜¯èµ‹å€¼çš„ä¸€ä¸ªç”± UIImage è½¬æ¢æˆ CGImage çš„ç±»å‹çš„å›¾ç‰‡ï¼Œ UIImage åœ¨è·å–å›¾ç‰‡çš„æ—¶å€™æ˜¯æŒ‰ç…§ Retina å±å¹•çš„åˆ†è¾¨ç‡æ¯”ä¾‹æ¥è·å–å›¾ç‰‡çš„ï¼Œè·å–çš„æ˜¯é«˜è´¨é‡çš„ Retina ç‰ˆæœ¬çš„å›¾ç‰‡ï¼Œä½†æ˜¯åœ¨è½¬æ¢æˆ CGImage åè¿™ä¸ªæ¯”ä¾‹çš„ç¼©æ”¾æ‹‰ä¼¸å°±è¢«å¿½ç•¥äº†ï¼Œæ‰€ä»¥åŒæ ·çš„ä¸€å¼ å›¾ç‰‡ UIImage å±•ç¤ºå‡ºæ¥çš„çœ‹èµ·æ¥æ¯” CGImage å±•ç¤ºå‡ºæ¥çš„è¦å°ï¼Œä½†æ˜¯æ›´æ¸…æ™°ã€‚ä½†æ˜¯åœ¨ CALayer ä¸­è¿˜æ˜¯å¯ä»¥è®©èµ‹å€¼çš„ CGImage æ­£å¸¸çš„æ˜¾ç¤ºåœ¨ Retina å±å¹•ä¸Šçš„ï¼Œè¿™é‡Œè®¾ç½® CALayer çš„ contentScale å±æ€§ï¼Œè¯¥å±æ€§å…¶å®å°±æ˜¯ä¸ºäº†æ”¯æŒé«˜åˆ†è¾¨ç‡å±å¹•çš„æ˜¾ç¤ºè€Œå­˜åœ¨çš„å§ã€‚ä¸€èˆ¬å¦‚ä¸‹è®¾ç½®è¯¥å±æ€§ï¼š 1layer.contentsScale = [UIScreen mainScreen].scale; è¯¥æ–¹æ³•è®¾ç½® layer çš„ contentsScale å±æ€§æ¯”èµ·ç›´æ¥è®¾ç½®æ”¹å±æ€§çš„æ¯”ä¾‹æ›´å¥½ï¼Œæ”¹æ–¹æ³•ä¼šè®©è¯¥å±æ€§è·Ÿéšå±å¹•çš„æ¯”ä¾‹è€Œæ”¹å˜ã€‚ æˆªå–è¶…å‡ºå›¾å±‚è¾¹ç•Œçš„æ˜¾ç¤ºå†…å®¹ï¼ˆmasksToBoundsï¼‰åœ¨å›¾å±‚ä¸Šæ˜¾ç¤ºå¯„å®¿å›¾æœ‰æ—¶å€™å›¾ç‰‡å¯èƒ½ä¼šè¶…å‡ºå›¾å±‚çš„è¾¹ç•Œï¼Œè¿™æ ·çš„æƒ…å†µåœ¨ UIView ä¸‹ä¹Ÿæœ‰åŒæ ·çš„é—®é¢˜ã€‚åœ¨ UIView ä¸­ç”¨ä¸€ä¸ªå«åš clipsToBounds å±æ€§æ¥å†³å®šæ˜¯å¦æ˜¾ç¤ºè¶…å‡ºè¾¹ç•Œçš„å†…å®¹ã€‚ CALayer ä¸­åŒæ ·çš„ä¹Ÿæœ‰ä¸€ä¸ªå±æ€§å¯ä»¥å†³å®šæ˜¯å¦æ˜¾ç¤ºå…¶è¶…å‡ºè¾¹ç•Œçš„å†…å®¹ masksToBounds ã€‚ç¤ºä¾‹ğŸŒ°å¦‚ä¸‹ï¼š 1_layerView.layer.masksToBounds = YES; CALayerä¸­ä½¿ç”¨å›¾ç‰‡æ‹¼åˆæŠ€æœ¯ï¼ˆcontentsRectï¼‰ CALayer ä¸­ contentsRect å¯ä»¥å›¾å±‚æ˜¾ç¤ºè‡ªå·±çš„ä¸€éƒ¨åˆ†å†…å®¹ã€‚è¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ª CGRect ç±»å‹çš„ï¼Œä½†æ˜¯è¿™é‡Œå’Œå¹³å¸¸ä½¿ç”¨çš„ bounds ã€ frame å±æ€§ä¸åŒã€‚ contentsRect ä½¿ç”¨çš„æ˜¯å•ä½åæ ‡ï¼Œå•ä½åæ ‡æ˜¯æŒ‡åœ¨0åˆ°1ä¹‹é—´çš„ä¸€ä¸ªç›¸å¯¹çš„åæ ‡ç³»ï¼Œè¿™é‡Œå°±æ˜¯ç›¸å¯¹äºå¯„å®¿å›¾çš„ã€‚ contentsRect é»˜è®¤æƒ…å†µä¸‹æ˜¯{0ï¼Œ0ï¼Œ1ï¼Œ1}ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯æ˜¾ç¤ºä¸€ä¸ªå®Œæ•´çš„å›¾ç‰‡çš„ï¼Œå½“æŠŠè¯¥å±æ€§ç¼©å°åå›¾ç‰‡å°±ä¼šè¢«è£å‰ªï¼Œåªæ˜¾ç¤ºå‡ºè®¾ç½®çš„ç›¸å¯¹çš„åæ ‡ä¸­çš„å†…å®¹ã€‚å¦‚ä¸‹æ¼”ç¤ºäº†å¦‚ä½•å°†ä¸€ä¸ªå›¾ç‰‡åˆ‡å‰²æˆ4å—ï¼Œæ¥æ‹¼æ¥æ˜¾ç¤ºå‡ºæ¥ï¼š 1234567891011121314151617181920212223242526272829303132333435#import &quot;CALayerImageSpritesViewController.h&quot;@interface CALayerImageSpritesViewController ()@property (weak, nonatomic) IBOutlet UIView *firstView;@property (weak, nonatomic) IBOutlet UIView *secondView;@property (weak, nonatomic) IBOutlet UIView *thirdView;@property (weak, nonatomic) IBOutlet UIView *forthView;@end@implementation CALayerImageSpritesViewController- (instancetype)init &#123; self = [super init]; if (self) &#123; UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@&quot;Main&quot; bundle:nil]; self = [storyboard instantiateViewControllerWithIdentifier:@&quot;spriteImageVC&quot;]; &#125; return self;&#125;- (void)viewDidLoad &#123; [super viewDidLoad]; UIImage *spriteImage = [UIImage imageNamed:@&quot;Edison.jpg&quot;]; [self addImage:spriteImage WithContentsRect:CGRectMake(0, 0, 0.5, 0.5) toLayer:self.firstView.layer]; [self addImage:spriteImage WithContentsRect:CGRectMake(0.5, 0, 0.5, 0.5) toLayer:self.secondView.layer]; [self addImage:spriteImage WithContentsRect:CGRectMake(0, 0.5, 0.5, 0.5) toLayer:self.thirdView.layer]; [self addImage:spriteImage WithContentsRect:CGRectMake(0.5, 0.5, 0.5, 0.5) toLayer:self.forthView.layer];&#125;- (void)addImage:(UIImage *)image WithContentsRect:(CGRect)rect toLayer:(CALayer *)layer &#123; layer.contents = (__bridge id)image.CGImage; layer.contentsGravity = kCAGravityResizeAspect; layer.contentsRect = rect;&#125;@end è®¾ç½®å›¾å±‚çš„å¯æ‹‰ä¼¸åŒºåŸŸï¼ˆcontentsCenterï¼‰è¯¥å±æ€§æ˜¯ä¸€ä¸ª CGRect ç±»å‹ï¼Œå’Œ contentsRect ä¸€æ ·ä½¿ç”¨çš„æ˜¯å•ä½åæ ‡ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯{0ï¼Œ0ï¼Œ1ï¼Œ1}ã€‚å®ƒå®šä¹‰äº†ä¸€ä¸ªå›ºå®šçš„è¾¹æ¡†å’Œä¸€ä¸ªåœ¨å›¾å±‚ä¸Šå¯æ‹‰ä¼¸çš„åŒºåŸŸï¼Œåœ¨æ™®é€šæƒ…å†µä¸‹ä¿®æ”¹è¯¥å±æ€§ï¼Œå›¾å±‚çš„æ˜¾ç¤ºå¹¶ä¸ä¼šå‘ç”Ÿä»»ä½•çš„å˜åŒ–ï¼Œä½†æ˜¯å½“å›¾å±‚è¢«æ‹‰ä¼¸çš„æ—¶å€™å°±ä¼šæœ‰æ‰€å˜åŒ–ï¼Œå› ä¸ºè¿™å°±æ˜¯è®¾ç½®æ‹‰ä¼¸åŒºåŸŸçš„ä¸€ä¸ªå±æ€§ã€‚ ä¾‹å¦‚ğŸŒ°ï¼šå°† contentsCenter è®¾ç½®ä¸ºï¼š{0.25ï¼Œ0.25ï¼Œ0.5ï¼Œ0.5}ã€‚å…¶æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š å…¶å®æˆ‘çœ‹åˆ°è¿™ä¸ªå›¾æˆ‘ä¹Ÿè¿˜æ˜¯æä¸å¤ªæ‡‚è¿™ä¸ªæ˜¯æ€ä¹ˆæ‹‰ä¼¸çš„ï¼Œä½†æ˜¯å†çœ‹ä¸‹ä¸‹é¢è¿™ä¸ªä¾‹å­ğŸŒ°ï¼š è¢«æ‹‰ä¼¸å‰çš„åŸå›¾ï¼š åœ¨ä»£ç ä¸­å¦‚ä¸‹è®¾ç½® contentsCenter å±æ€§ï¼š 12345678910111213141516171819202122#import &quot;CALayerContentsCenterViewController.h&quot;@interface CALayerContentsCenterViewController ()@property (nonatomic,strong) UIView *layerView;@end@implementation CALayerContentsCenterViewController- (void)viewDidLoad &#123; [super viewDidLoad]; self.layerView = [[UIView alloc]init]; _layerView.bounds = CGRectMake(0, 0, 300, 300); _layerView.center = self.view.center; [self.view addSubview:_layerView]; UIImage *image = [UIImage imageNamed:@&quot;Test.png&quot;]; _layerView.layer.contents = (__bridge id) image.CGImage; _layerView.layer.contentsGravity = kCAGravityResizeAspect; _layerView.layer.contentsCenter = CGRectMake(0.25, 0.25, 0.5, 0.5); &#125;@end æ‹‰ä¼¸åçš„æ•ˆæœå¦‚ä¸‹å›¾ï¼š è¯¥æ•ˆæœå¯ä»¥ä½œç”¨äºåœ¨å¯„å®¿å›¾å±‚ä¸Šï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ä½œç”¨äºåœ¨ Core Graphics è¿è¡Œæ—¶ç»˜åˆ¶çš„å›¾å½¢ä¸Šã€‚ å›¾å±‚å¸ƒå±€ç®¡ç†å›¾å±‚å’Œ UIView ä¸€æ ·ä¹Ÿæœ‰è‡ªå·±çš„å¸ƒå±€ç®¡ç†çš„ç›¸å…³çš„å±æ€§ï¼Œ UIView æœ‰ frameï¼Œ bounds ï¼Œ center ï¼Œ CALayer ä¹Ÿæœ‰ä¸ä¹‹ç›¸å¯¹åº”çš„å±æ€§ï¼Œ frameï¼Œ bounds ï¼Œ position ã€‚ CALayer çš„ position å…¶å®å’Œ UIView çš„ center ä»£è¡¨çš„éƒ½æ˜¯åŒä¸€ä¸ªå€¼ã€‚ frame è¿™ä¸ªå±æ€§å…¶å®å¹¶ä¸æ˜¯ä¸€ä¸ªåˆå§‹çš„å±æ€§ï¼Œè¯¥å±æ€§æ˜¯é€šè¿‡ bounds å’Œ position å’Œ transform è®¡ç®—å¾—åˆ°çš„ï¼Œæ‰€æœ‰æ”¹å˜è¿™3ä¸ªä¸­çš„ä»»æ„ä¸€ä¸ªçš„å€¼éƒ½ä¼šå½±å“åˆ° frame ï¼ŒåŒæ ·æ”¹å˜ frame ä¹Ÿä¼šå½±å“è¿™ä¸‰ä¸ªå±æ€§çš„å€¼çš„æ”¹å˜ã€‚æœ€åæ³¨æ„ä¸€ç‚¹çš„æ˜¯å½“å›¾å±‚åšå‡ºæ—‹è½¬åï¼Œå›¾å±‚çš„ frame å¯èƒ½å°±å’Œ bounds ä¸ä¸€è‡´äº†ï¼Œ frame å®é™…ä¸Šä»£è¡¨äº†è¦†ç›–åœ¨å›¾å±‚æ—‹è½¬ä¹‹åçš„æ•´ä¸ªè½´å¯¹é½çš„çŸ©å½¢åŒºåŸŸã€‚ é”šç‚¹ï¼ˆanchorPointï¼‰è¿™ä¸ªå±æ€§å¾ˆå¯èƒ½ä¼šæŠŠäººæç³Šæ¶‚ï¼Œçœ‹ä¼¼æ˜¯å¾ˆå¥½ç†è§£çš„ï¼Œä½†æ˜¯å¾ˆå¤šäººç»å¸¸å› ä¸ºè¿™ä¸ªå±æ€§è¢«æç³Šæ¶‚ã€‚ anchorPoint ä¸€èˆ¬ä½äºå›¾å±‚çš„ä¸­å¿ƒï¼Œä½†æ˜¯è¿™ä¸ªå±æ€§æ˜¯å¯ä»¥è¢«æ”¹å˜çš„ï¼Œè™½ç„¶åœ¨ UIView ä¸­è¯¥å±æ€§æ²¡æœ‰è¢«æš´éœ²å‡ºæ¥ï¼Œä½†æ˜¯åœ¨ CALayer ä¸­æ˜¯å¯ä»¥è¿›è¡Œä¿®æ”¹çš„ã€‚å½“ä¿®æ”¹ anchorPoint å±æ€§æ—¶å¯èƒ½ä¼šé€ æˆå›¾å±‚çš„åç§»ï¼Œ ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªæ—¶å€™å›¾å±‚çš„ä¸­å¿ƒç‚¹ï¼ˆ position ï¼‰ä»¥åŠ UIView çš„ center ç›¸å¯¹äºçˆ¶è§†å›¾æ˜¯ä¸ä¼šæ”¹å˜çš„ï¼Œä½†æ˜¯ anchorPoint å‘ç”Ÿäº†æ”¹å˜ï¼Œ anchorPoint è¢«ä¿®æ”¹å anchorPoint ä¼šè‡ªåŠ¨çš„å‘å›¾å±‚çš„ position å¯¹é½ï¼Œè¿™ä¸ªæ—¶å€™ center æˆ–è€… position è¿™ä¸ªå±æ€§å¯èƒ½å¹¶ä¸æ˜¯å›¾å±‚çœŸæ­£çš„ä¸­å¿ƒç‚¹ã€‚å½“æ”¹å˜äº† anchorPoint ï¼Œ position å±æ€§ä¿æŒå›ºå®šçš„å€¼å¹¶æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œä½†æ˜¯ frame å´ç§»åŠ¨äº†ã€‚å½“å¯¹å›¾å±‚åšå˜æ¢ï¼Œæ—‹è½¬çš„æ—¶å€™ï¼Œå›¾å±‚éƒ½ä¼šä»¥ anchorPoint ä¸ºä¸­å¿ƒç‚¹æ¥æ—‹è½¬ã€‚ å›¾å±‚ç¿»è½¬ï¼ˆgeometryFlippedï¼‰é€šå¸¸æ¥è¯´ï¼Œåœ¨ iOS ä¸Šï¼Œä¸€ä¸ªå›¾å±‚çš„ä½ç½®æ˜¯ç›¸å¯¹äºçˆ¶å›¾å±‚ä»å·¦ä¸Šè§’å¼€å§‹çš„ï¼Œä½†æ˜¯åœ¨ MacOS ä¸­åˆ™æ˜¯ä»å·¦ä¸‹è§’å¼€å§‹çš„ã€‚å›¾å±‚ç¿»è½¬ï¼Œè¯¥å±æ€§æ˜¯ä¸€ä¸ª BOOL å±æ€§ï¼Œåœ¨ iOS ä¸­å°†è¯¥å±æ€§è®¾ç½®ä¸º YES çš„æ—¶å€™ï¼Œå›¾å±‚å°†ä¼šç›¸å¯¹äºçˆ¶å›¾å±‚åšå‚ç›´ç¿»è½¬ï¼Œå³è¯¥å›¾å±‚çš„ä½ç½®å°†ä¼šç›¸å¯¹äºçˆ¶å›¾å±‚ä»å·¦ä¸‹è§’å¼€å§‹ã€‚ åæ ‡ç³»è½¬æ¢å›¾å±‚å’Œ UIView ä¸€æ ·ï¼Œå›¾å±‚æ ‘ä¸­å„ä¸ªå›¾å±‚é—´ç›¸å¯¹äºçš„åæ ‡ä½ç½®æ˜¯å¯ä»¥ç›¸äº’è½¬æ¢çš„ï¼Œè‹¹æœæä¾›äº†å¦‚ä¸‹çš„æ–¹æ³•ï¼Œè®©æˆ‘ä»¬å¯ä»¥åœ¨å„ä¸ªå›¾å±‚é—´è·å¾—å…¶ç›¸å¯¹äºå…¶ä»–å›¾å±‚çš„åæ ‡ä½ç½®ï¼Œè€Œä¸ä»…é™äºç›¸å¯¹äºçˆ¶å›¾å±‚çš„ä½ç½®ï¼š 1234- (CGPoint)convertPoint:(CGPoint)point fromLayer:(CALayer *)layer; - (CGPoint)convertPoint:(CGPoint)point toLayer:(CALayer *)layer; - (CGRect)convertRect:(CGRect)rect fromLayer:(CALayer *)layer;- (CGRect)convertRect:(CGRect)rect toLayer:(CALayer *)layer; å›¾å±‚çš„è‡ªåŠ¨å¸ƒå±€åœ¨Mac OSå¹³å°ä¸‹ï¼Œ CALayer æœ‰ä¸€ä¸ªå«åš layoutManager çš„å±æ€§å¯ä»¥é€šè¿‡ CALayoutManager åè®®å’Œ CAConstraintLayoutManager ç±»æ¥å®ç°è‡ªåŠ¨æ’ç‰ˆçš„æœºåˆ¶ã€‚ä½†æ˜¯å› ä¸º iOS å’Œ MacOS è¿˜æ˜¯æœ‰ä¸€å®šçš„åŒºåˆ«ï¼Œæ‰€æœ‰åœ¨ iOS ä¸Šå¹¶ä¸é€‚ç”¨ã€‚åœ¨ä½¿ç”¨è§†å›¾ UIView æ—¶æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ UIViewAutoresizingMask å’Œ NSLayoutConstraint æ¥å®Œæˆè‡ªåŠ¨å¸ƒå±€ï¼Œä½†æ˜¯åœ¨ CALayer ä¸‹å°±ä¸èƒ½ä½¿ç”¨è¿™æ ·çš„æ–¹å¼æ¥å¤„ç†äº†ã€‚åœ¨ CALayer ä¸­å¸ƒå±€éœ€è¦éµå®ˆ CALayerDelegate ä¸­çš„æ–¹æ³•ï¼š 1- (void)layoutSublayersOfLayer:(CALayer *)layer; åœ¨æ­¤æ–¹æ³•ä¸­æ¥å¸ƒå±€å›¾å±‚ã€‚å½“å›¾å±‚çš„ bounds å‘ç”Ÿæ”¹å˜ï¼Œæˆ–è€…å›¾å±‚çš„-setNeedsLayoutæ–¹æ³•è¢«è°ƒç”¨æ—¶å°±ä¼šæ‰§è¡Œæ­¤ä»£ç†æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥åœ¨æ­¤ä»£ç†æ–¹æ³•ä¸­æ¥å¸ƒå±€æˆ–é‡æ–°è°ƒæ•´å­å›¾å±‚çš„å¤§å°ä»¥åŠä½ç½®ï¼Œä½†æ˜¯ä¸èƒ½åƒ UIView çš„ autoresizingMask å’Œ constraints å±æ€§åšåˆ°è‡ªé€‚åº”å±å¹•æ—‹è½¬ã€‚ å›¾å±‚æ•ˆæœåœ†è§’åœ†è§’çŸ©å½¢ï¼Œ CALayer æœ‰ä¸€ä¸ªå« conrnerRadius çš„å±æ€§ï¼Œä»–æ§åˆ¶å›¾å±‚çš„åœ†è§’ç‡ï¼Œé»˜è®¤æ˜¯0.0ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸ºä»»æ„çš„å€¼ï¼Œè¯¥å€¼ä¼šå½±å“èƒŒæ™¯è‰²ï¼Œä½†æ˜¯èƒŒæ™¯å›¾ç‰‡å’Œé‡Œé¢çš„å­å›¾å±‚ä¸ä¼šå—åˆ°å½±å“ï¼Œæ‰€ä»¥å¦‚æœæœ‰èƒŒæ™¯å›¾ç‰‡æˆ–è€…æœ‰å­è§†å›¾åœ¨å›¾å±‚å†…æ—¶ï¼Œè®¾ç½®æ”¹å±æ€§åå¯èƒ½ä¸ä¼šæ ¹æ®è®¾ç½®çš„åœ†è§’ç‡æ¥æ˜¾ç¤ºå›¾å±‚ã€‚ä¸è¿‡è¿™ä¸ªé—®é¢˜åªéœ€è¦è®¾ç½®å¦ä¸€ä¸ªå±æ€§å³å¯è§£å†³ï¼Œ masksToBounds ï¼Œè¯¥å±æ€§æ˜¯ä¸€ä¸ª BOOL ç±»å‹,ä»–å¯ä»¥å†³å®šæ˜¯å¦æ˜¾ç¤ºè¶…å‡ºå›¾å±‚å¤–çš„å›¾å±‚éƒ¨åˆ†ã€‚é»˜è®¤æ˜¯ NO ï¼Œå½“è®¾ç½®ä¸º YES çš„æ—¶å€™å›¾å±‚å°±ä¼šæˆªå–è¶…å‡ºå›¾å±‚çš„éƒ¨åˆ†ã€‚åœ†å½¢å›¾å±‚ä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½® conrnerRadius æ¥è®¾ç½®ï¼Œå‰ææ˜¯å½“å‰å›¾å±‚æ˜¯ä¸€ä¸ªæ­£æ–¹å½¢ï¼Œå½“ conrnerRadius çš„å€¼ç­‰äºæ­£æ–¹å½¢è¾¹é•¿çš„ä¸€åŠçš„æ—¶å€™å°±æ˜¯åœ†å½¢ã€‚ å›¾å±‚è¾¹æ¡† CALayer æœ‰ä¸¤ä¸ªå±æ€§å¯ä»¥ä¸ºå›¾å±‚ç»˜åˆ¶è¾¹æ¡†ï¼Œå³ borderWidth å’Œ borderColor ï¼Œé€šè¿‡è¿™ä¸¤ä¸ªå±æ€§æˆ‘ä»¬å¯ä»¥å®šåˆ¶å›¾å±‚ç»˜åˆ¶çš„è¾¹æ¡†ï¼Œè¿™æ¡çº¿(åˆè¢«ç§°ä½œstroke)ä¼šæ²¿ç€å›¾å±‚çš„ bounds è¾¹ç¼˜æ¥ç»˜åˆ¶ï¼ŒåŒæ—¶ä¹ŸåŒ…å«äº†å›¾å±‚çš„è§’ã€‚è¾¹æ¡†æ˜¯ç»˜åˆ¶åœ¨å›¾å±‚è¾¹ç•Œé‡Œé¢çš„ï¼Œä¸”åœ¨æ‰€æœ‰çš„å­å›¾å±‚æˆ–å­å†…å®¹å‰é¢ã€‚ borderWidth ç¡®å®šäº†å›¾å±‚æ‰€ç»˜åˆ¶çš„è¾¹æ¡†çš„å®½åº¦ï¼Œ borderColor åˆ™ç¡®å®šäº†å›¾å±‚è¾¹æ¡†çš„é¢œè‰²ã€‚ å›¾å±‚é˜´å½±åœ¨å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦ä¸ºå›¾å±‚ç»˜åˆ¶é˜´å½±ï¼Œç»˜åˆ¶å›¾å±‚é˜´å½±ä¹‹éœ€è¦ç»™å›¾å±‚çš„ shadowOpacity å¤åˆ¶å³å¯ï¼Œè¯¥å±æ€§æ˜¯ä¸€ä¸ª0(ä¸å¯è§)-1(å®Œå…¨ä¸é€æ˜)ä¹‹é—´çš„æµ®ç‚¹æ•°ã€‚å¦å¤–è¿˜å¯ä»¥é€šè¿‡å…¶ä»–ä¸€äº›å›¾å±‚çš„å±æ€§æ¥æ›´æ”¹é˜´å½±çš„ä¸€äº›å…¶ä»–æ•ˆæœï¼Œ shadowColor ï¼Œ shadowOffset å’ŒshwdowRadiusã€‚ shadowColor çœ‹åå­—æˆ‘ä»¬å°±çŸ¥é“è¿™æ˜¯æ§åˆ¶é˜´å½±é¢œè‰²çš„å±æ€§ï¼Œè¯¥å±æ€§æ˜¯ä¸€ä¸ª CGColorRef ç±»å‹çš„å±æ€§ï¼Œè¯¥å±æ€§é»˜è®¤çš„é˜´å½±é¢œè‰²æ˜¯é»‘è‰²ã€‚ shadowOffset å±æ€§æ§åˆ¶ç€é˜´å½±çš„æ–¹å‘å’Œè·ç¦»ï¼Œå®ƒæ˜¯ä¸€ä¸ª CGSize çš„å€¼ã€‚ shadowRadius æ˜¯æ§åˆ¶å›¾å±‚é˜´å½±è¾¹ç•Œæ¨¡ç³Šåº¦çš„å±æ€§ï¼Œå½“è¯¥å±æ€§ä¸º0çš„æ—¶å€™ï¼Œå›¾å±‚è¾¹ç•Œå’Œé˜´å½±ä¹‹é—´å°±æ˜¾å¾—éå¸¸æ˜æ˜¾ï¼Œä¸æ˜¯å¾ˆè‡ªç„¶ï¼Œå½“æ•°å€¼è¶Šå¤§å›¾å±‚å’Œé˜´å½±çš„è¾¹ç•Œå°±è¶Šè‡ªç„¶ï¼Œæ˜¾å¾—æ²¡æœ‰é‚£ä¹ˆæ˜æ˜¾ã€‚ è¦æ³¨æ„çš„æ˜¯å›¾å±‚çš„é˜´å½±æ˜¯æ ¹æ®å›¾å±‚å†…å®¹è®¡ç®—ç»˜åˆ¶å‡ºæ¥çš„ï¼Œå¹¶ä¸æ˜¯ç®€å•çš„åœ¨å›¾å±‚è¾¹æ¡†å¤–ç»˜åˆ¶å‡ºé˜´å½±çš„ã€‚æ¯”å¦‚è¯´å¦‚æœå›¾å±‚ä¸­é™¤äº†å›¾å±‚ä¸­å›¾ç‰‡æ˜¾ç¤ºéƒ¨åˆ†æœ‰å†…å®¹ï¼Œå…¶ä»–éƒ¨åˆ†æ˜¯é€æ˜çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªé˜´å½±å°†ä¼šæ²¿ç€å›¾å±‚çš„æ˜¾ç¤ºå†…å®¹æ¥ç»˜åˆ¶ï¼Œè€Œä¸æ˜¯æ²¿ç€å›¾å±‚çš„è¾¹ç•Œç»˜åˆ¶çš„ã€‚è¿˜æœ‰ä¸€ç‚¹é˜´å½±åœ¨å›¾å±‚ä¸­æ˜¯å¯ä»¥è¢« masksToBounds å±æ€§è£å‰ªæ‰çš„ï¼Œæ‰€ä»¥åœ¨æœ‰ä½¿ç”¨ masksToBounds å±æ€§çš„å›¾å±‚ä¸­ç»˜åˆ¶é˜´å½±çš„æ—¶å€™æœ€å¥½å•ç‹¬åœ¨åˆ›å»ºä¸€ä¸ªå›¾å±‚æ”¾åœ¨å›¾å±‚ä¹‹ä¸‹æ¥ä¸“é—¨ç»˜åˆ¶å›¾å±‚çš„é˜´å½±ï¼Œè¿™æ ·é˜´å½±å°±ä¸ä¼šè¢«è£å‰ªæ‰ã€‚ ä½¿ç”¨ shadowPath è‡ªå®šä¹‰å›¾å±‚é˜´å½±äº‹å®ä¸Šå›¾å±‚çš„é˜´å½±æ˜¯å¾ˆæ¶ˆè€—æ€§èƒ½çš„ï¼Œå› ä¸ºä»ä¸Šé¢å¾—çŸ¥å›¾å±‚é˜´å½±å¹¶ä¸æ˜¯å›ºå®šçš„æ²¿ç€å›¾å±‚çš„è¾¹ç¼˜ç»˜åˆ¶çš„ï¼Œè€Œæ˜¯æ ¹æ®å›¾å±‚å†…å®¹çš„å½¢çŠ¶è®¡ç®—æ¥çš„ã€‚æˆ‘ä»¬å¯ä»¥äº‹å…ˆä¸ºå›¾å±‚æŒ‡å®šé˜´å½±æ ·å¼ï¼Œé€šè¿‡å¯¹å›¾å±‚çš„ shadowPath å±æ€§æŒ‡å®šå›¾å±‚æ ·å¼æ¥æé«˜æ€§èƒ½ã€‚ shadowPath æ˜¯ä¸€ä¸ª CGPathRef ç±»å‹ï¼ˆä¸€ä¸ªæŒ‡å‘ CGPath çš„æŒ‡é’ˆï¼‰ã€‚ CGPath æ˜¯ä¸€ä¸ª Core Graphics å¯¹è±¡ï¼Œç”¨æ¥æŒ‡å®šä»»æ„çš„ä¸€ä¸ªçŸ¢é‡å›¾å½¢ã€‚å¯ä»¥é€šè¿‡è¿™ä¸ªå±æ€§å•ç‹¬äºå›¾å±‚å½¢çŠ¶ä¹‹å¤–æŒ‡å®šé˜´å½±çš„å½¢çŠ¶ã€‚ 123456789101112131415161718192021222324252627@interface ViewController ()@property (nonatomic, weak) IBOutlet UIView *layerView1;@property (nonatomic, weak) IBOutlet UIView *layerView2;@end@implementation ViewController- (void)viewDidLoad&#123; [super viewDidLoad]; //enable layer shadows self.layerView1.layer.shadowOpacity = 0.5f; self.layerView2.layer.shadowOpacity = 0.5f; //create a square shadow CGMutablePathRef squarePath = CGPathCreateMutable(); CGPathAddRect(squarePath, NULL, self.layerView1.bounds); self.layerView1.layer.shadowPath = squarePath; CGPathRelease(squarePath); ï¿¼//create a circular shadow CGMutablePathRef circlePath = CGPathCreateMutable(); CGPathAddEllipseInRect(circlePath, NULL, self.layerView2.bounds); self.layerView2.layer.shadowPath = circlePath; CGPathRelease(circlePath);&#125;@end å¦‚æœå›¾å±‚é˜´å½±çš„å›¾å½¢ç›¸å½“çš„å¤æ‚ä¹Ÿå¯ä»¥ä½¿ç”¨ UIBezierPath æ¥ä¸ºå›¾å±‚ç»˜åˆ¶é˜´å½±ã€‚ å›¾å±‚è’™ç‰ˆ CALayer ä¸­æœ‰ä¸€ä¸ªå« mask çš„å±æ€§ï¼Œè¿™ä¸ªå±æ€§æœ¬èº«å°±æ˜¯ä¸€ä¸ª CALayer çš„ç±»å‹ã€‚è¯¥å›¾å±‚å°±åƒæ˜¯å›¾å±‚çš„å­å›¾å±‚ä¸€æ ·ï¼Œæˆ‘çš„ç†è§£åº”è¯¥æ˜¯è¦†ç›–åœ¨çˆ¶å›¾å±‚(è¯¥å±æ€§çš„æ‹¥æœ‰è€…)ä¹‹ä¸Šçš„å›¾å±‚ï¼Œä¸Šé¢ä¸€éƒ¨åˆ†ä»£ç ä¸­çš„ conrnerRadius å’Œ masksToBounds å±æ€§å°±æ˜¯é€šè¿‡å¯¹ mask å›¾å±‚è¿›è¡Œæ“ä½œè¾¾åˆ°ä¿®æ”¹å›¾å±‚åœ†è§’ç‡ä»¥åŠè£å‰ªå›¾å±‚çš„ã€‚æœ‰å¾ˆé‡è¦çš„ä¸€ç‚¹æˆ‘ä¹‹å‰ä¸€ç›´æœ‰é”™è¯¯çš„ç†è§£ï¼Œæˆ‘ä¸€ç›´ä»¥ä¸º mask å±æ€§ä¸­ mask å›¾å±‚é€æ˜çš„éƒ¨åˆ†æ‰æ˜¯è¢«ä¿ç•™çš„è€Œå®å¿ƒçš„éƒ¨åˆ†ä¼šè¢«è£å‰ªï¼Œç„¶è€Œè¿™ç‚¹å’Œæˆ‘çš„ç†è§£åˆšåˆšç›¸åã€‚ mask å›¾å±‚ä¸­å®å¿ƒçš„éƒ¨åˆ†ä¼šè¢«ä¿ç•™æ˜¾ç¤ºå‡ºæ¥ï¼Œé€æ˜çš„éƒ¨åˆ†åˆ™ä¼šè¢«éšè—æ‰ã€‚ å¦‚ä¸‹ä»£ç ï¼Œå°†ä¼šæŠŠä¸€ä¸ªå›¾å±‚ï¼Œæ˜¾ç¤ºæˆ mask å†…å®¹çš„å½¢çŠ¶ï¼š 1234567891011121314151617181920212223242526272829#import \"CALayerMaskViewController.h\"@interface CALayerMaskViewController ()@property (weak, nonatomic) IBOutlet UIImageView *imageView;@end@implementation CALayerMaskViewController- (instancetype)init &#123; self = [super init]; if (self) &#123; UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@\"Main\" bundle:nil]; self = [storyboard instantiateViewControllerWithIdentifier:@\"MaskLayerVC\"]; &#125; return self;&#125;- (void)viewDidLoad &#123; [super viewDidLoad]; self.view.backgroundColor = [UIColor whiteColor]; self.imageView.image = [UIImage imageNamed:@\"Edison.jpg\"]; CALayer *maskLayer = [[CALayer alloc]init]; maskLayer.frame = _imageView.bounds; maskLayer.contents = (__bridge id)[UIImage imageNamed:@\"Heart\"].CGImage; _imageView.layer.mask = maskLayer; &#125; CALayer çš„ mask å±æ€§å› ä¸ºæ˜¯ CALayer ç±»å‹ï¼Œæ‰€ä»¥å›¾å±‚è’™ç‰ˆä¸ä¸€å®šå±€é™äºé™æ€çš„å›¾ç‰‡çš„æ ·å¼ã€‚ä»»ä½•ç”±å›¾å±‚æ„æˆçš„éƒ½å¯ä»¥ä½œä¸º mask å±æ€§ï¼Œè¿™æ ·è’™æ¿å¯ä»¥é€šè¿‡ä»£ç ç”šè‡³æ˜¯åŠ¨ç”»å®æ—¶ç”Ÿæˆã€‚ ç»„é€æ˜åœ¨ UIView ä¸­æœ‰ä¸€ä¸ª alpha çš„å±æ€§ç”¨æ¥è®¾ç½®è§†å›¾çš„é€æ˜åº¦ï¼ŒåŒæ ·çš„åœ¨ CALayer ä¸­ä¹Ÿæœ‰ä¸ä¹‹å¯¹åº”è®¾ç½®é€æ˜åº¦çš„å±æ€§ï¼Œé‚£å°±æ˜¯opacityã€‚è¿™ä¸¤ä¸ªå±æ€§éƒ½ä¼šå¯¹å­è§†å›¾æˆ–è€…å­å›¾å±‚æœ‰æ‰€å½±å“ã€‚å½“ä¸€ä¸ªè§†å›¾åŒ…å«å­è§†å›¾çš„æ—¶å€™ï¼Œå»è®¾ç½®è§†å›¾çš„é€æ˜åº¦å°±ä¼šæœ‰æ‰€é—®é¢˜ï¼Œæ¯”å¦‚æŠŠä¸€ä¸ªè§†å›¾çš„é€æ˜åº¦ï¼ˆalphaï¼‰è®¾ç½®ä¸º0.5çš„æ—¶å€™è¯¥è§†å›¾çš„å­è§†å›¾é€æ˜åº¦å´ä¸æ˜¯0.5ã€‚è¿™æ˜¯å› ä¸ºå›¾å±‚çš„é‡å é€æ˜åº¦é€ æˆçš„ï¼Œå¦‚æœå¸Œæœ›å­è§†å›¾ä¹ŸåŒæ ·å’Œè§†å›¾é€æ˜ï¼Œé‚£ä¹ˆæœ‰ä¸¤ç§æ–¹å¼å»è§£å†³ã€‚ç¬¬ä¸€ç§å°±æ˜¯é€šè¿‡åœ¨é¡¹ç›®çš„Info.plistæ–‡ä»¶ä¸­è®¾ç½® UIViewGroupOpacity å±æ€§ä¸º YES å³å¯è¾¾åˆ°æ•ˆæœï¼Œä½†æ˜¯è¿™ç§æ–¹å¼ä¼šå½±å“åˆ°æ•´ä¸ªçš„é¡¹ç›®ï¼Œå¾ˆæ˜æ˜¾çš„åœ¨æŸäº›æ—¶å€™è¿™ä¸ªè§£å†³æ–¹å¼å¹¶ä¸æ˜¯æœ€å¥½çš„ã€‚ç¬¬äºŒç§æ–¹å¼å°±æ˜¯è®¾ç½®è§†å›¾ä¸­å›¾å±‚çš„ shouldRasterize å±æ€§ä¸º YES ï¼Œè®¾ç½®è¯¥å±æ€§çš„æ—¶å€™ä¸€å®šè¦è®¾ç½® rasterizationScale å±æ€§ä»¥å»åŒ¹é…å±å¹•ï¼Œé˜²æ­¢è§†å›¾åœ¨Retinaå±å¹•ä¸‹åƒç´ åŒ–çš„é—®é¢˜ã€‚è¿˜æœ‰ä¸€ç‚¹ï¼Œå¦‚æœ shouldRasterize å’Œ UIViewGroupOpacity åŒæ—¶ä½¿ç”¨ä¼šæœ‰ä¸€å®šçš„æ€§èƒ½é—®é¢˜ã€‚ ç»˜åˆ¶CALayerçš„å¯„å®¿å›¾CALayer çš„ Contents å±æ€§ä¹Ÿä¸ä¸€å®šéè¦èµ‹å€¼ä¸€ä¸ªå¯„å®¿å›¾ï¼Œå¯èƒ½æœ‰çš„æ—¶å€™æˆ‘ä»¬éœ€å‘€è‡ªå·±å®šä¹‰ä¸€äº›ç®€å•çš„è§†å›¾ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥é€šè¿‡ Core Grapcis ç›´æ¥æ¥ç»˜åˆ¶å¯„å®¿å›¾ã€‚é€šè¿‡ç»§æ‰¿ UIView å¹¶å®ç° - drawRectï¼šæ–¹æ³•æ¥å®ç°è‡ªå®šä¹‰ç»˜åˆ¶ã€‚ åœ¨é»˜è®¤çš„æƒ…å†µä¸‹ - drawRectï¼šæ–¹æ³•æ˜¯æ²¡æœ‰å®ç°çš„ï¼Œå› ä¸ºå¯¹äºUIViewæ¥è¯´å¯„å®¿å›¾ä¸æ˜¯å¿…é¡»çš„ï¼Œè€Œä¸”è°ƒç”¨è¿™ä¸ªæ–¹æ³•åç³»ç»Ÿå°±ä¼šä¸ºè§†å›¾åˆ†é…ä¸€ä¸ªå¯„å®¿å›¾ï¼Œè¿™ä¸ªå¯„å®¿å›¾çš„åƒç´ å°ºå¯¸å°±æ˜¯è§†å›¾çš„å°ºå¯¸å¤§å°ä¹˜ä»¥ contentsSacle çš„å€¼ã€‚è¯¥æ–¹æ³•çš„è°ƒç”¨ä¼šæ¶ˆè€—ä¸€å®šçš„ CPU èµ„æºï¼Œå¯¹æ€§èƒ½é€ æˆä¸€å®šçš„æŸè€—ï¼Œæ‰€ä»¥åœ¨æ²¡æœ‰å®ç°è‡ªå®šä¹‰ç»˜åˆ¶çš„æ—¶å€™å°±ä¸è¦å»è°ƒç”¨è¯¥æ–¹æ³•ã€‚ åœ¨å®ç°äº†- drawRectï¼šæ–¹æ³•åç³»ç»Ÿå°±ä¼šè‡ªåŠ¨ç»˜åˆ¶å¯„å®¿å›¾æ˜¾ç¤ºåˆ°å±å¹•ä¸Šã€‚ä½†æ˜¯æœ‰çš„æ—¶å€™æˆ‘ä»¬éœ€è¦é‡æ–°ç»˜åˆ¶ä¸€ä¸ªå¯„å®¿å›¾ï¼Œå½“ç„¶é‡ç»˜ä¹Ÿæ˜¯åœ¨- drawRectï¼šæ–¹æ³•ä¸­æ¥å®Œæˆçš„ï¼Œä½†æ˜¯å½“æ·»åŠ äº†ç»˜åˆ¶ä»£ç åè¿è¡Œèµ·æ¥å‘ç°æ²¡æœ‰ä»»ä½•çš„æ•ˆæœã€‚å…¶å®è¿™é‡Œæˆ‘ä»¬éœ€è¦å»æ‰‹åŠ¨çš„è°ƒç”¨å¦ä¸€ä¸ªæ–¹æ³•- setNeedDisplayï¼šï¼Œè°ƒç”¨è¯¥æ–¹æ³•åç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨- drawRectï¼šæ–¹æ³•è¿›è¡Œé‡ç»˜ï¼Œä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿè¿™æ˜¯å› ä¸º- drawRectï¼šæ–¹æ³•é»˜è®¤åªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œæˆ‘ä»¬é‡ç»˜çš„æ—¶å€™å°±ä¸å›å†æ¬¡è°ƒç”¨äº†ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦è°ƒç”¨- setNeedDisplayï¼šæ¥è®©ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨- drawRectï¼šæ–¹æ³•æ¥è¿›è¡Œé‡ç»˜ã€‚å½“ç„¶è¿™æ˜¯åœ¨ UIView ä¸­ç»˜åˆ¶å¯„å®¿å›¾ï¼Œå…¶å®ä¹Ÿæ˜¯ä½¿ç”¨ CALayer æ¥å®Œæˆçš„ç»˜åˆ¶å·¥ä½œï¼Œå’Œä¿å­˜ç»˜åˆ¶å¥½çš„å¯„å®¿å›¾ã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ CALayer ä¸­ç›´æ¥ç»˜åˆ¶å¯„å®¿å›¾ã€‚CALayer æœ‰ä¸€ä¸ªå¯é€‰çš„ delegate å±æ€§ï¼Œå®ç°äº† CALayerDelegateçš„åè®®ï¼Œè¯¥åè®®æ˜¯ä¸€ä¸ªéæ­£å¼åè®®ï¼Œåªéœ€è¦åœ¨éœ€è¦ç»˜åˆ¶çš„æ—¶å€™è°ƒç”¨ç›¸å¯¹åº”çš„æ–¹æ³•å CALayer å°±ä¼šè‡ªåŠ¨å»å®Œæˆå‰©ä¸‹çš„å·¥ä½œã€‚å½“ CALayer è¢«ç»˜åˆ¶çš„æ—¶å€™é¦–å…ˆä¼šè°ƒç”¨ä¸‹é¢çš„è¿™ä¸ªä»£ç†æ–¹æ³•ï¼Œæ¥è¯·æ±‚è·å–ä¸€ä¸ªå¯„å®¿å›¾æ¥æ˜¾ç¤ºï¼š 1- (void)displayLayer:(CALayerCALayer *)layer; åœ¨è¿™ä¸ªä»£ç†æ–¹æ³•ä¸­æˆ‘ä»¬å¯ä»¥ç»™å®ƒä¸€ä¸ªå·²ç»ç»˜åˆ¶å¥½çš„å¯„å®¿å›¾ã€‚å¦‚æœæ²¡æœ‰å®ç°è¯¥æ–¹æ³•é‚£ä¹ˆ CALayer å°±ä¼šç»§ç»­è°ƒç”¨ä¸‹é¢è¿™ä¸ªæ–¹æ³•ï¼š 1- (void)drawLayer:(CALayer *)layer inContext:(CGContextRef)ctx; åœ¨è¿™ä¸ªæ–¹æ³•è°ƒç”¨åè¿™ä¸ªæ–¹æ³•é‡Œä¼šç”Ÿæˆä¸€ä¸ªç©ºçš„å¯„å®¿å›¾ layer å’Œä¸€ä¸ª Core Graphics çš„ç»˜åˆ¶å¯„å®¿å›¾çš„ä¸Šä¸‹æ–‡ç¯å¢ƒ ctxã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­æˆ‘ä»¬å°±å¯ä»¥åšä¸€äº›ç»˜åˆ¶çš„å·¥ä½œã€‚ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬è¿˜éœ€è¦æ˜¾ç¤ºçš„å»è°ƒç”¨- displayæ–¹æ³•æˆ‘ä»¬ç»˜åˆ¶çš„å¯„å®¿å›¾æ‰ä¼šæ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œè¿™é‡Œå’Œ UIView çš„ä¸åŒæ˜¯å½“å›¾å±‚æ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„æ—¶å€™ CALayer ä¸å›è‡ªåŠ¨é‡ç»˜è¯¥å†…å®¹ï¼Œé‡ç»˜å†…å®¹æ˜¯éœ€è¦å¼€å‘è€…è‡ªå·±å»è°ƒç”¨çš„ã€‚åœ¨ CALayer ä¸­ç»˜åˆ¶å¯„å®¿çš„çš„æ—¶å€™è¶…å‡ºè¾¹ç•Œçš„å›¾æ˜¯ä¸å›è¢«ç»˜åˆ¶å‡ºæ¥çš„ã€‚ å…¶å®åœ¨å¹³æ—¶è‡ªå®šä¹‰ç»˜åˆ¶æ§ä»¶çš„æ—¶å€™æˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯ä¸ä¼šä½¿ç”¨ CALayer çš„ delegate å»ç»˜åˆ¶æ§ä»¶çš„ï¼Œä¸€èˆ¬éƒ½æ˜¯åœ¨ UIView ä¸­è°ƒç”¨ - drawRectï¼šæ–¹æ³•è¿›è¡Œç»˜åˆ¶ï¼ŒUIView ä¼šè‡ªåŠ¨çš„æŠŠå›¾å±‚çš„ä»£ç†è®¾ç½®ä¸º self ï¼Œå¹¶ä¸”æä¾›- displayLayer ï¼šçš„å®ç°ï¼Œå®Œæˆæ‰€æœ‰çš„ç»˜åˆ¶ï¼Œå¹¶ä¸”åœ¨éœ€è¦é‡ç»˜çš„æ—¶å€™è°ƒç”¨- displayæ–¹æ³•ã€‚ å¦‚ä¸‹æ¼”ç¤ºä¸€ä¸‹å¦‚ä½•ä½¿ç”¨ CALayer æ¥ç»˜åˆ¶å¯„å®¿å›¾ï¼š 1234567891011121314151617181920212223242526272829303132333435363738#import &quot;ViewController.h&quot;@interface ViewController () &lt;CALayerDelegate&gt;@end@implementation ViewController- (void)viewDidLoad &#123; [super viewDidLoad]; CALayer *layer = [CALayer layer]; layer.frame = CGRectMake(50, 50, 100, 100); layer.backgroundColor = [UIColor orangeColor].CGColor; layer.delegate = self; layer.contentsScale = [UIScreen mainScreen].scale; [self.view.layer addSublayer:layer]; [layer display];&#125;- (void)drawLayer:(CALayer *)layer inContext:(CGContextRef)ctx &#123; CGContextSetLineWidth(ctx, 10.0); CGContextSetFillColorWithColor(ctx, [UIColor redColor].CGColor); CGMutablePathRef path = CGPathCreateMutable(); CGPathMoveToPoint(path, &amp;CGAffineTransformIdentity, 0, 0); CGPathAddLineToPoint(path, &amp;CGAffineTransformIdentity, 100, 100); CGPathAddLineToPoint(path, &amp;CGAffineTransformIdentity, 20, 80); CGPathCloseSubpath(path); CGContextAddPath(ctx, path); CGContextFillPath(ctx); &#125;@end æ•ˆæœå¦‚ä¸‹ï¼š","categories":[],"tags":[{"name":"å›¾å±‚","slug":"å›¾å±‚","permalink":"Aaronzjp.cn/tags/å›¾å±‚/"},{"name":"CALayer","slug":"CALayer","permalink":"Aaronzjp.cn/tags/CALayer/"},{"name":"Core Animation","slug":"Core-Animation","permalink":"Aaronzjp.cn/tags/Core-Animation/"}]},{"title":"æ–¹æ³•è°ƒé…æŠ€æœ¯ï¼ˆmethod swizzlingï¼‰","slug":"Method-Swizzling","date":"2016-09-19T09:33:52.000Z","updated":"2017-07-27T02:55:04.000Z","comments":true,"path":"2016/09/19/Method-Swizzling/","link":"","permalink":"Aaronzjp.cn/2016/09/19/Method-Swizzling/","excerpt":"â€‹ åœ¨å‰é¢çš„å…³äºruntimeä¸­å·²ç»è¯´è¿‡OCè¿è¡Œæ—¶è¯­è¨€ï¼Œåœ¨å…¶ç¼–è¯‘çš„æ—¶å€™å°±ä¼šæŠŠOCä¸­çš„æ¶ˆæ¯è½¬æ¢æˆä¸€ä¸ªç±»ä¼¼äºå¦‚ä¸‹ï¼š id objc_msgSend ( id self, SEL cmd, ... );ç»“æ„çš„Cè¯­è¨€å‡½æ•°ï¼Œåœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™ç¨‹åºå°±ä¼šæ ¹æ®idæ‰€å¯¹åº”çš„ç±»ï¼Œä»¥åŠä¼ å…¥çš„SELé€‰æ‹©å­åœ¨è¯¥ç±»çš„æ–¹æ³•åˆ—è¡¨ä¸­å»æŸ¥æ‰¾ç›¸å¯¹åº”çš„æ–¹æ³•ï¼Œå¹¶æ‰§è¡Œã€‚åˆ©ç”¨è¿™ä¸€ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿è¡ŒæœŸå»æ”¹å˜é€‰æ‹©å­åç§°ç›¸å¯¹åº”çš„æ–¹æ³•ï¼Œè¿™æ ·æˆ‘ä»¬æ—¢ä¸éœ€è¦æŸ¥çœ‹åˆ°æºä»£ç ï¼Œåˆæ²¡æœ‰å¿…è¦å»é‡å†™å­ç±»æ¥è¦†å†™æ–¹æ³•å°±èƒ½æ”¹å˜ç±»æœ¬èº«çš„åŠŸèƒ½ã€‚è¿™æ ·ä¸€æ¥æ–°åŠŸèƒ½å°±ä¼šåœ¨ç±»çš„æ‰€æœ‰å®ä¾‹ä¸­è¡¨ç°å‡ºæ¥ï¼Œè€Œä¸ä»…é™äºé‚£äº›é‡å†™å­ç±»çš„å®ä¾‹ã€‚è¿™ç§æ–¹æ¡ˆå°±å«åšâ€œæ–¹æ³•è°ƒé…â€ï¼ˆmethod swizzlingï¼‰ã€‚","text":"â€‹ åœ¨å‰é¢çš„å…³äºruntimeä¸­å·²ç»è¯´è¿‡OCè¿è¡Œæ—¶è¯­è¨€ï¼Œåœ¨å…¶ç¼–è¯‘çš„æ—¶å€™å°±ä¼šæŠŠOCä¸­çš„æ¶ˆæ¯è½¬æ¢æˆä¸€ä¸ªç±»ä¼¼äºå¦‚ä¸‹ï¼š id objc_msgSend ( id self, SEL cmd, ... );ç»“æ„çš„Cè¯­è¨€å‡½æ•°ï¼Œåœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™ç¨‹åºå°±ä¼šæ ¹æ®idæ‰€å¯¹åº”çš„ç±»ï¼Œä»¥åŠä¼ å…¥çš„SELé€‰æ‹©å­åœ¨è¯¥ç±»çš„æ–¹æ³•åˆ—è¡¨ä¸­å»æŸ¥æ‰¾ç›¸å¯¹åº”çš„æ–¹æ³•ï¼Œå¹¶æ‰§è¡Œã€‚åˆ©ç”¨è¿™ä¸€ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿è¡ŒæœŸå»æ”¹å˜é€‰æ‹©å­åç§°ç›¸å¯¹åº”çš„æ–¹æ³•ï¼Œè¿™æ ·æˆ‘ä»¬æ—¢ä¸éœ€è¦æŸ¥çœ‹åˆ°æºä»£ç ï¼Œåˆæ²¡æœ‰å¿…è¦å»é‡å†™å­ç±»æ¥è¦†å†™æ–¹æ³•å°±èƒ½æ”¹å˜ç±»æœ¬èº«çš„åŠŸèƒ½ã€‚è¿™æ ·ä¸€æ¥æ–°åŠŸèƒ½å°±ä¼šåœ¨ç±»çš„æ‰€æœ‰å®ä¾‹ä¸­è¡¨ç°å‡ºæ¥ï¼Œè€Œä¸ä»…é™äºé‚£äº›é‡å†™å­ç±»çš„å®ä¾‹ã€‚è¿™ç§æ–¹æ¡ˆå°±å«åšâ€œæ–¹æ³•è°ƒé…â€ï¼ˆmethod swizzlingï¼‰ã€‚ â€‹ ç±»æ–¹æ³•åˆ—è¡¨ä¼šæŠŠé€‰æ‹©å­çš„åç§°æ˜ å°„åˆ°ç›¸å…³çš„æ–¹æ³•åˆ—è¡¨ä¸Šï¼Œä½¿å¾—åŠ¨æ€æ¶ˆæ¯æ´¾å‘ç³»ç»Ÿèƒ½å¤Ÿé€šè¿‡æŸ¥æ‰¾æ–¹æ³•åˆ—è¡¨æ‰¾åˆ°ç›¸å¯¹åº”çš„æ–¹æ³•å¹¶è°ƒç”¨ã€‚è¿™äº›æ–¹æ³•å‡ä»¥æŒ‡é’ˆçš„å½¢å¼è¡¨ç¤ºï¼Œå¹¶å­˜å‚¨åœ¨ç±»çš„æ–¹æ³•åˆ—è¡¨ï¼ˆobjc_method_listï¼‰ä¸­ï¼Œè¯¥æŒ‡é’ˆå°±æ˜¯IMPã€‚ IMPçš„åŸå‹å¦‚ä¸‹ï¼š id (*IMP)(id, SEL,...); å®ç°æ–¹æ³•äº¤æ¢çš„å®ç°æ–¹æ³•å¦‚ä¸‹ï¼š void method_exchangeImplementations(Method m1,Method m2) è¿™ä¸ªå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œå…¶ä¸­è¿™ä¸¤ä¸ªå‚æ•°å°±æ˜¯å¾…äº¤æ¢çš„ä¸¤ä¸ªæ–¹æ³•ã€‚ è€Œæ–¹æ³•çš„å®ç°åˆ™å¯ä»¥é€šè¿‡ä»¥ä¸‹è¿™ä¸ªæ–¹æ³•æ¥è·å¾—ï¼š Method class_getInstanceMethod(Class class,SEL aSelector) æ­¤å‡½æ•°ä¼šæ ¹æ®ç»™å®šçš„å‚æ•°çš„ç±»ï¼Œå’Œé€‰æ‹©å­å»åˆ°æ–¹æ³•åˆ—è¡¨ä¸­å–å‡ºç›¸åº”çš„æ–¹æ³•ã€‚ ä¸‹é¢ç”¨ä¸€ä¸ªä¾‹å­ğŸŒ°æ¥éªŒè¯ä¸‹ï¼š NSSrtingä¸­æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯lowercaseStringå’ŒuppercaseStringå…¶ä½œç”¨æ—¶å°†è‹±æ–‡å­—ç¬¦ä¸²åˆ†åˆ«è½¬æ¢æˆå°å†™å’Œå¤§å†™ã€‚ç°åœ¨ç”¨ä¸Šé¢ä»‹ç»çš„æ–¹æ³•æ¥è®©è¿™ä¸¤ä¸ªæ–¹æ³•äº¤æ¢ã€‚ 12345Method originalMethod = class_getInstanceMethod([NSString class], @selector(lowercaseString));Method swappedMethod = class_getInstanceMethod([NSString class], @selector(uppercaseString));method_exchangeImplementions(originalMethod, swappedMethod); â€‹ å®é™…ä¸Šè¿™æ ·ç›´æ¥äº¤æ¢ä¸¤ä¸ªæ–¹æ³•çš„æ„ä¹‰åŸºæœ¬ä¸å¤§ï¼Œå› ä¸ºä»–ä»¬éƒ½å·²ç»è¢«å®ç°å¾—å¾ˆå¥½äº†ï¼Œè¿™æ ·äº¤æ¢ååè€Œå¼•èµ·æ··æ·†ã€‚ä¸€èˆ¬ä¼šç¼–å†™ä¸€ä¸ªæ–°çš„æ–¹æ³•ï¼Œåœ¨æ–°çš„æ–¹æ³•ä¸­å®ç°ä¸€äº›é™„åŠ çš„åŠŸèƒ½ï¼Œå†è°ƒç”¨åŸæœ‰çš„å®ç°ã€‚å¦‚ä¸‹ï¼š 1234567891011- (NSString *)zjp_myLowercaseString &#123; NSString *lowercase = [self zjp_myLowercaseString] NSLog(@&quot;%@ =&gt; %@&quot;,self, lowercase); return lowercase;&#125;Method originalMethod = class_getInstanceMethod([NSString class], @selector(lowercaseString));Method swappedMethod = class_getInstanceMethod([NSString class], @selector(zjp_myLowercaseString));method_exchangeImplementions(originalMethod, swappedMethod); è¿™æ ·äº¤æ¢æ–¹æ³•åï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨è¿™ä¸ªlowercaseStringæ—¶å°±å›é™„åŠ çš„å®Œæˆæˆ‘ä»¬å‘é‡Œé¢æ·»åŠ çš„æ–¹æ³•äº†ã€‚ä¼šæ‰“å°å‡ºè¢«è½¬æ¢å‰å’Œè½¬æ¢åçš„å­—ç¬¦ä¸²ã€‚é€šè¿‡è¿™æ ·çš„æ–¹æ³•æˆ‘ä»¬å°±å¯ä»¥ä¸ºæˆ‘ä»¬ä¸çŸ¥é“å…·ä½“å®ç°çš„æ–¹æ³•å¢åŠ æ—¥å¿—è¾“å‡ºçš„åŠŸèƒ½ä»¥ä¾¿æˆ‘ä»¬çš„ç¨‹åºè°ƒè¯•ã€‚ä¸è¿‡é™¤äº†è¿™æ ·ç”¨ä»¥ä¸ºå…¶å®è¿˜æœ‰ä¸€äº›å¥½ç”¨çš„åŠŸèƒ½ï¼Œä½ æ‡‚çš„ã€‚ã€‚ã€‚ã€‚è¿™æ ·åé¢æœ‰æœºä¼šå†è¯´ã€‚","categories":[],"tags":[{"name":"runtime","slug":"runtime","permalink":"Aaronzjp.cn/tags/runtime/"}]},{"title":"runtime-æ¶ˆæ¯è½¬å‘æœºåˆ¶ï¼ˆmessage forwardingï¼‰","slug":"Message-Forwarding","date":"2016-09-13T03:48:39.000Z","updated":"2017-07-27T02:55:08.000Z","comments":true,"path":"2016/09/13/Message-Forwarding/","link":"","permalink":"Aaronzjp.cn/2016/09/13/Message-Forwarding/","excerpt":"â€‹ ä¸Šæ¬¡åœ¨å‘é€æ¶ˆæ¯objc_msgSendä¸­æåˆ°äº†ï¼Œå¦‚æœåœ¨å½“å‰çš„ç±»çš„æ–¹æ³•åˆ—è¡¨ä¸­å¦‚æœæ‰¾ä¸åˆ°å¯¹åº”çš„é€‰æ‹©å­çš„æ–¹æ³•å°±ä¼šæ‰§è¡Œæ¶ˆæ¯è½¬å‘ï¼ˆmessage forwardingï¼‰ï¼Œåœ¨æ¶ˆæ¯çš„è½¬å‘è¿‡ç¨‹ä¸­æˆ‘ä»¬å°±å¯ä»¥åœ¨ç¨‹åºä¸­å‘Šè¯‰ç¨‹åºåº”è¯¥æ€æ ·å»å¤„ç†è¿™æ ·æœªçŸ¥çš„æ¶ˆæ¯ï¼Œå¯ä»¥åœ¨æ¶ˆæ¯çš„è½¬å‘è¿‡ç¨‹ä¸­è®¾ç½®æŒ‚é’©ï¼Œç”¨æ¥æ‰§è¡Œé¢„å®šçš„é€»è¾‘å¤„ç†æ–¹å¼ï¼Œæ¥åšåˆ°å½“ç¨‹åºä¸­çš„æŸä¸ªç±»æ‰¾ä¸åˆ°å¯¹åº”çš„æ–¹æ³•æ—¶ä¸è‡³äºå¯¼è‡´ç¨‹åºçš„å´©æºƒã€‚ â€‹ å…¶ä¸­æ¶ˆæ¯è½¬å‘æœºåˆ¶è¯¦ç»†çš„æ¥åˆ’åˆ†ä¸€å…±åˆ†ä¸º3ä¸ªéƒ¨åˆ†ï¼š åŠ¨æ€æ–¹æ³•è§£æ å¤‡æ´æ¥æ”¶è€… å®Œæ•´çš„æ¶ˆæ¯è½¬å‘","text":"â€‹ ä¸Šæ¬¡åœ¨å‘é€æ¶ˆæ¯objc_msgSendä¸­æåˆ°äº†ï¼Œå¦‚æœåœ¨å½“å‰çš„ç±»çš„æ–¹æ³•åˆ—è¡¨ä¸­å¦‚æœæ‰¾ä¸åˆ°å¯¹åº”çš„é€‰æ‹©å­çš„æ–¹æ³•å°±ä¼šæ‰§è¡Œæ¶ˆæ¯è½¬å‘ï¼ˆmessage forwardingï¼‰ï¼Œåœ¨æ¶ˆæ¯çš„è½¬å‘è¿‡ç¨‹ä¸­æˆ‘ä»¬å°±å¯ä»¥åœ¨ç¨‹åºä¸­å‘Šè¯‰ç¨‹åºåº”è¯¥æ€æ ·å»å¤„ç†è¿™æ ·æœªçŸ¥çš„æ¶ˆæ¯ï¼Œå¯ä»¥åœ¨æ¶ˆæ¯çš„è½¬å‘è¿‡ç¨‹ä¸­è®¾ç½®æŒ‚é’©ï¼Œç”¨æ¥æ‰§è¡Œé¢„å®šçš„é€»è¾‘å¤„ç†æ–¹å¼ï¼Œæ¥åšåˆ°å½“ç¨‹åºä¸­çš„æŸä¸ªç±»æ‰¾ä¸åˆ°å¯¹åº”çš„æ–¹æ³•æ—¶ä¸è‡³äºå¯¼è‡´ç¨‹åºçš„å´©æºƒã€‚ â€‹ å…¶ä¸­æ¶ˆæ¯è½¬å‘æœºåˆ¶è¯¦ç»†çš„æ¥åˆ’åˆ†ä¸€å…±åˆ†ä¸º3ä¸ªéƒ¨åˆ†ï¼š åŠ¨æ€æ–¹æ³•è§£æ å¤‡æ´æ¥æ”¶è€… å®Œæ•´çš„æ¶ˆæ¯è½¬å‘ åŠ¨æ€æ–¹æ³•è§£æâ€‹ å¯¹è±¡åœ¨æ”¶åˆ°è¿™æ¡æ— æ³•åšå‡ºå“åº”çš„æ¶ˆæ¯åï¼Œé¦–å…ˆä¼šè°ƒç”¨æ‰€å±ç±»çš„å¦‚ä¸‹çš„æ–¹æ³•ï¼š + (BOOL)resolveInstanceMethod:(SEL)sel å½“ç„¶å¦‚æœè¿™ä¸ªæœªå®ç°çš„æ–¹æ³•ä¸æ˜¯ä¸€ä¸ªå®ä¾‹æ–¹æ³•ï¼Œè€Œæ˜¯ç±»æ–¹æ³•ï¼Œé‚£ä¹ˆä¼šæœ‰ä¸€ä¸ªä¸ä¹‹ç›¸å¯¹åº”çš„æ–¹æ³•æ¥å¤„ç†ï¼š + (BOOL)resolveClassMethod:(SEL)sel è¯¥æ–¹æ³•çš„è¿™ä¸ªå‚æ•°SELå°±æ˜¯é‚£ä¸ªæœªçŸ¥çš„é€‰æ‹©å­ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªBooleanç±»å‹ï¼Œå¦‚æœè¿”å›YESåˆ™è¡¨ç¤ºè¿™ä¸ªç±»ä¸ºå…¶æ–°å¢äº†ä¸€ä¸ªå®ä¾‹æ–¹æ³•æ¥å¤„ç†æ­¤é€‰æ‹©å­ï¼Œå¦‚æœè¿”å›NOåˆ™åä¹‹ã€‚ä½¿ç”¨æ­¤æ–¹æ³•çš„å‰ææ˜¯ï¼Œç›¸å…³å¤„ç†å‡½æ•°çš„å®ç°ä»£ç å·²ç»å®ç°äº†ï¼Œåªæ˜¯åœ¨è¿è¡Œçš„æ—¶å€™åŠ¨æ€çš„å°†è¯¥å®ç°æ–¹æ³•åŠ¨æ€çš„æ’å…¥åˆ°ç±»å°±å¥½äº†ã€‚ï¼ˆæ‰€æ’å…¥æ·»åŠ çš„æ–¹æ³•æ˜¯è¦ç”¨Cå‡½æ•°å®ç°çš„ï¼‰ã€‚ å…·ä½“ä½¿ç”¨ä¾‹å­ğŸŒ°å¦‚ä¸‹ï¼š 123456789101112+ (BOOL)resolveInstanceMethod:(SEL)sel&#123; //é¦–å…ˆåˆ¤æ–­è¿™ä¸ªæœªå®ç°çš„æ–¹æ³•æ˜¯ä¸æ˜¯å·²ç»å®ç°äº†ç­‰å¾…è¢«åŠ¨æ€æ’å…¥åˆ°ç±»çš„æ–¹æ³•ï¼Œè¿™é‡Œç”¨testä½œä¸ºä¾‹å­ //ä¹Ÿå¯ä»¥åŒè¿‡æŠŠé€‰æ‹©å­å­—ç¬¦ä¸²åŒ–é€šè¿‡åˆ¤æ–­å­—ç¬¦ä¸²çš„åŒ¹é…æ¥åšå¤„ç† //NSString *selectorString = NSStringFromSelector(sel) //if ([selectorString hasPrefix:@&quot;set&quot;]) &#123;&#125;.... if (aSEL == @selector(test)) &#123; class_addMethod([self class], sel, (IMP)(å·²ç»å®ç°çš„é‚£ä¸ªå‡½æ•°), &quot;v@:&quot;); // åŠ¨æ€æ·»åŠ æ–¹æ³• return YES; // è¿”å›YESï¼Œåˆ™ä¸ä¼šè½¬å‘&#125; return [super resolveInstanceMethod:aSEL]; // ä¸æ˜¯éœ€è¦åŠ¨æ€æ·»åŠ çš„æ–¹æ³•ï¼ŒæŒ‰ç…§çˆ¶ç±»å¤„ç†&#125; è¿™é‡Œç”¨åˆ°äº†class_addMethodå‡½æ•°ï¼Œè¯¥å‡½æ•°å¯ä»¥å‘ç±»ä¸­åŠ¨æ€åœ°æ·»åŠ æ–¹æ³•ï¼Œç”¨ä»¥å¤„ç†ç»™å®šçš„é€‰æ‹©å­ã€‚å…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¢«æ’å…¥æ–¹æ³•çš„ç±»ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯é€‰æ‹©å­ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å‡½æ•°æŒ‡é’ˆï¼Œåªæƒ³å¾…æ’å…¥æ·»åŠ åˆ°ç±»çš„æ–¹æ³•ï¼Œè€Œæœ€åä¸€ä¸ªå‚æ•°åˆ™è¡¨ç¤ºå¾…æ·»åŠ æ–¹æ³•çš„â€ç±»å‹ç¼–ç â€ï¼ˆtype encodingï¼‰ã€‚ å¤‡æ´æ¥æ”¶è€…â€‹ å¦‚æœåœ¨åŠ¨æ€æ–¹æ³•è§£æçš„é‚£ä¸€æ­¥æ²¡æœ‰å¯¹æ­¤åšç›¸å…³çš„å¤„ç†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥è¿˜æ˜¯å¯ä»¥å¯¹æ­¤ä½œå‡ºç›¸åº”çš„å¤„ç†çš„ã€‚åœ¨è¿™æ­¥ä¸­ä¸»è¦åšçš„å°±æ˜¯èƒ½ä¸èƒ½æŠŠè¿™ä¸ªæœªèƒ½è§£è¯»åˆ°åˆ°æ–¹æ³•è½¬äº¤ç»™å…¶ä»–çš„æ¶ˆæ¯æ¥å—è€…æ¥å¤„ç†ã€‚è¯¥æ­¥ä¸­ä¼šåœ¨å¦‚ä¸‹çš„æ–¹æ³•ä¸­è¿›è¡Œè¿™ä¸ªæ­¥éª¤çš„å¤„ç†ï¼š - (id)forwardingTargetForSelector:(SEL)aSelector å…·ä½“ä½¿ç”¨ä¾‹å­ğŸŒ°å¦‚ä¸‹ï¼š 1234567- (id)forwardingTargetForSelector:(SEL)aSelector&#123; if(aSelector == @selector(test))&#123; return testObject;//è¿”å›è¢«è½¬äº¤çš„å…¶å®ƒçš„æ¶ˆæ¯æ¥å—è€… &#125; return [super forwardingTargetForSelector:aSelector];// ä¸æ˜¯éœ€è¦åŠ¨æ€æ·»åŠ çš„æ–¹æ³•ï¼ŒæŒ‰ç…§çˆ¶ç±»å¤„ç†&#125; åªè¦è¿™ä¸ªæ–¹æ³•ä¸­æœ€åè¿”å›çš„ä¸é€‚nilå’Œselfé‚£ä¹ˆæ•´ä¸ªæ¶ˆæ¯å‘é€çš„è¿‡ç¨‹å°±ä¼šè¢«é‡å¯ï¼Œå½“ç„¶æ¥æ”¶æ¶ˆæ¯çš„å¯¹è±¡å°±å›å˜æˆè¿™é‡Œè¿”å›çš„è¿™ä¸ªç±»ã€‚å¦‚æœè¿™é‡Œè¿˜æ˜¯æ²¡æœ‰åŠæ—¶çš„å¤„ç†é‚£ä¹ˆå°±å›è¿›å…¥åˆ°æ¶ˆæ¯è½¬å‘çš„æœ€åä¸€æ­¥äº†ï¼Œè¿›è¡Œå®Œæ•´çš„æ¶ˆæ¯è½¬å‘ã€‚ å®Œæ•´çš„æ¶ˆæ¯è½¬å‘â€‹ åˆ°äº†è¿™ä¸€æ­¥çš„æ—¶å€™å°±æ˜¯æœ€åæŒ½æ•‘æœªè§£è¯»æ¶ˆæ¯çš„æ—¶å€™ï¼Œåœ¨è¿™æ­¥é¦–å…ˆè¦åˆ›å»ºNSInvocationå¯¹è±¡ï¼Œç„¶åæŠŠæœªå¤„ç†çš„æ¶ˆæ¯çš„æ‰€æœ‰çš„ç»†èŠ‚éƒ½æ·»åŠ åˆ°æ­¤ï¼Œæ­¤å¯¹è±¡ä¸­åŒ…å«äº†é€‰æ‹©å­ï¼Œç›®æ ‡ï¼Œä»¥åŠå‚æ•°ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬åŒæ ·çš„å¯ä»¥æ”¹å˜è°ƒç”¨ç›®æ ‡ï¼Œä½¿æ¶ˆæ¯åœ¨æ–°ç›®æ ‡ä¸Šè°ƒç”¨ï¼Œè¿™ä¸ªå°±å’Œç¬¬äºŒæ­¥ä¸­çš„æ“ä½œå…¶å®æ˜¯ç­‰æ•ˆçš„äº†ã€‚æˆ‘ä»¬è¿˜å¯ä»¥åœ¨æ¶ˆæ¯è§¦å‘å‰å¯¹æ¶ˆæ¯è¿›è¡Œå…¶å®ƒçš„ä¿®æ”¹ï¼Œæ¯”å¦‚æ”¹å˜æ¶ˆæ¯å†…å®¹ï¼Œå¢åŠ æ¶ˆæ¯çš„å‚æ•°ï¼Œæ›´æ”¹æ¶ˆæ¯çš„ç›®æ ‡ã€‚å¦‚æœæ­¤æ¶ˆæ¯ä¸åº”è¯¥ç”±æœ¬ç±»æ¥å¤„ç†ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨è¶…ç±»çš„åŒåæ–¹æ³•æ¥å¤„ç†ã€‚å¦‚æœæœ€ç»ˆè¿˜æ˜¯æœªè¢«å¤„ç†ï¼Œåˆ™è¿˜æ˜¯ä¼šè°ƒç”¨doseNotRecognizeSelectorï¼Œä»¥æŠ›å‡ºå¼‚å¸¸ï¼Œè¡¨ç¤ºè¿™æ¡æ¶ˆæ¯æœ€ç»ˆæœªèƒ½å¾—åˆ°å¤„ç†ï¼Œå¯¼è‡´ç¨‹åºå´©æºƒã€‚ æ•´ä¸ªæ¶ˆæ¯è½¬å‘æµç¨‹å›¾å¦‚ä¸‹ï¼š","categories":[],"tags":[{"name":"runtimeâ€‹","slug":"runtimeâ€‹","permalink":"Aaronzjp.cn/tags/runtimeâ€‹/"}]},{"title":"iOSå‘é€æ¶ˆæ¯","slug":"objc-msgSend","date":"2016-09-08T14:23:28.000Z","updated":"2017-07-27T02:53:39.000Z","comments":true,"path":"2016/09/08/objc-msgSend/","link":"","permalink":"Aaronzjp.cn/2016/09/08/objc-msgSend/","excerpt":"â€‹ OC è¯­è¨€ä¸­ï¼Œå¯¹è±¡è°ƒç”¨æ–¹æ³•æˆ‘ä»¬ç§°ä¹‹ä¸ºå‘é€æ¶ˆæ¯ï¼Œæˆ–è€…å«åšâ€œä¼ é€’æ¶ˆæ¯â€ï¼ˆpass a messageï¼‰ã€‚æ¶ˆæ¯å…·æœ‰â€œåç§°â€ï¼ˆnameï¼‰æˆ–â€œé€‰æ‹©å­â€ï¼ˆselectorï¼‰ï¼Œå®é™…ä¸Šå°±æ˜¯æ–¹æ³•åç§°ï¼Œå¯ä»¥æ¥å—å‚æ•°ï¼Œä¹Ÿå¯ä»¥æœ‰è¿”å›å€¼ã€‚åœ¨ OC ä¸­æˆ‘ä»¬æ˜¯è¿™æ ·å‘é€æ¶ˆæ¯çš„ï¼Œç»“æ„å¦‚ä¸‹ï¼š id retrunValue = [someObject messageName:parameter];","text":"â€‹ OC è¯­è¨€ä¸­ï¼Œå¯¹è±¡è°ƒç”¨æ–¹æ³•æˆ‘ä»¬ç§°ä¹‹ä¸ºå‘é€æ¶ˆæ¯ï¼Œæˆ–è€…å«åšâ€œä¼ é€’æ¶ˆæ¯â€ï¼ˆpass a messageï¼‰ã€‚æ¶ˆæ¯å…·æœ‰â€œåç§°â€ï¼ˆnameï¼‰æˆ–â€œé€‰æ‹©å­â€ï¼ˆselectorï¼‰ï¼Œå®é™…ä¸Šå°±æ˜¯æ–¹æ³•åç§°ï¼Œå¯ä»¥æ¥å—å‚æ•°ï¼Œä¹Ÿå¯ä»¥æœ‰è¿”å›å€¼ã€‚åœ¨ OC ä¸­æˆ‘ä»¬æ˜¯è¿™æ ·å‘é€æ¶ˆæ¯çš„ï¼Œç»“æ„å¦‚ä¸‹ï¼š id retrunValue = [someObject messageName:parameter]; OCä¸­çš„æ¶ˆæ¯ä¼ é€’å°±å¦‚åŒä¸Šé¢åˆ†è§£å‡ºæ¥çš„ç»“æ„ä¸€æ ·ã€‚å…¶ä¸­returnValueæ˜¯è¿”å›å€¼ï¼›someObjectæ˜¯æ¥å—è€…ï¼Œå³è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„å¯¹è±¡ï¼›messageName:æ˜¯é€‰æ‹©å­ï¼Œå³æ–¹æ³•åç§°ï¼›parameteræ˜¯å‚æ•°ï¼Œå³è°ƒç”¨æ–¹æ³•çš„æ—¶å€™ä¼ å…¥çš„å‚æ•°ã€‚é€‰æ‹©å­ï¼ˆselectorï¼‰ä¸å‚æ•°ï¼ˆparameterï¼‰åˆèµ·æ¥å°±æ˜¯æˆ‘ä»¬ç§°ä¸ºçš„â€œæ¶ˆæ¯â€ã€‚åœ¨ç¨‹åºç¼–è¯‘æœŸçš„æ—¶å€™ï¼Œæ‰€æœ‰ç±»ä¼¼è¿™æ ·çš„æ¶ˆæ¯æœ€ç»ˆéƒ½ä¼šè¢«è½¬æ¢æˆä¸€æ¡æ ‡å‡†çš„Cè¯­è¨€å‡½æ•°å†…ä¾›ç¨‹åºè°ƒç”¨ï¼Œå…¶ç»“æ„å¦‚ä¸‹ï¼š id objc_msgSend ( id self, SEL cmd, ... ); è¿™æ˜¯ä¸€ä¸ªå‚æ•°ä¸ªæ•°å¯å˜çš„å‡½æ•°ï¼Œèƒ½å¤Ÿæ¥æ”¶å¤šä¸ªçš„å‚æ•°ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°ä»£è¡¨æ¥æ”¶è€…ï¼Œç¬¬äºŒä¸ªå‚æ•°ä»£ç é€‰æ‹©å­ï¼ˆSELæ˜¯é€‰æ‹©å­çš„ç±»å‹ï¼‰ï¼Œåé¢å…¶ä»–çš„æ¶ˆæ¯å°±æ˜¯å‘é€æ¶ˆæ¯ä¸­æ‰€ä¼ å…¥çš„å‚æ•°ã€‚ è®²ä¸Šé¢çš„é‚£ä¸ªOCçš„ä¾‹å­è½¬æ¢åçš„åŸå‹å¦‚ä¸‹ï¼š id returnValue = objc_msgSend(someObject, @selector(messageName:),parameter); åœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™objc_msgSendå‡½æ•°ä¼šæ ¹æ®æ¥å—è€…å’Œé€‰æ‹©å­åœ¨ç›¸å¯¹åº”çš„ç±»ä¸­æŸ¥æ‰¾æ–¹æ³•ï¼Œåœ¨å¯¹åº”ç±»ä¸­æœ‰ä¸€ä¸ªâ€œæ–¹æ³•åˆ—è¡¨â€å¦‚æœèƒ½æ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•å°±æ‰§è¡Œæ­¤æ–¹æ³•ï¼Œè‹¥ä¸èƒ½å°±æ²¿ç€ç»§æ‰¿ä½“å‘ä¸Šçˆ¶ç±»ç»§ç»­æŸ¥æ‰¾ï¼Œå¦‚æœæœ€ç»ˆè¿˜æ˜¯æ‰¾ä¸åˆ°ç›¸å¯¹åº”çš„æ–¹æ³•å°±ä¼šæ‰§è¡Œâ€œæ¶ˆæ¯è½¬å‘ï¼ˆmessage forwardingï¼‰â€ã€‚ â€‹ åœ¨è°ƒç”¨æ–¹æ³•çš„æ—¶å€™æ‰§è¡Œçš„æ­¥éª¤å¾ˆå¤šï¼Œä½†æ˜¯objc_msgSendä¼šå°†åŒ¹é…åˆ°çš„æ–¹æ³•åˆ—è¡¨ä¸­çš„æ–¹æ³•ç¼“å­˜èµ·æ¥ï¼Œå…¶ç¼“å­˜åœ¨ä¸€ä¸ªå«â€œå¿«é€Ÿæ˜ å°„è¡¨â€é‡Œé¢ã€‚æ¯ä¸€ä¸ªç±»éƒ½æœ‰è¿™æ ·çš„ä¸€å—ç¼“å­˜ï¼Œåœ¨è¯¥ç±»ä¸‹æ¬¡å†æ‰§è¡Œç›¸åŒçš„æ¶ˆæ¯çš„æ—¶å€™å°±ä¼šä¼˜å…ˆä»â€œå¿«é€Ÿæ˜ å°„è¡¨â€ä¸­æŸ¥æ‰¾ï¼Œè€Œé€‰æ‹©å­å°±æ˜¯æŸ¥æ‰¾æ–¹æ³•æ—¶æ‰€ç”¨åˆ°çš„é”®ã€‚ objc_object, objc_class ä»¥åŠ Ojbc_methodåœ¨OCä¸­ï¼Œç±»ï¼Œå¯¹è±¡å’Œæ–¹æ³•å…¶å®éƒ½æ˜¯ä¸€ä¸ªCçš„ç»“æ„ä½“ï¼Œè¿™ç‚¹æˆ‘å¿™åœ¨objc/objc.hå’Œruntime.hçš„æ–‡ä»¶ä¸­å°±èƒ½æ‰¾åˆ°ä»–ä»¬çš„å®šä¹‰ã€‚ 1234567891011121314151617181920212223242526272829#if !OBJC_TYPES_DEFINED/// An opaque type that represents an Objective-C class.typedef struct objc_class *Class;/// Represents an instance of a class.struct objc_object &#123; Class isa OBJC_ISA_AVAILABILITY;&#125;;/// A pointer to an instance of a class.typedef struct objc_object *id;#endifstruct objc_class &#123; Class isa OBJC_ISA_AVAILABILITY;#if !__OBJC2__ Class super_class OBJC2_UNAVAILABLE; const char *name OBJC2_UNAVAILABLE; long version OBJC2_UNAVAILABLE; long info OBJC2_UNAVAILABLE; long instance_size OBJC2_UNAVAILABLE; struct objc_ivar_list *ivars OBJC2_UNAVAILABLE; struct objc_method_list **methodLists OBJC2_UNAVAILABLE; struct objc_cache *cache OBJC2_UNAVAILABLE; struct objc_protocol_list *protocols OBJC2_UNAVAILABLE;#endiftypedef struct objc_method *Method; objc_objectå®é™…ä¸Šæ˜¯ä¸€ä¸ªæŒ‡å‘ Class ç»“æ„ä½“ç±»å‹çš„æŒ‡é’ˆï¼ŒæŒ‡å‘å¯¹è±¡çš„ç±»ï¼Œè€Œ Class ä¸­ä¹Ÿæœ‰ä¸€ä¸ª isa æŒ‡é’ˆï¼ŒæŒ‡å‘äº†å…ƒç±»ï¼Œå…ƒç±»ä¸­åˆ™å­˜å‚¨äº†è¯¥ç±»çš„æ–¹æ³•åˆ—è¡¨objc_method_listã€‚ objc_method_list æœ¬è´¨æ˜¯ä¸€ä¸ªæœ‰ objc_method å…ƒç´ çš„å¯å˜é•¿åº¦çš„æ•°ç»„ã€‚ä¸€ä¸ª objc_method ç»“æ„ä½“ä¸­æœ‰å‡½æ•°åï¼Œä¹Ÿå°±æ˜¯SELï¼Œæœ‰è¡¨ç¤ºå‡½æ•°ç±»å‹çš„å­—ç¬¦ä¸²ï¼Œä»¥åŠå‡½æ•°çš„å®ç°IMPã€‚ objc_classå°±æ˜¯å‰é¢è¯´åˆ°çš„è¢«objc_objectä¸­é‚£ä¸ª isa æŒ‡é’ˆæ‰€æŒ‡å‘çš„ Class çš„ç±»äº†ã€‚è¿™ä¸ªobjc_classå…¶å®æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œå…¶ä¸­åœ¨è¿™ä¸ªç»“æ„ä½“ä¸­å°±åŒ…å«äº†å¾ˆå¤šè¿™ä¸ªç±»çš„ä¿¡æ¯ã€‚å…¶ä¸­å°±åŒ…æ‹¬äº†ä¸Šæ–‡ä¸­æåˆ°çš„å‚¨å­˜è¿™ä¸ªç±»ä¸­å½“å‰æ–¹æ³•çš„é“¾è¡¨objc_method_listå’Œå‚¨å­˜è¿™ä¸ªç±»ä¸­è¢«æ‰§è¡Œè¿‡çš„æ–¹æ³•çš„ç¼“å­˜objc_cacheç­‰ç›¸å…³çš„ä¿¡æ¯ã€‚ æ€»ç»“é‚£ä¹ˆæ€»ç»“æ¥è¯´å½“åœ¨ä»£ç ä¸­å†™ä¸‹ä¸€ä¸ª OC è¯­è¨€å‘é€çš„æ¶ˆæ¯åï¼Œé‚£ä¹ˆè¿™æ¡ OC è¯­è¨€çš„æ¶ˆæ¯é¦–å…ˆç»è¿‡ç¼–è¯‘å™¨ï¼Œå°±ä¼šè¢«ç¼–è¯‘å™¨è½¬æ¢æˆè¿™æ ·ç±»ä¼¼ç»“æ„çš„ä¸€æ¡ C è¯­è¨€å‡½æ•°ï¼š id objc_msgSend ( id self, SEL cmd, ... ); ä¸¾ä¸ªä¾‹å­ğŸŒ°ï¼š objc_msgSend(dog,@selector(eat:),) 1.é¦–å…ˆè¿™ä¸ªå‡½æ•°å°±ä¼šæ ¹æ®ä¼ å…¥çš„dogè¿™ä¸ªç±»çš„ isa æŒ‡é’ˆæ‰¾åˆ°ä»–çš„ classå³objc_class 2.åœ¨ class ä¸­æ‰¾åˆ°è¿™ä¸ªç±»çš„æ‰€æœ‰çš„ç›¸å…³ä¿¡æ¯ 3.ç„¶åä¼šé¦–å…ˆçš„ä» class ä¸­çš„objc_cacheå»æŸ¥æ‰¾eat æ–¹æ³• 4.å¦‚æœåœ¨objc_cacheä¸­æ²¡æœ‰æ‰¾åˆ° eat è¿™ä¸ªæ–¹æ³•ï¼Œåˆ™è¯´æ˜ eat æ–¹æ³•æ²¡æœ‰è¢«æ‰§è¡Œè¿‡ï¼Œåœ¨ç¼“å­˜ä¸­æ²¡æœ‰ 5.ç„¶åè¿›ä¸€æ­¥åˆ°è¿™ä¸ªç±»ä¸­çš„objc_method_listä¸­æ‰¾å’Œé€‰æ‹©å™¨ä¸­å¯¹åº”çš„æ–¹æ³•eat 6.å¦‚æœåœ¨ class ä¸­æ²¡æœ‰æ‰¾åˆ°ç›¸å…³çš„æ–¹æ³•ï¼Œåˆ™ä¼šç»§ç»­å‘ä¸ŠæŸ¥æ‰¾ï¼Œåœ¨çˆ¶ç±»ï¼ˆsuper_classï¼‰ä¸­å»æ‰¾ç›¸å¯¹åº”çš„æ–¹æ³• 7.ä¸€æ—¦æ‰¾åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œå°±å»æ‰§è¡Œå®ƒçš„å®ç° IMPã€‚ ä½†æ˜¯å¦‚æœæœ€ç»ˆä¸€ç›´éƒ½æ²¡æœ‰æ‰¾åˆ° eat è¿™ä¸ªç›¸å¯¹åº”çš„æ–¹æ³•å‘¢ï¼Ÿé€šå¸¸ç¨‹åºå°±ä¼šcrashå¹¶æŠ›å‡ºå¼‚å¸¸ï¼Œä½†æ˜¯åœ¨æŠ›å‡ºå¼‚å¸¸å‰é¦–å…ˆä¼šæ‰§è¡Œæ¶ˆæ¯è½¬å‘ï¼Œå…³äºæ¶ˆæ¯è½¬å‘çš„ç›¸å…³å­¦ä¹ å’Œç¬”è®°æˆ‘å°†ä¼šåœ¨ä¸‹ä¸€ç¯‡çš„åšå®¢ä¸­æ•´ç†å‡ºæ¥ã€‚","categories":[],"tags":[{"name":"runtime","slug":"runtime","permalink":"Aaronzjp.cn/tags/runtime/"}]},{"title":"iOS-å¯¹è±¡å…³è”","slug":"Associated Object","date":"2016-08-18T10:35:51.000Z","updated":"2017-07-27T02:57:42.000Z","comments":true,"path":"2016/08/18/Associated Object/","link":"","permalink":"Aaronzjp.cn/2016/08/18/Associated Object/","excerpt":"å…³è”å¯¹è±¡å°±æ˜¯ç»™æŸä¸ªå¯¹è±¡å…³è”ä¸€äº›å…¶ä»–çš„å¯¹è±¡ï¼Œè¿™äº›è¢«å…³è”çš„å¯¹è±¡é€šè¿‡é”®ï¼ˆkeyï¼‰æ¥åŒºåˆ†ç®¡ç†ã€‚æ¯”å¦‚ï¼š æœ‰ä¸€ä¸ªPersonç±»ï¼ŒAaronæ˜¯è¿™ä¸ªPersonç±»çš„å®ä¾‹ä¹Ÿå°±æ˜¯å¯¹è±¡ã€‚ç°åœ¨åˆå¢åŠ äº†ä¸€ä¸ªCarç±»ï¼Œä¸”æœ‰ä¸€ä¸ªAudiçš„å®ä¾‹ï¼Œæˆ‘ä»¬éœ€è¦ç»™Aaronå®ä¾‹å¢åŠ å…³è”ä¸€è¾†Audiè½¦ã€‚æ˜¾ç„¶å¸¸è§„çš„åšæ³•æ˜¯æŠŠCarç±»ä½œä¸ºå±æ€§æ·»åŠ åˆ°Aaronä¸­ï¼Œä½†æ˜¯åœ¨æœ‰çš„æŸäº›ç‰¹æ®Šçš„æƒ…å†µä¸‹æˆ‘ä»¬æ— æ³•å¯¹Aaronè¿™ä¸ªå®ä¾‹ç›´æ¥è¿›è¡Œæ“ä½œï¼Œä¹Ÿæ— æ³•é€šè¿‡ç»§æ‰¿å»æ“ä½œï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨å…³è”å¯¹è±¡æ¥è§£å†³è¿™ä¸ªé—®é¢˜äº†ã€‚","text":"å…³è”å¯¹è±¡å°±æ˜¯ç»™æŸä¸ªå¯¹è±¡å…³è”ä¸€äº›å…¶ä»–çš„å¯¹è±¡ï¼Œè¿™äº›è¢«å…³è”çš„å¯¹è±¡é€šè¿‡é”®ï¼ˆkeyï¼‰æ¥åŒºåˆ†ç®¡ç†ã€‚æ¯”å¦‚ï¼š æœ‰ä¸€ä¸ªPersonç±»ï¼ŒAaronæ˜¯è¿™ä¸ªPersonç±»çš„å®ä¾‹ä¹Ÿå°±æ˜¯å¯¹è±¡ã€‚ç°åœ¨åˆå¢åŠ äº†ä¸€ä¸ªCarç±»ï¼Œä¸”æœ‰ä¸€ä¸ªAudiçš„å®ä¾‹ï¼Œæˆ‘ä»¬éœ€è¦ç»™Aaronå®ä¾‹å¢åŠ å…³è”ä¸€è¾†Audiè½¦ã€‚æ˜¾ç„¶å¸¸è§„çš„åšæ³•æ˜¯æŠŠCarç±»ä½œä¸ºå±æ€§æ·»åŠ åˆ°Aaronä¸­ï¼Œä½†æ˜¯åœ¨æœ‰çš„æŸäº›ç‰¹æ®Šçš„æƒ…å†µä¸‹æˆ‘ä»¬æ— æ³•å¯¹Aaronè¿™ä¸ªå®ä¾‹ç›´æ¥è¿›è¡Œæ“ä½œï¼Œä¹Ÿæ— æ³•é€šè¿‡ç»§æ‰¿å»æ“ä½œï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨å…³è”å¯¹è±¡æ¥è§£å†³è¿™ä¸ªé—®é¢˜äº†ã€‚ æ€ä¹ˆå…³è”å¯¹è±¡å¦‚ä½•å…³è”å¯¹è±¡ï¼Ÿè‹¹æœæ—©å°±ä¸ºæˆ‘ä»¬æä¾›äº†å…³è”å¯¹è±¡çš„æ–¹æ³•ï¼š //é€šè¿‡è®¾ç½®é”®ï¼ˆkeyï¼‰å’Œå…³è”å¯¹è±¡ä»¥åŠè¢«ç®¡ç†å¯¹è±¡å’Œå†…å­˜å…³è”ç±»å‹æ¥å…³è”å¯¹è±¡ void objc_setAssociatedObject(id object, void *key, id value, objc_AssociationPolicy policy) //ä»å¯¹åº”çš„é”®ï¼ˆkeyï¼‰è·å–ç›¸å¯¹åº”çš„å…³è”å¯¹è±¡ id objc_getAssociatedObject(id object, void *key) //ç§»é™¤æŒ‡å®šå¯¹è±¡çš„å…¨éƒ¨å…³è”å¯¹è±¡ã€‚ä¸€èˆ¬ä¸è¿™æ ·åšï¼Œå› ä¸ºä¼šç§»é™¤æ‰€æœ‰çš„å…³è”å¯¹è±¡ï¼Œå¦‚ä¸éœ€è¦çš„æ—¶å€™åªè¦å…³è”å¯¹è±¡ä¸ºnilå³å¯ void objc_removeAssociatedObjects(id object) å‚æ•°è¯´æ˜ï¼š id object ï¼šè¢«å…³è”çš„å¯¹è±¡ const void *key ï¼šè¢«å…³è”å¯¹è±¡çš„é”®ï¼ˆkeyï¼‰æ­¤é”®æ˜¯ä¸€ä¸ªä¸é€æ˜çš„æŒ‡é’ˆï¼Œå³è¯¥æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®ä¸å±€é™äºæŸç§ç‰¹å®šçš„ç±»å‹ id value ï¼š å…³è”çš„å¯¹è±¡ objc_AssociationPolicy policy : å†…å­˜ç®¡ç†ç­–ç•¥ objc_AssociationPolicy policyæ˜¯ä¸€ä¸ªæšä¸¾å€¼ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªæšä¸¾å€¼å¯¹åº”äº†å…³è”å¯¹è±¡çš„å­˜å‚¨ç­–ç•¥ï¼Œå…¶ä¸­å¦‚æœä¸å…¶@propertyå¯¹åº”çš„ç­–ç•¥å¦‚ä¸‹ï¼š å…³è”ç±»å‹ ä¸ä¹‹ç­‰æ•ˆçš„@propertyå±æ€§ OBJC_ASSOCIATION_ASSIGN assign OBJC_ASSOCIATION_RETAIN_NONATOMIC nonatomic,retain OBJC_ASSOCIATION_COPY_NONATOMIC nonatomic,copy OBJC_ASSOCIATION_RETAIN retain OBJC_ASSOCIATION_COPY copy å…³è”å¯¹è±¡çš„ä½¿ç”¨å¦‚åœ¨å½“å‰æ§åˆ¶å™¨éœ€è¦å¼¹å‡ºä¸€ä¸ªAlertViewï¼Œä½†æ˜¯åœ¨æœ‰å¾ˆå¤šè¿™æ ·çš„ä¿¡æ¯è¦å¤„ç†çš„æ—¶å€™ï¼Œä»£ç å°±ä¼šæ˜¾å¾—å¾ˆä¹±ã€‚ä½†æ˜¯æˆ‘ä»¬åœ¨åˆ›å»ºalertViewçš„æ—¶å€™å°±æŠŠæ¯ä¸ªæŒ‰é’®ç‚¹å‡»åçš„äº‹ä»¶å†™å¥½å°±çœ‹èµ·æ¥ç®€æ´å¤šäº†ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142#import &quot;ViewController.h&quot;#import &lt;objc/runtime.h&gt;static void *AlertViewTest = &quot;AlertViewTest&quot;;@interface ViewController () &lt;UIAlertViewDelegate&gt;@end@implementation ViewController- (void)viewDidLoad &#123; [super viewDidLoad]; // Do any additional setup after loading the view, typically from a nib.&#125;- (IBAction)alertViewClicked:(UIButton *)sender &#123; UIAlertView *alertView = [[UIAlertView alloc]initWithTitle:@&quot;AlertViewå¼¹å‡º&quot; message:@&quot;å¯¹è±¡å…³è”çš„ç»ƒä¹ &quot; delegate:self cancelButtonTitle:@&quot;å–æ¶ˆ&quot; otherButtonTitles:@&quot;ç¡®å®š&quot;, nil]; //block,ç‚¹å‡»åå¤„ç†çš„block void (^alertViewClicked) (NSInteger) = ^(NSInteger buttonIndex) &#123; NSLog(@&quot;ä½ ç‚¹å‡»äº†ç¬¬ %ld ä¸ªæŒ‰é’®&quot;,buttonIndex); &#125;; //æŠŠblockå…³è”åˆ°alertViewä¸­ objc_setAssociatedObject(alertView, AlertViewTest, alertViewClicked, OBJC_ASSOCIATION_COPY); [alertView show]; &#125;- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex &#123; //ä»alertViewä¸­è·å–è¢«å…³è”çš„block void (^alertViewClicked) (NSInteger) = objc_getAssociatedObject(alertView, AlertViewTest); //è°ƒç”¨blockï¼Œä»¥æ¥å¤„ç†alertViewæŒ‰é’®è¢«ç‚¹å‡»åçš„å“åº” alertViewClicked(buttonIndex);&#125;@end å…³è”å¯¹è±¡çš„ä»‹ç»å’Œç”¨æ³•å¤§è‡´å°±æ˜¯è¿™æ ·ï¼Œè™½ç„¶ä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œå¥½ç”¨ã€‚ä½†æ˜¯åœ¨é¡¹ç›®ä¸­æˆ‘è§‰å¾—è¿˜æ˜¯å°½é‡é¿å…ä½¿ç”¨è¿™æ ·çš„æ–¹æ³•ï¼Œå› ä¸ºå¯¹è±¡å…³è”é¢‘ç¹å¤§é‡çš„ä½¿ç”¨ä¼šå¯¹é¡¹ç›®åæœŸçš„è°ƒè¯•å’Œç»´æŠ¤é€ æˆå›°éš¾ï¼Œä¸€æ—¦è¿™é‡Œå‡ºç°é—®é¢˜å°±ä¼šå¾ˆéš¾å†bugæŸ¥æ‰¾è°ƒè¯•ä¸­æ‰¾åˆ°é—®é¢˜æ‰€åœ¨ã€‚","categories":[],"tags":[{"name":"runtime","slug":"runtime","permalink":"Aaronzjp.cn/tags/runtime/"}]},{"title":"iOSç½‘ç»œç¼–ç¨‹NSURLConnectionï¼NSURLSession","slug":"iOS-NetWork-Programming-NSURLConnectionAndNSURLSession","date":"2016-08-11T04:16:49.000Z","updated":"2017-07-27T02:56:59.000Z","comments":true,"path":"2016/08/11/iOS-NetWork-Programming-NSURLConnectionAndNSURLSession/","link":"","permalink":"Aaronzjp.cn/2016/08/11/iOS-NetWork-Programming-NSURLConnectionAndNSURLSession/","excerpt":"iOSç½‘ç»œç¼–ç¨‹æ˜¯æœ€åŸºç¡€å¸¸ç”¨çš„çŸ¥è¯†ï¼Œå¯ä»¥è¯´æ˜¯ä»å¼€å§‹å­¦ä¹ iOSçš„æ—¶å€™å°±åº”è¯¥è¦å¿…å¤‡çš„åŸºç¡€çŸ¥è¯†ã€‚ä½†æ˜¯å¹³å¸¸åœ¨é¡¹ç›®ä¸­éƒ½ä½¿ç”¨æ¯”è¾ƒæˆç†Ÿçš„ç¬¬ä¸‰æ–¹ç½‘ç»œè¯·æ±‚çš„æ¡†æ¶ï¼ˆæ¯”å¦‚ï¼šAFNetworkingï¼‰æ¥æ›¿ä»£äº†è‹¹æœå®˜æ–¹æ‰€æä¾›çš„ç½‘ç»œè¯·æ±‚APIï¼Œå¯¹è‹¹æœæä¾›çš„APIç›¸å…³çš„ä¸œè¥¿å°±é€æ¸çš„å¿½ç•¥äº†ã€‚ä¸ºäº†ç†è§£å…¶ç›¸å…³çŸ¥è¯†å’ŒåŸç†ï¼Œæ‰€ä»¥å¯¹è¿™å—çŸ¥è¯†å¤ä¹ ä¸€ä¸‹ï¼Œé¡ºä¾¿æ•´ç†æˆåšå®¢ã€‚","text":"iOSç½‘ç»œç¼–ç¨‹æ˜¯æœ€åŸºç¡€å¸¸ç”¨çš„çŸ¥è¯†ï¼Œå¯ä»¥è¯´æ˜¯ä»å¼€å§‹å­¦ä¹ iOSçš„æ—¶å€™å°±åº”è¯¥è¦å¿…å¤‡çš„åŸºç¡€çŸ¥è¯†ã€‚ä½†æ˜¯å¹³å¸¸åœ¨é¡¹ç›®ä¸­éƒ½ä½¿ç”¨æ¯”è¾ƒæˆç†Ÿçš„ç¬¬ä¸‰æ–¹ç½‘ç»œè¯·æ±‚çš„æ¡†æ¶ï¼ˆæ¯”å¦‚ï¼šAFNetworkingï¼‰æ¥æ›¿ä»£äº†è‹¹æœå®˜æ–¹æ‰€æä¾›çš„ç½‘ç»œè¯·æ±‚APIï¼Œå¯¹è‹¹æœæä¾›çš„APIç›¸å…³çš„ä¸œè¥¿å°±é€æ¸çš„å¿½ç•¥äº†ã€‚ä¸ºäº†ç†è§£å…¶ç›¸å…³çŸ¥è¯†å’ŒåŸç†ï¼Œæ‰€ä»¥å¯¹è¿™å—çŸ¥è¯†å¤ä¹ ä¸€ä¸‹ï¼Œé¡ºä¾¿æ•´ç†æˆåšå®¢ã€‚ ç›®å‰åœ¨iOSçš„Foundationæ¡†æ¶ä¸­æä¾›çš„åŸç”Ÿçš„ç½‘ç»œè®¿é—®ç±»ä¸»è¦ç”±ä¸¤ä¸ªï¼ŒNSURLConnection å’Œ NSURLSession ï¼Œå…¶ä¸­ NSURLConnection æ˜¯åœ¨2003å¹´ä» iOS 2.0+ éšç€Safariçš„å‘å¸ƒå°±å‘å¸ƒäº†ï¼ŒNSURLSession æ˜¯ä» iOS 7.0+ å‡ºç°çš„ï¼Œå…¶ç›®çš„å°±æ˜¯ä½œä¸ºNSURLConnection çš„æ›¿æ¢ï¼Œä½†æ˜¯ç›®å‰æ¥è¯´ NSURLConnection è¿˜æ˜¯ä¸èƒ½å®Œå…¨çš„è¢«æ›¿æ¢çš„ï¼ŒNSURLSession æ€»çš„æ¥è¯´ä½œä¸º NSURLConnection çš„æ›¿æ¢æ¥è¯´ï¼Œå¯¹æ¯” NSURLConnection è¿˜æ˜¯æœ‰å¾ˆå¤šä¼˜åŒ–çš„ã€‚NSURLSession é’ˆå¯¹ä¸‹è½½ï¼ä¸Šä¼ ï¼Œæ–­ç‚¹ç»­ä¼ ï¼Œåå°ä¸‹è½½ç­‰æä¾›äº†ä¸“é—¨çš„è§£å†³æ–¹æ¡ˆã€‚ ç½‘ç»œè¯·æ±‚æ–¹æ³•ï¼ˆGETï¼POSTï¼‰ç½‘ç»œè¯·æ±‚è¿™é‡Œå°±è¦è¯´åˆ° HTTPï¼HTTPS ç½‘ç»œåè®®ï¼Œè¯¥åè®®è§„å®šäº†ç½‘ç»œé€šä¿¡çš„ä¸€äº›æ ‡å‡†ï¼Œç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ã€‚åè€… HTTPS æ˜¯åŸºäº HTTP åè®®è¿›è¡Œä¸€å±‚åŠ å¯†åçš„ç½‘ç»œåè®®ï¼Œæ‰€ä¼ è¾“çš„æ•°æ®éƒ½æ˜¯ç»è¿‡åŠ å¯†ï¼Œç›¸å¯¹äº HTTP æ¥è¯´è¦å®‰å…¨ã€‚ ä½¿ç”¨ HTTPï¼HTTPS åè®®å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œé¦–å…ˆå®¢æˆ·ç«¯ä¼šå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œåœ¨æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚åå†å°†å®¢æˆ·ç«¯è¯·æ±‚çš„æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚è¯·æ±‚çš„æ–¹æ³•æœ‰å¦‚ä¸‹å‡ ç§ï¼š æ–¹æ³• æè¿° GET ä»æŒ‡å®šçš„èµ„æºè¯·æ±‚æ•°æ®ã€‚ POST å‘æŒ‡å®šçš„èµ„æºæäº¤è¦è¢«å¤„ç†çš„æ•°æ®ã€‚ HEAD ä¸ GET ç›¸åŒï¼Œä½†åªè¿”å› HTTP æŠ¥å¤´ï¼Œä¸è¿”å›æ–‡æ¡£ä¸»ä½“ã€‚ PUT ä¸Šä¼ æŒ‡å®šçš„ URI è¡¨ç¤ºã€‚ DELETE åˆ é™¤æŒ‡å®šèµ„æºã€‚ OPTIONS è¿”å›æœåŠ¡å™¨æ”¯æŒçš„ HTTP æ–¹æ³•ã€‚ CONNECT æŠŠè¯·æ±‚è¿æ¥è½¬æ¢åˆ°é€æ˜çš„ TCP/IP é€šé“ã€‚ å…¶ä¸­å¸¸ç”¨çš„å°±æ˜¯ GET å’Œ POST æ–¹æ³•ã€‚ GET è¯·æ±‚æ˜¯å°†æ•°æ®æ‹¼æ¥åœ¨ URL ä¹‹åå‘èµ·çš„æ˜æ–‡æ•°æ®è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥è¯·æ±‚å¯ä»¥å¾ˆæ˜æ˜¾çš„åœ¨ URL ä¸­çœ‹åˆ°è¯·æ±‚æ—¶å‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®ï¼Œè€Œä¸” GET è¯·æ±‚æ—¶æäº¤çš„æ•°æ®æ˜¯æœ‰é•¿åº¦é™åˆ¶çš„ã€‚æ‰€ä»¥ GET è¯·æ±‚ä¸€èˆ¬ç”¨æ¥å•çº¯çš„ä»æœåŠ¡å™¨å–å›æ•°æ®ï¼Œæˆ–è€…æäº¤ä¸€äº›æ— å…³ç´§è¦çš„æ•°æ®ç»™æœåŠ¡å™¨ã€‚å…¶å®å½“æµè§ˆç½‘ç«™çš„æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨ç½‘å€æ è¾“å…¥çš„ç½‘å€å°±æ˜¯ä¸€ç§ GET è¯·æ±‚ï¼Œé€šè¿‡è¯¥è¯·æ±‚ä»æœåŠ¡å™¨å–å›ç½‘é¡µæ•°æ®ï¼Œç„¶åé€šè¿‡æµè§ˆå™¨è§£ææ¸²æŸ“ç„¶åæ˜¾ç¤ºåœ¨æµè§ˆå™¨çª—å£ã€‚ POST è¯·æ±‚æ˜¯å°†æ•°æ®æ”¾åœ¨è¯·æ±‚ä½“ä¸­å‘å‡ºçš„è¯·æ±‚ï¼Œç›¸å¯¹äº GET è¯·æ±‚æ¥è¯´æ›´åŠ å®‰å…¨ï¼Œä¸” PSOT è¯·æ±‚æäº¤çš„æ•°æ®æ˜¯æ²¡æœ‰é•¿åº¦é™åˆ¶çš„ã€‚POST ç›¸å¯¹äº GET è¯·æ±‚æ›´åŠ é€‚åˆç”¨æ¥å‘æœåŠ¡å™¨æäº¤æ•°æ®ã€‚ NSURLConnection ä½¿ç”¨æ­¥éª¤NSURLConnection çš„ä¸€èˆ¬ä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š 1.NSURLï¼Œç½‘ç»œè¯·æ±‚åœ°å€ï¼Œå³å¾…è¯·æ±‚çš„ç½‘ç»œèµ„æºçš„è·¯å¾„ã€‚ï¼ˆURLç›¸å…³çš„å¯æŸ¥çœ‹ç½‘ç»œåè®®ï¼‰ 2.è®¾ç½®è¯·æ±‚ï¼ŒNSURLRequestï¼NSMutableURLRequestã€‚ä¸»è¦æ˜¯ç”¨ NSMutableURLRequest ï¼Œå› ä¸º NSURLRequest ä¸€æ—¦åˆå§‹åŒ–å®Œæˆåå°±æ— æ³•ä¿®æ”¹äº†ã€‚ 3.è¿æ¥åˆ°ç½‘ç»œï¼Œå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚åœ¨è‹¹æœæä¾›çš„ API ä¸­å·²ç»å¯¹ç½‘ç»œè¯·æ±‚åšäº†åŒæ­¥è¯·æ±‚å’Œå¼‚æ­¥è¯·æ±‚çš„æ”¯æŒï¼ŒåŒæ­¥è¯·æ±‚ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œè€Œå¼‚æ­¥åˆ™ä¸ä¼šï¼Œå¼‚æ­¥è¯·æ±‚ä¸­è¯·æ±‚çš„å›è°ƒæ–¹å¼åˆ†ä¸º Block å’Œ Delegate ä¸¤ç§æ–¹å¼ã€‚ 4.æ¥æ”¶è¯·æ±‚åˆ°çš„æ•°æ® 5.å¯¹è¯·æ±‚åˆ°çš„æ•°æ®è¿›è¡Œè§£æå¤„ç†ç­‰ NSURLConnection çš„ä½¿ç”¨POST åŒæ­¥è¯·æ±‚ï¼š1234567891011121314151617181920//URLç½‘ç»œèµ„æºè¯·æ±‚ä½ç½®NSString *webLocation = @&quot;http://v.juhe.cn/todayOnhistory/queryEvent.php&quot;;NSString *parametersString = [NSString stringWithFormat:@&quot;date=%@&amp;key=%@&quot;,date,appKey];NSURL *url = [NSURL URLWithString:webLocation];//è®¾ç½®è¯·æ±‚ï¼Œè¯·æ±‚åœ°å€ã€ç¼“å­˜æ–¹å¼ã€è¯·æ±‚è¶…æ—¶æ—¶é—´NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:60];//è®¾ç½®è¯·æ±‚æ–¹æ³•,é»˜è®¤ä¸ºGET[request setHTTPMethod:@&quot;POST&quot;];//POSTè¯·æ±‚å‚æ•°ï¼Œè®¾ç½®åœ¨è¯·æ±‚ä½“ä¸­[request setHTTPBody:[parametersString dataUsingEncoding:NSUTF8StringEncoding]];//ç”¨äºæ¥æ”¶æœåŠ¡å™¨çš„å“åº”å’Œè¯·æ±‚é”™è¯¯ã€‚NSHTTPURLResponse *response;NSError * error = nil;//å‘é€åŒæ­¥ç½‘ç»œè¯·æ±‚NSData *data = [NSURLConnection sendSynchronousRequest:request returningResponse:&amp;response error:&amp;error];//è§£æJSONæ•°æ®ï¼Œè½¬æ¢æˆDictionary// NSDictionary *dic = [NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingMutableContainers error:nil];NSString *string = [[NSString alloc]initWithData:data encoding:NSUTF8StringEncoding];[self showAlertWith:string]; ä¸Šé¢ä¹Ÿæåˆ°äº†ï¼Œç½‘ç»œè¯·æ±‚APIï¼ŒNSURLConnectionã€NSURLSessionç­‰å·²ç»é’ˆå¯¹ç½‘ç»œè¯·æ±‚åšäº†çº¿ç¨‹çš„å¤„ç†ã€‚ä¸Šé¢è¿™æ®µä»£ç å‘èµ·çš„æ˜¯ä¸€ä¸ªåŒæ­¥è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥è¯·æ±‚ä¼šé˜»å¡ä½çº¿ç¨‹ç›´åˆ°ç½‘ç»œè¯·æ±‚å®Œæˆæ‰ä¼šè¿›ä¸€æ­¥çš„åšå…¶ä»–çš„å¤„ç†ï¼Œæ‰€ä»¥åŒæ­¥è¯·æ±‚æ˜¯æ— æ³•å–æ¶ˆçš„ã€‚ GET åŒæ­¥è¯·æ±‚ï¼šGET å’Œ POST è¯·æ±‚å…¶å®åœ¨ä½¿ç”¨ä¸Šæ­¥éª¤åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œåœ¨æ²¡æœ‰å¯¹ NSURLRequestï¼NSMutableURLRequest è¯·æ±‚æ–¹æ³•åšæ˜¾ç¤ºçš„è®¾ç½®çš„æ—¶å€™é»˜è®¤å‘èµ·çš„ç½‘ç»œè¯·æ±‚æ˜¯ GET è¯·æ±‚ã€‚ 123456789101112131415//URLç½‘ç»œè¯·æ±‚åœ°å€ï¼Œä»¥åŠè¯·æ±‚æäº¤çš„æ•°æ®NSString *webLocation = [NSString stringWithFormat:@&quot;http://v.juhe.cn/todayOnhistory/queryEvent.php?date=%@&amp;key=%@&quot;,date,appKey];NSURL *url = [NSURL URLWithString:webLocation];//è®¾ç½®è¯·æ±‚ï¼Œè¯·æ±‚åœ°å€ã€ç¼“å­˜æ–¹å¼ã€è¯·æ±‚è¶…æ—¶æ—¶é—´NSMutableURLRequest *request = [[NSMutableURLRequest alloc]initWithURL:url cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:60];//è®¾ç½®è¯·æ±‚æ–¹å¼ã€‚é»˜è®¤å°±æ—¶GETè¯·æ±‚ï¼Œå¯ä»¥ä¸è¦ä¸‹é¢è¿™æ®µä»£ç // [request setHTTPMethod:@&quot;GET&quot;];//ç”¨äºæ¥æ”¶æœåŠ¡å™¨çš„å“åº”å’Œè¯·æ±‚é”™è¯¯ã€‚NSHTTPURLResponse *response;NSError * error = nil;//å‘èµ·è¯·æ±‚NSData *data = [NSURLConnection sendSynchronousRequest:request returningResponse:&amp;response error:&amp;error];NSString *str = [[NSString alloc]initWithData:data encoding:NSUTF8StringEncoding];[self showAlertWith:str]; GET å¼‚æ­¥è¯·æ±‚ ï¼ˆBlockå›è°ƒæ–¹å¼ï¼‰åœ¨ä¸Šé¢çš„ä½¿ç”¨æ­¥éª¤ä¸­æåˆ°å¼‚æ­¥è¯·æ±‚å¯ä»¥åˆ†ä¸ºä¸¤ç§å›è°ƒæ–¹å¼ï¼ŒBlock å’Œ Delegateã€‚è¿™ä¸¤ç§æ–¹å¼åœ¨ GET å’Œ POST è¯·æ±‚ä¸­ä½¿ç”¨åŸºæœ¬éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å°±ä¸åˆ†åˆ«åœ¨ GET å’Œ POST ä¸­ä¸€ä¸€ä¸¾ä¾‹äº†ï¼Œä¸»è¦åœ¨å›è°ƒæ–¹å¼ä¸Šä½œå‡ºä¸¤ä¸ªä¾‹å­ã€‚ 12345678910111213NSString *webLocation = [NSString stringWithFormat:@&quot;http://v.juhe.cn/todayOnhistory/queryEvent.php?date=%@&amp;key=%@&quot;,date,appKey]; NSURL *url = [NSURL URLWithString:webLocation];NSMutableURLRequest *request = [[NSMutableURLRequest alloc]initWithURL:url cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:60];// [request setHTTPMethod:@&quot;GET&quot;];// å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œå¹¶é€šè¿‡blockå›è°ƒæ¥æ”¶è¯·æ±‚åˆ°çš„æ•°æ®ï¼Œå¹¶å±•ç¤ºå‡ºæ¥[NSURLConnection sendAsynchronousRequest:request queue:[NSOperationQueue mainQueue] completionHandler:^(NSURLResponse * _Nullable response, NSData * _Nullable data, NSError * _Nullable connectionError) &#123; NSString *string = [[NSString alloc]initWithData:data encoding:NSUTF8StringEncoding]; __weak NetworkRequestViewController *weakSelf = self; [weakSelf showAlertWith:string];&#125;]; POST å¼‚æ­¥è¯·æ±‚ï¼ˆDelegateå›è°ƒæ–¹å¼ï¼‰Delegate æ–¹å¼å¯ä»¥ç›‘æ§è¯·æ±‚è¿›åº¦ä»¥åŠæ•°æ®æ¥æ”¶è¯¦æƒ…ï¼Œæ‰€ä»¥ Delegate æ–¹å¼ä¹Ÿå¸¸å¸¸ç”¨æ¥ä¸‹è½½æ¯”è¾ƒå¤§çš„æ•°æ®ã€‚æ•°æ®è¾ƒå¤§çš„æ—¶å€™ä¹Ÿå¯ä»¥é€šè¿‡ä¸€äº›æ–¹å¼æ”¯æŒæ–­ç‚¹ç»­ä¼ ç­‰ã€‚è¿™å°±æ˜¯ Delegate å›è°ƒæ–¹å¼çš„å¥½å¤„å§ã€‚ä¸‹é¢çš„ä¾‹å­å°†ç®€å•çš„å®ç°ä¸‹è½½ä¸€ä¸ªçŸ­è§†é¢‘çš„åŠŸèƒ½ï¼Œå¹¶å¯ä»¥æš‚åœä¸‹è½½çš„åŠŸèƒ½ã€‚é¦–å…ˆæ·»åŠ å¦‚ä¸‹å±æ€§ï¼š 12345678@property (nonatomic,strong) NSMutableData *returnDataInfo;@property (nonatomic,strong) NSURLConnection *connection;@property (nonatomic,assign) NSUInteger totalSize;@property (nonatomic,copy) NSString *filmName;@property (nonatomic,assign) NSUInteger currentSize;@property (nonatomic,strong) NSFileHandle *handle;@property (weak, nonatomic) IBOutlet UIProgressView *progressView;@property (weak, nonatomic) IBOutlet UIButton *downloadButton; åœ¨ä½¿ç”¨ä»£ç†å›è°ƒçš„æ—¶å€™é¦–å…ˆè¦éµå®ˆä¸¤ä¸ªåè®®ï¼ŒNSURLConnectionDelegate,NSURLConnectionDataDelegateã€‚ 123456789101112131415NSString *mp4WebLocation = @&quot;http://120.25.226.186:32812/resources/videos/minion_01.mp4&quot;;NSURL *url = [NSURL URLWithString:mp4WebLocation];//åˆå§‹åŒ–ä¸€ä¸ªè¯·æ±‚NSMutableURLRequest *request = [[NSMutableURLRequest alloc]initWithURL:url cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:60]; //è°è¯·æ±‚å¤´å‚æ•°ï¼Œå³ä¸‹è½½æ–‡ä»¶å¼€å§‹ç»“æŸçš„ä½ç½®/*bytes=0-100ä¸‹è½½æ–‡ä»¶æ•°æ®çš„èŒƒå›´ï¼Œ-å‰é¢çš„æ•°å­—æ˜¯å¼€å§‹çš„ä½ç½®ï¼Œ-åé¢çš„æ•°å­—æ˜¯ç»“æŸçš„ä½ç½®ã€ä¸æŒ‡å®šå³ä¸ºä¸‹è½½åˆ°å®Œæˆ*/NSString *range = [NSString stringWithFormat:@&quot;bytes=%zd-&quot;,self.currentSize];[request setValue:range forHTTPHeaderField:@&quot;Range&quot;]; //å‘é€è¯·æ±‚ï¼Œå¹¶è®¾ç½®è¯·æ±‚ä»£ç†self.connection = [NSURLConnection connectionWithRequest:request delegate:self]; åœ¨å‘é€è¯·æ±‚åä¸»è¦åœ¨å¦‚ä¸‹çš„ä¸‰ä¸ªä»£ç†æ–¹æ³•ä¸­ç®¡ç†ä¸‹è½½è¿›åº¦ä»¥åŠæ¥æ”¶æ•°æ®ï¼Œå­˜å‚¨æ•°æ®çš„å¤„ç†ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667#pragma mark - Connection Delegate- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response &#123; if (connection == self.connection) &#123; //ä¸€å®šè¦åšæ­¤åˆ¤æ–­ï¼Œå¦åˆ™åœ¨æš‚åœä¸‹è½½åå†æ­¤ä¸‹è½½æ—¶ä¼šå‡ºé”™ï¼Œåˆ›å»ºæ–°çš„æ–‡ä»¶å¥æŸ„ï¼Œæ–‡ä»¶ä¼šæŸåã€‚ if (self.currentSize &gt; 0) &#123; return; &#125; else &#123; //è·å–å°†è¦ä¸‹è½½çš„æ–‡ä»¶çš„æ€»å¤§å° self.totalSize = response.expectedContentLength; //è·å–è¦ä¸‹è½½æ–‡ä»¶çš„æ–‡ä»¶å self.filmName = response.suggestedFilename; //è®¾ç½®æ–‡ä»¶å­˜å‚¨åœ°å€ NSString *path = [NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES)lastObject]; NSString *fullPath = [path stringByAppendingPathComponent:_filmName]; NSLog(@&quot;%@&quot;,fullPath); //åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶åœ¨æ”¹åœ°å€ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶çš„åœ°å€ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–‡ä»¶å†…å®¹ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æ–‡ä»¶å±æ€§ [[NSFileManager defaultManager]createFileAtPath:fullPath contents:nil attributes:nil]; //åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¥æŸ„ self.handle = [NSFileHandle fileHandleForWritingAtPath:fullPath]; &#125; &#125; else &#123; self.returnDataInfo = [[NSMutableData alloc]init]; NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *)response; NSLog(@&quot;%ld&quot;,(long)httpResponse.statusCode); NSLog(@&quot;%@&quot;,httpResponse.allHeaderFields); &#125; &#125;- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data &#123; if (connection == self.connection) &#123; //ç§»åŠ¨æ–‡ä»¶å¥æŸ„åˆ°æ–‡ä»¶æœ«å°¾ [self.handle seekToEndOfFile]; //é€šè¿‡æ–‡ä»¶å¥æŸ„å†™å…¥æ–‡ä»¶ [self.handle writeData:data]; //è®¡ç®—å½“å‰ä¸‹è½½åˆ°æ•°æ®é•¿åº¦ self.currentSize += data.length; //å½“å‰ä¸‹è½½æ–‡ä»¶çš„ç™¾åˆ†æ¯” self.progressView.progress = (double) self.currentSize / self.totalSize; &#125; else &#123; [_returnDataInfo appendData:data]; &#125;&#125;- (void)connectionDidFinishLoading:(NSURLConnection *)connection &#123; //æ•°æ®è¯·æ±‚å®Œæ¯• if (connection == self.connection) &#123; //å…³é—­æ–‡ä»¶å¥æŸ„ [self.handle closeFile]; //å¥æŸ„è®¾ç½®ä¸ºnil self.handle = nil; [self.downloadButton setSelected:NO]; [self.downloadButton setTitle:@&quot;ä¸‹è½½å®Œæˆ&quot; forState:UIControlStateNormal]; &#125; else &#123; NSString *string = [[NSString alloc]initWithData:_returnDataInfo encoding:NSUTF8StringEncoding]; [self showAlertWith:string]; _returnDataInfo = nil; &#125;&#125;#pragma mark - Connection DataDelegate- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error &#123; NSLog(@&quot;æ•°æ®è¯·æ±‚å¤±è´¥!&quot;);&#125; NSURLSession ä»‹ç»å‰é¢ä¹Ÿæåˆ°äº† NSURLSession æ˜¯ç”¨æ¥æ›¿æ¢ NSURLConnection çš„ï¼Œé‚£ä¹ˆ URLSession è‚¯å®šæ¯” NSURLConnection æ›´åŠ æ–¹ä¾¿ï¼Œå¼ºå¤§ï¼Œä»¥åŠçµæ´»ã€‚NSURLSession å¯¹äº NSURLConnection æœ€å¤§çš„æ”¹å˜å°±æ˜¯å¯ä»¥çµæ´»çš„å•ç‹¬é…ç½®ç»™ä¸ª Session çš„ç¼“å­˜ï¼Œåè®®ï¼Œcookieï¼Œä»¥åŠè¯ä¹¦ç­–ç•¥ã€‚NSURL ä¸»è¦å¯ä»¥åˆ†ä¸ºä¸‰å¤§å—ï¼ŒNSURLSessionã€NSURLSessionConfigurationã€NSURLSessionTaskã€‚ NSURLSeesionTaskè¯¥ç±»ä¸‹æœ‰å››ä¸ªå­ç±»ï¼Œåˆ†åˆ«æ˜¯ NSURLSessionDataTaskã€NSURLSessionDownloadTaskã€NSURLSessionUploadTaskã€NSURLSessionStreamTaskï¼Œé€šè¿‡åå­—æˆ‘æƒ³ä¹Ÿèƒ½å¤§æ¦‚çŸ¥é“è¿™å››ä¸ªå­ç±»ä¸»è¦çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯ã€‚ NSURLSessionDataTaskï¼Œä»æœåŠ¡å™¨è¯·æ±‚æ•°æ®ï¼Œå¹¶è¿”å› NSData ç±»å‹çš„æ•°æ®ã€‚ä¸»è¦ç”¨äºGETã€POSTçš„ç½‘ç»œè¯·æ±‚ NSURLSessionDownloadTaskï¼Œä»æœåŠ¡å™¨è¯·æ±‚æ•°æ®ï¼Œå¹¶ä¸´æ—¶å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå½“ä¸‹è½½ç»“æŸä¼šè¿”å›ä¸€ä¸ªä¸´æ—¶çš„æ–‡ä»¶è·¯å¾„ã€‚ä¸»è¦ç”¨äºä»æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶ï¼Œæˆ–è€…é’ˆå¯¹æ•°æ®æ¯”è¾ƒå¤§çš„ä¸‹è½½è¯·æ±‚ã€‚ NSURLSessionUploadTaskï¼Œä¸Šä¼ æ•°æ®åˆ°æœåŠ¡å™¨ï¼Œä½†æ˜¯ä¹Ÿä¼šè¿”å›ç›¸åº”çš„æ•°æ®ï¼Œæ‰€ä»¥è¯¥ç±»æ˜¯ç»§æ‰¿äº NSURLSessionDataTask çš„ã€‚ä¸»è¦ç”¨æ¥ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨ï¼Œæˆ–è€…ä¸Šä¼ å¤§é‡çš„æ•°æ®åˆ°æœåŠ¡å™¨ç«¯ã€‚ NSURLSessionStreamTaskï¼Œå»ºç«‹ä¸€ä¸ªTCP / IPè¿æ¥çš„ä¸»æœºåå’Œç«¯å£æˆ–ä¸€ä¸ªç½‘ç»œæœåŠ¡å¯¹è±¡ã€‚ NSURLSession çš„ä½¿ç”¨NSURLSessionDataTaskï¼šé¦–å…ˆé€šè¿‡ NSURLSession åˆ›å»ºä¸€ä¸ª GET è¯·æ±‚ï¼š 12345678910111213141516171819202122232425262728//ç½‘ç»œåœ°å€NSString *webLocation = [NSString stringWithFormat:@&quot;http://v.juhe.cn/todayOnhistory/queryEvent.php?date=%@&amp;key=%@&quot;,date,appKey];//åˆ›å»ºç½‘ç»œåœ°å€URLNSURL *url = [NSURL URLWithString:webLocation];//åˆ›å»ºè¯·æ±‚NSURLRequest *request = [NSURLRequest requestWithURL:url];//è·å¾— iOS æä¾›çš„å…±äº« Session å•ä¾‹NSURLSession *session = [NSURLSession sharedSession];//é€šè¿‡ request åˆ›å»ºä»»åŠ¡NSURLSessionDataTask *task = [session dataTaskWithRequest:request completionHandler:^(NSData * _Nullable data, NSURLResponse * _Nullable response, NSError * _Nullable error) &#123; dispatch_async(dispatch_get_main_queue(), ^&#123; NSString *str = [[NSString alloc]initWithData:data encoding:NSUTF8StringEncoding]; [self showAlertWith:str]; &#125;);&#125;];//å¼€å§‹ä»»åŠ¡[task resume]; /* ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡ URL åˆ›å»ºä»»åŠ¡.....é€šè¿‡ URL ç›´æ¥åˆ›å»ºçš„è¯·æ±‚ï¼Œå°±ç›¸å½“äºä¸€ä¸ªé»˜è®¤çš„ GET è¯·æ±‚ï¼Œè¿™åªæ˜¯ä¸€ç§å¿«æ·çš„æ–¹å¼*ï¼// NSURLSessionDataTask *task2 = [session dataTaskWithURL:url completionHandler:^(NSData * _Nullable data, NSURLResponse * _Nullable response, NSError * _Nullable error) &#123;// dispatch_async(dispatch_get_main_queue(), ^&#123;// NSString *str = [[NSString alloc]initWithData:data encoding:NSUTF8StringEncoding];// [self showAlertWith:str];// &#125;);// &#125;];// [task2 resume]; ä¸Šé¢ä½¿ç”¨ NSURLSessionDataTask åˆ›å»ºäº†ä¸€ä¸ª GET è¯·æ±‚ï¼ŒPOST è¯·æ±‚å°±å’Œä¸Šé¢ NSURLConnection ä¸­åˆ›å»º POST è¯·æ±‚çš„æ–¹æ³•ä¸€æ ·ï¼Œä½¿ç”¨ request.HTTPMethod = @&quot;POST&quot;; æˆ–è€…ä½¿ç”¨ç›¸åº”çš„ Set æ–¹æ³•ä¹Ÿå¯ä»¥ï¼Œè®¾ç½®è¯·æ±‚ä½“ä¹Ÿæ˜¯ç±»ä¼¼ [request setHTTPBody:[parametersString dataUsingEncoding:NSUTF8StringEncoding]];ã€‚NSURLSession å’Œ NSURLConnection åŒºåˆ«å°±æ˜¯ NSURLSession æ˜¯æ²¡æœ‰åŒæ­¥è¯·æ±‚çš„ï¼ŒNSURLSession çš„è¯·æ±‚éƒ½æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œå½“æ•°æ®è¯·æ±‚å®Œæ¯•å›è°ƒæ›´æ–° UI çš„æ—¶å€™éœ€è¦å›åˆ°ä¸»çº¿ç¨‹è¿›è¡Œè¿›ä¸€æ­¥çš„æ“ä½œã€‚ NSURLSessionDownloadTaskï¼šNSURLSessionDownloadTask å’Œ NSURLConnection ä¸€æ ·ï¼Œä¸‹è½½æ–‡ä»¶æœ‰ä¸¤ç§å›è°ƒæ–¹å¼ï¼Œä¸€ç§æ˜¯ Block ä¸€ç§æ˜¯ Delegate æ–¹å¼ã€‚è¿™ä¸¤ç§æ–¹å¼å·®åˆ«ä¹Ÿå’Œ NSURLConnection çš„å·®åˆ«æ˜¯å·®ä¸å¤šçš„ï¼Œè¿™é‡Œçš„ Block æ–¹å¼æ— æ³•ç›‘æ§ä¸‹è½½è¿›åº¦ï¼Œå½“ä¸‹è½½å®Œæˆçš„æ—¶å€™ä¼šç›´æ¥è¿”å›ä¸€ä¸ªä¸‹è½½å®Œæˆçš„ä¸´æ—¶æ–‡ä»¶çš„è·¯å¾„ã€‚å…·ä½“ä½¿ç”¨å¦‚ä¸‹ï¼š 12345678910111213NSString *mp4WebLocation = @&quot;http://120.25.226.186:32812/resources/videos/minion_01.mp4&quot;;NSURL *url = [NSURL URLWithString:mp4WebLocation];NSURLRequest *request = [NSURLRequest requestWithURL:url];NSURLSession *session = [NSURLSession sharedSession];NSURLSessionDownloadTask *task = [session downloadTaskWithRequest:request completionHandler:^(NSURL * _Nullable location, NSURLResponse * _Nullable response, NSError * _Nullable error) &#123; NSLog(@&quot;ä¸‹è½½å®Œæˆï¼Œåœ°å€ä¸ºï¼š%@&quot;,location); NSString *path = @&quot;/Users/aaron/Desktop&quot;; NSString *fileName = response.suggestedFilename; NSString *fullPath = [path stringByAppendingPathComponent:fileName]; NSFileManager *fileManager = [NSFileManager defaultManager]; [fileManager copyItemAtURL:location toURL:[NSURL fileURLWithPath:fullPath] error:nil];&#125;];[task resume]; Delegate æ–¹å¼çš„å›è°ƒåˆ™å¯ä»¥ç›‘æ§ä¸‹è½½è¿›åº¦ç­‰ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œæ–­ç‚¹ç»­ä¼ ã€‚åœ¨ NSURLSession ä½¿ç”¨æ–­ç‚¹ç»­ä¼ å°±è¦æ¯”åœ¨ NSURLConnection ä¸­è¦ç®€å•ä¸€ç‚¹ï¼Œåªéœ€è¦åœ¨æš‚åœçš„æ—¶å€™ä¿å­˜æš‚åœæ—¶è¿”å›çš„æ•°æ®ï¼Œåœ¨ç»§ç»­ä¸‹è½½çš„æ—¶å€™ä¼ å…¥æš‚åœæ—¶å·²ç»ä¸‹è½½çš„æ•°æ®å³å¯ã€‚ é¦–å…ˆæ·»åŠ å¦‚ä¸‹å‡ ä¸ªå±æ€§å’Œå…¨å±€å˜é‡å¹¶éµå®ˆNSURLSessionDelegateä»£ç†ï¼š 1234567891011@interface NetworkRequestViewController ()&lt;NSURLSessionDelegate&gt;@property (weak, nonatomic) IBOutlet UIProgressView *progressView2;@property (weak, nonatomic) IBOutlet UIButton *downloadButton2;@end@implementation NetworkRequestViewController &#123; NSURLSession *_seesion2; NSURLSessionDownloadTask *_task2; NSData *_data2; NSURLRequest *_request2;&#125; å‘èµ·æ•°æ®ä¸‹è½½ï¼Œæˆ–è€…æš‚åœä¸‹è½½ä»¥åŠç»§ç»­ä¸‹è½½ï¼š 12345678910111213141516171819if (sender.isSelected) &#123; [_task2 cancelByProducingResumeData:^(NSData * _Nullable resumeData) &#123; _data2 = resumeData; &#125;]; sender.selected = !sender.selected;&#125; else &#123; if (!_data2) &#123; NSString *mp4WebLocation = @&quot;http://120.25.226.186:32812/resources/videos/minion_01.mp4&quot;; NSURL *url = [NSURL URLWithString:mp4WebLocation]; _request2 = [NSURLRequest requestWithURL:url]; NSURLSessionConfiguration *config = [NSURLSessionConfiguration defaultSessionConfiguration]; _seesion2 = [NSURLSession sessionWithConfiguration:config delegate:self delegateQueue:[NSOperationQueue mainQueue]]; _task2 = [_seesion2 downloadTaskWithRequest:_request2]; &#125; else &#123; _task2 = [_seesion2 downloadTaskWithResumeData:_data2]; &#125; [_task2 resume]; sender.selected = !sender.selected;&#125; åœ¨ä»£ç†æ–¹æ³•ç§ç›‘æ§ä¸‹è½½è¿›åº¦ï¼Œä»¥åŠUIçš„æ›´æ–° 123456789101112- (void)URLSession:(NSURLSession *)session downloadTask:(NSURLSessionDownloadTask *)downloadTask didFinishDownloadingToURL:(NSURL *)location &#123; NSLog(@&quot;ä¸‹è½½å®Œæˆï¼Œåœ°å€ä¸ºï¼š%@&quot;,location); NSString *path = @&quot;/Users/aaron/Desktop&quot;; NSString *fileName = @&quot;å°é»„äºº.mp4&quot;; NSString *fullPath = [path stringByAppendingPathComponent:fileName]; NSFileManager *fileManager = [NSFileManager defaultManager]; [fileManager copyItemAtURL:location toURL:[NSURL fileURLWithPath:fullPath] error:nil];&#125;- (void)URLSession:(NSURLSession *)session downloadTask:(nonnull NSURLSessionDownloadTask *)downloadTask didWriteData:(int64_t)bytesWritten totalBytesWritten:(int64_t)totalBytesWritten totalBytesExpectedToWrite:(int64_t)totalBytesExpectedToWrite &#123; self.progressView2.progress = (double)totalBytesWritten/totalBytesExpectedToWrite;&#125; NSURLSessionUploadTaskï¼šNSURLSessionUploadTask çš„ä½¿ç”¨æ–¹æ³•ç›®å‰å…ˆè®°å½•ä¸‹å¤§æ¦‚çš„ä½¿ç”¨æ–¹å¼ï¼Œå› ä¸ºå…·ä½“çš„æˆ‘è¿™é‡Œç°åœ¨ä¹Ÿæ²¡æœ‰å¯ä»¥ç”¨çš„ API æ¥ä½¿ç”¨ä»¥åŠæµ‹è¯•ã€‚ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š 12345678910111213NSURL *URL = [NSURL URLWithString:@&quot;http://example.com/upload&quot;];NSURLRequest *request = [NSURLRequest requestWithURL:URL];NSData *data = ...;NSURLSession *session = [NSURLSession sharedSession];NSURLSessionUploadTask *uploadTask = [session uploadTaskWithRequest:request fromData:data completionHandler: ^(NSData *data, NSURLResponse *response, NSError *error) &#123; // ... &#125;];[uploadTask resume]; NSURLSessionConfigurationNSURLSessionConfiguration å¯¹è±¡æ˜¯ç”¨æ¥å¯¹ NSURLSession è¿›è¡Œåˆå§‹åŒ–é…ç½®çš„ï¼ŒNSURLSessionConfiguration æ˜¯å¯¹ä»¥å‰ NSMutableURLRequest æ‰€æä¾›çš„ç½‘ç»œè¯·æ±‚çš„è®¾ç½®è¿›è¡Œæ‰©å……ï¼Œå¯ä»¥æŒ‡å®šå¯ç”¨ç½‘ç»œï¼Œcookieï¼Œå®‰å…¨æ€§ï¼Œç¼“å­˜ç­–ç•¥ï¼Œç”šè‡³æ˜¯ä½¿ç”¨è‡ªå®šä¹‰åè®®ã€‚ ä½¿ç”¨ NSURLSessionConfiguration æ¥åˆå§‹åŒ– NSURLSession çš„æ—¶å€™ï¼ŒNSURLSession çš„å¯¹è±¡ä¼šæŠŠç”¨æ¥åˆå§‹åŒ–çš„ NSURLSessionConfiguration å¯¹è±¡è¿›è¡Œ copy å¹¶ä¿å­˜åˆ°è‡ªå·±çš„ä¸€ä¸ªåªè¯»å±æ€§ä¸­å»ï¼Œæ‰€ä»¥ä¸€æ—¦ Session åˆå§‹åŒ–å®Œæˆåï¼Œä»–çš„ Configuration å°±æ˜¯ä¸èƒ½è¢«ä¿®æ”¹çš„ã€‚ åˆ›å»ºNSURLSessionConfigurationåœ¨å¸¸è§„çš„ä½¿ç”¨æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„ä¸‰ä¸ªç±»æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ª NSURLSessionConfiguration å¯¹è±¡ï¼Œä»è¿™ä¸‰ä¸ªç±»æ–¹æ³•ä¸­ä¹Ÿå¯ä»¥çœ‹å‡ºåŸºæœ¬ä¸Šæ˜¯æ»¡è¶³å¹³å¸¸çš„éœ€æ±‚çš„ã€‚ + defualtSessionConfiguration; è¿”å›ä¸€ä¸ªå¸¸è§„çš„ configuration å¯¹è±¡ã€‚ + ephemeralSessionConfiguration; è¿”å›ä¸€ä¸ªé¢„è®¾çš„é…ç½®ï¼Œè¯¥é…ç½®ä¸ä¼šå¯¹ç¼“å­˜ï¼ŒCookiesï¼Œå’Œè¯ä¹¦è¿›è¡Œç¼“å­˜ã€‚ + backgroundSessionConfiguration:(NSString *)identifier; è¿”å›ä¸€ä¸ªåå°é…ç½®ï¼Œåå°é…ç½®å’Œå…¶ä»–ä¸åŒçš„æ˜¯ï¼Œåœ¨åå°é…ç½®ä¸‹çš„ Session å¯ä»¥åœ¨åº”ç”¨ç¨‹åºæŒ‚èµ·ï¼Œé€€å‡ºæˆ–è€…å´©æºƒçš„æƒ…å†µä¸‹è¿è¡Œä¸Šä¼ å’Œä¸‹è½½ä»»åŠ¡ã€‚åˆå§‹åŒ–æ—¶æŒ‡å®šçš„æ ‡è¯†ç¬¦å¯ä»¥ç”¨æ¥æ¢å¤å¯¹è¿™ä¸ª Session çš„æ“ä½œã€‚ åŸºæœ¬é…ç½®NSURLSessionConfiguration çš„é…ç½®å±æ€§å¤ªå¤šäº†ï¼Œä¸‹é¢ä¼šè¯´ä¸€äº›å¸¸ç”¨çš„åŸºæœ¬çš„é…ç½®ï¼Œå…¶ä»–çš„å±æ€§è¯¦æƒ…å¯ä»¥æŸ¥çœ‹è‹¹æœå®˜æ–¹æ–‡æ¡£çš„æè¿° HTTPAdditionalHeaders å¯ä»¥è®¾ç½®è®¾ç½®è¯·æ±‚çš„æ•°æ®å¤´ï¼Œå¦‚è¯·æ±‚çš„å†…å®¹ç±»å‹ï¼Œè¯­è¨€ï¼Œç”¨æˆ·ä»£ç†å’Œèº«ä»½è®¤è¯ç­‰ã€‚ allowsCellularAccess æ˜¯å¦å…è®¸ä½¿ç”¨èœ‚çªç½‘è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œå…¶é»˜è®¤çš„æ˜¯ YES timeoutIntervalForRequest å’Œ timeoutIntervalForResource åˆ†åˆ«ç”¨äºæŒ‡å®šè¯·æ±‚è¶…æ—¶çš„æ—¶é—´å’Œèµ„æºè¶…æ—¶çš„æ—¶é—´ HTTPMaximumConnectionsPerHost ç”¨äºæŒ‡å®šé“¾æ¥åˆ°æŒ‡å®šä¸»æœºçš„æœ€å¤§æ•°é‡ï¼Œåœ¨MacOSä¸­é»˜è®¤ä¸º6ï¼ŒiOSä¸­é»˜è®¤ä¸º4 connectionProxyDictionary æŒ‡å®š Session è¿æ¥ä¸­çš„ä»£ç†æœåŠ¡å™¨ sharedContainerIdentifier æŒ‡å®šä¸€ä¸ªå…±äº«å®¹å™¨æ ‡è¯†ç¬¦ï¼Œè¯¥å±æ€§ä¸»è¦ç”¨äºApp Extensionï¼ˆå¦‚Weightï¼‰å¼€å‘ä¸­ Session å…±äº«çš„å¤„ç†ã€‚ Cookie ç­–ç•¥ HTTPCookieStorage å­˜å‚¨äº† session æ‰€ä½¿ç”¨çš„ cookieã€‚é»˜è®¤æƒ…å†µä¸‹ä¼šä½¿ç”¨ NSHTTPCookieShorage çš„ +sharedHTTPCookieStorage; è¿™ä¸ªå•ä¾‹å¯¹è±¡ HTTPCookieAcceptPolicy å†³å®šäº†ä»€ä¹ˆæƒ…å†µä¸‹ session åº”è¯¥é‡‡ç”¨æœåŠ¡å™¨çš„ cookie HTTPShouldSetCookies BOOLå±æ€§ï¼Œç”¨äºæŒ‡å®šä»€ä¹ˆæ—¶å€™è¯·æ±‚åº”è¯¥ä½¿ç”¨ Session å­˜å‚¨çš„ cookieï¼Œå³ HTTPCookieSorage å±æ€§çš„å€¼ å®‰å…¨ç­–ç•¥ TLSMaximumSupportedProtocol å’Œ TLSMinimumSupportedProtocol ç¡®å®š session æ˜¯å¦æ”¯æŒ SSL åè®®ï¼Œè®¾ç½® SSL åè®®æ”¯æŒçš„ç‰ˆæœ¬ URLCredentialStorage å­˜å‚¨äº† session æ‰€ä½¿ç”¨çš„è¯ä¹¦ã€‚é»˜è®¤æƒ…å†µä¸‹ä¼šä½¿ç”¨ NSURLCredentialStorage çš„ +sharedCredentialStorage; è¿™ä¸ªå•ä¾‹å¯¹è±¡ ç¼“å­˜ç­–ç•¥ URLCache è®¾ç½® session ä½¿ç”¨ç¼“å­˜ã€‚é»˜è®¤æƒ…å†µä¸‹ä¼šä½¿ç”¨ NSURLCache çš„ +sharedURLCache è¿™ä¸ªå•ä¾‹å¯¹è±¡ï¼Œåœ¨ ephemeralSession ä¸­é»˜è®¤æ˜¯ nil ï¼Œåœ¨ backgroundSession ä¸­é»˜è®¤æ˜¯ç§å¯†å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Œå½“ Session å¤±æ•ˆçš„æ—¶å€™å°±ä¼šè¢«é”€æ¯ requestCachePolicy æŒ‡å®šäº†ä¸€ä¸ªè¯·æ±‚çš„ç¼“å­˜å“åº”åº”è¯¥åœ¨ä»€ä¹ˆæ—¶å€™è¿”å› è‡ªå®šä¹‰åè®® protocolClasses ç”¨æ¥é…ç½®ç‰¹å®šæŸä¸ª session æ‰€ä½¿ç”¨çš„è‡ªå®šä¹‰åè®®ï¼ˆè¯¥åè®®æ˜¯ NSURLProtocol çš„å­ç±»ï¼‰çš„æ•°ç»„ã€‚ æ€»ç»“æœ¬ç¯‡æ–‡ç« å°±ä¸»è¦å›é¡¾ä¸€ä¸‹è¿™å—å†…å®¹ï¼Œåœ¨å¸¸ç”¨å¼€å‘ä¸­ä½¿ç”¨çš„ä¸€äº›å…³äºç½‘ç»œè¯·æ±‚çš„çŸ¥è¯†ï¼Œå½“ç„¶è¿™å—è‚¯å®šä¹Ÿæ˜¯æ²¡æœ‰å¤ªè¯¦ç»†çš„è®²è§£ï¼Œä¸€äº›å…¶ä»–ä¸å¸¸ç”¨çš„åŸºæœ¬æ²¡æœ‰è¯´åˆ°ï¼Œå¦‚æœæƒ³äº†è§£å¾—æ›´åŠ çš„å…¨é¢ï¼Œè¿˜æ˜¯å»ç¿»é˜…è‹¹æœå®˜æ–¹æ–‡æ¡£ã€‚ä¸Šé¢è®²åˆ°çš„è¿™äº›ä¸œè¥¿å…¶å®åœ¨è‹¹æœçš„å®˜æ–¹æ–‡æ¡£ä¸­éƒ½æœ‰å…¨é¢çš„è®²è§£ã€‚","categories":[],"tags":[{"name":"ç½‘ç»œç¼–ç¨‹","slug":"ç½‘ç»œç¼–ç¨‹","permalink":"Aaronzjp.cn/tags/ç½‘ç»œç¼–ç¨‹/"}]},{"title":"iOS10 æƒé™Crashé—®é¢˜","slug":"iOS10-CrashOfPermission","date":"2016-08-09T03:22:30.000Z","updated":"2017-07-27T02:56:10.000Z","comments":true,"path":"2016/08/09/iOS10-CrashOfPermission/","link":"","permalink":"Aaronzjp.cn/2016/08/09/iOS10-CrashOfPermission/","excerpt":"â€‹ æ‰‹æœºå‡çº§iOS10beatç‰ˆæœ¬åï¼Œå…¬å¸é¡¹ç›®åœ¨çœŸæœºä¸Šæµ‹è¯•å‡ºç°äº†å´©æºƒçš„ç°è±¡ã€‚ä¸€æ‰“å¼€Appå°±Crashäº†ï¼Œä¸€å¼€å§‹è¿˜ä¸å¤ªç¡®å®šé—®é¢˜ï¼Œä»¥ä¸ºæ˜¯é¡¹ç›®æœ¬èº«ä»£ç çš„é—®é¢˜ã€‚æ‰¾äº†åŠå¤©ï¼Œåæ¥å±…ç„¶åœ¨æ§åˆ¶å°çš„è¾“å‡ºä¸­æ‰¾åˆ°äº†é—®é¢˜ï¼ˆæ§åˆ¶å°è¾“å‡ºçš„å†…å®¹å¤ªå¤šäº†ä¸å¥½æ‰¾å•ŠğŸ˜‚ï¼‰ã€‚ â€‹ æ§åˆ¶å°è¾“å‡ºçš„ä¿¡æ¯å¦‚ä¸‹ï¼š","text":"â€‹ æ‰‹æœºå‡çº§iOS10beatç‰ˆæœ¬åï¼Œå…¬å¸é¡¹ç›®åœ¨çœŸæœºä¸Šæµ‹è¯•å‡ºç°äº†å´©æºƒçš„ç°è±¡ã€‚ä¸€æ‰“å¼€Appå°±Crashäº†ï¼Œä¸€å¼€å§‹è¿˜ä¸å¤ªç¡®å®šé—®é¢˜ï¼Œä»¥ä¸ºæ˜¯é¡¹ç›®æœ¬èº«ä»£ç çš„é—®é¢˜ã€‚æ‰¾äº†åŠå¤©ï¼Œåæ¥å±…ç„¶åœ¨æ§åˆ¶å°çš„è¾“å‡ºä¸­æ‰¾åˆ°äº†é—®é¢˜ï¼ˆæ§åˆ¶å°è¾“å‡ºçš„å†…å®¹å¤ªå¤šäº†ä¸å¥½æ‰¾å•ŠğŸ˜‚ï¼‰ã€‚ â€‹ æ§åˆ¶å°è¾“å‡ºçš„ä¿¡æ¯å¦‚ä¸‹ï¼š â€‹ This app has crashed because it attempted to access privacy-sensitive data without a usage description. The appâ€™s Info.plist must contain an NSPhotoLibraryUsageDescription key with a string value explaining to the user how the app uses this data. â€‹ å¤§æ¦‚çš„æ„æ€å°±æ˜¯è¯´ä½ éœ€è¦åœ¨é¡¹ç›®æ–‡ä»¶çš„info.plistä¸­å»æ·»åŠ ç›¸å…³æƒé™çš„è¯·æ±‚æè¿°ã€‚ â€‹ è§£å†³æ–¹å¼ï¼š â€‹ 1.åœ¨é¡¹ç›®æ–‡ä»¶ä¸­æ‰¾åˆ°info.plistæ–‡ä»¶ï¼Œç”¨Xcode æ‰“å¼€ã€‚ â€‹ 2.åœ¨è¯¥æ–‡ä»¶ä¸­æ·»åŠ ç›¸å¯¹åº”çš„æƒé™çš„keyä»¥åŠè¯·æ±‚æ—¶çš„æ–‡å­—æè¿°ã€‚ ä»¥é€šè®¯å½•æƒé™ä¸ºä¾‹ï¼š 12&lt;key&gt;Contacts Usage Description&lt;/key&gt;&lt;string&gt;æ­¤ App éœ€è¦æ‚¨çš„åŒæ„æ‰èƒ½è·å–è”ç³»äºº&lt;/string&gt; éœ€è¦æ³¨æ„çš„æ˜¯keyä¸èƒ½å†™é”™äº†ï¼Œå…·ä½“Crashçš„åŸå› ä»€ä¹ˆæƒé™æ²¡æœ‰æ·»åŠ å¯ä»¥ä»æ§åˆ¶å°çš„è¾“å‡ºä¿¡æ¯ä¸­æ‰¾åˆ°ï¼Œæ‰¾åˆ°åæ·»åŠ ç›¸å…³æƒé™è¯·æ±‚çš„keyå’Œæè¿°å°±å¯ä»¥äº†ã€‚","categories":[],"tags":[{"name":"ç–‘éš¾æ‚ç—‡","slug":"ç–‘éš¾æ‚ç—‡","permalink":"Aaronzjp.cn/tags/ç–‘éš¾æ‚ç—‡/"}]},{"title":"UINavigationBar","slug":"UINavigationBar","date":"2016-05-31T10:31:30.000Z","updated":"2017-10-12T03:19:30.000Z","comments":true,"path":"2016/05/31/UINavigationBar/","link":"","permalink":"Aaronzjp.cn/2016/05/31/UINavigationBar/","excerpt":"NavigationBar æ˜¯åœ¨å¤§å¤šæ•°Appä¸­å¾ˆå¸¸è§çš„ä¸€ä¸ªæ§ä»¶ï¼Œå®ƒæ€»æ˜¯æ˜¾ç¤ºåœ¨ App çª—å£çš„é¡¶éƒ¨ï¼Œå…¶ä½œç”¨å°±æ˜¯ç”¨æ¥æ˜¾ç¤ºå½“å‰è§†å›¾çš„å±‚çº§ã€‚ NavigationBar ä¸»è¦åŒ…å«äº†è¿™æ ·å‡ ä¸ªéƒ¨åˆ†ï¼Œleft(back) Button ã€ CenterTitle ã€ RightButtonã€‚å¦‚ä¸‹å›¾ï¼š","text":"NavigationBar æ˜¯åœ¨å¤§å¤šæ•°Appä¸­å¾ˆå¸¸è§çš„ä¸€ä¸ªæ§ä»¶ï¼Œå®ƒæ€»æ˜¯æ˜¾ç¤ºåœ¨ App çª—å£çš„é¡¶éƒ¨ï¼Œå…¶ä½œç”¨å°±æ˜¯ç”¨æ¥æ˜¾ç¤ºå½“å‰è§†å›¾çš„å±‚çº§ã€‚ NavigationBar ä¸»è¦åŒ…å«äº†è¿™æ ·å‡ ä¸ªéƒ¨åˆ†ï¼Œleft(back) Button ã€ CenterTitle ã€ RightButtonã€‚å¦‚ä¸‹å›¾ï¼š å¤§å¤šæ•°æ—¶å€™ NavigationBar éƒ½æ˜¯ä½¿ç”¨åœ¨ UINavigationController ä¸­çš„ï¼Œç”± NavigationController æ¥ç®¡ç†å’Œæ˜¾ç¤º NavigationBar çš„ã€‚å½“ç„¶ NavigationBar ä¹Ÿå¯ä»¥å•ç‹¬çš„ä½¿ç”¨ã€‚å½“åœ¨ NavigationController ä¸­ä½¿ç”¨ NavigationBar çš„æ—¶å€™ï¼ŒNavigationController ä¼šè‡ªåŠ¨ç®¡ç† NavigationBar çš„çŠ¶æ€ï¼Œè¿™æ—¶å€™ NavigationBar çš„ Title é»˜è®¤ä¸ºå½“å‰æ§åˆ¶å™¨çš„ Title ã€‚ä¹Ÿå¯ä»¥è‡ªå·±å»æ‰‹åŠ¨çš„ä¿®æ”¹ï¼Œåœ¨ NavigationController ä¸­ä¿®æ”¹ NavigationBar ç›´æ¥é€šè¿‡ NavigationController ä¸Šçš„å±æ€§ NavigationBar å°±å¯ä»¥ä¿®æ”¹çš„ã€‚ NavigationBarçš„ä½¿ç”¨å…¶å® NavigationBar æ˜¯å¾ˆå°‘å•ç‹¬ä½¿ç”¨çš„ï¼Œä½†æ˜¯ä¸æ’é™¤æŸäº›æ—¶å€™éœ€è¦å•ç‹¬çš„å»åˆ›å»ºä¸€ä¸ª NavigationBar ç„¶åå»è‡ªå·±ç®¡ç†ã€‚æ‰€ä»¥è¿˜æ˜¯åœ¨è¿™é‡Œå†™ä¸€ä¸‹ï¼Œä»¥å…åˆ°æ—¶å€™éœ€è¦ç”¨åˆ°æˆ‘åˆå¾—åˆ°å¤„å»ç¿»èµ„æ–™ã€‚ å‘ UINavigationBar çš„æ ˆé¡¶å‹å…¥æ–°çš„ UINavigationItem ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š 1- (void)pushNavigationItem:(UINavigationItem *)item animated:(BOOL)animated; å‘ NavigationBar; ä½¿ UINavigationBar å‡ºæ ˆï¼Œä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›å‡ºæ ˆçš„ Item ï¼š 1- (nullable UINavigationItem *)popNavigationItemAnimated:(BOOL)animated; é™¤äº†ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•æ·»åŠ  Items ä»¥å¤–è¿˜å¯ä»¥é€šè¿‡ items å±æ€§ä»¥åŠå¦‚ä¸‹æ–¹æ³•æ·»åŠ  UINavigationItem åˆ° UINavigationBarï¼š 1- (void)setItems:(nullable NSArray&lt;UINavigationItem *&gt; *)items animated:(BOOL)animated; NavigationBarä»£ç†ï¼š 12345678910111213141516//æ˜¯å¦ push è¯¥ Item- (BOOL)navigationBar:(UINavigationBar *)navigationBar shouldPushItem:(UINavigationItem *)item &#123; return YES;&#125;//Item push ååˆ°å›è°ƒ- (void)navigationBar:(UINavigationBar *)navigationBar didPushItem:(UINavigationItem *)item &#123;&#125;//æ˜¯å¦ pop è¯¥ Item- (BOOL)navigationBar:(UINavigationBar *)navigationBar shouldPopItem:(UINavigationItem *)item &#123; return YES;&#125;//Item popååˆ°å›è°ƒ- (void)navigationBar:(UINavigationBar *)navigationBar didPopItem:(UINavigationItem *)item &#123;&#125; é€šè¿‡ UINavigationBar çš„ä»£ç†å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç®¡ç† UINavigationBar ä¸­ items çš„è¿›æ ˆå’Œå‡ºæ ˆã€‚ UINavigationBar ä¸­ items çš„è¿›æ ˆå’Œå‡ºæ ˆç¤ºæ„å›¾ï¼š è‡ªå®šä¹‰UINavigationBarçš„å¤–è§‚äº†è§£å¦‚ä¸‹å±æ€§åï¼Œå°±å¯ä»¥é€šè¿‡è¿™äº›å±æ€§æ¥è®¾ç½®è‡ªå·±æ»¡æ„çš„ UINavigationBar äº†ã€‚ barStyleï¼š UINavigationBar çš„æ ·å¼ï¼Œå¯ä¾›é€‰æ‹©çš„æœ‰ä¸¤ç§ç™½è‰²(UIBarStyleDefault)å’Œé»‘è‰²(UIBarStyleBlack) translucentï¼š UINavigationBar æ˜¯å¦åŠé€æ˜ï¼Œé»˜è®¤ä¸º YES barTintColorï¼š é€šè¿‡æ­¤å±æ€§å¯ä»¥è®¾ç½® UINavigationBar çš„èƒŒæ™¯è‰² tintColorï¼š è¿™é‡Œæ˜¯ä¿®æ”¹ UINavigationBar ä¸­ UINavigationItem çš„é¢œè‰²ï¼ŒåŒ…æ‹¬ Item ä¸­å›¾ç‰‡å’Œæ ‡é¢˜çš„é¢œè‰²ã€‚(è¯¥å±æ€§æ˜¯ iOS 7.0 åæ–°å¢çš„ä¸€ä¸ªå±æ€§ï¼Œå‡¡æ˜¯ç»§æ‰¿äº UIView çš„è¯•å›¾éƒ½æœ‰è¯¥å±æ€§)ã€‚ titleTextAttributesï¼šè¯¥å±æ€§å¯ä»¥è®¾ç½®æ ‡é¢˜çš„é¢œè‰²ï¼Œå…¶å®é™¤äº†é¢œè‰²æ„å¤–è¿˜å¯ä»¥è®¾ç½®å­—ä½“é˜´å½±ã€èƒŒæ™¯è‰²ç­‰ç­‰å’Œå­—ç¬¦ç›¸å…³çš„ã€‚ä½¿ç”¨å¦‚ä¸‹ï¼š 1_bar.titleTextAttributes = @&#123;NSForegroundColorAttributeName:[UIColor redColor]&#125;; é™¤äº†å¯ä»¥æ›´æ”¹æ ‡é¢˜çš„é¢œè‰²å¤–è¿˜å¯ä»¥æ›´æ”¹æ ‡é¢˜å‚ç›´ä½ç½®ï¼Œä½¿ç”¨ä»¥ä¸‹æ–¹æ³•å³å¯ï¼š 1- (void)setTitleVerticalPositionAdjustment:(CGFloat)adjustment forBarMetrics:(UIBarMetrics)barMetrics; ä¿®æ”¹è¿”å›æŒ‰é’®å›¾æ ‡é€šè¿‡è¿™ä¸¤ä¸ªå±æ€§å¯ä»¥ä¿®æ”¹è¿”å›æŒ‰é’®çš„å›¾æ ‡ï¼š backIndicatorImage è¿”å›æŒ‰é’®å›¾æ ‡ backIndicatorTransitionMaskImage è¿”å›æŒ‰é’®å›¾æ ‡é®ç½© éœ€è¦æ³¨æ„çš„æ˜¯è¦åŒæ—¶è®¾ç½®è¿™ä¸¤ä¸ªå±æ€§æ‰èƒ½ä¿®æ”¹è¿”å›æŒ‰é’®çš„å›¾æ ‡ NavigationBaré¢œè‰²å’Œæ ‡é¢˜å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸º NavigationBar è®¾ç½®èƒŒæ™¯å›¾ç‰‡ä»¥åŠé˜´å½±å›¾ç‰‡ï¼š ä½¿ç”¨è¯¥æ–¹æ³•å¯ä»¥ä¸º UINavigationBar è®¾ç½®èƒŒæ™¯å›¾ç‰‡ï¼Œè°ƒæ•´å›¾ç‰‡ä½ç½®ç­‰ç­‰ 1- (void)setBackgroundImage:(nullable UIImage *)backgroundImage forBarPosition:(UIBarPosition)barPosition barMetrics:(UIBarMetrics)barMetrics; åŒæ ·ä¹Ÿå¯ä»¥æä¾›ä¸€ä¸ªå¯è°ƒæ•´å¤§å°çš„å›¾ç‰‡æ¥è®¾ç½®é˜´å½±å›¾ç‰‡ï¼Œé€šè¿‡ shadowImage è¿™ä¸ªå±æ€§å³å¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœæ²¡æœ‰è®¾ç½®èƒŒæ™¯å›¾ç‰‡ï¼Œé‚£ä¹ˆé˜´å½±å›¾ç‰‡æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚ä¹‹å‰å°±é‡åˆ°ä¸€ä¸ªéœ€æ±‚è¦æ±‚éšè— NavigationBar ä¸‹é¢çš„é»‘çº¿ï¼Œå°±å¯ä»¥é€šè¿‡è®¾ç½®ä¸€ä¸ªç©ºçš„å›¾ç‰‡æ¥è¾¾åˆ°ã€‚ åœ¨ UINavigationBar ä¸­å±‚çº§å…³ç³»å¦‚ä¸‹å›¾ï¼š å‚è€ƒèµ„æ–™ï¼š UINavigationBar UINavigationItem","categories":[],"tags":[{"name":"UIKit","slug":"UIKit","permalink":"Aaronzjp.cn/tags/UIKit/"},{"name":"UINavigationBar","slug":"UINavigationBar","permalink":"Aaronzjp.cn/tags/UINavigationBar/"}]},{"title":"ã€ŠHTTPæƒå¨æŒ‡å—ã€‹è¯»ä¹¦ç¬”è®°ä¸€","slug":"URL-and-Resource","date":"2016-05-25T13:31:46.000Z","updated":"2017-12-05T15:12:50.452Z","comments":true,"path":"2016/05/25/URL-and-Resource/","link":"","permalink":"Aaronzjp.cn/2016/05/25/URL-and-Resource/","excerpt":"â€‹ å¦‚ä»Šæˆ‘ä»¬éšæ—¶éšåœ°éƒ½åœ¨é€šè¿‡å„ç§è®¾å¤‡ä¸Šç½‘ï¼Œæˆ‘ä»¬é€šè¿‡ç½‘ç»œå¬æ­Œï¼ŒæŸ¥çœ‹å›¾ç‰‡ï¼Œæµè§ˆç½‘é¡µã€‚é‚£æˆ‘ä»¬æ‰€è®¿é—®çš„è¿™äº›ä¸œè¥¿ï¼ŒéŸ³ä¹ï¼Œå›¾ç‰‡ï¼Œç½‘é¡µæ˜¯ä»å“ªæ¥çš„å‘¢ï¼Ÿæ”¾åœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿæˆ‘ä»¬é€šè¿‡ä»€ä¹ˆæ ·çš„æ–¹å¼ä½¿ç”¨æ‰‹ä¸­çš„è®¾å¤‡å»è®¿é—®çš„è¿™äº›èµ„æºå‘¢ï¼Ÿ â€‹ å…¶å®æˆ‘ä»¬æ‰€è®¿é—®çš„è¿™äº›èµ„æºéƒ½æ˜¯å­˜å‚¨åœ¨ä¸–ç•Œå„åœ°çš„æœåŠ¡å™¨çš„ï¼Œæˆ‘ä»¬é€šè¿‡ URL åœ¨ç½‘ç»œä¸Šå®šä½å’Œè®¿é—®è¿™äº›èµ„æºã€‚æˆ‘ä»¬æœ€å¸¸è§çš„ URL å°±æ˜¯æˆ‘ä»¬åœ¨ä¸Šç½‘æ—¶æ‰“å¼€æµè§ˆå™¨ååœ¨åœ°å€æ è¾“å…¥çš„ç½‘å€ï¼Œè¿™ä¸ªå°±æ˜¯ URLã€‚URL æ˜¯ URI çš„å­é›†ã€‚","text":"â€‹ å¦‚ä»Šæˆ‘ä»¬éšæ—¶éšåœ°éƒ½åœ¨é€šè¿‡å„ç§è®¾å¤‡ä¸Šç½‘ï¼Œæˆ‘ä»¬é€šè¿‡ç½‘ç»œå¬æ­Œï¼ŒæŸ¥çœ‹å›¾ç‰‡ï¼Œæµè§ˆç½‘é¡µã€‚é‚£æˆ‘ä»¬æ‰€è®¿é—®çš„è¿™äº›ä¸œè¥¿ï¼ŒéŸ³ä¹ï¼Œå›¾ç‰‡ï¼Œç½‘é¡µæ˜¯ä»å“ªæ¥çš„å‘¢ï¼Ÿæ”¾åœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿæˆ‘ä»¬é€šè¿‡ä»€ä¹ˆæ ·çš„æ–¹å¼ä½¿ç”¨æ‰‹ä¸­çš„è®¾å¤‡å»è®¿é—®çš„è¿™äº›èµ„æºå‘¢ï¼Ÿ â€‹ å…¶å®æˆ‘ä»¬æ‰€è®¿é—®çš„è¿™äº›èµ„æºéƒ½æ˜¯å­˜å‚¨åœ¨ä¸–ç•Œå„åœ°çš„æœåŠ¡å™¨çš„ï¼Œæˆ‘ä»¬é€šè¿‡ URL åœ¨ç½‘ç»œä¸Šå®šä½å’Œè®¿é—®è¿™äº›èµ„æºã€‚æˆ‘ä»¬æœ€å¸¸è§çš„ URL å°±æ˜¯æˆ‘ä»¬åœ¨ä¸Šç½‘æ—¶æ‰“å¼€æµè§ˆå™¨ååœ¨åœ°å€æ è¾“å…¥çš„ç½‘å€ï¼Œè¿™ä¸ªå°±æ˜¯ URLã€‚URL æ˜¯ URI çš„å­é›†ã€‚ URIâ€‹ URI ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆUniform Resource Identifierï¼‰ï¼Œæ˜¯ä¸€ç”¨æ¥æ ‡è¯†äº’è”ç½‘èµ„æºçš„å­—ç¬¦ä¸²ï¼Œè¿™ç§æ ‡è¯†ç”¨æ¥å¯¹ç½‘ç»œä¸­çš„èµ„æºé€šè¿‡ç‰¹å®šçš„åè®®æ¥è¿›è¡Œèµ„æºå®šä½è¾¨è®¤èµ„æºçš„ã€‚URI ä¸‹é¢åˆåˆ†ä¸º URL ã€URN ã€‚ URLâ€‹ URL ç»Ÿä¸€èµ„æºå®šä½ç¬¦ ï¼ˆUniform Resource Locatorï¼‰ï¼Œæ˜¯æˆ‘ä»¬å¹³å¸¸ä½¿ç”¨æœ€å¤šçš„ã€‚URL ç”¨æ¥å®šä½ç½‘ç»œä¸­èµ„æºçš„ä½ç½®ï¼Œå½“æˆ‘ä»¬è®¿é—®ç½‘é¡µçš„æ—¶å€™åœ¨æµè§ˆå™¨ä¸­è¾“å…¥çš„ä¸€ä¸²å­—ç¬¦å°±æ˜¯ URL ã€‚URL åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ã€‚ URL æ–¹æ¡ˆï¼ˆschemeï¼‰ã€‚é€šè¿‡æ–¹æ¡ˆç¨‹åºå¯ä»¥çŸ¥é“é€šè¿‡ä»€ä¹ˆçš„åè®®æ–¹å¼å»è®¿é—®èµ„æºï¼Œåœ¨è®¿é—®ç½‘é¡µçš„æ—¶å€™ä½¿ç”¨çš„æ–¹æ¡ˆä¸€èˆ¬æ˜¯ HTTP å’Œ HTTPSã€‚é™¤äº†è¿™äº›è¿˜æœ‰ FTPã€mailtoã€rtspã€rtspuã€file ç­‰æ–¹æ¡ˆã€‚ URL ç¬¬äºŒéƒ¨åˆ†åˆ™æ˜¯æœåŠ¡å™¨çš„ä½ç½®ï¼Œé€šè¿‡è¿™éƒ¨åˆ†ç¨‹åºå¯ä»¥çŸ¥é“è¦è®¿é—®çš„èµ„æºåœ¨ä»€ä¹ˆæœåŠ¡å™¨ä¸Šã€‚æ¯”å¦‚ï¼ˆwww.aaronzjp.cnï¼‰ URL ç¬¬ä¸‰éƒ¨åˆ†åˆ™å…·ä½“æ ‡æ˜äº†èµ„æºæ‰€åœ¨æœåŠ¡å™¨çš„è·¯å¾„ï¼Œé€šè¿‡è¯¥è·¯å¾„å°±å¯ä»¥å®šä½èµ„æºçš„å…·ä½“ä½ç½®ã€‚ å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ç½‘å€åæµè§ˆå™¨ä»æœåŠ¡å™¨è¯»å–ç½‘é¡µæ•°æ®æ˜¾ç¤ºå‡ºæ¥çš„æ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹ï¼š é€šè¿‡è¾“å…¥çš„ç½‘å€ç¡®å®šè®¿é—®èµ„æºæ‰€éœ€è¦çš„æ–¹æ¡ˆ é€šè¿‡ URL çš„ç¬¬äºŒéƒ¨åˆ†è§£æå‡ºä¸»æœºå é€šè¿‡ DNS æœåŠ¡å™¨å°†ä¸»æœºåè½¬æ¢æˆæœåŠ¡å™¨çš„ é€šè¿‡ URL è§£æå‡ºæœåŠ¡å™¨ç«¯å£å·ï¼Œå¦‚æœæ²¡æœ‰ç«¯å£å·åˆ™æ˜¯é»˜è®¤çš„ 80 ç«¯å£ é€šè¿‡æœåŠ¡å™¨çš„ IP åœ°å€å’Œç«¯å£å·æµè§ˆå™¨ä¸æœåŠ¡å™¨å»ºç«‹ TCP è¿æ¥ é€šè¿‡ URL çš„ç¬¬ä¸‰éƒ¨åˆ†ç¡®å®šè¦è®¿é—®çš„èµ„æºæ‰€åœ¨æœåŠ¡å™¨çš„ä½ç½® å‘æœåŠ¡å™¨å‘é€ä¸€æ¡ HTTP è¯·æ±‚æŠ¥æ–‡ æœåŠ¡å™¨æ”¶åˆ°æµè§ˆå™¨è¯·æ±‚çš„æ•°æ®åï¼Œç»è¿‡å¤„ç†æœåŠ¡å™¨å‘é€ä¸€æ¡å“åº”æŠ¥æ–‡ æµè§ˆå™¨æ”¶åˆ°å“åº”æŠ¥æ–‡è·å–åˆ°æ•°æ®åå…³é—­ TCP è¿æ¥å¹¶å°†æ•°æ®å±•ç¤ºåœ¨æµè§ˆå™¨ä¸­ URL å¹¶ä¸æ˜¯ä¸€ç»„æ²¡æœ‰è§„å¾‹çš„å­—ç¬¦ä¸²ï¼ŒURL æ˜¯æœ‰æ˜ç¡®è¯­æ³•è§„åˆ™çš„å­—ç¬¦ä¸²ï¼Œå¤§å¤šæ•°çš„ URL éƒ½éµå¾ªå¦‚ä¸‹çš„è¯­æ³•ï¼š 1&lt;scheme&gt;://&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/&lt;path&gt;;&lt;params&gt;?&lt;query&gt;#&lt;frag&gt; schemeï¼šæ–¹æ¡ˆ userï¼šç”¨æˆ·å passwordï¼šå¯†ç  hostï¼šæœåŠ¡å™¨åŸŸåæˆ– IP åœ°å€ portï¼šæœåŠ¡å™¨ç«¯å£å· pathï¼šè®¿é—®èµ„æºçš„å…·ä½“è·¯å¾„ paramsï¼šè®¿é—®å‚æ•° queryï¼šæŸ¥è¯¢æ¡ä»¶ fragï¼šè®¿é—®ç‰‡æ®µï¼Œå…¶ä¸­è®¿é—®ç‰‡æ®µæ˜¯ä¸ä¼šè¢«å‘é€ç»™æµè§ˆå™¨çš„ä»…åœ¨å®¢æˆ·ç«¯ä½¿ç”¨ï¼Œå¯ä»¥é€šè¿‡ç‰‡æ®µå®šä½èµ„æºçš„æŸä¸€éƒ¨åˆ† ä¸€èˆ¬æ¥è¯´ URL åªèƒ½ä½¿ç”¨è‹±æ–‡å­—æ¯ï¼Œæ•°å­—å’Œæ ‡ç‚¹ç¬¦å·ç»„æˆï¼Œä¸èƒ½ä½¿ç”¨å…¶ä»–çš„æ–‡å­—å’Œç¬¦å·ã€‚å…¶ä¸­æœ‰ä¸€éƒ¨åˆ†è¢«ä¿ç•™çš„å­—ç¬¦å¦‚ä¸‹ï¼š ä½†æ˜¯åœ¨ URL ä¸­éš¾å…ä¼šæœ‰æ±‰å­—çš„å‡ºç°ï¼Œåœ¨æœ‰æ±‰å­—çš„æƒ…å†µä¸‹å°±å¿…é¡»ä½¿ç”¨ç»è¿‡ç¼–ç åçš„ URLã€‚ä½†æ˜¯åœ¨ç½‘ç»œæ ‡å‡†ä¸­æ˜¯æ²¡æœ‰å…·ä½“è§„å®šç¼–ç è§„åˆ™çš„ï¼Œæ‰€æœ‰ä¸åŒçš„ç¨‹åºï¼ˆæµè§ˆå™¨ï¼‰æœ‰ä¸åŒçš„å±äºè‡ªå·±çš„ä¸€å¥—ç¼–ç è§„åˆ™ã€‚é€šè¿‡åœ¨ç½‘ä¸Šæœç´¢åå‘ç°é˜®ä¸€å³°è€å¸ˆçš„è¿™ç¯‡åšå®¢å¾ˆå¥½çš„è§£é‡Šäº†åœ¨ä¸åŒæµè§ˆå™¨ä¸‹åˆ†åˆ«ä½¿ç”¨äº†ä»€ä¹ˆæ ·çš„ç¼–ç è§„åˆ™ã€‚å…·ä½“å‚è€ƒï¼šå…³äºURLç¼–ç  URNâ€‹ URN ç»Ÿä¸€èµ„æºåç§°ï¼ˆUniform Resource Nameï¼‰URN ç›®å‰çš„ä½¿ç”¨èŒƒå›´æœ‰é™æ‰€ä»¥æ²¡æœ‰å»è¯¦ç»†çš„æ›´åŠ æ·±å…¥çš„å»äº†è§£ã€‚ä¹¦ä¸­å¯¹äº URN çš„æè¿°å¦‚ä¸‹ï¼š URI çš„ç¬¬äºŒç§å½¢å¼å°±æ˜¯ç»Ÿä¸€èµ„æºå(URN)ã€‚URN æ˜¯ä½œä¸ºç‰¹å®šå†…å®¹çš„å”¯ä¸€åç§°ä½¿ç”¨çš„ï¼Œä¸ç›®å‰çš„èµ„æºæ‰€åœ¨åœ°æ— å…³ã€‚ä½¿ç”¨è¿™äº›ä¸ä½ç½®æ— å…³çš„ URNï¼Œå°±å¯ä»¥å°†èµ„æºå››å¤„æ¬ç§»ã€‚é€šè¿‡ URNï¼Œè¿˜å¯ä»¥ç”¨åŒä¸€ä¸ªåå­—é€šè¿‡å¤šç§ç½‘ç»œè®¿é—®åè®®æ¥è®¿é—®èµ„æºã€‚æ¯”å¦‚ï¼Œä¸è®ºå› ç‰¹ç½‘æ ‡å‡†æ–‡æ¡£ RFC 2141 ä½äºä½•å¤„(ç”šè‡³å¯ä»¥å°†å…¶å¤åˆ¶åˆ°å¤šä¸ªåœ°æ–¹)ï¼Œéƒ½å¯ä»¥ç”¨ä¸‹åˆ— URN æ¥å‘½åå®ƒ: urn:ietf:rfc:2141 URN ä»ç„¶å¤„äºè¯•éªŒé˜¶æ®µï¼Œè¿˜æœªå¤§èŒƒå›´ä½¿ç”¨ã€‚ä¸ºäº†æ›´æœ‰æ•ˆåœ°å·¥ä½œï¼ŒURN éœ€è¦ä¸€ä¸ªæ”¯æ’‘æ¶æ„æ¥è§£æèµ„æºçš„ä½ç½®ã€‚è€Œæ­¤ç±»æ¶æ„çš„ç¼ºä¹ä¹Ÿå»¶ç¼“äº†å…¶è¢«é‡‡ç”¨çš„è¿›åº¦ã€‚ä½† URNç¡®å®ä¸ºæœªæ¥å‘å±•ä½œå‡ºäº†ä¸€äº›ä»¤äººå…´å¥‹çš„æ‰¿è¯ºã€‚ æˆ‘ä»¬å¹³å¸¸ç”Ÿæ´»ä¸­ä¹¦åé¢çš„ ISBN æ˜¯å±äº URN çš„ä¸€ç§ã€‚ å‚è€ƒèµ„æ–™ï¼š URI-ç»´åŸºç™¾ç§‘ URL-ç»´åŸºç™¾ç§‘ URN-ç»´åŸºç™¾ç§‘","categories":[],"tags":[{"name":"HTTP","slug":"HTTP","permalink":"Aaronzjp.cn/tags/HTTP/"},{"name":"URL","slug":"URL","permalink":"Aaronzjp.cn/tags/URL/"}]},{"title":"iOS - å¤šçº¿ç¨‹","slug":"Multiple-Thread","date":"2016-05-17T01:40:48.000Z","updated":"2017-07-27T02:54:50.000Z","comments":true,"path":"2016/05/17/Multiple-Thread/","link":"","permalink":"Aaronzjp.cn/2016/05/17/Multiple-Thread/","excerpt":"å¾ˆå¤šæ—¶å€™åœ¨æˆ‘ä»¬çš„è½¯ä»¶é¡¹ç›®ä¸­æˆ‘ä»¬éƒ½éœ€è¦ç”¨åˆ°å¤šçº¿ç¨‹ï¼Œåœ¨iOSçš„é¡¹ç›®ä¸­ä¹Ÿä¸ä¾‹å¤–ã€‚å¤šçº¿ç¨‹æ˜¯ç¼–ç¨‹ä¸­é‡è¦çš„ä¸€é¡¹æŠ€æœ¯ï¼Œå¤šçº¿ç¨‹åˆåˆ†ä¸ºå¹¶å‘å’Œä¸²è¡Œï¼Œåœ¨æ­¤åŸºç¡€ä¸Šåˆåˆ†ä¸ºåŒæ­¥çº¿ç¨‹å’Œå¼‚æ­¥çº¿ç¨‹ã€‚ä»¥ä¸‹è¿™å‡ ç‚¹å¾ˆå®¹æ˜“æ··æ·†ï¼Œå½“ç„¶GCDä¸­è¿˜æœ‰å¹¶å‘é˜Ÿåˆ—å’Œä¸²è¡Œé˜Ÿåˆ—ï¼Œè¿™ä¸ªåœ¨ä¸‹é¢çš„GCDä¸­æœ‰æåˆ°ã€‚","text":"å¾ˆå¤šæ—¶å€™åœ¨æˆ‘ä»¬çš„è½¯ä»¶é¡¹ç›®ä¸­æˆ‘ä»¬éƒ½éœ€è¦ç”¨åˆ°å¤šçº¿ç¨‹ï¼Œåœ¨iOSçš„é¡¹ç›®ä¸­ä¹Ÿä¸ä¾‹å¤–ã€‚å¤šçº¿ç¨‹æ˜¯ç¼–ç¨‹ä¸­é‡è¦çš„ä¸€é¡¹æŠ€æœ¯ï¼Œå¤šçº¿ç¨‹åˆåˆ†ä¸ºå¹¶å‘å’Œä¸²è¡Œï¼Œåœ¨æ­¤åŸºç¡€ä¸Šåˆåˆ†ä¸ºåŒæ­¥çº¿ç¨‹å’Œå¼‚æ­¥çº¿ç¨‹ã€‚ä»¥ä¸‹è¿™å‡ ç‚¹å¾ˆå®¹æ˜“æ··æ·†ï¼Œå½“ç„¶GCDä¸­è¿˜æœ‰å¹¶å‘é˜Ÿåˆ—å’Œä¸²è¡Œé˜Ÿåˆ—ï¼Œè¿™ä¸ªåœ¨ä¸‹é¢çš„GCDä¸­æœ‰æåˆ°ã€‚ åŒæ­¥çº¿ç¨‹ ä¸å›å¼€å¯æ–°çš„çº¿ç¨‹ï¼Œåœ¨å½“å‰çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡ï¼ŒåŒæ—¶ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç­‰åˆ°å½“å‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åæ‰ä¼šç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚ å¼‚æ­¥çº¿ç¨‹ ä¼šå¼€å¯æ–°çš„çº¿ç¨‹ï¼Œåœ¨æ–°çš„çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šé˜»å¡å½“å‰çš„çº¿ç¨‹ã€‚ NSThreadNSThreadç›¸å¯¹å…¶ä»–çº¿ç¨‹æ–¹æ¡ˆæ¯”è¾ƒè½»é‡çº§ï¼Œèƒ½æ›´æ–¹ä¾¿ç›´è§‚çš„å»æ§åˆ¶çº¿ç¨‹å¯¹è±¡ï¼Œå¯¹å…¶è¿›è¡Œç®¡ç†ï¼Œä½†æ˜¯ç¼ºç‚¹æ˜¯éœ€è¦è‡ªå·±å»ç®¡ç†çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸï¼Œçº¿ç¨‹åŒæ­¥ã€‚å¯¹ç³»ç»Ÿä¹Ÿä¼šæœ‰ä¸€å®šçš„å¼€é”€ã€‚å…¶å®åœ¨å®é™…çš„å¼€å‘ä½¿ç”¨ä¸­è¯¥æ–¹æ¡ˆä½¿ç”¨çš„å¾ˆå°‘ï¼Œä¸€èˆ¬å°±æ˜¯è·å–ä¸‹å½“å‰çº¿ç¨‹å’Œä¸»çº¿ç¨‹çš„æ—¶å€™ä½¿ç”¨èµ·æ¥æ¯”è¾ƒä¾¿åˆ©ã€‚ è·å–å½“å‰çº¿ç¨‹ï¼š 1NSThread *current = [NSThread currentThread]; è·å–ä¸»çº¿ç¨‹ï¼š 1NSThread *main = [NSThread mainThread]; åˆ›å»ºå¹¶å¼€å¯çº¿ç¨‹ï¼š 123NSThread *thread = [[[NSThreadalloc] initWithTarget:selfselector:@selector(run:)object:@&quot;mj&quot;] autorelease];//å¼€å¯çº¿ç¨‹[thread start]; åˆ›å»ºå¹¶è‡ªåŠ¨å¯åŠ¨çº¿ç¨‹ï¼š 1[NSThread detachNewThreadSelector:@selector(run:) toTarget:self withObject:@&quot;mj&quot;]; é€šè¿‡NSObjectåŸºç±»çš„æ–¹æ³•éšå¼åˆ›å»ºçº¿ç¨‹ï¼š 1[self performSelectorInBackground:@selector(run:) withObject:@&quot;mj&quot;]; é€šè¿‡ä»¥ä¸ŠNSbjectæ–¹å¼åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼åªèƒ½åœ¨OCä¸­ä½¿ç”¨ï¼Œåœ¨swiftä¸­è‹¹æœå› ä¸ºæŸäº›å®‰å…¨é—®é¢˜å»æ‰äº†performSelectorè¿™ä¸€ç³»åˆ—çš„æ–¹æ³• æš‚åœå½“å‰çº¿ç¨‹ï¼š 1[NSThread sleepForTimeInterval:2]; 12NSDate *date = [NSDate dateWithTimeInterval:2 sinceDate:[NSDate date]];[NSThread sleepUntilDate:date]; æš‚åœå½“å‰çº¿ç¨‹åˆ°æŸä¸ªæ—¶é—´ 1+ (void)sleepUntilDate:(NSDate *)date; åœ¨æŒ‡å®šçº¿ç¨‹æ‰§è¡Œæ“ä½œç›´åˆ°å®Œæˆï¼š 12//åœ¨threadè¿™ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œselfçš„runæ–¹æ³•ã€‚YESæ˜¯æŒ‡è¯¥çº¿ç¨‹ä¼šä¼šé€ æˆé˜»å¡ï¼Œrunæ–¹æ³•ä¼šåœ¨threadçº¿ç¨‹æ‰§è¡Œå®Œæ¯•åæ‰ä¼šæ‰§è¡Œå…¶ä»–æ“ä½œã€‚[self performSelector:@selector(run) onThread:thread withObject:nil waitUntilDone:YES]; åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œæ“ä½œç›´åˆ°å®Œæˆï¼š 1[self performSelectorOnMainThread:@selector(run) withObject:nil waitUntilDone:YES]; åœ¨å½“å‰çº¿ç¨‹æ‰§è¡Œæ“ä½œï¼š 1[self performSelector:@selector(run) withObject:nil]; å…¶ä»–æ“ä½œï¼š 1234567891011//å–æ¶ˆçº¿ç¨‹- (void)cancel;//å¯åŠ¨çº¿ç¨‹- (void)start;//åˆ¤æ–­æŸä¸ªçº¿ç¨‹çš„çŠ¶æ€çš„å±æ€§@property (readonly, getter=isExecuting) BOOL executing;@property (readonly, getter=isFinished) BOOL finished;@property (readonly, getter=isCancelled) BOOL cancelled;//è®¾ç½®å’Œè·å–çº¿ç¨‹åå­—-(void)setName:(NSString *)n;-(NSString *)name; NSOpreationä½¿ç”¨NSOperationå’ŒNSOperationQueueè¿›è¡Œå¤šçº¿ç¨‹å¼€å‘ï¼Œåœ¨çº¿ç¨‹çš„ç®¡ç†ä¸Šå°±æ›´åŠ çš„æ–¹ä¾¿ï¼Œåªè¦å°†ä¸€ä¸ªNSOperationï¼ˆå®é™…å¼€ä¸­éœ€è¦ä½¿ç”¨å…¶å­ç±»NSInvocationOperationã€NSBlockOperationï¼‰æ”¾åˆ°NSOperationQueueè¿™ä¸ªé˜Ÿåˆ—ä¸­çº¿ç¨‹å°±ä¼šä¾æ¬¡å¯åŠ¨ã€‚ NSOperationQueueè´Ÿè´£ç®¡ç†ã€æ‰§è¡Œæ‰€æœ‰çš„NSOperationï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¯ä»¥æ›´åŠ å®¹æ˜“çš„ç®¡ç†çº¿ç¨‹æ€»æ•°å’Œæ§åˆ¶çº¿ç¨‹ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚ NSOperationæœ‰ä¸¤ä¸ªå¸¸ç”¨å­ç±»ç”¨äºåˆ›å»ºçº¿ç¨‹æ“ä½œï¼šNSInvocationOperationå’ŒNSBlockOperationï¼Œä¸¤ç§æ–¹å¼å…¶å®æ²¡æœ‰åŒºåˆ«ï¼Œä½†æ˜¯æ˜¯åè€…ä½¿ç”¨Blockå½¢å¼è¿›è¡Œä»£ç ç»„ç»‡ï¼Œä½¿ç”¨èµ·æ¥ä¼šç›¸å¯¹äºå‰è€…æ›´åŠ æ–¹ä¾¿çµæ´»ã€‚ NSInvocationOperationï¼š123NSInvocationOperation *invocationOperation =[[NSInvocationOperation alloc]initWithTarget:self selector:@selector(loadImage) object:nil];//å¼€å§‹æ‰§è¡Œ[invocationOperation start]; NSBlockOperationï¼š12345678910111213141516NSBlockOperation *operation = [NSBlockOperation blockOperationWithBlock:^()&#123; NSLog(@&quot;æ‰§è¡Œç¬¬1æ¬¡æ“ä½œï¼Œçº¿ç¨‹ï¼š%@&quot;, [NSThread currentThread]); &#125;];//æ·»åŠ ä¸€ä¸ªæ–°çš„çº¿ç¨‹[operation addExecutionBlock:^() &#123; NSLog(@&quot;åˆæ‰§è¡Œäº†1ä¸ªæ–°çš„æ“ä½œï¼Œçº¿ç¨‹ï¼š%@&quot;, [NSThread currentThread]); &#125;];////æ·»åŠ ä¸€ä¸ªæ–°çš„çº¿ç¨‹[operation addExecutionBlock:^() &#123; NSLog(@&quot;åˆæ‰§è¡Œäº†1ä¸ªæ–°çš„æ“ä½œï¼Œçº¿ç¨‹ï¼š%@&quot;, [NSThread currentThread]); &#125;];//å¼€å§‹æ‰§è¡Œ[operation start];/*è¿™é‡Œä¸€å…±å¹¶å‘æ‰§è¡Œäº†ä¸‰ä¸ªçº¿ç¨‹*/ åœ¨åšå®Œä»¥ä¸Šçš„æ“ä½œå(ä¸ç®¡æ˜¯é€šè¿‡NSInvocationOperationè¿˜æ˜¯é€šè¿‡NSBlockOperation)è¯¥çº¿ç¨‹å¯åŠ¨æ‰§è¡Œï¼Œé»˜è®¤æ˜¯åœ¨å½“å‰çº¿ç¨‹åŒæ­¥æ‰§è¡Œçš„ï¼Œè°ƒç”¨startæ–¹æ³•åå¹¶ä¸ä¼šå»å¼€å¯ä¸€ä¸ªæ–°çš„çº¿ç¨‹å»æ‰§è¡Œæ“ä½œã€‚éœ€è¦å¦‚ä¸‹åˆ›å»ºä¸€ä¸ªæ“ä½œé˜Ÿåˆ—ï¼Œå°†NSOperationæ”¾å…¥æ“ä½œé˜Ÿåˆ—ä¸­ã€‚ 1234//åˆ›å»ºæ“ä½œé˜Ÿåˆ—NSOperationQueue *operationQueue=[[NSOperationQueue alloc]init];//æ³¨æ„æ·»åŠ åˆ°æ“ä½œé˜Ÿåï¼Œé˜Ÿåˆ—ä¼šå¼€å¯ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ­¤æ“ä½œ[operationQueue addOperation:operation]; å–æ¶ˆçº¿ç¨‹æ“ä½œï¼š 1[operation cancel]; çº¿ç¨‹ç»“æŸååšä¸€äº›æ“ä½œï¼š 123456//å¦‚æœæƒ³åœ¨ä¸€ä¸ªNSOperationæ‰§è¡Œå®Œæ¯•ååšä¸€äº›äº‹æƒ…ï¼Œå°±è°ƒç”¨NSOperationçš„setCompletionBlockæ–¹æ³•æ¥è®¾ç½®æƒ³åšçš„äº‹æƒ…operation.completionBlock = ^() &#123; NSLog(@&quot;æ‰§è¡Œå®Œæ¯•&quot;); &#125;; è®¾ç½®çº¿ç¨‹ä¾èµ–ï¼Œè¯¥æ–¹æ³•å¯ä»¥ç”¨æ¥å¤„ç†åœ¨æ‰§è¡Œä¸€ä¸ªæ“ä½œå‰éœ€è¦ç”¨åˆ°ä¸Šä¸€ä¸ªçº¿ç¨‹æ“ä½œçš„ç»“æœçš„æƒ…æ™¯ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ªç½‘ç»œè¯·æ±‚Bï¼Œè¯¥ç½‘ç»œéœ€è¦ç­‰å¾…ç½‘ç»œè¯·æ±‚Aè¯·æ±‚åˆ°çš„ç»“æœæ¥ä½œä¸ºç½‘ç»œè¯·æ±‚Bçš„å‚æ•°ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥è°çŸ¥ç½‘ç»œè¯·æ±‚Bçº¿ç¨‹ä¾èµ–ç½‘ç»œè¯·æ±‚Açº¿ç¨‹ï¼Œåœ¨Açº¿ç¨‹è¯·æ±‚ç»“æŸå¾—åˆ°ç»“æœåå†å‘èµ·ç½‘ç»œè¯·æ±‚Bã€‚ 12[operation addDependency:A];//operationçº¿ç¨‹åœ¨çº¿ç¨‹Aæ‰§è¡Œå®Œæˆåæ‰ä¼šæ‰§è¡Œ GCD(Grand Central Dispatch)GCD(Grand Central Dispatch)æ˜¯åŸºäºCè¯­è¨€å¼€å‘çš„ä¸€å¥—å¤šçº¿ç¨‹å¼€å‘æœºåˆ¶ï¼Œä¹Ÿæ˜¯ç›®å‰è‹¹æœå®˜æ–¹æ¨èçš„å¤šçº¿ç¨‹å¼€å‘æ–¹æ³•ã€‚GCDåœ¨ä¸‰ç§å¤šçº¿ç¨‹æ–¹å¼ä¸­æŠ½è±¡å±‚æ¬¡æœ€é«˜ï¼Œæ˜¯ç”¨èµ·æ¥ä¹Ÿæœ€ç®€å•ï¼Œå®ƒåŸºäºCè¯­è¨€å¼€å‘ï¼Œå¹¶ä¸åƒNSOperationæ˜¯é¢å‘å¯¹è±¡çš„å¼€å‘ï¼Œè€Œæ˜¯å®Œå…¨é¢å‘è¿‡ç¨‹çš„ã€‚è¿™ç§æœºåˆ¶ç›¸æ¯”è¾ƒäºå‰é¢ä¸¤ç§å¤šçº¿ç¨‹å¼€å‘æ–¹å¼æœ€æ˜¾è‘—çš„ä¼˜ç‚¹å°±æ˜¯å®ƒå¯¹äºå¤šæ ¸è¿ç®—æ›´åŠ æœ‰æ•ˆã€‚ GCDä¸­ä¹Ÿæœ‰ä¸€ä¸ªç±»ä¼¼äºNSOperationQueueçš„é˜Ÿåˆ—ï¼ŒGCDç»Ÿä¸€ç®¡ç†æ•´ä¸ªé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚ä½†æ˜¯GCDä¸­çš„é˜Ÿåˆ—åˆ†ä¸ºå¹¶è¡Œé˜Ÿåˆ—å’Œä¸²è¡Œé˜Ÿåˆ—ä¸¤ç±»ï¼š ä¸²è¡Œé˜Ÿåˆ—ï¼šä¸€æ¬¡åªæ‰§è¡Œä¸€ä¸ªçº¿ç¨‹ï¼ŒæŒ‰ç…§æ·»åŠ åˆ°é˜Ÿåˆ—çš„é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚ å¹¶å‘é˜Ÿåˆ—ï¼šä¸€æ¬¡å¯ä»¥æ‰§è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹çš„æ‰§è¡Œæ²¡æœ‰å…ˆåé¡ºåºã€‚æ ¹æ®åŒæ­¥æˆ–è€…å¼‚æ­¥æœ‰ä¸åŒçš„æ‰§è¡Œæ–¹å¼ã€‚æ”¾åˆ°å¹¶è¡Œé˜Ÿåˆ—çš„ä»»åŠ¡ï¼ŒGCDä¹Ÿä¼šFIFOçš„å–å‡ºæ¥ï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œä»–å–å‡ºæ¥ä¸€ä¸ªå°±ä¼šæ”¾åˆ°åˆ«çš„çº¿ç¨‹ï¼Œç„¶åå†å–å‡ºæ¥ä¸€ä¸ªåˆæ”¾åˆ°å¦ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œï¼Œä½†æ˜¯å› ä¸ºè¿™ä¸ªè¿‡ç¨‹ç›¸å½“çš„çŸ­æš‚ï¼Œæ‰€ä»¥å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œçœ‹èµ·æ¥æ‰€æœ‰çš„ä»»åŠ¡éƒ½æ˜¯ä¸€èµ·æ‰§è¡Œçš„ï¼Œä½†æ˜¯è¿˜æ˜¯å¾—æ³¨æ„å¹¶å‘çº¿ç¨‹çš„æ•°é‡ï¼Œæ•°é‡è¿‡å¤§åŒæ ·ä¼šå¯¹ç³»ç»Ÿæ€§èƒ½é€ æˆå½±å“ã€‚ åœ¨GCDä¸­è¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šé˜Ÿåˆ—å°±æ˜¯ä¸»é˜Ÿåˆ—ï¼Œç”¨æ¥æ‰§è¡Œä¸»çº¿ç¨‹ä¸Šçš„æ“ä½œä»»åŠ¡ã€‚åœ¨éœ€è¦æ›´æ–°UIçš„æ—¶å€™æˆ‘ä»¬å°±ä¼šç”¨åˆ°è¿™ä¸ªé˜Ÿåˆ—ï¼Œæˆ‘ä»¬ç”¨å¦‚ä¸‹çš„æ–¹å¼æ¥è·å–è¯¥é˜Ÿåˆ—ã€‚ 123dispatch_async(dispatch_get_main_queue(), ^&#123; //ä¸»é˜Ÿåˆ—ä¸­éœ€è¦è¿è¡Œçš„ä»£ç  &#125;); å¹¶å‘é˜Ÿåˆ—çš„åˆ›å»ºï¼šå¹¶å‘é˜Ÿåˆ—åŒæ ·æ˜¯ä½¿ç”¨dispatch_queue_create()æ–¹æ³•åˆ›å»ºï¼Œåªæ˜¯æœ€åä¸€ä¸ªå‚æ•°æŒ‡å®šä¸ºDISPATCH_QUEUE_CONCURRENTè¿›è¡Œåˆ›å»º,å¦‚ä¸‹ï¼š 1dispatch_queue_t concurrent = dispatch_queue_create(&quot;concurrentThread&quot;, DISPATCH_QUEUE_CONCURRENT); åœ¨å®é™…çš„ä½¿ç”¨ä¸­å…¶å®é€šå¸¸ä¸ä¼šå»åˆ›å»ºä¸€ä¸ªæ–°çš„å¹¶å‘é˜Ÿåˆ—ï¼Œä¸€èˆ¬ä¼šç”¨ä¸‹é¢çš„æ–¹å¼å»è·å–ç³»ç»Ÿä¸­çš„å…¨å±€å¹¶å‘é˜Ÿåˆ—æ¥æ‰§è¡Œä»»åŠ¡ã€‚ å…¨å±€å¹¶å‘é˜Ÿåˆ—çš„åˆ›å»ºï¼šåœ¨å®é™…å¼€å‘ä¸­é€šå¸¸ä¸ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªå…¨å±€å¹¶å‘é˜Ÿåˆ—è€Œæ˜¯ä½¿ç”¨dispatch_get_global_queue()æ–¹æ³•å–å¾—ä¸€ä¸ªå…¨å±€çš„å¹¶å‘é˜Ÿåˆ—ï¼ˆå¦‚æœæœ‰å¤šä¸ªå¹¶å‘é˜Ÿåˆ—å¯ä»¥ä½¿ç”¨å‰è€…åˆ›å»ºï¼‰ï¼Œå…¶ä¸­åœ¨è¯¥å…¨å±€å¹¶å‘é˜Ÿåˆ—ä¸­æœ‰å››ç§ä¼˜å…ˆçº§é€‰é¡¹ï¼Œä¸€èˆ¬æˆ‘ä»¬ä½¿ç”¨é»˜è®¤ï¼ˆDISPATCH_QUEUE_PRIORITY_DEFAULTï¼‰çš„å°±å¥½ï¼Œå››ç§ä¼˜å…ˆçº§å¦‚ä¸‹ï¼š 123456789/* * The global concurrent queues may still be identified by their priority, * which map to the following QOS classes: * * - DISPATCH_QUEUE_PRIORITY_HIGH: QOS_CLASS_USER_INITIATED * - DISPATCH_QUEUE_PRIORITY_DEFAULT: QOS_CLASS_DEFAULT * - DISPATCH_QUEUE_PRIORITY_LOW: QOS_CLASS_UTILITY * - DISPATCH_QUEUE_PRIORITY_BACKGROUND: QOS_CLASS_BACKGROUND */ 123456789101112 /*å–å¾—å…¨å±€é˜Ÿåˆ— ç¬¬ä¸€ä¸ªå‚æ•°ï¼šçº¿ç¨‹ä¼˜å…ˆçº§ ç¬¬äºŒä¸ªå‚æ•°ï¼šé¢„ç•™å‚æ•°ï¼Œç›®å‰æ²¡æœ‰ç”¨ï¼Œä¸€èˆ¬ä¼ å…¥0 */ dispatch_queue_t globalQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0); //åˆ›å»ºå¤šä¸ªçº¿ç¨‹ç”¨äºå¡«å……å›¾ç‰‡ for (int i=0; i&lt;count; ++i) &#123; //å¼‚æ­¥æ‰§è¡Œé˜Ÿåˆ—ä»»åŠ¡ dispatch_async(globalQueue, ^&#123;//çº¿ç¨‹ä¸­éœ€è¦æ‰§è¡Œçš„æ“ä½œ &#125;); &#125; å¹¶å‘æ•°çš„æ§åˆ¶å¹¶å‘å¤ªå¤šçš„æ—¶å€™æˆ‘ä»¬éœ€è¦å»æ§åˆ¶å¹¶å‘æ•°é‡ï¼Œå› ä¸ºå¹¶å‘å¤ªå¤šä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ï¼Œåœ¨å®é™…å¼€å‘ä¸­å¹¶å‘æ•°ä¸æ˜¯è¶Šå¤šè¶Šå¥½çš„ã€‚å› ä¸ºå¹¶å‘æ•°é‡å¤ªå¤§å¯¹ç³»ç»Ÿçš„å¼€é”€ï¼Œæ¶ˆè€—ä¼šå¢å¤§ï¼ŒåŒæ—¶å¯¹èµ„æºçš„è®¿é—®ä¹Ÿå¾ˆéš¾æ§åˆ¶ï¼Œå®¹æ˜“å¯¼è‡´æ­»é”ã€‚æˆ‘ä»¬ä½¿ç”¨dispatch_applyæ¥æ§åˆ¶æœ€å¤§å¹¶å‘æ•°ã€‚ 123456dispatch_queue_t globalQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);//çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ä¸º10size_t maxConcurrentThread = 10;dispatch_apply(maxConcurrentThread, globalQueue, ^(size_t i) &#123; //çº¿ç¨‹ä¸­éœ€è¦çš„æ“ä½œ&#125;); ä¸²è¡Œé˜Ÿåˆ—çš„åˆ›å»ºï¼š12345678910111213/*åˆ›å»ºä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ— ç¬¬ä¸€ä¸ªå‚æ•°ï¼šé˜Ÿåˆ—åç§° ç¬¬äºŒä¸ªå‚æ•°ï¼šé˜Ÿåˆ—ç±»å‹(ä¹Ÿå¯ä»¥ä¼ NULLï¼Œå› ä¸ºé»˜è®¤çš„å°±æ˜¯DISPATCH_QUEUE_SERIAL) */ dispatch_queue_t serialQueue = dispatch_queue_create(&quot;myThreadQueue1&quot;, DISPATCH_QUEUE_SERIAL);//æ³¨æ„queueå¯¹è±¡ä¸æ˜¯æŒ‡é’ˆç±»å‹ //åˆ›å»ºå¤šä¸ªçº¿ç¨‹ç”¨äºå¡«å……å›¾ç‰‡ for (int i=0; i&lt;count; ++i) &#123; //å¼‚æ­¥æ‰§è¡Œé˜Ÿåˆ—ä»»åŠ¡ dispatch_async(serialQueue, ^&#123; //çº¿ç¨‹ä¸­éœ€è¦çš„æ“ä½œ &#125;); &#125; å¼‚æ­¥ä¸åŒæ­¥ï¼šä¸Šé¢åˆ›å»ºçš„è¿™äº›çº¿ç¨‹æ“ä½œéƒ½æ˜¯å¼‚æ­¥æ“ä½œ dispatch_async()ï¼Œå¦‚æœè¦ä½¿ç”¨åŒæ­¥æ“ä½œåˆ™æ˜¯ dispatch_sync()ã€‚ åŒæ­¥æ‰§è¡Œ(é˜»å¡å½“å‰çº¿ç¨‹) å¼‚æ­¥æ‰§è¡Œï¼ˆä¸é˜»å¡å½“å‰çº¿ç¨‹ï¼‰ ä¸²è¡Œé˜Ÿåˆ— å½“å‰çº¿ç¨‹ï¼Œä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œï¼ˆFIFOï¼‰ å…¶ä»–çº¿ç¨‹ï¼Œä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œï¼ˆFIFOï¼‰ å¹¶è¡Œé˜Ÿåˆ— å½“å‰çº¿ç¨‹ï¼Œä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œï¼ˆFIFOï¼‰ å¤šä¸ªçº¿ç¨‹ï¼Œä¸€èµ·æ‰§è¡Œ è·å–å…¬å…±é˜Ÿåˆ—å…¶å®è¿™ä¸ªåœ¨ä¸Šé¢ä¹Ÿæœ‰æåˆ°ï¼Œé€šè¿‡è¿™å‡ ç§æ–¹æ³•å¯ä»¥è·å–åˆ°ç³»ç»Ÿé¢„è®¾çš„å…¬å…±é˜Ÿåˆ—: dispatch_get_current_queueï¼šåœ¨iOS 6.0ä¹‹åå·²ç»åºŸå¼ƒï¼Œç”¨äºè·å–å½“å‰æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„é˜Ÿåˆ—ï¼Œä¸»è¦ç”¨äºè°ƒè¯• dispatch_get_main_queueï¼š æœ€å¸¸ç”¨çš„ï¼Œç”¨äºè·å–åº”ç”¨ä¸»çº¿ç¨‹å…³è”çš„ä¸²è¡Œè°ƒåº¦é˜Ÿåˆ— dispatch_get_global_queueï¼šæœ€å¸¸ç”¨çš„ï¼Œç”¨äºè·å–åº”ç”¨å…¨å±€å…±äº«çš„å¹¶å‘é˜Ÿåˆ— åé¢è¿™ä¸¤ä¸ªåˆ†åˆ«è·å–ä¸»çº¿ç¨‹çš„ä¸²è¡Œé˜Ÿåˆ—å’Œè·å–åº”ç”¨å…¨å±€å…±äº«çš„å¹¶å‘é˜Ÿåˆ—æ˜¯éå¸¸å¸¸ç”¨çš„ï¼Œå½“æˆ‘ä»¬éœ€è¦å¼€ä¸€ä¸ªçº¿ç¨‹å¹¶å‘åœ°å¼‚æ­¥æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œæˆ‘ä»¬å°±ä¼šæ”¾åˆ°å…¨å±€é˜Ÿåˆ—ä¸­ã€‚å½“æˆ‘ä»¬åœ¨å¼‚æ­¥æ‰§è¡Œå®Œæˆæ—¶ï¼Œé€šå¸¸éœ€è¦å›åˆ°ä¸»çº¿ç¨‹æ›´æ–°UIæ˜¾ç¤ºã€‚ é˜Ÿåˆ—çš„å†…å­˜ç®¡ç†é˜Ÿåˆ—ï¼Œå³Dispatch Queueä¸å…¶å®ƒç±»å‹çš„dispatchå¯¹è±¡æ˜¯å¼•ç”¨è®¡æ•°çš„æ•°æ®ç±»å‹ã€‚å½“åˆ›å»ºä¸€ä¸ªä¸²è¡Œdispatch queueæ—¶,åˆå§‹å¼•ç”¨è®¡æ•°ä¸º1,æˆ‘ä»¬å¯ç”¨dispatch_retainå’Œdispatch_releaseå‡½æ•°æ¥å¢åŠ å’Œå‡å°‘å¼•ç”¨è®¡æ•°ã€‚å½“å¼•ç”¨è®¡æ•°ä¸º0æ—¶,ç³»ç»Ÿä¼šå¼‚æ­¥åœ°é”€æ¯è¿™ä¸ªqueueã€‚å¯¹äºç³»ç»Ÿé¢„è®¾æä¾›çš„é˜Ÿåˆ—æ­¤æ–¹æ³•æ— æ•ˆï¼Œç³»ç»Ÿé¢„è®¾çš„é˜Ÿåˆ—ä¸éœ€è¦æˆ‘ä»¬æ¥ç®¡ç†ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç®¡ç†è¯¥é˜Ÿåˆ—ã€‚ æš‚åœ/ç»§ç»­é˜Ÿåˆ—12dispatch_suspend(gqueue);dispatch_resume(gqueue); é˜Ÿåˆ—ç»„çš„ä½¿ç”¨å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦è¿›è¡Œå¤šä¸ªæ“ä½œï¼Œä½†æ˜¯éœ€è¦è¿™äº›æ“ä½œéƒ½å®Œæˆä»¥åæ‰èƒ½å›åˆ°ä¸»é˜Ÿåˆ—å»æ›´æ–°UIï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨è¿™æ ·çš„æ–¹å¼ä½¿ç”¨é˜Ÿåˆ—ç»„æ¥å®Œæˆè¿™æ ·çš„è¦æ±‚ã€‚ 123456789101112131415161718192021dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0); // å¼‚æ­¥æ‰§è¡Œdispatch_async(queue, ^&#123; // åˆ›å»ºä¸€ä¸ªç»„ dispatch_group_t group = dispatch_group_create(); // åˆ†åˆ«å°†ä»»åŠ¡æ·»åŠ åˆ°ç»„ä¸­ dispatch_group_async(group, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; &#125;); dispatch_group_async(group, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123; &#125;); // ç­‰å¾…ç»„ä¸­çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•,å›åˆ°ä¸»çº¿ç¨‹æ‰§è¡Œblockå›è°ƒ dispatch_group_notify(group, dispatch_get_main_queue(), ^&#123; &#125;);&#125;); å»¶è¿Ÿæ‰§è¡Œ ä½¿ç”¨NSObjectæä¾›çš„APIåŒæ­¥æ‰§è¡Œï¼Œä½†æ˜¯è¯¥ç±»ä¼¼æ–¹æ³•åœ¨swiftè¯­è¨€ä¸­å·²ç»åºŸå¼ƒï¼ŒåŸå› çš„ä¸å®‰å…¨ã€‚ 1[self performSelector:@selector(myFunction) withObject:nil afterDelay:5.0]; é€šè¿‡ä½¿ç”¨è®¡æ—¶å™¨æ¥è¾¾åˆ°å»¶è¿Ÿæ‰§è¡Œçš„æ•ˆæœ ä½¿ç”¨dispatch_afteræ–¹æ³•å¼‚æ­¥å»¶è¿Ÿæ‰§è¡Œ 123456CGFloat time = 5.0f;dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(time * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123; // timeç§’åå¼‚æ­¥æ‰§è¡Œè¿™é‡Œçš„ä»£ç ... &#125;); æœ€åé™„ä¸ŠGCDä¸­çš„ç®€å•ä½¿ç”¨çš„Demo GCDDemo","categories":[],"tags":[{"name":"iOSå¤šçº¿ç¨‹","slug":"iOSå¤šçº¿ç¨‹","permalink":"Aaronzjp.cn/tags/iOSå¤šçº¿ç¨‹/"}]},{"title":"iOSå¼€å‘-æ–‡ä»¶ç®¡ç†","slug":"File-Manager","date":"2016-04-28T04:53:47.000Z","updated":"2017-07-27T02:57:17.000Z","comments":true,"path":"2016/04/28/File-Manager/","link":"","permalink":"Aaronzjp.cn/2016/04/28/File-Manager/","excerpt":"â€‹ åœ¨ iOS å¼€å‘ä¸­ï¼Œæ€»æ˜¯æœ‰éœ€æ±‚æˆ‘ä»¬éœ€è¦åœ¨æœ¬åœ°å­˜å‚¨æ•°æ®ï¼Œä½†æ˜¯å­˜å‚¨æ•°æ®çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬æ€ä¹ˆæ ·å»å†³å®šç”¨ä»€ä¹ˆæ–¹å¼å»å­˜å‚¨æ•°æ®ï¼Ÿç›®å‰ iOS å¼€å‘ä¸­å­˜å‚¨æ•°æ®çš„æ–¹å¼æœ‰å±æ€§åˆ—è¡¨ã€å¯¹è±¡å½’æ¡£ã€æ•°æ®åº“ï¼ˆSQLiteï¼ŒCore Dataï¼‰ç­‰ï¼Œæœ€ç»ˆè¿™äº›æ•°æ®éƒ½ä¼šä»¥æŸäº›æ–‡ä»¶ç­‰å½¢å¼å­˜å…¥è¯¥Appå¯¹åº”çš„æ²™ç›’ï¼ˆSandBoxï¼‰ç›®å½•ä¸­ã€‚","text":"â€‹ åœ¨ iOS å¼€å‘ä¸­ï¼Œæ€»æ˜¯æœ‰éœ€æ±‚æˆ‘ä»¬éœ€è¦åœ¨æœ¬åœ°å­˜å‚¨æ•°æ®ï¼Œä½†æ˜¯å­˜å‚¨æ•°æ®çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬æ€ä¹ˆæ ·å»å†³å®šç”¨ä»€ä¹ˆæ–¹å¼å»å­˜å‚¨æ•°æ®ï¼Ÿç›®å‰ iOS å¼€å‘ä¸­å­˜å‚¨æ•°æ®çš„æ–¹å¼æœ‰å±æ€§åˆ—è¡¨ã€å¯¹è±¡å½’æ¡£ã€æ•°æ®åº“ï¼ˆSQLiteï¼ŒCore Dataï¼‰ç­‰ï¼Œæœ€ç»ˆè¿™äº›æ•°æ®éƒ½ä¼šä»¥æŸäº›æ–‡ä»¶ç­‰å½¢å¼å­˜å…¥è¯¥Appå¯¹åº”çš„æ²™ç›’ï¼ˆSandBoxï¼‰ç›®å½•ä¸­ã€‚ æ²™ç®±ç›®å½•â€‹ æ¯ä¸ª iOS ç¨‹åºéƒ½æœ‰è‡ªå·±ç‹¬ç«‹å¯¹åº”çš„å­˜å‚¨ç©ºé—´ï¼ˆæ²™ç›’ï¼‰ï¼Œæ²™ç›’ç›®å½•æ˜¯ä¸€ç§å‡ºäºå¯¹æ•°æ®å®‰å…¨ç­–ç•¥çš„è®¾è®¡ã€‚æ²™ç›’è®¾è®¡çš„åŸç†å°±æ˜¯åªèƒ½å…è®¸è‡ªå·±å¯¹åº”çš„åº”ç”¨è®¿é—®ï¼Œè€Œä¸å…è®¸å…¶ä»–çš„åº”ç”¨ç›´æ¥è®¿é—®æ²™ç›’ï¼Œä¸€èˆ¬æ¥è¯´ç¨‹åºä¹‹é—´æ˜¯ä¸å¯ä»¥ç›¸äº’è®¿é—®æ²™ç›’çš„ã€‚ â€‹ å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç¨‹åºæ—¶ï¼Œè¯¥ç¨‹åºæ²™ç›’ä¸­é»˜è®¤ç›®å½•æ˜¯è¿™æ ·çš„ä¸‰ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«æ˜¯ Documentã€Libraryã€tmpã€‚å…¶ä¸­Libraryä¸‹åˆæœ‰ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«æ˜¯Preferencesã€Cachesï¼Œä»–ä»¬çš„ç”¨é€”ï¼Œä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼š Documentï¼šè¯¥ç›®å½•ä¸€èˆ¬ç”¨äºå­˜å‚¨éå¸¸å¤§çš„æ–‡ä»¶æˆ–è€…é¢‘ç¹æ›´æ–°çš„æ•°æ®ï¼Œä¸€èˆ¬æ•°æ®åº“ï¼Œå¤§å‹æŒä¹…åŒ–çš„æ•°æ®éƒ½å­˜æ”¾åœ¨æ­¤ç›®å½•ä¸‹ã€‚å¯ä»¥åœ¨æ­¤ç›®å½•ä¸‹æ·»åŠ å­æ–‡ä»¶å¤¹ï¼Œèƒ½å¤Ÿé€šè¿‡ iTunes æˆ–è€… iCloud å¤‡ä»½ã€‚ Libraryï¼šåœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹æœ‰ä¸¤ä¸ªç›®å½• Preferencesï¼šè¯¥ç›®å½•ä¸€èˆ¬ç”¨æˆ·å­˜æ”¾åº”ç”¨ç¨‹åºçš„è®¾ç½®æ•°æ®ï¼Œ Cachesï¼šè¿™ä¸ªç›®å½•å’ŒDocumentå¾ˆç›¸ä¼¼ï¼Œå¯ä»¥å­˜æ”¾åº”ç”¨ç¨‹åºçš„æ•°æ®ï¼Œç”¨æ¥å­˜å‚¨ç¼“å­˜æ–‡ä»¶ tmpï¼šè¿™æ˜¯ä¸´æ—¶æ–‡ä»¶ç›®å½•ï¼Œç”¨æˆ·å¯ä»¥è®¿é—®æ­¤ç›®å½•ï¼Œè¯¥ç›®å½•ä¸èƒ½å¤Ÿé€šè¿‡ iTunes æˆ–è€… iCloud å¤‡ä»½ã€‚ å„ä¸ªæ–‡ä»¶å¤¹çš„è·¯å¾„è·å–æ–¹å¼å¦‚ä¸‹ï¼š 1234567891011121314NSString *homeString = NSHomeDirectory(); NSLog(@&quot;ç¨‹åºæ ¹ç›®å½•ï¼š%@&quot;,homeString); NSString *DocumentPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject]; NSLog(@&quot;Documentç›®å½•:%@&quot;,DocumentPath); NSString *LibraryPath = [NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES) lastObject]; NSLog(@&quot;Libraryç›®å½•:%@&quot;,LibraryPath); NSString *CachesPath = [NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES) lastObject]; NSLog(@&quot;Cachesç›®å½•:%@&quot;,CachesPath); NSString *tempPath = NSTemporaryDirectory(); NSLog(@&quot;tempç›®å½•ï¼š%@&quot;,tempPath); NSFileManagerNSFileManagerè¿™ä¸ªç±»å¬åå­—ä¹Ÿåº”è¯¥çŸ¥é“è¯¥ç±»ä¸»è¦è´Ÿè´£æ–‡ä»¶çš„ç®¡ç†ï¼Œæ–‡ä»¶çš„å¢åˆ æŸ¥æ”¹ï¼Œä»¥åŠæ–‡ä»¶å±æ€§çš„ç®¡ç†ã€‚ ä½¿ç”¨NSFileManageræ¥ç®¡ç†æ–‡ä»¶é¦–å…ˆåˆå§‹åŒ–ä¸€ä¸ªNSFileManagerçš„å¯¹è±¡ã€‚ 12// NSFileManageræ˜¯ä¸€ä¸ªå•ä¾‹å¯¹è±¡ï¼Œåªå®ä¾‹åŒ–ä¸€æ¬¡ã€‚NSFileManager *manager = [NSFileManager defaultManager]; åˆ›å»ºæ–‡ä»¶å¤¹ï¼š 1234567891011NSString *docPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,NSUserDomainMask,YES) lastObject];NSString *directoryPath = [docPath StringByAppedingPathComponent:@&quot;Test&quot;];BOOL isSucces = [manager createDirectoryAtPath:directoryPath withIntermediateDirectories:YES attributes:nil error:nil];if (isSuccess) &#123; NSLog(@&quot;åˆ›å»ºæˆåŠŸ!&quot;);&#125; else &#123; NSLog(@&quot;åˆ›å»ºå¤±è´¥ï¼&quot;);&#125; åˆ›å»ºæ–‡ä»¶ï¼š 12345// åˆ›å»ºæ–‡ä»¶çš„ä¿å­˜è·¯å¾„NSString *filePath = [directoryPath stringByAppendingPathComponent:@&quot;userInfo.plist&quot;];//ä½¿ç”¨ NSFileManager åˆ›å»ºæ–‡ä»¶BOOL isSuccess = [manager createFileAtPath:filePath contents:nil attributes:nil]; åˆ é™¤æ–‡ä»¶ï¼š 12// ä½¿ç”¨NSFileManager ç§»é™¤æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶BOOL isSuccess = [manager removeItemAtPath:directoryPath error:nil]; è·å–æ–‡ä»¶å±æ€§ï¼š 12NSDictionary *fileAttribute = [manager attributesOfItemAtPath:subPathString error:nil];NSLog(@&quot;%@&quot;,fileAttribute); å†™å…¥æ–‡ä»¶ï¼š å°†æ•°æ®å†™å…¥æ–‡ä»¶çš„æ–¹å¼ä¸»è¦æ˜¯çœ‹å…·ä½“çš„æ–‡ä»¶æ˜¯ä»€ä¹ˆï¼Œæ¯”å¦‚NSStringã€NSArrayã€NSDictionaryã€NSDataç­‰ï¼Œéƒ½æœ‰å°†æ•°æ®å†™å…¥æ–‡ä»¶çš„æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼ŒåŸºæœ¬æ˜¯WriteToFileï¼šatomicallyï¼šæ ¼å¼çš„æ–¹æ³•ï¼š 12345 NSMutableDictionary *info = [NSMutableDictionary dictionary];[info setObject:@&quot;2015å¹´10æœˆ26æ—¥13:05:46&quot; forKey:@&quot;date&quot;];[info setObject:@&quot;TEST&quot; forKey:@&quot;content&quot;];// å†™å…¥æ•°æ®BOOL isSuccess = [info writeToFile:filePath atomically:YES];","categories":[],"tags":[{"name":"æ•°æ®å­˜å‚¨","slug":"æ•°æ®å­˜å‚¨","permalink":"Aaronzjp.cn/tags/æ•°æ®å­˜å‚¨/"},{"name":"æœ¬åœ°åŒ–","slug":"æœ¬åœ°åŒ–","permalink":"Aaronzjp.cn/tags/æœ¬åœ°åŒ–/"},{"name":"æ–‡ä»¶ç®¡ç†","slug":"æ–‡ä»¶ç®¡ç†","permalink":"Aaronzjp.cn/tags/æ–‡ä»¶ç®¡ç†/"}]},{"title":"iOSå¼€å‘-SQLiteæ•°æ®åº“","slug":"SQLite-DataBase","date":"2016-04-20T13:00:25.000Z","updated":"2017-07-27T02:53:31.000Z","comments":true,"path":"2016/04/20/SQLite-DataBase/","link":"","permalink":"Aaronzjp.cn/2016/04/20/SQLite-DataBase/","excerpt":"â€‹ åœ¨ iOS å¼€å‘ä¸­æˆ‘ä»¬ç»å¸¸ä¼šå¯¹æ•°æ®è¿›è¡Œå­˜å‚¨ï¼Œæˆ‘ä»¬å·²çŸ¥æœ‰å¦‚ä¸‹å‡ ç§æ•°æ®æœ¬åœ°åŒ–çš„æ–¹å¼ï¼š å±æ€§åˆ—è¡¨ å¯¹è±¡å½’æ¡£ SQLiteæ•°æ®åº“ Core Data","text":"â€‹ åœ¨ iOS å¼€å‘ä¸­æˆ‘ä»¬ç»å¸¸ä¼šå¯¹æ•°æ®è¿›è¡Œå­˜å‚¨ï¼Œæˆ‘ä»¬å·²çŸ¥æœ‰å¦‚ä¸‹å‡ ç§æ•°æ®æœ¬åœ°åŒ–çš„æ–¹å¼ï¼š å±æ€§åˆ—è¡¨ å¯¹è±¡å½’æ¡£ SQLiteæ•°æ®åº“ Core Data â€‹ å…¶ä¸­ï¼Œå‰ä¸¤é¡¹å±æ€§åˆ—è¡¨ä»¥åŠå½’æ¡£éƒ½åªé€‚åˆè½»é‡åŒ–çš„æ•°æ®å­˜å‚¨ï¼Œå¯¹äºæ¯”è¾ƒå°‘é‡çš„è½»é‡çº§çš„æ•°æ®æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å±æ€§åˆ—è¡¨ä»¥åŠå¯¹è±¡å½’æ¡£çš„æ–¹å¼æ¥è¿›è¡Œå­˜å‚¨ã€‚ä½†æ˜¯åœ¨éœ€è¦å­˜å‚¨å¤§é‡çš„æ•°æ®çš„æ—¶å€™æˆ‘ä»¬å°±éœ€è¦åˆ©ç”¨æ•°æ®åº“æ¥å¯¹æ•°æ®è¿›è¡Œå­˜å‚¨ã€‚iOSå¼€å‘ä¸­æ¯”è¾ƒå¸¸ç”¨çš„æ•°æ®åº“æœ‰ SQLite ï¼ŒCore Data ï¼Œå½“ç„¶ä¹Ÿæœ‰ä¸€äº›å…¶å®ƒçš„ç¬¬ä¸‰æ–¹çš„æ¡†æ¶å®ç°å¯¹æ•°æ®åº“çš„å­˜å‚¨å’Œæ“ä½œï¼Œæ¯”å¦‚FMDBï¼ŒRealmã€‚ SQLiteâ€‹ SQLite æ˜¯ä¸€æ¬¾å¼€æºçš„æ•°æ®åº“ï¼Œä¸»è¦é‡‡ç”¨ C è¯­è¨€ç¼–å†™ï¼Œå…·æœ‰å¯ç§»æ¤æ€§å¼ºã€å¯é æ€§é«˜ã€å°è€Œå®¹æ˜“ä½¿ç”¨çš„ç‰¹ç‚¹ã€‚SQLite åœ¨ä½¿ç”¨çš„æ—¶å€™å®ƒä¸åº”ç”¨ç¨‹åºä¹‹é—´æ˜¯å…±ç”¨çš„ç›¸åŒçš„è¿›ç¨‹ï¼Œè€Œä¸æ˜¯å•ç‹¬çš„ä¸¤ä¸ªè¿›ç¨‹ã€‚SQLite ç›®å‰çš„ä¸»æµç‰ˆæœ¬æ˜¯ SQLite3 ã€‚SQLite æ˜¯å¼±ç±»å‹çš„æ•°æ®åº“ï¼Œå…¶å®åŸºæœ¬ä¸Šå¯ä»¥å¿½ç•¥æ•°æ®ç±»å‹ï¼Œä½†æ˜¯ä¸ºäº†ç¼–ç¨‹è§„èŒƒï¼Œä»¥åŠåç»­æ–¹ä¾¿çš„ç»´æŠ¤ï¼Œå»ºè®®è¿˜æ˜¯åœ¨åˆ›å»ºæ•°æ®åº“è¡¨çš„æ—¶å€™æ˜ç¡®å®šä¹‰å„ä¸ªå­—æ®µçš„æ•°æ®ç±»å‹ã€‚ â€‹ SQLiteæ”¯æŒå¦‚ä¸‹å¸¸è§çš„æ•°æ®ç±»å‹ï¼š æ•°æ®ç±»å‹ å’Œç¨‹åºå¯¹åº”çš„æ•°æ®ç±»å‹ INTEGER æœ‰ç¬¦å·çš„æ•´æ•°ç±»å‹ REAl æµ®ç‚¹ç±»å‹ TEXT å­—ç¬¦ä¸²ç±»å‹ï¼Œé‡‡ç”¨UTF-8UTF-16å­—ç¬¦ç¼–ç  BLOB äºŒè¿›åˆ¶å¤§å¯¹è±¡ç±»å‹ï¼Œèƒ½å¤Ÿå­˜æ”¾ä»»ä½•äºŒè¿›åˆ¶æ•°æ® é™¤äº†ä¸Šé¢è¿™äº›æ•°æ®ç±»å‹çš„æ”¯æŒï¼Œè¿˜æœ‰ä¸€äº›å…¼å®¹çš„æ•°æ®ç±»å‹ã€‚å…¶ä¸­ SQLite ä¸­æ˜¯æ²¡æœ‰ Boolean ç±»å‹çš„ï¼Œä¸€èˆ¬æˆ‘ä»¬ç”¨ 0 å’Œ 1 æ¥ä»£æ›¿ï¼Œä¹Ÿæ²¡æœ‰æ—¥æœŸå’Œæ—¶é—´ç±»å‹ï¼Œä¸€èˆ¬è¿™æ ·çš„ç±»å‹æˆ‘ä»¬å°†å®ƒå­˜å‚¨åœ¨ TEXT ã€ REAL å’Œ INTEGER ç±»å‹ä¸­ã€‚ åˆ›å»ºæ•°æ®åº“è¦æƒ³ç†Ÿç»ƒçš„ä½¿ç”¨ SQLite æ•°æ®åº“ï¼Œé¦–å…ˆè¿˜æ˜¯éœ€è¦ç†Ÿæ‚‰ä¸€ä¸‹ SQLite æ•°æ®åº“ç®€å•çš„å¢ã€åˆ ã€æ”¹ã€æŸ¥çš„ SQLè¯­å¥ çš„ï¼Œèƒ½ç®€å•çš„ä½¿ç”¨ SQL çš„æŸ¥è¯¢è¯­å¥ã€‚ åœ¨ iOSä¸­ æˆ‘ä»¬è¦ä½¿ç”¨ SQLite æ•°æ®åº“é¦–å…ˆè¦æ·»åŠ  SQLite åº“åˆ°å·¥ç¨‹ä¸­ï¼Œå¹¶å¼•å…¥å¤´æ–‡ä»¶ sqlite3.h è¦åˆ›å»ºæ•°æ®åº“ï¼Œä¸€èˆ¬ä½¿ç”¨ä»¥ä¸‹ä¸‰ä¸ªæ­¥éª¤ ä½¿ç”¨ sqlite3_open å‡½æ•°æ‰“å¼€æ•°æ®åº“ã€‚ ä½¿ç”¨ sqlite3_exec å‡½æ•°æ¥åˆ›å»ºæ•°æ®åº“è¡¨ã€‚ ä½¿ç”¨ sqlite3_close å‡½æ•°å…³é—­æ•°æ®åº“ã€‚ åœ¨æˆ‘çš„ Demo ä¸­ï¼Œæˆ‘é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªå« SQLiteManager çš„ç±»ï¼Œæ¥ä¸“é—¨ç®¡ç†æ•°æ®åº“çš„æ“ä½œï¼Œåœ¨- (BOOL)creatDB;æ–¹æ³•ä¸­å¼€å§‹åˆ›å»ºæ•°æ®åº“è¡¨ï¼Œå¹¶è¿”å›æ˜¯å¦æˆåŠŸåˆ›å»ºæ•°æ®åº“è¡¨ï¼Œå¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839- (BOOL)creatDB &#123; //è·å–Documentsæ–‡ä»¶è·¯å¾„ NSString *basePath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject]; //æ‹¼æ¥è·å–æ•°æ®åº“çš„åœ°å€ dataBasePath = [[NSString alloc]initWithString:[basePath stringByAppendingPathComponent:DATA_BASE_NAME]]; NSLog(@&quot;æ•°æ®åº“åœ°å€---&gt; %@&quot;,dataBasePath); //è¿”å›æˆåŠŸä¸å¦ BOOL isSuccess = YES; //æ‰“å¼€æ•°æ®åº“ //ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°æ®åº“å®Œæ•´çš„åœ°å€ //ç¬¬äºŒä¸ªå‚æ•°æ˜¯SQLiteæ•°æ®åº“å¯¹è±¡ //SQLITE_OK æ˜¯SQLiteä¸­çš„å¸¸é‡å®å®šä¹‰ï¼Œè¡¨ç¤ºå½“å‰æ•°æ®åº“æ“ä½œçš„çŠ¶æ€ if (sqlite3_open([dataBasePath UTF8String], &amp;db) == SQLITE_OK) &#123; char *erro; //æ•°æ®åº“SQLè¯­å¥ï¼Œå½“Personè¡¨ä¸å­˜åœ¨çš„æ—¶å€™å°±åˆ›å»ºï¼Œå¦åˆ™å°±ä¸åˆ›å»º NSString *createSQLite = [NSString stringWithFormat:@&quot;CREATE TABLE IF NOT EXISTS Person (name TEXT PRIMARY KEY, phone TEXT, age TEXT);&quot;]; //æ•°æ®åº“å»ºè¡¨å‡½æ•° if (sqlite3_exec(db, [createSQLite UTF8String], NULL, NULL, &amp;erro) != SQLITE_OK) &#123; //å…³é—­æ•°æ®åº“ï¼Œé‡Šæ”¾èµ„æº sqlite3_close(db); NSAssert(NO, @&quot;æ•°æ®åº“å»ºè¡¨å¤±è´¥ï¼&quot;); return isSuccess = NO; &#125; else &#123; sqlite3_close(db); NSLog(@&quot;æ•°æ®åº“å»ºè¡¨æˆåŠŸï¼&quot;); return isSuccess; &#125; &#125; else &#123; //æ³¨æ„åªè¦æ‰§è¡Œäº†æ•°æ®åº“æ‰“å¼€å‡½æ•°çš„æ“ä½œï¼Œä¸ç®¡æ•°æ®åº“æ˜¯å¦æ‰“å¼€æˆåŠŸæˆ–å¤±è´¥ï¼Œä¸ºäº†å®‰å…¨èµ·è§éƒ½éœ€è¦å…³é—­æ•°æ®åº“ sqlite3_close(db); NSAssert(NO, @&quot;æ•°æ®åº“æ‰“å¼€å¤±è´¥!&quot;); return isSuccess = NO; &#125; return isSuccess;&#125; ä¸Šé¢è¿™æ®µä»£ç ä¸­çš„ SQL è¯­å¥ï¼š 1NSString *createSQLite = [NSString stringWithFormat:@&quot;CREATE TABLE IF NOT EXISTS Person (name TEXT PRIMARY KEY, phone TEXT, age TEXT);&quot;]; åœ¨åˆ›å»ºæ•°æ®åº“è¡¨çš„æ—¶å€™å­˜å…¥äº†ä¸‰ç§æ•°æ®ï¼Œnameã€phoneã€ageã€‚å…¶ä¸­ name æ˜¯ä¸»é”®ã€‚åœ¨ SQL è¯­å¥ä¸­ï¼Œè¿˜å¯ä»¥åŠ å…¥å­—æ®µçº¦æŸï¼Œæ¯”å¦‚ï¼š 1NSString *sql = @&quot;create table if not exists stu (ID integer primary key, name text not null, gender text default &apos;ç”·&apos;)&quot;; ä»¥ä¸‹æ˜¯ SQLite ä¸­å¸¸ç”¨çš„å­—æ®µçº¦æŸæ¡ä»¶ï¼š NOT NULL éç©ºï¼Œç¡®ä¿æŸåˆ—ä¸èƒ½æœ‰ NULL å€¼ã€‚ UNIQUE å”¯ä¸€ï¼Œç¡®ä¿æŸåˆ—ä¸­çš„æ‰€æœ‰å€¼æ˜¯ä¸åŒçš„ã€‚ PRIMARY KEY ä¸»é”®ï¼Œå”¯ä¸€æ ‡è¯†æ•°æ®åº“è¡¨ä¸­çš„å„è¡Œ/è®°å½•ã€‚ CHECK æ¡ä»¶æ£€æŸ¥ï¼Œç¡®ä¿ä¸€åˆ—ä¸­çš„æ‰€æœ‰å€¼æ»¡è¶³ä¸€å®šæ¡ä»¶ DEFAULT é»˜è®¤ï¼Œå½“æŸåˆ—æ²¡æœ‰æŒ‡å®šå€¼æ—¶ï¼Œä¸ºè¯¥åˆ—æä¾›é»˜è®¤å€¼ å½“å†™å®Œä¸Šé¢ä»£ç åï¼Œåªè¦è¿è¡Œç¨‹åºæˆ‘ä»¬å°±èƒ½åœ¨ç›¸å¯¹åº”çš„æ¨¡æ‹Ÿå™¨è·¯å¾„ä¸‹æ‰¾åˆ° Person.sqlite æ–‡ä»¶äº†ï¼Œå½“ç„¶ä¸ºäº†è°ƒè¯•æ–¹ä¾¿ï¼Œçœ‹ç¨‹åºæ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œæœ€å¥½è¿˜æ˜¯åœ¨ç”µè„‘ä¸Šå®‰è£…ä¸€ä¸ª SQLite çš„å·¥å…·ï¼Œä»¥ä¾¿æŸ¥çœ‹æ•°æ®åº“ã€‚æˆ‘æ¨èå¦‚ä¸‹å›¾è¿™ä¸ªå·¥å…·å§ï¼Œå…·ä½“çš„ä½¿ç”¨è¿˜æ˜¯çœ‹ä¸ªäººçš„ä¹ æƒ¯ã€‚ï¼ˆä¸è¦é—®æˆ‘ä»å“ªä¸‹ã€‚ã€‚ã€‚æˆ‘ç›¸ä¿¡ä½ ä»¬æ‰¾å¾—åˆ°ğŸ˜€ï¼‰ å­˜å‚¨æ•°æ®ï¼ˆä¿®æ”¹æ•°æ®ï¼‰ä¿®æ”¹æ•°æ®æ—¶ï¼Œä¼šä½¿ç”¨åˆ°çš„ SQL è¯­å¥æœ‰ insert ã€update ã€delete ã€insert or replace ç­‰ã€‚è¿™æ¬¡ Demo ä¸­å­˜å‚¨æ•°æ®ä½¿ç”¨çš„æ˜¯ insert or replace ï¼Œå› ä¸ºè¿™é‡Œæ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„è§„åˆ’ï¼Œæ²¡æœ‰å¯¹å¦‚æœä¸»é”®çš„æ•°æ®æ˜¯ç›¸åŒçš„æƒ…å†µä½œå‡ºå¤„ç†ï¼Œå¦‚æœç”¨ insert çš„è¯ï¼Œä¸»é”®ç›¸åŒçš„æ—¶å€™ï¼Œå°±ä¼šå­˜å‚¨æ•°æ®å¤±è´¥ï¼Œä¿®æ”¹æ•°æ®çš„æ“ä½œæ­¥éª¤éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ SQL è¯­å¥ä¸ä¸€æ ·ã€‚ ä¿®æ”¹æ•°æ®çš„ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š ä½¿ç”¨ sqlite3_open å‡½æ•°æ‰“å¼€æ•°æ®åº“ ä½¿ç”¨ sqlite3_prepare_v2 å‡½æ•°ä¸å¤„ç† SQL è¯­å¥ ä½¿ç”¨ sqlite3_bind_text å‡½æ•°æ¥ç»‘å®šå‚æ•° ä½¿ç”¨ sqlite3_step å‡½æ•°æ‰§è¡Œ SQL è¯­å¥ æŸ¥è¯¢ç»“æŸåä½¿ç”¨ sqlite3_ finalize å’Œ sqlite3_close å‡½æ•°é‡Šæ”¾èµ„æº Demo ä¸­åªæ˜¯å­˜å‚¨äº†ç®€å•çš„æ•°æ®ç±»å‹ï¼Œå› ä¸ºåœ¨å†™è¿™ä¸ª Demo æ—¶æˆ‘å¿½ç•¥äº†æ•°æ®åº“ç±»å‹ BLOB æˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œå›¾ç‰‡ï¼ŒéŸ³é¢‘ï¼Œè§†é¢‘ï¼Œæ˜¯æ€ä¹ˆå­˜å‚¨è¿›å»çš„ğŸ˜‚ã€‚ ä½†æ˜¯ï¼Œä½†æ˜¯å°±åœ¨æˆ‘å†™è¿™ä¸ªåšå®¢æ—¥è®°å‰ï¼Œæˆ‘ç®—æ˜¯çŸ¥é“æ€ä¹ˆå­˜å‚¨è¿›å»çš„äº†ã€‚å¦‚æœè¦å­˜å‚¨å›¾ç‰‡ï¼ŒéŸ³é¢‘ï¼Œè§†é¢‘æ–‡ä»¶çš„è¯ï¼Œéœ€è¦å…ˆä½¿ç”¨ NSData ç±»å°†æ–‡ä»¶è½¬æ¢æˆäºŒè¿›åˆ¶ï¼Œç„¶åç”¨ BLOB ç±»å‹å­˜å…¥ SQLite æ•°æ®åº“ï¼Œè¿™ä¸ªå…·ä½“çš„æ“ä½œæˆ‘ä¼šåœ¨ Demo ä¸­æ›´æ–°ã€‚ å­˜å‚¨æ•°æ®çš„æ–¹æ³•åœ¨ Demo ä¸­æˆ‘ä¹Ÿç”¨äº†ä¸€ä¸ªä¸“é—¨çš„æ–¹æ³•ï¼ˆ- (BOOL)saveName:(NSString *)name AndPhone:(NSString *)phone WithAge:(NSString *)age ;ï¼‰æ¥å­˜å‚¨æ•°æ®ï¼Œå¹¶è¿”å›ä¸€ä¸ª BOOL å€¼æ¥ç¡®å®šæ˜¯å¦å‚¨å­˜æˆåŠŸã€‚ 1234567891011121314151617181920212223242526272829- (BOOL)saveName:(NSString *)name AndPhone:(NSString *)phone WithAge:(NSString *)age &#123; //è¿”å›æˆåŠŸä¸å¦ BOOL isSuccess = YES; if (sqlite3_open([dataBasePath UTF8String], &amp;db) != SQLITE_OK) &#123; sqlite3_close(db); isSuccess = NO; NSAssert(NO, @&quot;æ•°æ®åº“æ‰“å¼€å¤±è´¥&quot;); &#125; else &#123; NSString *insertSQLString = [NSString stringWithFormat:@&quot;INSERT OR REPLACE INTO Person (name, phone, age) VALUES (?, ?, ?)&quot;]; //é¢„å¤„ç†å‡½æ•° int result = sqlite3_prepare_v2(db, [insertSQLString UTF8String], -1, &amp;statment, NULL); if (result == SQLITE_OK) &#123; //ç»‘å®šæ•°æ® sqlite3_bind_text(statment, 1, [name UTF8String], -1, NULL); sqlite3_bind_text(statment, 2, [phone UTF8String], -1, NULL); sqlite3_bind_text(statment, 3, [age UTF8String], -1, NULL); //æ’å…¥æ•°æ® if (sqlite3_step(statment) != SQLITE_DONE) &#123; isSuccess = NO; NSAssert(NO, @&quot;æ’å…¥æ•°æ®å¤±è´¥&quot;); &#125; else &#123; isSuccess = YES; &#125; &#125; &#125; sqlite3_finalize(statment); sqlite3_close(db); return isSuccess;&#125; æŸ¥è¯¢æ•°æ®æŸ¥è¯¢æ•°æ®å’Œä¿®æ”¹æ•°æ®çš„æ­¥éª¤åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯åœ¨ç¬¬4æ­¥åå¤šäº†ä¸€ä¸ªå­—æ®µæ•°æ®æå–çš„æ­¥éª¤ã€‚æŸ¥è¯¢æ‰€æœ‰ Person çš„ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132- (NSArray *)findAllPerson &#123; NSMutableArray *personArray = [NSMutableArray array]; if (sqlite3_open([dataBasePath UTF8String], &amp;db) != SQLITE_OK) &#123; sqlite3_close(db); NSAssert(NO, @&quot;æ•°æ®åº“æ‰“å¼€å¤±è´¥&quot;); &#125; else &#123; NSString *findAllPersonSQLString = @&quot;SELECT name,phone,age FROM Person&quot;; int result = sqlite3_prepare_v2(db, [findAllPersonSQLString UTF8String], -1, &amp;statment, NULL); if (result == SQLITE_OK) &#123; while (sqlite3_step(statment) == SQLITE_ROW) &#123; // è·å–è®°å½•ä¸­çš„å­—æ®µå€¼ // ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¯­å¥å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å­—æ®µçš„ä¸‹æ ‡ï¼Œä»0å¼€å§‹ NSString *name = [NSString stringWithUTF8String:(const char *) sqlite3_column_text(statment, 0)]; NSString *phone = [NSString stringWithUTF8String:(const char *) sqlite3_column_text(statment, 1)]; NSString *age = [NSString stringWithUTF8String:(const char *) sqlite3_column_text(statment, 2)]; Person *person = [[Person alloc]init]; person.name = name; person.phone = phone; person.age = age; [personArray addObject:person]; &#125; &#125; sqlite3_finalize(statment); sqlite3_close(db); &#125; return [personArray copy];&#125; è¿™æ®µä»£ç ä¸­æŸ¥è¯¢çš„æ˜¯æ•°æ®åº“è¡¨ä¸­æ‰€æœ‰çš„æ•°æ®ã€‚æŒ‰æ¡ä»¶æŸ¥è¯¢æ•°æ®çš„æ–¹æ³•å’Œè¿™ä¸ªåŸºæœ¬ä¹Ÿæ˜¯å·®ä¸å¤šçš„ï¼ŒåŒºåˆ«åœ¨äºæŸ¥è¯¢æ‰€æœ‰æ•°æ®æ²¡æœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œä¸éœ€è¦ç»‘å®šå‚æ•°ï¼Œéå†æ•°æ®çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯ while å¾ªç¯è¯­å¥ï¼Œè€Œä¸æ˜¯ if æ¡ä»¶åˆ¤æ–­è¯­å¥ã€‚æŸ¥æ‰¾å¯¹åº” phone çš„ Person å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233- (Person *)findPersonWithPhone:(NSString *)phone &#123; NSMutableArray *personArray = [NSMutableArray array]; if (sqlite3_open([dataBasePath UTF8String], &amp;db) != SQLITE_OK) &#123; sqlite3_close(db); NSAssert(NO, @&quot;æ•°æ®åº“æ‰“å¼€å¤±è´¥&quot;); &#125; else &#123; NSString *findAllPersonSQLString = @&quot;SELECT * FROM Person WHERE phone = ?&quot;; int result = sqlite3_prepare_v2(db, [findAllPersonSQLString UTF8String], -1, &amp;statment, NULL); if (result == SQLITE_OK) &#123; //å’ŒæŸ¥è¯¢æ‰€æœ‰æ•°æ®çš„åŒºåˆ«å°±åœ¨è¿™é‡Œï¼Œå…ˆç»‘å®šæ•°æ®ï¼Œå†ç”¨ifå»è¿‡æ»¤æŸ¥è¯¢ç»“æœ //ç»‘å®šæ•°æ® sqlite3_bind_text(statment,1,[phone UTF8String],-1,NULL) if (sqlite3_step(statment) == SQLITE_ROW) &#123; // è·å–è®°å½•ä¸­çš„å­—æ®µå€¼ // ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¯­å¥å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å­—æ®µçš„ä¸‹æ ‡ï¼Œä»0å¼€å§‹ NSString *name = [NSString stringWithUTF8String:(const char *) sqlite3_column_text(statment, 0)]; NSString *phone = [NSString stringWithUTF8String:(const char *) sqlite3_column_text(statment, 1)]; NSString *age = [NSString stringWithUTF8String:(const char *) sqlite3_column_text(statment, 2)]; Person *person = [[Person alloc]init]; person.name = name; person.phone = phone; person.age = age; &#125; &#125; sqlite3_finalize(statment); sqlite3_close(db); &#125; return person;&#125; SQLite çš„æŸ¥è¯¢è¯­å¥å½“ç„¶ä¹Ÿæ˜¯å¯ä»¥æ·»åŠ ä¸€äº›æ¡ä»¶çš„ï¼Œæ¯”å¦‚ï¼š è®¡ç®—æŸå­—æ®µè®°å½•çš„æ•°é‡ï¼š SELECT COUNT ï¼ˆå­—æ®µï¼‰FROM è¡¨åï¼› ç¤ºä¾‹ğŸŒ°ï¼š 1NSString *findAllPersonCountSQLString = @&quot;SELECT COUNT (phone) FROM Person &quot;; æŸ¥è¯¢ç»“æœæŒ‰é¡ºåºæ’åˆ—ï¼š SELECT * FROM è¡¨å ORDER BY å­—æ®µ ; ç¤ºä¾‹ğŸŒ°ï¼š æŸ¥æ‰¾Personå¹¶æŒ‰ç…§é™åºæ’åˆ—ï¼ˆ DESC é™åºï¼ŒASC å‡åºï¼‰ 1NSString *findAllPersonSQLStringByDesc = @&quot;SELECT * FROM Person ORDER BY phone DESC &quot;; æ§åˆ¶æŸ¥è¯¢ç»“æœçš„æ•°é‡ï¼š SELECT * FROM è¡¨å LIMIT æ•°å€¼1, æ•°å€¼2 ; ç¤ºä¾‹ğŸŒ°ï¼š è·³è¿‡ç¬¬0è·³æ•°æ®å–10æ¡æ•°æ® 1NSString *findAllPersonSQLString = @&quot;SELECT * FROM Person LIMIT 0ï¼Œ10 &quot;; å…¶å®è¿˜æœ‰æ›´å¤šçš„SQLæŸ¥è¯¢è¯­å¥ï¼Œæƒ³è¦çŸ¥é“æ›´å¤šæŸ¥è¯¢è¯­å¥çš„å¯ä»¥åœ¨æˆ‘å‰é¢ç»™å‡ºçš„ç½‘ç«™ä¸­è‡ªè¡Œå­¦ä¹ ã€‚ åˆ é™¤æ•°æ®123456789101112131415161718192021222324- (BOOL)deletePersonWithName:(NSString *)name &#123; BOOL isSucces = YES; if (sqlite3_open([dataBasePath UTF8String], &amp;db) != SQLITE_OK) &#123; sqlite3_close(db); return NO; NSAssert(NO, @&quot;æ•°æ®åº“æ‰“å¼€å¤±è´¥&quot;); &#125; else &#123; NSString *deletePersonSQLString = @&quot;DELETE FROM Person WHERE name =?&quot;; int result = sqlite3_prepare_v2(db, [deletePersonSQLString UTF8String], -1, &amp;statment, NULL); if (result == SQLITE_OK) &#123; sqlite3_bind_text(statment, 1, [name UTF8String], -1, NULL); if (sqlite3_step(statment) != SQLITE_DONE) &#123; return isSucces = NO; NSAssert(NO, @&quot;æ•°æ®åº“åˆ é™¤å¤±è´¥&quot;); &#125; else &#123; NSLog(@&quot;æ•°æ®åˆ é™¤æˆåŠŸ&quot;); return isSucces = YES; &#125; &#125; &#125; sqlite3_finalize(statment); sqlite3_close(db); return isSucces;&#125; å…³äºSQLiteæ›´å¤šçš„å­¦ä¹  Demoä¸‹è½½åœ°å€","categories":[],"tags":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"Aaronzjp.cn/tags/æ•°æ®åº“/"},{"name":"SQLite","slug":"SQLite","permalink":"Aaronzjp.cn/tags/SQLite/"}]},{"title":"KVO/KVCçš„ä½¿ç”¨","slug":"KVO:KVC","date":"2016-03-31T02:40:37.000Z","updated":"2017-07-27T02:55:23.000Z","comments":true,"path":"2016/03/31/KVO:KVC/","link":"","permalink":"Aaronzjp.cn/2016/03/31/KVO:KVC/","excerpt":"KVOï¼ˆkey-value observingï¼‰å’ŒKVCï¼ˆKey-value codingï¼‰è¿™ä¸¤ç§æ¨¡å¼å…¶å®æ˜¯ä¸€ç§è§‚å¯Ÿè€…æ¨¡å¼çš„è®¾è®¡ï¼Œå¯ä»¥è®©æˆ‘ä»¬æ›´åŠ çµæ´»çš„åˆ©ç”¨Objective-Cè¯­è¨€çš„åŠ¨æ€ç‰¹æ€§æ¥ç¼–å†™ä»£ç ã€‚KVOå’ŒKVCå…¶å®æ˜¯ä¸€å¥—éæ­£å¼çš„åè®®ï¼Œæ˜¯åœ¨å…¶NSObjectç±»ä¸­å®ç°çš„ï¼Œæ‰€ä»¥åªæœ‰ç»§æ‰¿äº†è¯¥ç±»å°±å¯ä»¥ä½¿ç”¨è¿™ä¸€éæ­£å¼çš„åè®®ã€‚","text":"KVOï¼ˆkey-value observingï¼‰å’ŒKVCï¼ˆKey-value codingï¼‰è¿™ä¸¤ç§æ¨¡å¼å…¶å®æ˜¯ä¸€ç§è§‚å¯Ÿè€…æ¨¡å¼çš„è®¾è®¡ï¼Œå¯ä»¥è®©æˆ‘ä»¬æ›´åŠ çµæ´»çš„åˆ©ç”¨Objective-Cè¯­è¨€çš„åŠ¨æ€ç‰¹æ€§æ¥ç¼–å†™ä»£ç ã€‚KVOå’ŒKVCå…¶å®æ˜¯ä¸€å¥—éæ­£å¼çš„åè®®ï¼Œæ˜¯åœ¨å…¶NSObjectç±»ä¸­å®ç°çš„ï¼Œæ‰€ä»¥åªæœ‰ç»§æ‰¿äº†è¯¥ç±»å°±å¯ä»¥ä½¿ç”¨è¿™ä¸€éæ­£å¼çš„åè®®ã€‚ KVCï¼ˆKey-value codingï¼‰ç®€ä»‹KVCï¼ˆKey-value codingï¼‰ä»å…¨ç§°æ¥çœ‹ä¸€èˆ¬è¢«ç¿»è¯‘æˆäº†é”®å€¼ç¼–ç ï¼Œä½¿ç”¨KVCæˆ‘ä»¬å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²å»è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹å˜é‡ã€‚ KVCçš„ä½¿ç”¨ä½¿ç”¨KVCæˆ‘ä»¬å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²å»è®¿é—®å¯¹è±¡ç›¸å¯¹åº”çš„å®ä¾‹å˜é‡ï¼Œå…¶æœ¬è´¨å¤§æ¦‚å°±æ˜¯é€šè¿‡ä½¿ç”¨å¯¹åº”çš„å­—ç¬¦ä¸²å‘å¯¹è±¡å‘é€æ¶ˆæ¯ã€‚å…¶ä¸­ä¸»è¦çš„æ–¹æ³•å¦‚ä¸‹ï¼š 1234- (id)valueForKey:(NSString *)key; - (void)setValue:(id)value forKey:(NSString *)key; - (id)valueForKeyPath:(NSString *)keyPath; - (void)setValue:(id)value forKeyPath:(NSString *)keyPath; æ™®é€šæƒ…å†µä¸‹æˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨å¯¹è±¡çš„è®¾ç½®æ–¹æ³•å’Œå–å€¼æ–¹æ³•å»è®¿é—®å…¶å±æ€§ï¼Œä½†æ˜¯åœ¨KVCä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™æ ·çš„æ–¹å¼å»è®¿é—®å¯¹è±¡çš„å±æ€§ï¼Œæœ€ç®€å•çš„KVCçš„ä½¿ç”¨å¯ä»¥é€šè¿‡è¿™æ ·çš„æ–¹å¼å»è®¿é—®å±æ€§ï¼š 12345678//è¢«è®¿é—®çš„å±æ€§@property (nonatomic,copy) NSString *name;//å–å€¼NSString *name = [object valueForKey:@&quot;name&quot;];//è®¾å€¼[object setValue:@&quot;Aaron&quot; forKey:!&quot;name&quot;]; åœ¨KVCä¸­é™¤äº†å¯ä»¥è®¿é—®å¯¹è±¡çš„å±æ€§å¤–ï¼Œè¿˜å¯ä»¥è®¿é—®å¯¹è±¡çš„ä¸€äº›æ•°æ®ç±»å‹å±æ€§ï¼ˆå¦‚ï¼šint ï¼ŒCGFloatï¼ŒCGRectç­‰æ•°æ®ç±»å‹å’Œé›†åˆï¼‰ã€‚Foudationæ¡†æ¶ä¼šå¯¹æ­¤è¿›è¡Œå°è£…å’Œå¤„ç†ã€‚ 12345678//è¢«è®¿é—®çš„æ•°æ®ç±»å‹å±æ€§@property (nonatomic) CGFloat number;//å–å€¼CGFloat number = [object valueForKey@&quot;number&quot;];//è®¾å€¼[object setValue:@(20) forKey:@&quot;number&quot;] åœ¨ä¸Šé¢æˆ‘ä»¬é€šè¿‡KVCå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²æ¥è®¿é—®å¯¹è±¡çš„å±æ€§ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€é”®â€ é”®è·¯å¾„ï¼ˆKey Pathï¼‰ä¸Šé¢ä½¿ç”¨äº†é”®å»è®¿é—®å¯¹è±¡çš„å±æ€§ï¼ŒåŒæ ·çš„KVCä¹Ÿå¯ä»¥é€šè¿‡é”®è·¯å¾„çš„å…³ç³»å»è®¿é—®å¯¹è±¡ã€‚ å‡è®¾æœ‰ä¸€ä¸ªPersonå¯¹è±¡ï¼Œè¯¥å¯¹è±¡æœ‰ä¸€ä¸ªdogå±æ€§ï¼Œdogå±æ€§æœ‰sleepå±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é”®è·¯å¾„æ¥è®¿é—®è¿™ä¸ªsleepå±æ€§ï¼š 1[person valueForKeyPath:@&quot;dog.sleep&quot;] é€šè¿‡å»ºè·¯å¾„ä¹Ÿå¯ä»¥ç”¨ç›¸å¯¹åº”çš„æ–¹æ³•å»è®¾å€¼ã€‚ KVOï¼ˆkey-value observingï¼‰ç®€ä»‹KVOï¼ˆkey-value observingï¼‰ï¼Œå…¶å®æ˜¯ä¸€ç§è§‚å¯Ÿè€…æ¨¡å¼ï¼ŒKVOæ˜¯åŸºäºKVCçš„å¦ä¸€ç§å®ç°çš„è§‚å¯Ÿè€…æ¨¡å¼ï¼Œåˆ©ç”¨è¯¥æ¨¡å¼å¯ä»¥ç›‘å¬æƒ³è¦è§‚å¯Ÿçš„å±æ€§ï¼Œå½“å…¶å‘ç”Ÿå˜åŒ–æ—¶å°±ä¼šè°ƒç”¨ç›‘è§†å™¨æŒ‡å®šçš„æ–¹æ³•ã€‚ KVOçš„ä½¿ç”¨åœ¨KVOæ¨¡å¼ä¸­æ¯”è¾ƒé‡è¦çš„å‡ ä¸ªæ–¹æ³•å¦‚ä¸‹ï¼š 12345678910111213141516//æ·»åŠ å¯¹è±¡çš„è§‚å¯Ÿè€…- (void)addObserver:(NSObject *)observer forKeyPath:(NSString *)keyPath options:(NSKeyValueObservingOptions)options context:(void *)context;//è§‚å¯Ÿè€…éœ€è¦å®ç°çš„æ–¹æ³•ï¼Œå½“è¢«è§‚å¯Ÿè€…å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¼šè°ƒç”¨æ­¤æ–¹æ³•- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context&#123; NSLog(@&quot;old: %@&quot;, [change objectForKey:NSKeyValueChangeOldKey]); NSLog(@&quot;old: %@&quot;, [change objectForKey:NSKeyValueChangeNewKey]); NSLog(@&quot;context: %@&quot;, context);&#125;//ç§»é™¤è§‚å¯Ÿè€…- (void)removeObserver:(NSObject *)observer forKeyPath:(NSString *)keyPath é”®å€¼éªŒè¯ï¼ˆKVVï¼ŒKey-Value Validateï¼‰KVVä¹Ÿæ˜¯KVC APIä¸­çš„ä¸€éƒ¨åˆ†ï¼Œè¿™æ˜¯ç”¨æ¥éªŒè¯å±æ€§å€¼çš„APIï¼Œä¿è¯äº†æ•°æ®çš„ä¸€è‡´æ€§ï¼ŒKVCæ˜¯ä¸ä¼šåšä»»ä½•çš„éªŒè¯ï¼Œä¹Ÿä¸ä¼šè‡ªåŠ¨çš„å»è°ƒç”¨KVVçš„æ–¹æ³•ï¼Œæˆ‘ä»¬è¦æƒ³éªŒè¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œåªç”¨é€šè¿‡KVVæ¥å®ç°æˆ‘ä»¬è‡ªå·±çš„éªŒè¯æ–¹æ³•ä»¥ä¾¿æ¥ä¿è¯ä»–ä»¬çš„ä¸€è‡´æ€§ã€‚ æˆ‘ä»¬ä¸€èˆ¬é€šè¿‡è°ƒç”¨æ­¤æ–¹æ³•æ¥éªŒè¯æ•°æ®ï¼š 1- (BOOL)validateValue:(inout id *)ioValue forKey:(NSString *)inKey error:(out NSError **)outError; æ¯”å¦‚å½“æˆ‘ä»¬éœ€è¦éªŒè¯Personç±»ä¸­nameå­—æ®µä¸ä¸ºç©ºï¼Œå¯ä»¥è¿™æ ·ï¼š 123456789NSString *name = @&quot;LiLei&quot;;NSString *key = @&quot;name&quot;;NSError *error = nil;if (Person validateValue:&amp;name forKey:key error:&amp;error) &#123; NSLog(@&quot;name is nil&quot;)&#125; else &#123; NSLog(@&quot;name is not nil&quot;)&#125; å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡é‡å†™æ­¤æ–¹æ³•ï¼Œä»¥ä¾¿é€šè¿‡æˆ‘ä»¬è‡ªå·±çš„é€»è¾‘æ¥éªŒè¯æ•°æ® ï¼š 123456789- (BOOL)validateName:(NSString **)name error:(NSError * __autoreleasing *)outError&#123; if ((*name).length == 0) &#123; (*name) = @&quot;default name&quot;; return NO; &#125; return YES;&#125; æ‰‹åŠ¨é€šçŸ¥å’Œè‡ªåŠ¨é€šçŸ¥KVOä½œä¸ºè§‚å¯Ÿè€…ï¼Œå½“æˆ‘ä»¬è§‚å¯Ÿçš„å±æ€§å‘ç”Ÿå˜åŒ–æ—¶å°±ä¼šå‘å‡ºé€šçŸ¥å‘Šè¯‰æˆ‘ä»¬è¢«è§‚å¯Ÿè€…å‘ç”Ÿäº†æ”¹å˜ã€‚é€šè¿‡è‡ªåŠ¨å±æ€§ï¼Œå»ºç«‹é”®å€¼è§‚å¯Ÿï¼Œéƒ½å±äºè‡ªåŠ¨é”®å€¼è§‚å¯Ÿã€‚å› ä¸ºä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œåªè¦è®¾ç½®é”®å€¼ï¼Œå°±ä¼šè‡ªåŠ¨å‘å‡ºé€šçŸ¥ã€‚è€Œæ‰‹åŠ¨é”®å€¼è§‚å¯Ÿï¼Œä¸èƒ½ä½¿ç”¨è‡ªåŠ¨åŒ–å±æ€§ï¼Œéœ€è¦è‡ªå·±å†™ setter/getter æ–¹æ³•ï¼Œæ‰‹åŠ¨å‘é€é€šçŸ¥ã€‚ æ‰‹åŠ¨é€šçŸ¥çš„å®ç°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142//æ‰‹åŠ¨é€šçŸ¥çš„å®ç°@interface Person : NSObject&#123; NSString *name;&#125;- (NSString *)name;- (void)setName:(int)theName;@end@implementation Person- (id) init&#123; self = [super init]; if (nil != self) &#123; name = @&quot;Aaron&quot;; &#125; return self;&#125;- (NSString *)name&#123; return name;&#125;- (void)setName:(NSString *)theName&#123; //å‘é€é€šçŸ¥ï¼šé”®å€¼å³å°†æ”¹å˜ [self willChangeValueForKey:@&quot;name&quot;]; name = theName; //å‘é€é€šçŸ¥ï¼šé”®å€¼å·²ç»ä¿®æ”¹ [self didChangeValueForKey:@&quot;name&quot;];&#125;/** * å½“è®¾ç½®é”®å€¼ä¹‹åï¼Œé€šè¿‡æ­¤æ–¹æ³•ï¼Œå†³å®šæ˜¯å¦å‘é€é€šçŸ¥ */+ (BOOL) automaticallyNotifiesObserversForKey:(NSString *)key&#123; //å½“ key ä¸º nameæ—¶ï¼Œæ‰‹åŠ¨å‘é€é€šçŸ¥ if ([key isEqualToString:@&quot;age&quot;]) &#123; return NO; &#125; //å½“ä¸ºå…¶ä»–keyæ—¶ï¼Œè‡ªåŠ¨å‘é€é€šçŸ¥ return [super automaticallyNotifiesObserversForKey:key];&#125;@end å±æ€§ä¾èµ–åœ¨æŸäº›ç‰¹æ®Šçš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç±»çš„å‡ ä¸ªå±æ€§ä¹‹é—´æœ‰ç›¸äº’çš„å…³ç³»ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦è§‚å¯Ÿè¿™äº›æœ‰ç›¸äº’å…³ç³»çš„å±æ€§ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±è¦ä½¿ç”¨å±æ€§ä¾èµ–ã€‚æ¯”å¦‚ä¸€ä¸ªPersonç±»ä¸­æœ‰ä¸‰ä¸ªå±æ€§fullNameï¼ŒfirstNameï¼ŒlastNameï¼Œå¦‚æœåœ¨ä¸äº†è§£å±æ€§ä¾èµ–ä¹‹å‰ï¼Œæˆ‘ä»¬è¦è§‚å¯Ÿåå­—çš„å˜åŒ–å°±åªæœ‰æ·»åŠ ä¸‰ä¸ªè§‚å¯Ÿè€…ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨å±æ€§ä¾èµ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹å…¶ä¸­ä¸€ä¸ªå±æ€§æ·»åŠ è§‚å¯Ÿï¼ŒåŒæ—¶å¯¹è§‚å¯Ÿçš„è¿™ä¸ªå±æ€§è®¾ç½®å±æ€§ä¾èµ–åæ‹©ä¸šæˆ‘ä»¬å°±å¯ä»¥è§‚å¯Ÿåå­—çš„å˜åŒ–äº†ã€‚KVCä¸­åˆšåˆšå¥½å°±æä¾›äº†è¿™æ ·çš„æ–¹æ³•ï¼š 1+ (NSSet *)keyPathsForValuesAffectingValueForKey:(NSString *)key æ·»åŠ å±æ€§ä¾èµ–åˆ°è¢«è§‚å¯Ÿè€…ä¸Šï¼š 1234567/è®¾ç½®å±æ€§ä¾èµ–ï¼šfullNameå±æ€§ä¾èµ–äºfirstNameã€lastName//å¦‚æœè§‚å¯Ÿnameï¼Œå½“firstNameã€lastNameå‘ç”Ÿå˜åŒ–æ—¶ï¼Œè§‚å¯Ÿè€…ä¹Ÿä¼šæ”¶åˆ°nameå˜åŒ–é€šçŸ¥+ (NSSet *)keyPathsForValuesAffectingFullName&#123; NSSet *set = [NSSet setWithObjects:@&quot;firstName&quot;, @&quot;lastName&quot;, nil]; return set;&#125; åœ¨æ·»åŠ å¥½å±æ€§ä¾èµ–åï¼Œæˆ‘ä»¬åªéœ€è¦åƒå¹³å¸¸ä½¿ç”¨KVOè§‚å¯Ÿä¸€æ ·çš„ï¼Œå¯¹fullNameæ·»åŠ è§‚å¯Ÿè€…å³å¯ã€‚","categories":[],"tags":[{"name":"KVO/KVC","slug":"KVO-KVC","permalink":"Aaronzjp.cn/tags/KVO-KVC/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"Aaronzjp.cn/tags/è®¾è®¡æ¨¡å¼/"}]},{"title":"blockçš„ä½¿ç”¨","slug":"Block","date":"2016-03-29T13:53:52.000Z","updated":"2017-04-20T07:46:36.000Z","comments":true,"path":"2016/03/29/Block/","link":"","permalink":"Aaronzjp.cn/2016/03/29/Block/","excerpt":"â€‹ blockï¼ˆä»£ç å—ï¼‰ä»–çš„æœ¬è´¨å…¶å®æ˜¯å’Œå…¶ä»–çš„å˜é‡ç±»ä¼¼çš„ï¼Œä¸åŒçš„å°±æ˜¯blockï¼ˆä»£ç å—ä¸­å­˜å‚¨çš„æ˜¯ä¸€ä¸ªå‡½æ•°ä½“ï¼Œæˆ–è€…ä¸€æ®µä»£ç ï¼‰ã€‚åœ¨ä½¿ç”¨blockçš„æ—¶å€™å¯ä»¥åƒè°ƒç”¨æ–¹æ³•ä¸€æ ·çš„ï¼Œä¼ å…¥å‚æ•°ï¼Œç„¶åå¾—åˆ°è¿”å›å€¼ã€‚ ^ï¼ˆè„±å­—ç¬¦ï¼‰æ˜¯blockçš„è¯­æ³•æ ‡è®°ï¼Œä¸‹é¢æ˜¯blockçš„å£°æ˜ï¼š","text":"â€‹ blockï¼ˆä»£ç å—ï¼‰ä»–çš„æœ¬è´¨å…¶å®æ˜¯å’Œå…¶ä»–çš„å˜é‡ç±»ä¼¼çš„ï¼Œä¸åŒçš„å°±æ˜¯blockï¼ˆä»£ç å—ä¸­å­˜å‚¨çš„æ˜¯ä¸€ä¸ªå‡½æ•°ä½“ï¼Œæˆ–è€…ä¸€æ®µä»£ç ï¼‰ã€‚åœ¨ä½¿ç”¨blockçš„æ—¶å€™å¯ä»¥åƒè°ƒç”¨æ–¹æ³•ä¸€æ ·çš„ï¼Œä¼ å…¥å‚æ•°ï¼Œç„¶åå¾—åˆ°è¿”å›å€¼ã€‚ ^ï¼ˆè„±å­—ç¬¦ï¼‰æ˜¯blockçš„è¯­æ³•æ ‡è®°ï¼Œä¸‹é¢æ˜¯blockçš„å£°æ˜ï¼š ä¸‹é¢å°±æ¥å£°æ˜ä¸€ä¸ªblockå˜é‡è¯•è¯•ï¼š 12345678//å£°æ˜ä¸€ä¸ªblockå˜é‡int multiplier = 7;int (^myBlock)(int) = ^(int num) &#123; return num * multiplier;&#125;;//blockå˜é‡å¯ä»¥åƒå‡½æ•°ä¸€æ ·ä½¿ç”¨NSLog(@&quot;%d&quot;,myBlock(8)); blockå®é™…ä½¿ç”¨ç»“åˆtypedefä½¿ç”¨â€‹ ä¸Šé¢åªæ˜¯ç®€å•çš„è¯´äº†blockåœ¨å£°æ˜æ–¹å¼ï¼Œå’Œblockå˜é‡çš„å£°æ˜å’Œä½¿ç”¨ï¼Œblockæ˜¯ä¸€ä¸ªå¾ˆçµæ´»å¥½ç”¨çš„ä¸œè¥¿ï¼Œblockçš„ä½¿ç”¨ä¹Ÿååˆ†çš„å¹¿æ³›ï¼Œblockå¯ä»¥ç”¨åšå±æ€§ï¼Œå¯ä»¥ç”¨ä½œå‡½æ•°çš„è¿”å›å€¼ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‡½æ•°çš„å‚æ•°æ¥ä¼ é€’ä½¿ç”¨ã€‚ â€‹ å…¶å®blockä¹Ÿå¯ä»¥ç»“åˆtypedefæ¥ä½¿ç”¨ï¼Œç”¨typedefç»™æˆ‘ä»¬çš„blockèµ·ä¸€ä¸ªåˆ«åï¼Œè¿™æ ·åœ¨ä½¿ç”¨blockçš„æ—¶å€™å›æ›´åŠ æ–¹ä¾¿ï¼Œæ˜“è¯»ã€‚ 1typedef void (^ReturnTextBlock) (NSString *showText); ä½¿ç”¨blockå›è°ƒä¼ å€¼â€‹ ä½¿ç”¨æƒ…æ™¯ï¼Œæœ‰ä¸¤ä¸ªæ§åˆ¶å™¨ï¼ˆæ§åˆ¶å™¨ä¸€ï¼Œæ§åˆ¶å™¨äºŒï¼‰ã€‚åœ¨æ§åˆ¶å™¨äºŒä¸­è¾“å…¥ä¸€æ®µæ–‡å­—ï¼Œåœ¨è¿”å›åˆ°æ§åˆ¶å™¨ä¸€æ—¶ï¼Œæ˜¾ç¤ºå‡ºæ¥ã€‚ â€‹ é¦–å…ˆï¼Œæ–°å»ºå·¥ç¨‹å¹¶åˆ›å»ºä¸¤ä¸ªæ§åˆ¶å™¨ç±»ï¼Œå¦‚å›¾ï¼š â€‹ åœ¨æ§åˆ¶å™¨äºŒçš„å¤´æ–‡ä»¶ä¸­å£°æ˜ä¸€ä¸ªblockå±æ€§ï¼Œå¹¶å£°æ˜ä¸€ä¸ªå›è°ƒæ–¹æ³•ï¼š 1234567891011121314//ç»™blockå®šä¹‰ä¸€ä¸ªåˆ«åtypedef void (^ReturnTextBlock) (NSString *showText);@interface SecondViewController : UIViewController@property (nonatomic,copy) NSString *name;//å£°æ˜ä¸€ä¸ªblockå±æ€§@property (nonatomic, copy) ReturnTextBlock returnTextBlock;//ä½¿ç”¨æ­¤æ–¹æ³•å›è°ƒï¼Œè·å–æœ¬æ§åˆ¶å™¨ä¸­è¾“å…¥çš„æ–‡å­—ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡blockå±æ€§æ¥è·å–æ§åˆ¶å™¨ä¸­è¾“å…¥çš„æ–‡å­—ï¼‰- (void)returnText:(ReturnTextBlock)block;@end â€‹ åœ¨æ§åˆ¶å™¨äºŒä¸­ï¼Œç‚¹å‡»æŒ‰é’®å›è¿”å›æ§åˆ¶å™¨ä¸€çš„æ—¶å€™æˆ‘ä»¬å°†è¿™ä¸ªblockå±æ€§èµ‹å€¼ï¼š 123456- (void)viewWillDisappear:(BOOL)animated &#123; if (self.returnTextBlock != nil) &#123; //ç»™returnTextBlockèµ‹å€¼ self.returnTextBlock(self.inputTF.text); &#125;&#125; â€‹ ç„¶ååœ¨å›åˆ°æ§åˆ¶å™¨ä¸€çš„æ—¶å€™è·å–blockä¸­çš„å€¼å³å¯åˆ°è¾¾blockä¼ å€¼çš„ç›®çš„ï¼š 1234567891011121314- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender&#123; SecondViewController *tfVC = segue.destinationViewController; //é€šè¿‡å›è°ƒæ–¹æ³•è·å–æ§åˆ¶å™¨äºŒblockä¸­çš„å€¼ [tfVC returnText:^(NSString *showText) &#123; self.TestLabel.text = showText; &#125;]; //é€šè¿‡å±æ€§çš„æ–¹å¼è·å–æ§åˆ¶å™¨äºŒblockä¸­çš„å€¼// tfVC.returnTextBlock = ^(NSString *showText) &#123;// self.TestLabel.text = showText;// &#125;;&#125; blockä½œä¸ºå‡½æ•°è¿”å›å€¼â€‹ æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šæŠŠblockä½œä¸ºå‡½æ•°çš„è¿”å›å€¼æ¥å¤„ç†ï¼Œç”¨æ¥æä¾›ç»™å¤–éƒ¨æ¥è°ƒç”¨ï¼š 12345678910111213141516//å®šä¹‰ä¸€ä¸ªblocktypedef void (^TextBlock) (NSString *str);//æŠŠblockä½œä¸ºå‡½æ•°çš„è¿”å›å€¼- (TextBlock)returnAStringWithName &#123; TextBlock block = ^(NSString *str) &#123; NSLog(@&quot;ä»–çš„åå­—å«%@&quot;,str); &#125;; return block;&#125;//è°ƒç”¨è¿”å›å€¼ä¸ºblockçš„æ–¹æ³• TextBlock block = [self returnAStringWithName]; NSString *a = @&quot;ç‹å…«è›‹&quot;; //ä½¿ç”¨è¿”å›çš„block block(a); â€‹ blockçš„ä½¿ç”¨æ–¹å¼è¿˜æœ‰å¾ˆå¤šï¼Œåç»­ä¼šä»‹ç»æ›´å¤šæ›´æ–¹ä¾¿çš„blockçš„ä½¿ç”¨æ–¹å¼ã€‚ BlockDemo","categories":[],"tags":[{"name":"block","slug":"block","permalink":"Aaronzjp.cn/tags/block/"}]},{"title":"Appçš®è‚¤ï¼Œæ›´æ¢çš®è‚¤æ€è·¯","slug":"AppThemes","date":"2016-03-26T06:35:20.000Z","updated":"2017-07-27T02:58:38.000Z","comments":true,"path":"2016/03/26/AppThemes/","link":"","permalink":"Aaronzjp.cn/2016/03/26/AppThemes/","excerpt":"â€‹ æœ€è¿‘é‡åˆ°äº†ä¸€ä¸ªéœ€æ±‚ï¼Œå°±æ˜¯åšAppçš®è‚¤çš„æ¢è‚¤çš„åŠŸèƒ½ï¼Œå› ä¸ºä¹‹å‰ä¸€ç›´æ²¡æœ‰æ¶‰åŠåˆ°è¿™æ–¹é¢çš„éœ€æ±‚ï¼Œæ‰€ä»¥åˆšåˆšæ‹¿åˆ°è¿™ä¸ªéœ€æ±‚çš„æ—¶å€™æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆåšï¼Œåé¢é€šè¿‡æŸ¥çœ‹ç›¸å…³çš„èµ„æ–™ç»ˆäºå®Œæˆäº†è¿™ä¸ªéœ€æ±‚ã€‚ä¸‹é¢å°±æ˜¯æˆ‘å¯¹æœ¬æ¬¡è¿™ä¸ªéœ€æ±‚çš„ä¸€ç‚¹æƒ³æ³•å’Œå…·ä½“å®Œæˆçš„æ–¹æ³•ã€‚","text":"â€‹ æœ€è¿‘é‡åˆ°äº†ä¸€ä¸ªéœ€æ±‚ï¼Œå°±æ˜¯åšAppçš®è‚¤çš„æ¢è‚¤çš„åŠŸèƒ½ï¼Œå› ä¸ºä¹‹å‰ä¸€ç›´æ²¡æœ‰æ¶‰åŠåˆ°è¿™æ–¹é¢çš„éœ€æ±‚ï¼Œæ‰€ä»¥åˆšåˆšæ‹¿åˆ°è¿™ä¸ªéœ€æ±‚çš„æ—¶å€™æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆåšï¼Œåé¢é€šè¿‡æŸ¥çœ‹ç›¸å…³çš„èµ„æ–™ç»ˆäºå®Œæˆäº†è¿™ä¸ªéœ€æ±‚ã€‚ä¸‹é¢å°±æ˜¯æˆ‘å¯¹æœ¬æ¬¡è¿™ä¸ªéœ€æ±‚çš„ä¸€ç‚¹æƒ³æ³•å’Œå…·ä½“å®Œæˆçš„æ–¹æ³•ã€‚ ä¸»é¢˜ç®¡ç†â€‹ é¦–å…ˆæƒ³åˆ°ä¸»é¢˜æ˜¯ä»€ä¹ˆï¼Œå°±æ˜¯Appçš„çš®è‚¤ï¼Œçš®è‚¤å…¶å®åˆ’åˆ†ç»†ä¸€ç‚¹è¿™é‡Œå°±è¦è€ƒè™‘åˆ°Appçš®è‚¤æ˜¯å¦æœ‰å¸ƒå±€çš„æ”¹å˜ï¼Œæœ‰å¸ƒå±€çš„æ”¹å˜çš„çš®è‚¤å°±éœ€è¦é’ˆå¯¹çš®è‚¤åšå‡ºå¯¹åº”çš„å¸ƒå±€çš„çº¦æŸï¼Œæœ‰å¸ƒå±€æ”¹å˜çš„çš®è‚¤ä¸åœ¨æœ¬æ¬¡çš„è®¨è®ºä¹‹ä¸­ï¼Œå› ä¸ºç°åœ¨è¿˜æ²¡æœ‰æ¶‰åŠåˆ°æœ‰å¸ƒå±€å˜åŒ–çš„éœ€æ±‚ï¼Œè¿™é‡Œåªè¯´ä¸‹ç®€å•çš„çš®è‚¤çš„å˜æ›´ã€‚Appçš„çš®è‚¤å…¶å®å°±æ˜¯UIç•Œé¢çš„å›¾ç‰‡ï¼Œå’Œé¢œè‰²çš„æ”¹å˜ï¼Œé‚£æˆ‘ä»¬ç”¨ä»€ä¹ˆæ¥å­˜å‚¨è¿™äº›UIçš„çš®è‚¤å›¾ç‰‡å’Œé¢œè‰²å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªçš®è‚¤ç®¡ç†å™¨äº†ï¼Œè¿™ä¸ªçš®è‚¤ç®¡ç†å™¨çš„ä½œç”¨å…¶å®å°±æ˜¯ä¸€ä¸ªçš®è‚¤ç›¸å…³çš„èµ„æºç®¡ç†å™¨ï¼Œçš®è‚¤å…¶å®é‡ç‚¹åœ¨äºèµ„æºï¼Œè¿™æ˜¯ä¸€ä¸ªåªå…³å¿ƒçš®è‚¤ç›¸å…³èµ„æºçš„ç®¡ç†å™¨ï¼Œè€Œä¸”è¿™ä¸ªèµ„æºç®¡ç†å™¨åˆæ˜¯åªèƒ½æ•´ä¸ªAppå”¯ä¸€çš„ä¸€ä¸ªèµ„æºç®¡ç†å™¨ï¼Œå¦‚æœæœ‰å¤šä¸ªçš„è¯é‚£æˆ‘ä»¬è®¾ç½®çš®è‚¤çš„æ—¶å€™ä½¿ç”¨å“ªä¸€ä¸ªå‘¢ï¼Ÿè¿™æ ·å²‚ä¸æ˜¯ä¹±å¥—äº†ã€‚æ‰€æœ‰åªèƒ½æœ‰ä¸€ä¸ªã€‚æ‰€ä»¥è¿™é‡Œå°±ç”¨å•ä¾‹æ¥ä½œä¸ºçš®è‚¤ç®¡ç†å™¨æ¯”è¾ƒå¥½ã€‚ 1234567891011121314+ (ThemeManager *)sharedeThemeManager&#123; if (!themeManager) &#123; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken,^&#123; themeManager = [[super allocWithZone:NULL]init]; &#125;); &#125; return themeManager;&#125;+ (id)allocWithZone:(struct _NSZone *)zone &#123; return [ThemeManager sharedeThemeManager];&#125; ä¸»é¢˜èµ„æºç®¡ç†â€‹ ä¸»é¢˜ç®¡ç†å™¨æœ‰äº†ï¼Œä¸‹é¢å°±æ˜¯å…·ä½“çš„èµ„æºäº†ã€‚èµ„æºæˆ‘ç›´æ¥ä½¿ç”¨çš„æ˜¯æœ¬åœ°èµ„æºåŒ–æ¥ç®¡ç†çš®è‚¤èµ„æºï¼š å…¶ä¸­é¢œè‰²å’Œæ–‡å­—æè¿°ä¹Ÿæ”¾åœ¨äº†å¯¹åº”çš„ä¸»é¢˜æ–‡ä»¶å¤¹ç±»ï¼Œä½¿ç”¨plistæ–‡ä»¶æ¥è¿›è¡Œå‚¨å­˜ã€‚ æ¯æ¬¡è·å–ä¸»é¢˜çš„å¯¹åº”çš„ç›¸å…³èµ„æºæ—¶å°±ä¼šæ ¹æ®ä¸»é¢˜çš„ä¸»é¢˜åå±æ€§æ¥è·å–ä¸»é¢˜çš„ç›¸å…³èµ„æºï¼š @property (nonatomic,copy) NSString *themeName; æ ¹æ®ä¸»é¢˜çš„åå­—æ¥åˆ¤æ–­ä¸»é¢˜ç®¡ç†å™¨å»è·å–ä¸»é¢˜å¯¹åº”çš„èµ„æºçš„è·¯å¾„ï¼š 12345//é€šè¿‡ä¸»é¢˜åå­—æ¥è®¾ç½®ä¸»é¢˜çš„è·¯å¾„- (NSString *)themePath &#123; NSString *themePath = [[[[NSBundle mainBundle]resourcePath]stringByAppendingPathComponent:THEME_BUNDLE_PATH]stringByAppendingPathComponent:self.themeName ? : DEFAULT_THEME]; return themePath;&#125; é€šè¿‡è¿™æ ·çš„æ–¹æ³•å°±å¯ä»¥è®©ä¸»é¢˜ç®¡ç†å™¨é€šè¿‡ä¸»é¢˜çš„åå­—æ¥è·å–å¯¹åº”ä¸»é¢˜çš„ç›¸å…³èµ„æºã€‚å…¶ä¸­å›¾ç‰‡çš„èµ„æºå°±å¯ä»¥ç›´æ¥é€šè¿‡ä¸Šé¢çš„è¿™ä¸ªthemePathè·¯å¾„æ¥è·å–ç›¸å¯¹äºçš„å›¾ç‰‡èµ„æºäº†ã€‚(ä¸‹é¢çš„è¿™ä¸‰ä¸ªæ–¹æ³•å°±éœ€è¦åœ¨.hæ–‡ä»¶ä¸­å£°æ˜ï¼Œæš´éœ²åœ¨å¤–éƒ¨ï¼Œå…¶ä»–çš„UIç±»å°±èƒ½é€šè¿‡ä¸‹é¢çš„è¿™ä¸‰ä¸ªæ–¹æ³•è·å–å¯¹åº”ä¸»é¢˜çš„å›¾ç‰‡æ–‡ä»¶å’Œé¢œè‰²äº†)ã€‚ 1234//è·å–çš„å›¾ç‰‡çš„æ–¹æ³•çš„å®ç°- (UIImage *)getImageFromThemeWithName:(NSString *)imageName &#123; return [UIImage imageWithContentsOfFile:[self.themePath stringByAppendingPathComponent:imageName]];&#125; ä¸»é¢˜ç›¸å…³çš„é¢œè‰²å› ä¸ºæ˜¯ä»å¯¹åº”ä¸»é¢˜æ–‡ä»¶å¤¹çš„plistæ–‡ä»¶å»è¯»å–ï¼Œæ‰€ä»¥è¿™é‡Œæœ€å¥½è®¾è®¡ä¸€ä¸ªè·å–å¯¹åº”ä¸»é¢˜çš„plistæ–‡ä»¶çš„è·¯å¾„æ–¹æ³•å¹¶æŠŠplistæ–‡ä»¶é€šè¿‡å­—å…¸çš„æ–¹å¼è¯»å–å‡ºæ¥ï¼Œè¿”å›ä¸€ä¸ªå­—å…¸ï¼š 1234567//ä¸»é¢˜çš„é¢œè‰²æ–‡å­—çš„é…ç½®- (NSDictionary *)themeConfig &#123; if (!_themeConfig) &#123; _themeConfig = [NSDictionary dictionaryWithContentsOfFile:[self.themePath stringByAppendingPathComponent:THEME_CONFIG]]; &#125; return _themeConfig;&#125; ä¸»é¢˜æ–‡å­—å’Œé¢œè‰²åœ¨plistæ–‡ä»¶ä¸­æ˜¯è¿™æ ·å­˜å‚¨çš„ï¼š è¿™é‡Œçš„é¢œè‰²æ˜¯æŒ‰ç…§16è¿›åˆ¶çš„æ–¹å¼å­˜å‚¨çš„ï¼Œåœ¨iOSä¸­ä½¿ç”¨è¿™ä¸ªå­˜å‚¨çš„æ–¹å¼çš„é¢œè‰²çš„æ—¶å€™å°±éœ€è¦æŠŠæ”¹é¢œè‰²è½¬æ¢å±‚RGBçš„é¢œè‰²ï¼Œè¿™ä¸ªè¿™é‡Œå°±ä¸ç»†è¯´äº†ï¼Œç™¾åº¦iOS16è¿›åˆ¶é¢œè‰²è½¬æ¢å°±èƒ½æ‰¾åˆ°è½¬æ¢æ–¹æ³•ã€‚ ä¸‹é¢å°±æ˜¯å¯¹åº”çš„æ–‡ä»¶å’Œé¢œè‰²çš„è¯»å–æ–¹å¼ï¼Œé€šè¿‡è·å–è¿™ä¸ªplistæ–‡ä»¶çš„å†…å®¹è¿”å›çš„å­—å…¸ï¼Œä»è¿™ä¸ªå­—å…¸ä¸­å»è·å–å¯¹åº”ä¸»é¢˜çš„ç›¸å…³çš„æ–‡å­—å’Œé¢œè‰²ï¼š 1234567891011//è·å–é¢œè‰²çš„æ–¹æ³•çš„å®ç°- (UIColor *)getColorFromThemeWithColorNmae:(NSString *)colorName &#123; NSString *color = self.themeConfig[@&quot;Color&quot;][colorName]; return [UIColor colorWithHexString:color];&#125;//è·å–æ–‡å­—çš„æ–¹æ³•çš„å®ç°- (NSString *)getStringFromThemeWithStringName:(NSString *)stringNmae &#123; NSString *string = self.themeConfig[@&quot;Text&quot;][stringNmae]; return string;&#125; çš®è‚¤å˜æ›´é€šçŸ¥â€‹ å½“Appçš„ä¸»é¢˜çš®è‚¤çš„åå­—è¢«æ”¹å˜çš„æ—¶å€™ï¼ŒåŠ è½½æ–°çš„é¡µé¢çš„æ—¶å€™Appçš„çš®è‚¤ä¹Ÿå°±ä¼šæ ¹æ®ï¼Œçš®è‚¤ç®¡ç†å™¨çš„è¿™ä¸ªthemeNameçš„å˜åŒ–åˆ‡æ¢å¯¹åº”çš„çš®è‚¤ã€‚å¯¹äºæ²¡æœ‰æ˜¾ç¤ºåœ¨å½“å‰å±å¹•çš„é¡µé¢çš®è‚¤å°±ä¼šæ ¹æ®ä¸»é¢˜åè‡ªåŠ¨å˜åŒ–ã€‚ä½†æ˜¯åœ¨å·²ç»åŠ è½½çš„é¡µé¢ï¼ˆä¸€èˆ¬éƒ½æ˜¯åˆ‡æ¢ä¸»é¢˜æŒ‰é’®çš„è¿™ä¸ªé¡µé¢ï¼‰ï¼Œä¸»é¢˜å¯¹åº”çš„å˜åŒ–å°±éœ€è¦è®¾ç½®ä¸€ä¸ªç›‘å¬å™¨ï¼Œæˆ–è€…é€šçŸ¥æ—¶é—´å»é”®ç›˜ä¸»é¢˜çš„å˜åŒ–äº†ï¼Œè¿™æ ·æ‰èƒ½åœ¨ä¸»é¢˜å˜åŒ–çš„æ—¶å€™ï¼ŒåŠæ—¶çš„å˜æ›´å·²åŠ è½½é¡µé¢çš„ä¸»é¢˜ï¼Œè®©ç•Œé¢é‡æ–°ä»ä¸»é¢˜ç®¡ç†å™¨è·å–èµ„æºå†åŠ è½½ã€‚å› ä¸ºè¿™ç±»é€šçŸ¥ä¸€èˆ¬å±äºå…¨å±€æ€§çš„æ‰€ä»¥è¿™é‡Œæœ€å¥½ä½¿ç”¨é€šçŸ¥NSNotification â€‹ æ‰€ä»¥è¿™é‡Œåœ¨ä¸»é¢˜åå­—themeNameå‘ç”Ÿå˜åŒ–çš„æ—¶å€™å°±è¦è°ƒç”¨[NSNotificaitonCenter defaultCenter]çš„postNotificationName:object:å‘å‡ºé€šçŸ¥ï¼Œè€Œåœ¨å„ä¸ªæ¶‰åŠåˆ°ä¸»é¢˜æ›´æ¢çš„ViewControllerä¸­ä½¿ç”¨addObserver:selector:name:object:ç›‘å¬é€šçŸ¥äº‹ä»¶ï¼Œå¹¶å“åº”é€šçŸ¥åšå‡ºçš®è‚¤å˜æ›´é€šçŸ¥çš„å“åº”å¤„ç†æ–¹å¼ã€‚ æ€»ç»“â€‹ å…¶å®æ•´ä¸ªä¸»é¢˜ç®¡ç†å™¨å°±ç›¸å½“äºä¸€ä¸ªèµ„æºç®¡ç†å™¨ï¼Œè¿™é‡Œé’ˆå¯¹è¿™ä¸ªèµ„æºç®¡ç†å™¨è¿›è¡Œäº†å°è£…ã€‚é€šè¿‡è°ƒç”¨å¤–éƒ¨çš„è·å–å›¾ç‰‡èµ„æºå’Œé¢œè‰²ä»¥åŠæ–‡å­—çš„æ¥å£ï¼Œå°±å¯ä»¥è¿”å›å¯¹åº”ä¸»é¢˜çš„æ–‡å­—ï¼Œé¢œè‰²å’Œå›¾ç‰‡ã€‚å…¶å®å¤§éƒ¨åˆ†çš„è‡ªå®šä¹‰æ§ä»¶å’ŒUIæ¨¡å—éƒ½æ˜¯å¦‚æ­¤ï¼Œå°†å†…éƒ¨çš„å®ç°å°è£…èµ·æ¥ï¼ŒæŒ‰ç…§è¿™ä¸ªç®¡ç†å™¨çš„è§„åˆ™æ¥ä½¿ç”¨å’Œè°ƒç”¨æ¥å£ï¼Œå°±å¯ä»¥ç®€å•çš„ä½¿ç”¨è¿™ä¸ªç®¡ç†å™¨æ¥ç®¡ç†çš®è‚¤ï¼Œè®¾è®¡å¤§éƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œå¤šä¸€ä¸ªä¸­é—´å±‚ï¼Œå°±ä¼šè®©ç¨‹åºå˜å¾—æ›´åŠ çµæ´»æ˜“ç”¨ã€‚ é¡¹ç›®Demoåœ°å€","categories":[],"tags":[{"name":"æ€è·¯","slug":"æ€è·¯","permalink":"Aaronzjp.cn/tags/æ€è·¯/"}]},{"title":"ä½¿ç”¨Masonryå¸ƒå±€UI","slug":"UseMasonryLayoutUI","date":"2016-03-20T08:29:23.000Z","updated":"2017-07-27T02:52:46.000Z","comments":true,"path":"2016/03/20/UseMasonryLayoutUI/","link":"","permalink":"Aaronzjp.cn/2016/03/20/UseMasonryLayoutUI/","excerpt":"Masonry æ˜¯ä¸€ä¸ªé’ˆå¯¹ AutoLayout çš„å°è£…çš„è½»é‡çº§çš„å¸ƒå±€æ¡†æ¶ï¼Œæ‹¥æœ‰è‡ªå·±çš„è¯­æ³•æè¿°ï¼Œé€šè¿‡é“¾å¼è¯­æ³•å°è£… AutoLayoutï¼Œå¤§å¤§çš„æé«˜äº†ä»£ç çš„å¯è¯»æ€§å’Œç®€æ´åº¦ã€‚","text":"Masonry æ˜¯ä¸€ä¸ªé’ˆå¯¹ AutoLayout çš„å°è£…çš„è½»é‡çº§çš„å¸ƒå±€æ¡†æ¶ï¼Œæ‹¥æœ‰è‡ªå·±çš„è¯­æ³•æè¿°ï¼Œé€šè¿‡é“¾å¼è¯­æ³•å°è£… AutoLayoutï¼Œå¤§å¤§çš„æé«˜äº†ä»£ç çš„å¯è¯»æ€§å’Œç®€æ´åº¦ã€‚ AutoLayoutä»‹ç»iOS UIå¸ƒå±€ç›®å‰æœ‰å¾ˆå¤šç§æ–¹å¼ï¼Œä»æœ€å¼€å§‹çš„åªéœ€è¦ç®€å•çš„è®¡ç®—ä¸‹ç›¸å¯¹ä½ç½®ï¼Œåˆ° AutoresizingMask å¸ƒå±€ï¼Œå†åˆ° AutoLayout å¸ƒå±€ã€‚ä»è¿™äº› UI å¸ƒå±€åˆ°æ–¹å¼å°±å¯ä»¥çœ‹å‡º iOS è®¾å¤‡å±å¹•å°ºå¯¸çš„æ”¹å˜ï¼Œä¸ºäº†å…¼å®¹å¤šä¸ªå±å¹•å°ºå¯¸è‹¹æœæ¨å‡ºäº†ä¸Šé¢æåˆ°çš„è¿™äº› UI å¸ƒå±€æŠ€æœ¯ï¼Œç›®å‰ä½¿ç”¨æœ€å¤šçš„å°±æ˜¯ AutoLayout å¸ƒå±€ã€‚åœ¨ Storyboard ä¸Šä½¿ç”¨è¿˜æ˜¯æ¯”è¾ƒç›´æ¥çš„ï¼Œè®¾ç½®çº¦æŸåå°±ä¼šç«‹å³ç”Ÿæ•ˆï¼Œæ‰€è§å³æ‰€å¾—ã€‚ä½†æ˜¯ Storyboard åœ¨ç›¸å¯¹å¤æ‚çš„ UI å¸ƒå±€ä¸Šå°±æ˜¾å¾—ä¸æ˜¯é‚£ä¹ˆå¥½ç”¨äº†ï¼Œè¿˜æ˜¯å¾—ä½¿ç”¨ä»£ç è¿›è¡Œå¸ƒå±€ã€‚é‚£ä¹ˆä½¿ç”¨ä»£ç å¸ƒå±€çš„æ—¶å€™é—®é¢˜å°±æ¥äº†ï¼Œä½¿ç”¨è¿‡éƒ½çŸ¥é“ç®€ç›´å°±æ˜¯éš¾ä»¥å¿å—ï¼Œå¯ä»¥è¯´è¿™æ ·çš„ä»£ç ç®€ç›´æ˜¯å•°å—¦ã€‚ ä¸ä¿¡çœ‹ä¸€ä¸‹ï¼š 12345678910111213141516171819 UIView *redView = [[UIView alloc]init]; redView.backgroundColor = [UIColor redColor]; //ç»™æ¯ä¸ªè§†å›¾ä»£ç æ·»åŠ NSLayoutConstraintçº¦æŸçš„æ—¶å€™è¦å…³é—­è¿™ä¸ªå±æ€§ redView.translatesAutoresizingMaskIntoConstraints = NO; //åœ¨ç»™è§†å›¾æ·»åŠ çº¦æŸçš„æ—¶å€™è¦å…ˆå°†è§†å›¾æ·»åŠ åˆ°çˆ¶è§†å›¾ï¼Œä¸ç„¶ä¼šæŠ¥é”™ [self.view addSubview:redView]; //ç›¸å¯¹äºçˆ¶æ§ä»¶çš„å·¦è¾¹è· NSLayoutConstraint *redViewLeft = [NSLayoutConstraint constraintWithItem:redView attribute:NSLayoutAttributeLeft relatedBy:NSLayoutRelationEqual toItem:self.view attribute:NSLayoutAttributeLeft multiplier:1.0 constant:20.0]; [self.view addConstraint:redViewLeft]; //ç›¸å¯¹äºçˆ¶æ§ä»¶çš„ä¸‹è¾¹è· NSLayoutConstraint *redViewBottom = [NSLayoutConstraint constraintWithItem:redView attribute:NSLayoutAttributeBottom relatedBy:NSLayoutRelationEqual toItem:self.view attribute:NSLayoutAttributeBottom multiplier:1.0 constant:-20.0]; [self.view addConstraint:redViewBottom]; //è‡ªèº«å®½åº¦çº¦æŸï¼ˆè¿™é‡Œæ˜¯ç›´æ¥æ·»åŠ å®½åº¦çº¦æŸï¼‰ NSLayoutConstraint *redViewWidth = [NSLayoutConstraint constraintWithItem:redView attribute:NSLayoutAttributeWidth relatedBy:NSLayoutRelationEqual toItem:nil attribute:kNilOptions multiplier:1.0 constant:50]; [redView addConstraint:redViewWidth]; //è‡ªèº«é«˜åº¦çº¦æŸï¼ˆè¿™é‡Œæ˜¯ç›´æ¥æ·»åŠ é«˜åº¦çº¦æŸï¼‰ NSLayoutConstraint *redViewHeight = [NSLayoutConstraint constraintWithItem:redView attribute:NSLayoutAttributeHeight relatedBy:NSLayoutRelationEqual toItem:nil attribute:kNilOptions multiplier:1.0 constant:50]; [redView addConstraint:redViewHeight]; æ˜¯ä¸æ˜¯è§‰å¾—è¿™æ ·æ¥å¸ƒå±€ UI ä»£ç å¾ˆå•°å—¦ï¼Œä¹Ÿå¾ˆéš¾è¯»ï¼Ÿè¿™ä»…ä»…æ˜¯å¯¹ä¸€ä¸ª View çš„å¸ƒå±€ï¼Œæƒ³è±¡ä¸€ä¸‹ä¸€ä¸ªå¤æ‚çš„æ§åˆ¶å™¨ï¼Œé‡Œé¢æœ‰å¤šä¸ªçš„è§†å›¾ã€‚ã€‚ã€‚ å†æ¥å¯¹æ¯”ä¸‹ Masonryï¼š 12345678910UIView *redView = [[UIView alloc]init];redView.backgroundColor = [UIColor redColor];[self.view addSubview:redView];//æ·»åŠ çº¦æŸ[redView mas_makeConstraints:^(MASConstraintMaker *make) &#123; make.left.equalTo(self.view).offset(20); make.bottom.equalTo(self.view).offset(-20); make.size.mas_equalTo(CGSizeMake(50, 50)); &#125;]; æ²¡é”™ï¼Œä¸Šé¢é‚£ä¹ˆå¤§ä¸€å †ä»£ç ï¼Œåœ¨ Masonry ä¸Šåªéœ€è¦è¿™ä¹ˆå‡ å¥ã€‚ Masonryçš„ä½¿ç”¨é¦–å…ˆåœ¨ Masonry æœ‰ä¸‰ä¸ªæ–¹æ³•ç”¨æ¥ä¿®æ”¹çº¦æŸçš„ï¼Œé€šè¿‡åå­—å¤§æ¦‚ä¹Ÿèƒ½äº†è§£åˆ°è¿™ä¸‰ä¸ªæ–¹æ³•çš„ç”¨å¤„ã€‚ 123456//ç”¨æ¥æ·»åŠ çº¦æŸçš„ï¼Œæ³¨æ„çš„æ˜¯AutoLayoutä¸èƒ½åŒæ—¶å­˜åœ¨ä¸¤æ¡çº¦æŸåŒæ—¶é’ˆå¯¹ä¸€ä¸ªå¯¹è±¡ï¼Œä¼šæŠ¥é”™- (NSArray *)mas_makeConstraints:(void(^)(MASConstraintMaker *))block;//ç”¨æ¥æ›´æ–°çº¦æŸï¼Œä¸å­˜åœ¨ç›¸åŒçº¦æŸé’ˆå¯¹åŒä¸€ä¸ªå¯¹è±¡ï¼Œç›¸åŒçš„ä¼šè¢«æ›´æ–°- (NSArray *)mas_updateConstraints:(void(^)(MASConstraintMaker *))block;//æ¸…é™¤ä¹‹å‰æ‰€æœ‰çš„çº¦æŸï¼Œå¹¶æ›´æ–°ç°åœ¨æ·»åŠ çš„çº¦æŸ- (NSArray *)mas_remakeConstraints:(void(^)(MASConstraintMaker *make))block; equalTo å’Œ mas_equalTo çš„åŒºåˆ«ï¼š è¿™é‡Œ mas_equalTo æ˜¯å¯¹å…¶ä¸­çš„å‚æ•°åšäº†ä¸€ä¸ªBOXæ“ä½œï¼ˆè£…ç®±æ“ä½œï¼‰ï¼Œçœ‹äº†ä¸‹æºç å¾ˆé•¿ï¼Œå…·ä½“çš„æˆ‘ä¹Ÿæ²¡çœ‹å¤ªæ‡‚ï¼Œè¿™ä¸ªåé¢æœ‰æ—¶é—´ä»”ç»†äº†è§£ä¸‹ã€‚ç›®å‰æˆ‘åœ¨ä½¿ç”¨ä¸­çš„æ—¶å€™å¦‚æœæ˜¯ç›¸å¯¹äº View çš„çº¦æŸæ“ä½œæ˜¯ä½¿ç”¨ equalTo ï¼Œç›¸å¯¹äºç›´æ¥çš„æ•°å€¼å’Œç»“æ„ä½“çš„çº¦æŸæ˜¯ä½¿ç”¨ mas_equalToã€‚ ä»‹ç»å®Œä¸€äº›åŸºæœ¬çš„ä½¿ç”¨æ–¹æ³•åå°±æ¥åšä¸€äº›å®é™…æ“ä½œã€‚ ä¾‹å­1é¦–å…ˆæ¥å±…ä¸­æ˜¾ç¤ºä¸€ä¸ªçº¢è‰² Viewï¼š 12345678910111213UIView *redView = [[UIView alloc]init];redView.backgroundColor = [UIColor redColor];//æ·»åŠ çº¦æŸå‰éœ€è¦å…ˆæŠŠè§†å›¾æ·»åŠ åˆ°superViewä¸Šï¼Œå¦åˆ™ä¼šæŠ¥é”™[self.view addSubview:redView];[redView mas_makeConstraints:^(MASConstraintMaker *make) &#123; //ä¸­å¿ƒç‚¹ç­‰äºself.view make.center.equalTo(self.view); //viewçš„å®½å’Œé«˜ç­‰äº300 make.width.and.height.mas_equalTo(300); // è¿™ä¸€å¥å’Œä¸Šé¢ä¸€å¥æ˜¯ç­‰åŒçš„ï¼Œä¹Ÿæ˜¯è®¾ç½®viewçš„å®½å’Œé«˜çš„çº¦æŸç­‰äº300 // make.width.and.height.equalTo(@300);&#125;]; æ•ˆæœå¦‚ä¸‹ï¼š ä¾‹å­2åœ¨ä¾‹å­1çš„åŸºç¡€ä¸Šåˆ›å»ºä¸¤ä¸ªè§†å›¾ï¼Œè¾¹è·ç›¸äº’ä¸º10ï¼Œä¸”é«˜ç›¸ç­‰ï¼Œå®½ç›¸ç­‰ï¼š 12345678910111213141516171819202122232425262728293031323334353637//é¦–å…ˆæ·»åŠ è¿™ä¸¤ä¸ª View åˆ° redView ä¸ŠUIView *view1 = [[UIView alloc]init];view1.backgroundColor = [UIColor purpleColor];[redView addSubview:view1];UIView *view2 = [[UIView alloc]init];view2.backgroundColor = [UIColor orangeColor];[redView addSubview:view2];//æ·»åŠ  View1 çš„çº¦æŸ[view1 mas_makeConstraints:^(MASConstraintMaker *make) &#123; //å·¦è¾¹å’Œé¡¶éƒ¨ç›¸å¯¹ redView ç›¸è·10 make.left.and.top.equalTo(redView).offset(10); //å³è¾¹ç›¸å¯¹äº View2 çš„å·¦è¾¹ç›¸è· 10 make.right.equalTo(view2.mas_left).offset(-10); //ä¸­å¿ƒç‚¹ç›¸å¯¹äº redView ä¸­å¿ƒYè½´å¯¹é½ make.centerY.equalTo(redView.mas_centerY); //åº•éƒ¨ç›¸å¯¹äº redView çš„åº•éƒ¨ç›¸è·10 make.bottom.equalTo(redView).offset(-10); //å®½ç›¸å¯¹äº View2 çš„å®½ç›¸ç­‰ make.width.equalTo(view2.mas_width);&#125;];[view2 mas_makeConstraints:^(MASConstraintMaker *make) &#123; //å·¦è¾¹ç›¸å¯¹äº View1 çš„å³è¾¹ç›¸è·10 make.left.equalTo(view1.mas_right).offset(10); //å³è¾¹ç›¸å¯¹äº redView çš„å³è¾¹ç›¸è·10 make.right.equalTo(redView).offset(-10); //ä¸­å¿ƒç‚¹ç›¸å¯¹äº redView ä¸­å¿ƒYè½´å¯¹é½ make.centerY.equalTo(redView.mas_centerY); //é¡¶éƒ¨ç›¸å¯¹äº redView çš„è¾¹è·ä¸º10 make.top.equalTo(redView).offset(10); //åº•éƒ¨ç›¸å¯¹äº redView çš„è¾¹è·ä¸º10 make.bottom.equalTo(redView).offset(-10); //å®½ç›¸å¯¹äº View1 çš„å®½ç›¸ç­‰ make.width.equalTo(view1.mas_width);&#125;]; æ•ˆæœå¦‚ä¸‹ï¼š","categories":[],"tags":[{"name":"AutoLayout","slug":"AutoLayout","permalink":"Aaronzjp.cn/tags/AutoLayout/"}]},{"title":"ä»£ç å®ç°AutoLayoutå¸ƒå±€","slug":"AutoLayout UI","date":"2016-03-06T15:00:17.000Z","updated":"2017-07-27T02:57:38.000Z","comments":true,"path":"2016/03/06/AutoLayout UI/","link":"","permalink":"Aaronzjp.cn/2016/03/06/AutoLayout UI/","excerpt":"â€‹ åœ¨ä»£ç ä¸­æ·»åŠ Autolayoutçº¦æŸçš„æ–¹æ³•å°±å¦‚ä¸‹çš„æ•´ä¸ªdemoä»‹ç»ã€‚ä¸‹é¢demoä¸­è¿˜ä»‹ç»åˆ°äº†æ€ä¹ˆåœ¨Autolayoutä¸‹åšåŠ¨ç”»ï¼Œä»¥åŠçº¦æŸçš„ä¼˜å…ˆçº§ã€‚ åœ¨çº¦æŸæ·»åŠ ä¸­è¦æ³¨æ„ä»¥ä¸‹å‡ ä¸ªåœ°æ–¹ï¼š ä¸¤ä¸ªç›¸åŒä¸€å±‚çº§çš„è§†å›¾çš„çº¦æŸè¦æ·»åŠ åˆ°å…±åŒçš„çˆ¶è§†å›¾ä¸Š ä¸¤ä¸ªä¸åŒå±‚çº§çš„è§†å›¾çš„çº¦æŸè¦æ·»åŠ åˆ°ä»–ä»¬æœ€è¿‘çš„å…±æœ‰çš„çˆ¶è§†å›¾ä¸Š å­è§†å›¾ä¸çˆ¶è§†å›¾ä¹‹é—´çš„çº¦æŸæ·»åŠ åˆ°çˆ¶è§†å›¾ä¸Š","text":"â€‹ åœ¨ä»£ç ä¸­æ·»åŠ Autolayoutçº¦æŸçš„æ–¹æ³•å°±å¦‚ä¸‹çš„æ•´ä¸ªdemoä»‹ç»ã€‚ä¸‹é¢demoä¸­è¿˜ä»‹ç»åˆ°äº†æ€ä¹ˆåœ¨Autolayoutä¸‹åšåŠ¨ç”»ï¼Œä»¥åŠçº¦æŸçš„ä¼˜å…ˆçº§ã€‚ åœ¨çº¦æŸæ·»åŠ ä¸­è¦æ³¨æ„ä»¥ä¸‹å‡ ä¸ªåœ°æ–¹ï¼š ä¸¤ä¸ªç›¸åŒä¸€å±‚çº§çš„è§†å›¾çš„çº¦æŸè¦æ·»åŠ åˆ°å…±åŒçš„çˆ¶è§†å›¾ä¸Š ä¸¤ä¸ªä¸åŒå±‚çº§çš„è§†å›¾çš„çº¦æŸè¦æ·»åŠ åˆ°ä»–ä»¬æœ€è¿‘çš„å…±æœ‰çš„çˆ¶è§†å›¾ä¸Š å­è§†å›¾ä¸çˆ¶è§†å›¾ä¹‹é—´çš„çº¦æŸæ·»åŠ åˆ°çˆ¶è§†å›¾ä¸Š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104#import &quot;ViewController.h&quot;@interface ViewController ()&#123; UIView *blueView;&#125;@end@implementation ViewController- (void)viewDidLoad &#123; [super viewDidLoad]; [self addRedView];&#125;- (void)addRedView&#123; //é¦–å…ˆåˆ›å»ºè¿™ä¸ªView UIView *redView = [[UIView alloc]init]; redView.backgroundColor = [UIColor redColor]; //ç»™æ¯ä¸ªè§†å›¾ä»£ç æ·»åŠ NSLayoutConstraintçº¦æŸçš„æ—¶å€™è¦å…³é—­è¿™ä¸ªå±æ€§ redView.translatesAutoresizingMaskIntoConstraints = NO; //åœ¨ç»™è§†å›¾æ·»åŠ çº¦æŸçš„æ—¶å€™è¦å…ˆå°†è§†å›¾æ·»åŠ åˆ°çˆ¶è§†å›¾ï¼Œä¸ç„¶ä¼šæŠ¥é”™ [self.view addSubview:redView]; //ç›¸å¯¹äºçˆ¶æ§ä»¶çš„å·¦è¾¹è· NSLayoutConstraint *redViewLeft = [NSLayoutConstraint constraintWithItem:redView attribute:NSLayoutAttributeLeft relatedBy:NSLayoutRelationEqual toItem:self.view attribute:NSLayoutAttributeLeft multiplier:1.0 constant:20.0]; [self.view addConstraint:redViewLeft]; //ç›¸å¯¹äºçˆ¶æ§ä»¶çš„ä¸‹è¾¹è· NSLayoutConstraint *redViewBottom = [NSLayoutConstraint constraintWithItem:redView attribute:NSLayoutAttributeBottom relatedBy:NSLayoutRelationEqual toItem:self.view attribute:NSLayoutAttributeBottom multiplier:1.0 constant:-20.0]; [self.view addConstraint:redViewBottom]; //è‡ªèº«å®½åº¦çº¦æŸï¼ˆè¿™é‡Œæ˜¯ç›´æ¥æ·»åŠ å®½åº¦çº¦æŸï¼‰ NSLayoutConstraint *redViewWidth = [NSLayoutConstraint constraintWithItem:redView attribute:NSLayoutAttributeWidth relatedBy:NSLayoutRelationEqual toItem:nil attribute:kNilOptions multiplier:1.0 constant:50]; [redView addConstraint:redViewWidth]; //è‡ªèº«é«˜åº¦çº¦æŸï¼ˆè¿™é‡Œæ˜¯ç›´æ¥æ·»åŠ é«˜åº¦çº¦æŸï¼‰ NSLayoutConstraint *redViewHeight = [NSLayoutConstraint constraintWithItem:redView attribute:NSLayoutAttributeHeight relatedBy:NSLayoutRelationEqual toItem:nil attribute:kNilOptions multiplier:1.0 constant:50]; [redView addConstraint:redViewHeight]; //è“è‰²çš„å°æ–¹å— blueView = [[UIView alloc]init]; blueView.backgroundColor = [UIColor blueColor]; blueView.translatesAutoresizingMaskIntoConstraints = NO; [self.view addSubview:blueView]; //ç›¸å¯¹äºçº¢è‰²è§†å›¾çš„é¡¶éƒ¨çº¦æŸ NSLayoutConstraint *blueViewTop = [NSLayoutConstraint constraintWithItem:blueView attribute:NSLayoutAttributeTop relatedBy:NSLayoutRelationEqual toItem:redView attribute:NSLayoutAttributeTop multiplier:1.0 constant:0]; [self.view addConstraint:blueViewTop]; //è§†å›¾å·¦è¾¹çš„è¾¹è·ï¼ˆç›¸å¯¹äºçº¢è‰²è§†å›¾çš„å³è¾¹çš„è¾¹è·ï¼‰ NSLayoutConstraint *blueViewLeft = [NSLayoutConstraint constraintWithItem:blueView attribute:NSLayoutAttributeLeft relatedBy:NSLayoutRelationEqual toItem:redView attribute:NSLayoutAttributeRight multiplier:1.0 constant:20]; [self.view addConstraint:blueViewLeft]; //ç­‰äºçº¢è‰²è§†å›¾çš„å®½ NSLayoutConstraint *blueViewWidth = [NSLayoutConstraint constraintWithItem:blueView attribute:NSLayoutAttributeWidth relatedBy:NSLayoutRelationEqual toItem:redView attribute:NSLayoutAttributeWidth multiplier:1.0 constant:0]; [self.view addConstraint:blueViewWidth]; //ç­‰äºçº¢è‰²è§†å›¾çš„é«˜ NSLayoutConstraint *blueViewHeight = [NSLayoutConstraint constraintWithItem:blueView attribute:NSLayoutAttributeHeight relatedBy:NSLayoutRelationEqual toItem:redView attribute:NSLayoutAttributeHeight multiplier:1.0 constant:0]; [self.view addConstraint:blueViewHeight]; //é»‘è‰²çš„è§†å›¾ UIView *blackView = [[UIView alloc]init]; blackView.backgroundColor = [UIColor blackColor]; blackView.translatesAutoresizingMaskIntoConstraints = NO; [self.view addSubview:blackView]; //ç›¸å¯¹äºçº¢è‰²è§†å›¾çš„é¡¶éƒ¨çº¦æŸ NSLayoutConstraint *blackViewTop = [NSLayoutConstraint constraintWithItem:blackView attribute:NSLayoutAttributeTop relatedBy:NSLayoutRelationEqual toItem:redView attribute:NSLayoutAttributeTop multiplier:1.0 constant:0]; [self.view addConstraint:blackViewTop]; //è§†å›¾å·¦è¾¹çš„è¾¹è·ï¼ˆç›¸å¯¹äºçº¢è‰²è§†å›¾çš„å³è¾¹çš„è¾¹è·ï¼‰ NSLayoutConstraint *blackViewLeft = [NSLayoutConstraint constraintWithItem:blackView attribute:NSLayoutAttributeLeft relatedBy:NSLayoutRelationEqual toItem:blueView attribute:NSLayoutAttributeRight multiplier:1.0 constant:20]; [self.view addConstraint:blackViewLeft]; //ç›´æ¥æ·»åŠ é»‘è‰²è§†å›¾çš„å®½åº¦çº¦æŸ NSLayoutConstraint *blackViewWidth = [NSLayoutConstraint constraintWithItem:blackView attribute:NSLayoutAttributeWidth relatedBy:NSLayoutRelationEqual toItem:nil attribute:kNilOptions multiplier:1.0 constant:50]; [self.view addConstraint:blackViewWidth]; //ç›´æ¥æ·»åŠ é»‘è‰²è§†å›¾çš„é«˜åº¦çº¦æŸ NSLayoutConstraint *blackViewHeight = [NSLayoutConstraint constraintWithItem:blackView attribute:NSLayoutAttributeHeight relatedBy:NSLayoutRelationEqual toItem:nil attribute:kNilOptions multiplier:1.0 constant:50]; [self.view addConstraint:blackViewHeight]; //è¿™é‡Œä»‹ç»äº†åœ¨AutoLayoutä¸­åšåŠ¨ç”»çš„æ–¹æ³•ã€‚å½“è“è‰²è§†å›¾æ¶ˆå¤±åï¼Œè¿™ä¸ªè§†å›¾çš„å·¦è¾¹è·è¦è®¾ç½®ä¸ºç›¸å¯¹äºçº¢è‰²è§†å›¾çš„å³è¾¹è· NSLayoutConstraint *blackViewWithredViewLeft = [NSLayoutConstraint constraintWithItem:blackView attribute:NSLayoutAttributeLeft relatedBy:NSLayoutRelationEqual toItem:redView attribute:NSLayoutAttributeRight multiplier:1.0 constant:20]; //é‡å¤æ·»åŠ çº¦æŸæ˜¯å›æŠ¥é”™çš„ï¼Œä¸æ­£ç¡®çš„åšæ³•ã€‚ä½†æ˜¯è¿™é‡Œå¦‚æœè“è‰²è§†å›¾æ¶ˆå¤±ä¸æ”¹å˜çº¦æŸçš„è¯å°±è¾¾ä¸åˆ°æƒ³è¦çš„çº¦æŸæ•ˆæœ //è§£å†³æ–¹æ³•å°±æ˜¯è®¾ç½®çº¦æŸçš„ä¼˜å…ˆçº§ ä¼˜å…ˆçº§èŒƒå›´ä¸ºï¼š0 - 1000 æ•°å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ é»˜è®¤ä¸º1000 UILayoutPriority left = 200; blackViewWithredViewLeft.priority = left; [self.view addConstraint:blackViewWithredViewLeft];&#125;- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event&#123; [blueView removeFromSuperview]; [UIView animateWithDuration:2 animations:^&#123; //å½“è§†å›¾å‘ç”Ÿæ”¹å˜éœ€è¦æ›´æ–°çº¦æŸ [self.view layoutIfNeeded]; &#125;];&#125;","categories":[],"tags":[{"name":"Autolayout","slug":"Autolayout","permalink":"Aaronzjp.cn/tags/Autolayout/"}]},{"title":"åˆ©ç”¨Storyboardæˆ–Xibå®ç°è‡ªé€‚åº”Cell","slug":"StoryboardOrXibRealizeAutoLayoutCell","date":"2015-12-26T12:47:35.000Z","updated":"2017-07-27T02:53:17.000Z","comments":true,"path":"2015/12/26/StoryboardOrXibRealizeAutoLayoutCell/","link":"","permalink":"Aaronzjp.cn/2015/12/26/StoryboardOrXibRealizeAutoLayoutCell/","excerpt":"â€‹ é¦–å…ˆï¼ŒUITableViewè¿™ä¸œè¥¿æ€ä¹ˆç”¨å°±ä¸ç”¨è¯´äº†å§ï¼Œå¯ä»¥æ‹–ä¸€ä¸ªUITableviewåˆ°UIControllerä¸­ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ‹–ä¸€ä¸ªUITableViewControllerå‡ºæ¥ã€‚æ‹–UITableViewçš„æ—¶å€™ä¸è¦å¿˜è®°åŠ ä»£ç†å’Œæ•°æ®æºå°±å¯¹äº†ã€‚ å®Œæˆè¿™ä¸€æ­¥åå°±å¯ä»¥åœ¨storyboardä¸­å¯¹cellè¿›è¡Œçº¦æŸå¸ƒå±€äº†ï¼Œå°±ç”¨ä¸€ä¸ªç®€å•çš„demoæ¥è¯´ã€‚","text":"â€‹ é¦–å…ˆï¼ŒUITableViewè¿™ä¸œè¥¿æ€ä¹ˆç”¨å°±ä¸ç”¨è¯´äº†å§ï¼Œå¯ä»¥æ‹–ä¸€ä¸ªUITableviewåˆ°UIControllerä¸­ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ‹–ä¸€ä¸ªUITableViewControllerå‡ºæ¥ã€‚æ‹–UITableViewçš„æ—¶å€™ä¸è¦å¿˜è®°åŠ ä»£ç†å’Œæ•°æ®æºå°±å¯¹äº†ã€‚ å®Œæˆè¿™ä¸€æ­¥åå°±å¯ä»¥åœ¨storyboardä¸­å¯¹cellè¿›è¡Œçº¦æŸå¸ƒå±€äº†ï¼Œå°±ç”¨ä¸€ä¸ªç®€å•çš„demoæ¥è¯´ã€‚ è¿™é‡Œé€‰æ‹©ä½ éœ€è¦è‡ªé€‚åº”æ¢è¡Œçš„labelã€‚åˆ°å³è¾¹çš„å±æ€§é€‰æ‹©ä¸­è®¾ç½®ä¸‹ï¼Œè¿™æ ·labelå°±å¯ä»¥è‡ªåŠ¨æ¢è¡Œäº†ã€‚ä¸èƒ½çº¦æŸlabelçš„é«˜ï¼Œå¦åˆ™è‡ªåŠ¨æ¢è¡Œå°±æ— æ•ˆã€‚è®¾ç½®å¥½çº¦æŸåï¼Œåœ¨å³è¾¹æŠŠLinesçš„é€‰é¡¹è®¾ç½®ä¸º0ï¼ˆé»˜è®¤ä¸º1ï¼‰ï¼Œè¿™é‡Œçš„0ä»£è¡¨ä¸é™åˆ¶labelçš„è¡Œæ•°ã€‚ è®¾ç½®å¥½ä»¥ä¸Šæ­¥éª¤åï¼Œåœ¨ä»£ç ä¸­å®ç°ä»¥ä¸‹ä»£ç å°±å·²ç»æˆåŠŸçš„å®ç°cellçš„é«˜åº¦åªé€‚åº”äº†ã€‚ 1234567//è¿™é‡Œæ˜¯è®¾ç½®å•å…ƒæ ¼çš„é¢„åˆ¤é«˜åº¦ï¼Œæ ¹æ®è‡ªå·±çš„é¢„ä¼°å•å…ƒæ ¼çš„å¹³å‡é«˜åº¦éšä¾¿å¡«å†™ä¸€ä¸ªå°±è¡Œã€‚self.tableView.estimatedRowHeight = 200;//è¿™é‡Œæ˜¯è®¾ç½®å•å…ƒæ ¼é»˜è®¤çš„è¡Œé«˜ï¼Œå°±æ˜¯ä¼šæ ¹æ®è‡ªå·±çš„è®¡ç®—æ¥è·å¾—å®é™…é«˜åº¦;self.tableView.rowHeight = UITableViewAutomaticDimension; å¦‚æœå¯¹cellçš„å†…å®¹æœ‰æ›´å¤æ‚çš„éœ€æ±‚ï¼Œéœ€è¦åšcellè‡ªé€‚åº”çš„è¯ï¼Œè¿˜æ˜¯å»ºè®®ç”¨ä»£ç æ¥å®ç°ã€‚","categories":[],"tags":[{"name":"è‡ªé€‚åº”Cell","slug":"è‡ªé€‚åº”Cell","permalink":"Aaronzjp.cn/tags/è‡ªé€‚åº”Cell/"}]},{"title":"iOS9httpè¯·æ±‚","slug":"iOS9-http-Request","date":"2015-09-14T06:23:06.000Z","updated":"2017-07-27T02:56:22.000Z","comments":true,"path":"2015/09/14/iOS9-http-Request/","link":"","permalink":"Aaronzjp.cn/2015/09/14/iOS9-http-Request/","excerpt":"å› ä¸ºå‡çº§iOS9ä»¥åè‹¹æœè¦æ±‚Appå†…è®¿é—®ç½‘ç»œæ—¶å¿…é¡»ä½¿ç”¨HTTPSåè®®ï¼Œåœ¨æ–°å»ºçš„å·¥ç¨‹ä¸­éƒ½æ˜¯é»˜è®¤ä½¿ç”¨HTTPSåè®®çš„ï¼Œåœ¨ä¸ä¿®æ”¹çš„æƒ…å†µä¸‹æ— æ³•æ­£å¸¸çš„è®¿é—®HTTPåè®®çš„ç½‘ç»œã€‚ä»¥å‰é‡åˆ°è¿™ä¸ªé—®é¢˜è§£å†³åå°±æ²¡ç®¡ï¼Œç°åœ¨è®°å½•ä¸€ä¸‹æ–¹ä¾¿æŸ¥æ‰¾ã€‚","text":"å› ä¸ºå‡çº§iOS9ä»¥åè‹¹æœè¦æ±‚Appå†…è®¿é—®ç½‘ç»œæ—¶å¿…é¡»ä½¿ç”¨HTTPSåè®®ï¼Œåœ¨æ–°å»ºçš„å·¥ç¨‹ä¸­éƒ½æ˜¯é»˜è®¤ä½¿ç”¨HTTPSåè®®çš„ï¼Œåœ¨ä¸ä¿®æ”¹çš„æƒ…å†µä¸‹æ— æ³•æ­£å¸¸çš„è®¿é—®HTTPåè®®çš„ç½‘ç»œã€‚ä»¥å‰é‡åˆ°è¿™ä¸ªé—®é¢˜è§£å†³åå°±æ²¡ç®¡ï¼Œç°åœ¨è®°å½•ä¸€ä¸‹æ–¹ä¾¿æŸ¥æ‰¾ã€‚ è§£å†³æ–¹å¼æ‰¾åˆ°å·¥ç¨‹çš„Info.plistæ–‡ä»¶åœ¨å…¶ä¸­æ·»åŠ ä¸€ä¸ªApp Transport Security Settingsçš„å­—æ®µå±æ€§ï¼Œç„¶ååœ¨è¯¥å­—å…¸å±æ€§ä¸‹æ·»åŠ ä¸€ä¸ªAllow Arbitrary Loadså±æ€§ï¼Œè®¾ç½®ä¸ºYESå³å¯ã€‚ å¦‚ä¸‹å›¾ï¼š","categories":[],"tags":[{"name":"ç–‘éš¾æ‚ç—‡","slug":"ç–‘éš¾æ‚ç—‡","permalink":"Aaronzjp.cn/tags/ç–‘éš¾æ‚ç—‡/"}]},{"title":"gitçš„ç®€å•ä½¿ç”¨","slug":"UseGit","date":"2015-07-05T06:04:25.000Z","updated":"2017-04-19T09:18:41.000Z","comments":true,"path":"2015/07/05/UseGit/","link":"","permalink":"Aaronzjp.cn/2015/07/05/UseGit/","excerpt":"å…³äºå®‰è£…gitå› ä¸ºåœ¨Macä¸Šå®‰è£…Xcodeåå°±ä¼šè‡ªåŠ¨çš„å®‰è£…gitï¼Œæ‰€æœ‰Macç«¯çš„å®‰è£…æ–¹å¼å°±ä¸éœ€è¦æ€ä¹ˆè¯´äº†ï¼Œåœ¨Linuxä¸‹å…·ä½“çš„å°±ä¸æ€ä¹ˆè¯´äº†ï¼Œè‡ªè¡ŒGoogleï¼Œå› ä¸ºLinuxçš„ç‰ˆæœ¬å¤ªå¤šï¼Œå„ä¸ªç‰ˆæœ¬ä¹‹é—´éƒ½å­˜åœ¨å¾®å°çš„å·®å¼‚ã€‚åœ¨Windowsä¸‹æ¨èä½¿ç”¨git for Windowsï¼Œå®ƒåŒ…æ‹¬äº†å›¾å½¢å·¥å…·ä»¥åŠå‘½ä»¤çš„ä½¿ç”¨ã€‚","text":"å…³äºå®‰è£…gitå› ä¸ºåœ¨Macä¸Šå®‰è£…Xcodeåå°±ä¼šè‡ªåŠ¨çš„å®‰è£…gitï¼Œæ‰€æœ‰Macç«¯çš„å®‰è£…æ–¹å¼å°±ä¸éœ€è¦æ€ä¹ˆè¯´äº†ï¼Œåœ¨Linuxä¸‹å…·ä½“çš„å°±ä¸æ€ä¹ˆè¯´äº†ï¼Œè‡ªè¡ŒGoogleï¼Œå› ä¸ºLinuxçš„ç‰ˆæœ¬å¤ªå¤šï¼Œå„ä¸ªç‰ˆæœ¬ä¹‹é—´éƒ½å­˜åœ¨å¾®å°çš„å·®å¼‚ã€‚åœ¨Windowsä¸‹æ¨èä½¿ç”¨git for Windowsï¼Œå®ƒåŒ…æ‹¬äº†å›¾å½¢å·¥å…·ä»¥åŠå‘½ä»¤çš„ä½¿ç”¨ã€‚ é…ç½®gitå®‰è£…å®Œgitåæˆ‘ä»¬ç¬¬ä¸€ä»¶äº‹è¦åšçš„å°±æ˜¯é…ç½®gitï¼Œå…¶ä¸­é…ç½®gitæ–¹å¼å¦‚ä¸‹ï¼š git config â€“global user.name â€œç”¨æˆ·åâ€ git config â€“global user.email â€œé‚®ç®±â€ é…ç½®å¥½è¿™ä¸¤é¡¹åï¼Œå°±èƒ½é€šè¿‡gitçš„é…ç½®çŸ¥é“è°åœ¨gitä»“åº“ä¸­åšäº†ä»€ä¹ˆã€‚ åˆ›å»ºä¸€ä¸ªæ–°çš„gitä»“åº“åˆ›å»ºä¸€ä¸ªgitä»“åº“åï¼Œgitä¼šæŠŠè¯¥é¡¹ç›®çš„æ‰€æœ‰æ–‡ä»¶ä»¥åŠå†å²è®°å½•é€šè¿‡å¿«ç…§çš„æ–¹å¼ä¿å­˜åœ¨é¡¹ç›®ä¸­ï¼Œåœ¨åˆ›å»ºä»“åº“çš„æ—¶å€™ï¼Œé¦–å…ˆè¦è¿›å…¥åˆ°é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ï¼Œç„¶ååˆ›å»ºgitä»“åº“ã€‚åˆ›å»ºå®Œæˆågitä¼šåœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªéšè—çš„æ–‡ä»¶å¤¹ä»¥.gitç»“å°¾ã€‚ cd desktop/test git init è¿™æ ·å°±ä¸ºè¿™ä¸ªtestçš„å·¥ç¨‹åˆ›å»ºäº†ä¸€ä¸ªgitä»“åº“ã€‚ æŸ¥çœ‹gitä»“åº“çš„çŠ¶æ€gitä»“åº“çš„çŠ¶æ€æ˜¯å¾ˆé‡è¦çš„ä¸€ä¸ªä¸œè¥¿ï¼Œæˆ‘ä»¬é€šè¿‡gitä»“åº“çš„çŠ¶æ€å¯ä»¥åˆ¤æ–­å‡ºæ¥è¯¥é¡¹ç›®ä»“åº“ä¸­çš„ä¸œè¥¿æ˜¯å¦ä¸ºæœ€æ–°çš„ï¼Œä»¥åŠé¡¹ç›®æ˜¯å¦è¢«(commit)æäº¤åˆ°gitä»“åº“ä¿å­˜ã€‚ git status é€šè¿‡è¿™ä¸ªå‘½ä»¤å°±å¯ä»¥åœ¨terminalä¸­æ˜¾ç¤ºå‡ºå½“å‰gitä»“åº“çš„çŠ¶æ€ã€‚ æš‚å­˜gitä¸­æœ‰ä¸ªå«æš‚å­˜åŒºçš„ä¸œè¥¿ï¼Œæˆ‘ä»¬åœ¨æäº¤ä»£ç å‰éƒ½å…ˆè¦å°†ä»£ç ä¿å­˜åˆ°æš‚å­˜åŒºåœ¨è¿›è¡Œä»£ç çš„æäº¤ã€‚å¦‚ä¸‹æäº¤ä»£ç åˆ°gitæš‚å­˜åŒºçš„å‘½ä»¤ï¼š æäº¤å•ä¸ªçš„æ–‡ä»¶åˆ°æš‚å­˜åŒºï¼š git add æ–‡ä»¶å‘½ æäº¤æ‰€æœ‰çš„æ–‡ä»¶åˆ°æš‚å­˜åŒºï¼š git add -A å°†æ–‡ä»¶æäº¤åˆ°æš‚å­˜åŒºåå†æ¬¡ä½¿ç”¨git statusæŸ¥çœ‹çŠ¶æ€å°±ä¼šå‘ç°æ–‡ä»¶å·²ç»æäº¤äº†ï¼Œå…¶ä¸­çš„ä¿¡æ¯è¿˜ä¼šå‘Šè¯‰æˆ‘ä»¬å“ªäº›æ–‡ä»¶å‘ç”Ÿäº†æ”¹å˜ï¼Œä¿®æ”¹äº†ä»€ä¹ˆä¸œè¥¿ã€‚ æäº¤æ–‡ä»¶è¢«å­˜åˆ°æš‚å­˜åŒºåæˆ‘ä»¬è¿˜æ˜¯éœ€è¦æäº¤ä»£ç åˆ°git git commit å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹æäº¤çš„ä»£ç åŠ ä»¥æè¿°ï¼Œä»¥ä¾¿æ¸…æ¥šçš„è¡¨è¾¾æˆ‘ä»¬ä¿®æ”¹äº†ä»€ä¹ˆï¼Œç­‰ç­‰ï¼Œè¿™æ ·æˆ‘ä»¬èƒ½æ›´å¥½çš„æ‰¾åˆ°æŸä¸ªé˜¶æ®µçš„ä»£ç ï¼Œå›æ»šç­‰ç­‰çš„å…¶ä»–æ“ä½œ git commit -m â€œæè¿°å†…å®¹â€ æäº¤ä»£ç åˆ°è¿œç«¯ä»“åº“ä¸Šé¢æˆ‘ä»¬æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯åœ¨æœ¬åœ°ï¼Œæ–‡ä»¶ä¹Ÿéƒ½æ˜¯è¢«ä¿å­˜åœ¨æœ¬åœ°çš„ï¼Œä½†æ˜¯å½“æˆ‘ä»¬å¤„äºå¤šäººååŒå¼€å‘æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†ä»£ç å‘å¸ƒåˆ°è¿œç«¯çš„ä»“åº“ä»¥ä¾¿å…¶ä»–çš„å·¥ç¨‹å¸ˆpullä»¥åŠpushä»£ç åŠæ—¶çš„ä¿®æ”¹ä»£ç å’Œæäº¤åˆå¹¶ä»£ç ã€‚ è¿™é‡Œè¿œç«¯ä»“åº“å°±ç”¨githubä½œä¸ºç¤ºä¾‹ï¼Œé¦–å…ˆåœ¨githubä¸Šåˆ›å»ºä¸€ä¸ªä»“åº“ï¼Œç„¶åæ‰¾åˆ°ä»“åº“çš„sshåœ°å€æˆ–è€…httpåœ°å€ã€‚ç„¶ååœ¨terminalä¸­è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š git remote add origin ä»“åº“åœ°å€ åœ¨æœ¬åœ°ä»“åº“ä¸­æ·»åŠ å¥½è¿œç«¯ä»“åº“çš„åœ°å€åå°±å¯ä»¥æäº¤ä»£ç åˆ°è¿œç«¯ä»“åº“äº†ï¼š git push origin master æˆåŠŸpushåˆ°è¿œç«¯ä»“åº“åè¯¥é¡¹ç›®çš„å…¶ä»–äººå°±å¯ä»¥ä»è¿œç«¯ä»“åº“æ‹‰å–åˆšåˆšpushä¸Šå»çš„æœ€æ–°çš„ä»£ç ï¼š git pull origin master åˆ›å»ºåˆ†æ”¯æ¯ä¸ªä»“åº“åœ¨é»˜è®¤çš„æ—¶å€™éƒ½åªæœ‰ä¸€ä¸ªé»˜è®¤çš„åˆ†æ”¯masterï¼Œä½†æ˜¯åœ¨é¡¹ç›®ä¸­æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å¼€ä¸€äº›æ–°çš„åˆ†æ”¯ï¼Œæ–°å¼€åˆ†æ”¯ï¼š git branch åˆ†æ”¯å æŸ¥çœ‹åˆ†æ”¯çŠ¶æ€ï¼š git branch æ–°å¼€ä¸€ä¸ªåˆ†æ”¯åæˆ‘ä»¬éœ€è¦è¯•è¯•çœ‹åˆ‡æ¢åˆ°æ–°çš„åˆ†æ”¯ï¼Œåˆ‡æ¢åˆ†æ”¯ï¼š git checkout åˆ†æ”¯å åˆå¹¶åˆ†æ”¯ï¼Œåœ¨åˆå¹¶åˆ†æ”¯çš„æ—¶å€™ï¼Œä¸€å®šè¦æŠŠè¦åˆå¹¶çš„åˆ†æ”¯åˆ‡æ¢åˆ°å½“å‰åˆ†æ”¯ï¼Œç„¶åå»åˆå¹¶è¢«åˆå¹¶çš„åˆ†æ”¯ï¼Œè¿™é‡Œå°±æ˜¯ç”¨masterå»åˆå¹¶ä¸€ä¸ªåˆ†æ”¯ï¼š git checkout master git merge åˆ†æ”¯å åˆ é™¤åˆ†æ”¯ï¼š git branch -d åˆ†æ”¯å å…¶ä»–ä½¿ç”¨æŸ¥çœ‹gitæäº¤æ—¥å¿—ï¼š git log è¦æŸ¥çœ‹æ¯æ¬¡æ›´æ–°å…·ä½“éƒ½æ›´æ–°äº†ä»€ä¹ˆä¸œè¥¿ï¼š git show æäº¤çš„id æŸ¥çœ‹ä¸¤æ¬¡æäº¤çš„ä¸åŒï¼š git diff æäº¤çš„id..æäº¤çš„id å·®ä¸å¤šgitçš„åŸºæœ¬ä½¿ç”¨å°±æ˜¯è¿™äº›äº†ï¼Œå·²ç»è¶³å¤Ÿåœ¨å¹³å¸¸çš„å·¥ä½œä¸­ä½¿ç”¨äº†ï¼Œæœ€åæˆ‘è¿˜æ˜¯å»ºè®®èƒ½ç”¨å›¾å½¢å·¥å…·è¿˜æ˜¯ä½¿ç”¨å›¾å½¢å·¥å…·å§ï¼Œå› ä¸ºå›¾å½¢å·¥å…·æ›´ä¾¿æ·ï¼Œæ›´æ¸…æ¥šæ˜äº†è¿˜ä¸å®¹æ˜“å‡ºé”™ï¼Œæœ‰ä»€ä¹ˆä¸å¥½çš„å‘¢ã€‚OS Xä¸Šæˆ‘ç°åœ¨æ­£åœ¨ä½¿ç”¨çš„æ˜¯SourceTreeï¼Œå…·ä½“ä½¿ç”¨ä»€ä¹ˆè¿™ä¸ªçœ‹ä¸ªäººçš„å–œå¥½å’Œä¹ æƒ¯ã€‚","categories":[],"tags":[{"name":"git","slug":"git","permalink":"Aaronzjp.cn/tags/git/"}]},{"title":"ä¸€ä¸ªAppå¤šä¸ªUITabBarçš„å¤„ç†","slug":"Multiple-UITabBar","date":"2015-06-30T07:55:43.000Z","updated":"2017-07-27T02:58:34.000Z","comments":true,"path":"2015/06/30/Multiple-UITabBar/","link":"","permalink":"Aaronzjp.cn/2015/06/30/Multiple-UITabBar/","excerpt":"â€‹ å¹³æ—¶å¾ˆå¤šå¸¸è§„çš„Appéƒ½æ˜¯ä¸€ä¸ªAppåªæœ‰ä¸€ä¸ªUITabBarï¼Œä½†æ˜¯è¿™æ¬¡è¦åšçš„éœ€æ±‚æ˜¯åœ¨ä¸åŒçš„ViewControllerä¸‹å°±ä¼šæ˜¾ç¤ºä¸åŒçš„UITabBarï¼Œå› ä¸ºè‡ªå·±ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡åšè¿™æ ·çš„éœ€æ±‚çš„å¤„ç†ï¼Œæ‰€ä»¥ä¸€å¼€å§‹å°±åœ¨ç½‘ä¸Šæ‰¾ç±»ä¼¼éœ€æ±‚çš„èµ„æ–™ï¼Œç»“æœæ˜¯æ‰¾äº†åŠå¤©ä¹Ÿæ²¡æœ‰æ€ä¹ˆæ‰¾åˆ°ã€‚äºæ˜¯ä¹Ÿå°±åªèƒ½æ…¢æ…¢çš„ç¢ç£¨äº†ï¼Œ","text":"â€‹ å¹³æ—¶å¾ˆå¤šå¸¸è§„çš„Appéƒ½æ˜¯ä¸€ä¸ªAppåªæœ‰ä¸€ä¸ªUITabBarï¼Œä½†æ˜¯è¿™æ¬¡è¦åšçš„éœ€æ±‚æ˜¯åœ¨ä¸åŒçš„ViewControllerä¸‹å°±ä¼šæ˜¾ç¤ºä¸åŒçš„UITabBarï¼Œå› ä¸ºè‡ªå·±ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡åšè¿™æ ·çš„éœ€æ±‚çš„å¤„ç†ï¼Œæ‰€ä»¥ä¸€å¼€å§‹å°±åœ¨ç½‘ä¸Šæ‰¾ç±»ä¼¼éœ€æ±‚çš„èµ„æ–™ï¼Œç»“æœæ˜¯æ‰¾äº†åŠå¤©ä¹Ÿæ²¡æœ‰æ€ä¹ˆæ‰¾åˆ°ã€‚äºæ˜¯ä¹Ÿå°±åªèƒ½æ…¢æ…¢çš„ç¢ç£¨äº†ï¼Œ æœ€å¼€å§‹æˆ‘æƒ³çš„æ˜¯å¤šåšä¸€ä¸ªUITabBarControllerï¼Œåœ¨é‚£ä¸ªéœ€è¦å˜æ›´TabBarçš„Controllerä¸­å°±pushå‡ºå¦å¤–ä¸€ä¸ªUITabBarControllerï¼Œä½†æ˜¯ã€‚ã€‚ã€‚ä½†æ˜¯ã€‚ã€‚ã€‚ä½†æ˜¯åšå‡ºæ¥äº†å‘ç°å¹¶æ²¡æœ‰ä»»ä½•å˜åŒ–ã€‚ å¦‚ä¸‹å›¾è¿™æ ·ï¼š â€‹ è¯•äº†ä¸€ä¸‹æ„Ÿè§‰ä¸è¡Œï¼Œæ€ä¹ˆåŠï¼Ÿåˆ äº†ï¼Ÿæ­£å‡†å¤‡åˆ äº†çš„æ—¶å€™çªå‘å¥‡æƒ³çš„ä¼šä¸ä¼šæ˜¯ä¸Šä¸€ä¸ªTabBarçš„è§†å›¾æŠŠpushå‡ºæ¥çš„è¿™ä¸ªè§†å›¾ç»™æŒ¡ä½äº†å‘¢ï¼Ÿäºæ˜¯æˆ‘åœ¨pushå‡ºç¬¬äºŒä¸ªTabBarçš„æ—¶å€™å°è¯•éšè—æ‰ä¸Šä¸€ä¸ªè§†å›¾çš„TabBarå’ŒNavigationBarï¼š 12[self.navigationController.navigationBar setHidden:YES];[self.tabBarController.tabBar setHidden:YES]; éšè—åçœŸçš„å¯ä»¥äº†ï¼Œåœ¨pushå‡ºç¬¬äºŒä¸ªTabBarçš„æ—¶å€™æˆåŠŸçš„å˜æ›´äº†TabBarä½†æ˜¯æ–°çš„é—®é¢˜åˆå‡ºç°äº†ï¼Œè¿™æ ·pushååŸå…ˆçš„navigationBarå·²ç»è¢«éšè—äº†ï¼Œæ²¡æœ‰äº†è¿”å›æŒ‰é’®ï¼Œæ— æ³•è¿”å›åˆ°ä¸»é¡µé¢ã€‚äºæ˜¯è¿™é‡Œå°±åªèƒ½è‡ªå·±æ·»åŠ ä¸Šä¸€ä¸ªè¿”å›æŒ‰é’®ï¼Œç„¶åpopåˆ°æ ¹è§†å›¾ï¼š 1234567self.view.backgroundColor = [UIColor whiteColor];UIBarButtonItem *backButton = [[UIBarButtonItem alloc]initWithTitle:@&quot;è¿”å›&quot;style:UIBarButtonItemStylePlain target:self action:@selector(backToRootViewController)];//æ³¨æ„è¿™é‡Œçš„ä¸åŒ- (void)backToRootViewController &#123; [self.tabBarController.navigationController popToRootViewControllerAnimated:YES];&#125; æ³¨æ„è¿™é‡Œæ˜¯self.tabBarController.navigationController å¦‚æœæ˜¯self.navigationControllerçš„è¯æ˜¯æ²¡æœ‰æ•ˆæœçš„ï¼Œå…·ä½“åŸå› å¯èƒ½å°±æ˜¯TabBarè¢«å’ŒnavigationBarè¢«åµŒå¥—åå°±è¦è·å–åˆ°tabBarControllerçš„navigationBaræ¥popåˆ°ä¸»é¡µçš„æ ¹è§†å›¾ã€‚","categories":[],"tags":[{"name":"æ€è·¯","slug":"æ€è·¯","permalink":"Aaronzjp.cn/tags/æ€è·¯/"}]},{"title":"iOS-é¢„å¤„ç†ç¨‹åº","slug":"iOS-Precompiling","date":"2015-06-21T04:13:45.000Z","updated":"2017-07-27T02:56:48.000Z","comments":true,"path":"2015/06/21/iOS-Precompiling/","link":"","permalink":"Aaronzjp.cn/2015/06/21/iOS-Precompiling/","excerpt":"é¢„å¤„ç†ç¨‹åºï¼Œå³é¢„ç¼–è¯‘ã€‚é¢„å¤„ç†ç¨‹åºæ˜¯ç¨‹åºç¼–è¯‘è¿‡ç¨‹ä¸­çš„ä¸€éƒ¨åˆ†ã€‚é¡¾åæ€ä¹‰å¤§æ¦‚å°±æ˜¯åœ¨ç¨‹åºç¼–è¯‘ä¹‹å‰å°±å¤„ç†è¿™äº›é¢„ç¼–è¯‘ç¨‹åºæŒ‡ä»¤ã€‚åœ¨å¹³å¸¸å¼€å‘å·¥ä½œä¸­å¯èƒ½ç»å¸¸çœ‹åˆ°ä¸€å¤§å †çš„å…¨å¤§å†™çš„ä»£ç æœ‰çš„è¿˜ç”¨ä¸‹åˆ’çº¿æ¥è¿æ¥èµ·æ¥ï¼Œå…¶å®è¿™ä¸ªå°±æ˜¯é¢„ç¼–è¯‘ä»£ç ã€‚","text":"é¢„å¤„ç†ç¨‹åºï¼Œå³é¢„ç¼–è¯‘ã€‚é¢„å¤„ç†ç¨‹åºæ˜¯ç¨‹åºç¼–è¯‘è¿‡ç¨‹ä¸­çš„ä¸€éƒ¨åˆ†ã€‚é¡¾åæ€ä¹‰å¤§æ¦‚å°±æ˜¯åœ¨ç¨‹åºç¼–è¯‘ä¹‹å‰å°±å¤„ç†è¿™äº›é¢„ç¼–è¯‘ç¨‹åºæŒ‡ä»¤ã€‚åœ¨å¹³å¸¸å¼€å‘å·¥ä½œä¸­å¯èƒ½ç»å¸¸çœ‹åˆ°ä¸€å¤§å †çš„å…¨å¤§å†™çš„ä»£ç æœ‰çš„è¿˜ç”¨ä¸‹åˆ’çº¿æ¥è¿æ¥èµ·æ¥ï¼Œå…¶å®è¿™ä¸ªå°±æ˜¯é¢„ç¼–è¯‘ä»£ç ã€‚ è®²åˆ°é¢„ç¼–è¯‘æŒ‡ä»¤é¦–å…ˆå°±è¦è¯´ #define å®å®šä¹‰ã€‚ #define#define å®å®šä¹‰è¯­å¥çš„ä¸»è¦ç”¨é€”å°±æ˜¯æ›¿æ¢ï¼Œåªè¦åœ¨ç¨‹åºä¸­å‡ºç°è¯¥å®å®šä¹‰çš„åœ°æ–¹å°±ä¼šæŠŠå…¶æ›¿æ¢ä¸ºå®å®šä¹‰åçš„å¸¸é‡æˆ–è€…è¡¨è¾¾å¼ã€‚ å®å®šä¹‰çš„ç®€å•ä½¿ç”¨å¦‚ä¸‹ï¼š 123456789101112#define ONE 1#define IRON_MAN @&quot;iron man&quot;if (a == ONE) &#123; NSLog(@&quot;a = 1&quot;);&#125; else &#123; NSLog(@&quot;a != 1&quot;);&#125;NSString *ironman = @&quot;iron man&quot;;if ([ironman isEqualToString:IRON_MAN]) &#123; NSLog(IRON_MAN);&#125; è¾“å‡ºï¼š 12a = 1iron man å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„å®å®šä¹‰åªæ˜¯åšå‡ºäº†ç®€å•çš„æ›¿æ¢ï¼Œä½†æ˜¯æ¥ç€çœ‹ï¼Œå®å®šä¹‰è¿˜æœ‰æ›´é«˜çº§çš„ç”¨æ³•ï¼Œå®å®šä¹‰ä¹Ÿå¯ä»¥æ˜¯è¡¨è¾¾å¼ï¼Œæˆ–è€…å¸¦å‚æ•°çš„å®å®šä¹‰ã€‚ 12#define TWO_FIVE 5 + 5NSLog(@&quot;%f&quot;,TWO_FIVE); è¿™é‡Œè¿™ä¸ªå®å®šä¹‰æ˜¯ä¸€ä¸ªç®€çŸ­çš„è¡¨è¾¾å¼ï¼Œè¿™é‡Œä¼šè¾“å‡º10ã€‚å†æ¥çœ‹ä¸€ä¸‹å¸¦æœ‰å‚æ•°çš„å®å®šä¹‰æ˜¯ä»€ä¹ˆæ ·çš„å§ã€‚å¦‚ä¸‹ï¼š 12#define MAX_OF_NUMBER(a,b) a &gt;b ? a : bNSLog(@&quot;%d&quot;,MAX_OF_NUMBER(5, 10)); è¿™æ®µä»£ç ä¼šè¾“å‡º10ï¼Œè¯¥å®å®šä¹‰æ˜¯å¸¦æœ‰ä¸¤ä¸ªå‚æ•°çš„å®å®šä¹‰ï¼Œå…¶ä½œç”¨æ˜¯å–è¿™ä¸¤ä¸ªæ•°çš„æœ€å¤§å€¼ã€‚ æ¶ˆé™¤å®å®šä¹‰å¯ä»¥ä½¿ç”¨ #undef è¯­å¥ï¼Œå¦‚ä¸‹ï¼š å¦‚æœè¦åœ¨å®å®šä¹‰ä¸­æ¢è¡Œï¼Œåˆ™éœ€å‘€åœ¨æ¯è¡Œçš„ç»“å°¾å¤„æ·»åŠ åæ–œæ \\ã€‚ è¿™é‡Œä¸è®¨è®ºå®å®šä¹‰çš„æ­£ç¡®æ€§ï¼Œåªæ˜¯ç®€å•ä»‹ç»ä¸€ä¸‹å®å®šä¹‰çš„ä½¿ç”¨ï¼Œå…³äºå®å®šä¹‰å¯ä»¥å‚è€ƒä¸‹é¢çš„èµ„æ–™ã€‚ å®å®šä¹‰çš„é»‘é­”æ³• - å®èœé¸Ÿèµ·é£æ‰‹å†Œ æ¡ä»¶ç¼–è¯‘æ¡ä»¶ç¼–è¯‘çš„è¯­å¥ï¼š #if åœ¨é¢„å¤„ç†æŒ‡ä»¤ä¸­çš„æ¡ä»¶åˆ¤æ–­ï¼Œç›¸å½“äº if #ifdef åœ¨é¢„å¤„ç†æŒ‡ä»¤ä¸­åˆ¤æ–­æŸä¸ªå®æ˜¯å¦å·²ç»è¢«å®šä¹‰ #ifndef ä¸ä¸Šä¸€æ¡ç›¸åï¼Œåˆ¤æ–­æŸä¸ªå®å®šä¹‰æ˜¯å¦æœªå®šä¹‰ #elif é¢„å¤„ç†æŒ‡ä»¤ä¸­å¦‚æœå…¶ä»–æ¡ä»¶ä¸æ»¡è¶³åˆ™æ‰§è¡Œ #elif å†…çš„è¯­å¥ï¼Œå’Œ else if ä¸€æ · #else é¢„å¤„ç†æŒ‡ä»¤ä¸­å¦‚æœå…¶ä»–æ¡ä»¶éƒ½ä¸æ»¡è¶³åˆ™æ‰§è¡Œ #else åçš„è¯­å¥ï¼Œå’Œ else ä¸€æ · #endif æ¡ä»¶è¯­å¥ç»“æŸçš„æ ‡å¿—è¯­å¥ å€¼å¾—æ³¨æ„çš„å°±æ˜¯è¿™é‡Œçš„è¯­å¥éƒ½æ˜¯åˆ¤æ–­åé¢çš„æ¡ä»¶æ˜¯å¦æ»¡è¶³ï¼Œåªæœ‰ #ifdef æ˜¯åˆ¤æ–­æŸä¸ªå®æ˜¯å¦è¢«å®šä¹‰ã€‚åœ¨ä½¿ç”¨ä¸Šè¿™ä¸¤ä¸ªæ˜¯ç›¸åŒçš„ï¼š 1234567#ifdef IPHONE NSLog(IPHONE);#endif// ********************* #if defined (IPHONE) NSLog(IPHONE);#endif å…¶ä¸­ defined () ä¹Ÿæ˜¯åˆ¤æ–­æŸä¸ªå®æ˜¯å¦å·²ç»è¢«å®šä¹‰ï¼Œæ¡ä»¶ç¼–è¯‘è¯­å¥å’Œæ™®é€šçš„æ¡ä»¶åˆ¤æ–­è¯­å¥ä¸€æ ·ä¹Ÿæ˜¯å¯ä»¥åµŒå¥—çš„ã€‚è¿™é‡Œè´´å‡ºä¸€éƒ¨åˆ† Foudation æ¡†æ¶ä¸­çš„ä»£ç å‚è€ƒï¼Œå¯ä»¥çœ‹ä¸€ä¸‹åˆ«äººçš„ä½¿ç”¨ã€‚ å¦å¤–åœ¨å¾ˆå¤šæ—¶å€™åˆ›å»ºå¤´æ–‡ä»¶ä¸­éƒ½ä¼šæœ‰å¦‚ä¸‹çš„ä»£ç ï¼š 1234#ifndef Header_h #define Header_h #endif ä¸Šé¢çš„è¿™äº›é¢„ç¼–äºæŒ‡ä»¤ä»£ç å…¶å®å°±æ˜¯ä¸ºäº†é˜²æ­¢å¤´æ–‡ä»¶é‡å¤å¯¼å…¥ã€‚ æ–‡ä»¶å¯¼å…¥æ–‡ä»¶å¯¼å…¥å…¶å®ä¹Ÿæ˜¯å±äºé¢„å¤„ç†ç¨‹åºçš„ä¸€ç§ï¼Œä½†æ˜¯æ–‡ä»¶å¯¼å…¥åƒä»€ä¹ˆ #import #include @classç»å¸¸éƒ½åœ¨ä½¿ç”¨å·²ç»å¾ˆç†Ÿæ‚‰å…¶ä¸­çš„ç”¨æ³•å’Œå«ä¹‰äº†è¿™é‡Œå°±ä¸è®°å½•äº†ã€‚","categories":[],"tags":[{"name":"å®","slug":"å®","permalink":"Aaronzjp.cn/tags/å®/"}]},{"title":"å¦‚ä½•æ­å»ºè‡ªå·±çš„ä¸ªäººåšå®¢","slug":"CreateBlog","date":"2015-03-04T17:04:20.000Z","updated":"2017-04-19T09:09:07.000Z","comments":true,"path":"2015/03/05/CreateBlog/","link":"","permalink":"Aaronzjp.cn/2015/03/05/CreateBlog/","excerpt":"è‡ªå·±ä¹Ÿæ­å»ºäº†ä¸ªäººåšå®¢ï¼Œåœ¨æ­å»ºçš„è¿‡ç¨‹ä¸­ä¹Ÿåˆé‡åˆ°äº†å¾ˆå¤šé—®é¢˜ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘è‡ªå·±æ¥æ€»ç»“ä¸€ä¸‹ï¼Œæ­å»ºä¸€ä¸ªåšå®¢çš„è¿‡ç¨‹ã€‚æ–¹ä¾¿ä»¥ååšå®¢å‡ºé—®é¢˜çš„æ—¶å€™æ¥è¿™é‡ŒæŸ¥æ‰¾ã€‚","text":"è‡ªå·±ä¹Ÿæ­å»ºäº†ä¸ªäººåšå®¢ï¼Œåœ¨æ­å»ºçš„è¿‡ç¨‹ä¸­ä¹Ÿåˆé‡åˆ°äº†å¾ˆå¤šé—®é¢˜ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘è‡ªå·±æ¥æ€»ç»“ä¸€ä¸‹ï¼Œæ­å»ºä¸€ä¸ªåšå®¢çš„è¿‡ç¨‹ã€‚æ–¹ä¾¿ä»¥ååšå®¢å‡ºé—®é¢˜çš„æ—¶å€™æ¥è¿™é‡ŒæŸ¥æ‰¾ã€‚ é¦–å…ˆç¯å¢ƒæ­å»º å®‰è£…Node.jsã€‚å®˜ç½‘ä¸‹è½½ï¼Œä¸‹è½½åæ‰“å¼€æŒ‰ç…§æç¤ºä¸€æ­¥ä¸€æ­¥çš„å®‰è£…å³å¯ã€‚ gitè¿™ä¸ªä¸ç”¨å¤šè¯´ï¼Œå› ä¸ºæˆ‘ä½¿ç”¨çš„æ˜¯Macç”µè„‘ï¼Œæ‰€ä»¥è‡ªå¸¦gitã€‚ npmçš„å®‰è£…ï¼Œnpmä½¿ç”¨å‘½ä»¤å®‰è£… npm install -g hexo-cli,ä¹Ÿå¯ä»¥åˆ°å®˜ç½‘ä¸‹è½½ä¸‹æ¥è¿›è¡Œå®‰è£…å®˜ç½‘é“¾æ¥ ä¸Šé¢å‡ æ­¥åšå¥½åæˆ‘ä»¬çš„å‡†å¤‡å·¥ä½œå°±åšçš„å·®ä¸å¤šäº†ï¼ŒæŸ¥çœ‹ä¸Šé¢çš„å·¥å…·æ˜¯å¦å®‰è£…æˆåŠŸå¯ä»¥é€šè¿‡æŸ¥çœ‹ç‰ˆæœ¬çš„æ–¹å¼æ¥æŸ¥çœ‹ã€‚å¦‚ï¼šnode -v å»ºç«‹æœ¬åœ°ç«™ç‚¹ hexo init &lt;æ–‡ä»¶å¤¹åç§°&gt; cd &lt;æ–‡ä»¶å¤¹åç§°&gt; npm install å…‹éš†ä¸»é¢˜&emsp;&emsp;ä¸çŸ¥é“åœ¨å“ªæ‰¾ä¸»é¢˜å§ï¼Œå¯ä»¥è¿›å…¥åˆ°å®˜ç½‘é“¾æ¥å»æŸ¥çœ‹ï¼Œç‚¹å‡»ä¸»é¢˜é‡Œé¢æœ‰ä¸€éƒ¨åˆ†çš„ä¸»é¢˜ï¼Œä¹Ÿå¯ä»¥å»è¿™é‡Œ æœ‰å“ªäº›å¥½çœ‹çš„hexoä¸»é¢˜ï¼Ÿ å‘å¸ƒåˆ°github æ³¨å†Œgithubè¿™äº›æˆ‘å°±ä¸è¯´äº†å§ï¼Œè¿›å…¥åˆ°githuç™»é™†è´¦å·åï¼Œç‚¹å‡»New repositoryåˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼Œæ³¨æ„è¿™é‡Œçš„è¿™ä¸ªé¡¹ç›®å‘½åæ˜¯æœ‰è§„å®šçš„ï¼Œå¿…é¡»æ˜¯å¦‚ä¸‹çš„è¿™ç§æ ¼å¼å‘½åï¼š ä½ çš„githubåç§°.github.io â€‹ å› ä¸ºgithubè§„å®šåªèƒ½æ˜¯è¿™æ ·å‘½åçš„æ‰èƒ½ä»¥pageçš„æ ·å¼å±•ç°ï¼Œå…¶ä»–çš„å…¨éƒ¨é»˜è®¤å°±å¥½ï¼Œåˆ›å»ºå®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥åƒå¹³æ—¶ä½¿ç”¨githubä¸€æ ·çš„ï¼ŒæŠŠåšå®¢çš„æ–‡ä»¶pushåˆ°è¿™ä¸ªé¡¹ç›®å³å¯ã€‚ï¼ˆæ³¨æ„pushåšå®¢çš„æ—¶å€™æ˜¯push&lt;æ–‡ä»¶å¤¹åç§°&gt;â€“&gt;publicè¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰çš„æ–‡ä»¶ï¼‰ã€‚ ä¸ºäº†æ›´æ–¹ä¾¿çš„ç®¡ç†åšå®¢å’Œå¹³æ—¶æ–‡ä»¶çš„æ›´æ–°ï¼Œæˆ‘ä»¬æ¥é…ç½®ä¸€ä¸ªdeployã€‚æ‰“å¼€ç«™ç‚¹é…ç½®æ–‡ä»¶_config.ymlï¼Œæ‰¾åˆ°deployå­—æ®µï¼Œä¿®æ”¹æˆå¦‚ä¸‹çš„æ ·å¼å³å¯ã€‚ 1234567&gt; # Deployment&gt; ## Docs: http://hexo.io/docs/deployment.html&gt; deploy:&gt; type: git&gt; repository: git@github.com:ç”¨æˆ·å/ç”¨æˆ·å.github.io.git&gt; branch: master&gt; è¿™æ ·é…ç½®å¥½ä»¥åï¼Œæœ‰æ–°çš„åšå®¢æ·»åŠ ï¼Œæˆ–è€…ä¿®æ”¹åï¼Œåªéœ€è¦æ‰§è¡Œå¦‚ä¸‹çš„æ“ä½œå°±å¯ä»¥å°†åšå®¢å‘å¸ƒåˆ°githubï¼š hexo g //ç”Ÿæˆé™æ€ç½‘é¡µ hexo s //éƒ¨ç½²åœ¨æœ¬åœ°ï¼Œæ­¤æ­¥æ“ä½œå®Œåå°±å¯ä»¥åœ¨æœ¬åœ°æŸ¥çœ‹ç½‘é¡µé¢„è§ˆ hexo deploy //æ²¡æœ‰é—®é¢˜åå°±å¯ä»¥éƒ¨ç½²åˆ°githubä¸Šäº† è¿™ä¸‰æ­¥æ“ä½œå®Œæˆåå°±å…¶ä»–äººä¹Ÿå¯ä»¥é€šè¿‡githubæ¥è®¿é—®ä½ çš„ä¸ªäººåšå®¢äº†ã€‚ âš ï¸æ³¨æ„ï¼šä½¿ç”¨hexo dæ¥éƒ¨ç½²åšå®¢åˆ°githubé¦–å…ˆè¦å®‰è£…ä¸€ä¸ªæ’ä»¶hexo-deployer-gitï¼Œå®‰è£…æ–¹å¼ï¼Œcd åˆ°ä½ å½“å‰çš„åšå®¢æ ¹ç›®å½•æ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š npm install hexo-deployer-git â€“save å‘å¸ƒæ–°çš„æ–‡ç« hexo new &quot;æ–‡ç« æ ‡é¢˜åç§°&quot; æ‰§è¡Œä»¥ä¸Šå‘½ä»¤åï¼Œç›¸åº”æ–‡ä»¶å¤¹ä¸­ç”Ÿæˆ.mdæ–‡ä»¶ï¼Œæ‰¾åˆ°ç¼–è¾‘å¹¶ä¿å­˜åã€‚æ‰§è¡Œä»¥ä¸Šå‘å¸ƒåˆ°githubè¿™éƒ¨åˆ†ï¼Œå°±å¯ä»¥æŠŠæ–‡ç« å‘å¸ƒå‡ºå»äº†ã€‚ hexo cleanæ¸…ç†ï¼Œè¿™ä¸ªæ“ä½œä¼šå°†publicæ–‡ä»¶å¤¹åˆ é™¤ï¼Œè¿™ä¸ªæ…ç”¨ï¼Œåœ¨é‡åˆ°é—®é¢˜çš„æ—¶å€™å¯ä»¥é€šè¿‡è¿™ä¸ªæ¥æ¸…é™¤åå†é€šè¿‡hexo gé‡æ–°ç”Ÿæˆï¼Œå¹¶åŒæ­¥åˆ°githubã€‚","categories":[{"name":"å…¶ä»–","slug":"å…¶ä»–","permalink":"Aaronzjp.cn/categories/å…¶ä»–/"}],"tags":[{"name":"å…¶ä»–","slug":"å…¶ä»–","permalink":"Aaronzjp.cn/tags/å…¶ä»–/"}]}]}